olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c
Type: OLE
ERROR    Error when running oledump.plugin_biff, please report to https://github.com/decalage2/oletools/issues
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/oletools/thirdparty/oledump/plugin_biff.py", line 84, in P23Decode
    return value.decode('utf-8')
UnicodeDecodeError: 'utf-8' codec can't decode byte 0x92 in position 3: invalid start byte

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 3435, in _extract_xlm_plugin_biff
    self.xlm_macros = biff_plugin.Analyze()
  File "/usr/local/lib/python3.8/dist-packages/oletools/thirdparty/oledump/plugin_biff.py", line 5346, in Analyze
    name = P23Decode(data[offset:offset+lnName])
  File "/usr/local/lib/python3.8/dist-packages/oletools/thirdparty/oledump/plugin_biff.py", line 86, in P23Decode
    return value.decode('windows-1252')
  File "/usr/lib/python3.8/encodings/cp1252.py", line 15, in decode
    return codecs.charmap_decode(input,errors,decoding_table)
UnicodeDecodeError: 'charmap' codec can't decode byte 0x8d in position 4: character maps to <undefined>
-------------------------------------------------------------------------------
VBA MACRO ThisWorkbook.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/ThisWorkbook'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet1.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet2.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet3.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet4.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet5.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet5'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module41.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module41'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Sheet7.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet7'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet8.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet8'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet9.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet9'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Sheet10.cls 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Sheet10'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module11.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module11'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module12.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module12'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module13.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module13'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module14.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module2.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module2'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module3.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module3'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module4.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module4'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module5.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module5'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module6.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module6'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module7.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module7'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module8.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module8'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function


-------------------------------------------------------------------------------
VBA MACRO Module9.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module9'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module10.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module10'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module15.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module15'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module16.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module16'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module17.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module17'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module18.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module18'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module19.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module19'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module20.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module20'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module21.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module21'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module22.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module22'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module23.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module23'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module24.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module24'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module25.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module25'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function


-------------------------------------------------------------------------------
VBA MACRO Module26.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module26'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module27.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module27'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module28.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module28'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module29.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module29'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module30.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module30'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module31.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module31'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module32.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module32'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module33.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module33'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module110.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module110'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module34.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module34'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module35.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module35'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module111.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module111'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module36.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module36'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module112.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module112'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module113.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module113'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function
-------------------------------------------------------------------------------
VBA MACRO Module37.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module37'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module38.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module38'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module39.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module39'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

-------------------------------------------------------------------------------
VBA MACRO Module40.bas 
in file: Virus.MSExcel.Yagnuul.w-335f9b48a37f611d13187c69ec611a5bfb609d911d563135d5a39a74d6b7d42c - OLE stream: '_VBA_PROJECT_CUR/VBA/Module40'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Function tien_bang_chu(Tien As Double, DonVi As String, Optional TienXu As String) As String
  Dim mchuoi As String, mdem As Byte, mnhom As String * 3, tbc As String
  Dim v1 As String * 1, v2 As String * 1, v3 As String * 1
  Dim mphannguyen As String
  
  tien_bang_chu = ""
  If Not IsNumeric(Tien) Then
    MsgBox "Tham so cua ham phai la so", 16
    Exit Function
  End If

  Dim mkhongdong As String, mtram As String, mmuoi As String, mle As String, mmuoif As String
  Dim mlam As String, mnam As String, mmot As String, mmots As String, mty As String, mtrieu As String
  Dim mdong As String, mbon As String, mbay As String
  
  Const mkhong = "không"
  Const mngan = "ngàn"
  Const msau = "sáu"
  Const mtam = "tám"
  Const mchin = "chín"
  
  mkhongdong = mkhong & " " & DonVi
  mtram = "tr" & ChrW(259) & "m"
  mmuoi = "m" & ChrW(432) & ChrW(417) & "i"
  mle = "l" & ChrW(7867)
  mmuoif = "m" & ChrW(432) & ChrW(7901) & "i"
  mlam = "l" & ChrW(259) & "m"
  mnam = "n" & ChrW(259) & "m"
  mmot = "m" & ChrW(7897) & "t"
  mmots = "m" & ChrW(7889) & "t"
  mty = "t" & ChrW(7927)
  mtrieu = "tri" & ChrW(7879) & "u"
  mbon = "b" & ChrW(7889) & "n"
  mbay = "b" & ChrW(7849) & "y"

  If Tien = 0 Then
    tien_bang_chu = mkhongdong
    Exit Function
  End If

  mchuoi = Format$(Tien, "000000000000.00")
  mphannguyen = Left(mchuoi, Len(mchuoi) - 3)
  tbc = ""
  
  For mdem = 1 To 4
    mnhom = Mid$(mphannguyen, mdem * 3 - 2, 3)
    If mnhom <> "000" Then
      v1 = Left(mnhom, 1)
      v2 = Mid(mnhom, 2, 1)
      v3 = Right(mnhom, 1)
      tbc = RTrim(tbc) & " " & IIf(v1 <> "0", Choose(v1 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mtram, "")

      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
      ElseIf v2 = "0" Then
        If v1 <> "0" And v3 <> "0" Then
          tbc = RTrim(tbc) & " " & mle
        End If
      ElseIf v2 = "1" Then
        tbc = RTrim(tbc) & " " & mmuoif
      End If
      
      If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
        tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
      ElseIf v3 = "5" Then
        If v2 <> "0" Then
          tbc = RTrim(tbc) & " " & mlam
        Else
          tbc = RTrim(tbc) & " " & mnam
        End If
      ElseIf v3 = "1" Then
        If v2 <> "0" And v2 <> "1" Then
          tbc = RTrim(tbc) & " " & mmots
        Else
          tbc = RTrim(tbc) & " " & mmot
        End If
      End If

      tbc = RTrim(tbc) & " " & IIf(mdem = 1, mty, IIf(mdem = 2, mtrieu, IIf(mdem = 3, mngan, "")))
      tbc = LTrim(tbc)
      tbc = UCase(Left(tbc, 1)) & Mid(tbc, 2)
    End If
  Next mdem
  
  mphannguyen = Right(mchuoi, 2)
  If mphannguyen <> "00" Then
    tbc = tbc & DonVi
    v2 = Left(mphannguyen, 1)
    v3 = Right(mphannguyen, 1)
  
    If v2 <> "0" And v2 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v2 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin) & " " & mmuoi
    ElseIf v2 = "0" Then
      If v1 <> "0" And v3 <> "0" Then
        tbc = RTrim(tbc) & " " & mle
      End If
    ElseIf v2 = "1" Then
      tbc = RTrim(tbc) & " " & mmuoif
    End If
      
    If v3 <> "0" And v3 <> "5" And v3 <> "1" Then
      tbc = RTrim(tbc) & " " & Choose(v3 + 1, mkhong, mmot, "hai", "ba", mbon, mnam, msau, mbay, mtam, mchin)
    ElseIf v3 = "5" Then
      If v2 <> "0" Then
        tbc = RTrim(tbc) & " " & mlam
      Else
        tbc = RTrim(tbc) & " " & mnam
      End If
    ElseIf v3 = "1" Then
      If v2 <> "0" And v2 <> "1" Then
        tbc = RTrim(tbc) & " " & mmots
      Else
        tbc = RTrim(tbc) & " " & mmot
      End If
    End If
    
    tien_bang_chu = tbc & " " & TienXu
  Else
    tien_bang_chu = tbc & DonVi
  End If
End Function

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|Suspicious|ChrW                |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

