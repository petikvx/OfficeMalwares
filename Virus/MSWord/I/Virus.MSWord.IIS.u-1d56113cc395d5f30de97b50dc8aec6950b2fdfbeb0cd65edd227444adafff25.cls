olevba 0.60.1 on Python 3.8.10 - http://decalage.info/python/oletools
===============================================================================
FILE: Virus.MSWord.IIS.u-1d56113cc395d5f30de97b50dc8aec6950b2fdfbeb0cd65edd227444adafff25
Type: OLE
-------------------------------------------------------------------------------
VBA MACRO ThisDocument.cls 
in file: Virus.MSWord.IIS.u-1d56113cc395d5f30de97b50dc8aec6950b2fdfbeb0cd65edd227444adafff25 - OLE stream: 'Macros/VBA/ThisDocument'
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - 
Private Sub Document_Open()
¼„ð†ø±ë”��±Øï¾÷�É…øÍìÀÞ˜– ÑÝãß�ª±¦½ = "è"
§ß°º™Ê„Å±«Û¶¾±ªÃ¤­ñÐ‘÷É¢¯ã›ÍÈÍÍÏ‘ÜÛ¢¸Í›ž = "Ï‚òÛÓ‰Œ›’ÇÕ"
–—î•À²èð›¥Æìîì¾¯ŽõÎ·£Ý¨Å�†¯µãÅ¨ø¿è›¬ = "ÝÍÏ‚—â”Ä‚ž˜Áïšõæ•ÙÚ"
õÅç�¦ÜåÒÒÄ ¸ÞË·Û¹ïÄ¾êÇõ�ˆÒÕ¼ = "¥ÏÄ²÷¨ÛöŒ"
‰Œè†­ÃÄŒ = "´ë«ë"
Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¢øàã¶àîÆ†ÂšÂò®¹¦Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÔ™Õ©�Ïìœ™óœïÕ•Ÿ†ŸÓ±¿ = "© —‡Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ„×ãÂ©²Ð‘æ¿�"
íœ“¸§ ©„”î“ƒäµîôÍú…Üê¡Ä¤°ÀÌžô«¬†íª³ƒŒ™êÔéí®�ù = "‘Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñŒôµë"
à•ôÎÊŸÀÙèöÔô§Õø‡®°ƒó£º»ÚÆ¡ ­¥øÍŽ˜¦�í�ó = "¤À"
È­úôªòÎú¸À‹ÞˆÊ™»×»ìéÉ¸ Ö”úù™›æóªŠ¼©ÒÕ¨Ð„óàŒ”œ‰èõáÔ™§±¸ = "¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™½®…ñµ�ÖÖ"
¦‚ÂŠÁêÉ¦µÙ­¿ ò¤çïŽ¬ÁÚ†¿èòÇ’‚Žë„¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™„ÔÝ‰™¯Õè´ÓÖ±¤ = "àßÓ×›Â�½±„„“�Ê�"
¬¶�Ê¶“‘»£ðÂÆ¤”Ì‹ÈàŽéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡�¡¤¾šÉ¡äÌ›Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¦Ë­î¥´é = "”ë¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ŽÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñò"
Çôû«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÔšÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÇÉìÀ¼¡ÃË´�ÀšŸªÈØŽ®½Úá°”¾ÛšŽÞÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ”ÏÁÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ� = "íéæùÊ›À‘„Ù»žã"
ª”ßÒ�Ë¨¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™áÑŸúÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¥ä‰µé¹‡‡‹¾Á‡½¼Ú‚¦ = "²�Ñ²‚–Ü¡ì¸”½ÏÓ¶Ž"
Ð­äÇ¯¾ïž�…Óî¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸ÊŽï® = "�ºÙª"
ß‹È®éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÏŠøô†ÌŸ¡¾¹ùŠ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™™Ýà–ßÝƒÓ‰Ýç„…ì½àë = "»ïˆ˜®Ëð©ƒ�¯§�£Ô"
’èÐ“†ùàÆ�’›…„§¯®»½éº = "¡›ê­´¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¹ó‹™×ï²ðˆ"
ÇéÛêÝô¨í‚¸ô‡ËÆèç¹Ù�êÛ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Òìµš„Þ = "ƒÞ‡á±¥ª"
ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµùÌÛ–ò”Ä = "§éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡“ö•éî¦º×¦µ¾„§®ë"
ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÚô¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÞ¨è¸–Ð¶òÙ = "¦ÜßçÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÀÏ‘¯�¨Ë�"
ÝÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ê«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ªÊ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™º¬ª¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‚ëØ¸žµÙ¢Éð×È³©ìŠ×ø’¥Ô÷žñÔõÂ¨ = "�Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ˜°êÂžâÞßÂ¥±êËÔ�­â¹¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™êæÆ¡Û"
ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµÆ¨Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÚ¥¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¢Ôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ï  = "´˜Ä¶ŸÂõ§ö¢ïç"
¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = ActiveDocument.VBProject.VBComponents(1).CodeModule.countoflines
¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð = NormalTemplate.VBProject.VBComponents(1).CodeModule.countoflines
Application.Options.VirusProtection = False
Application.EnableCancelKey = wdCancelDisabled
WordBasic.DisableAutoMacros 0
Options.SaveNormalPrompt = False
If ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ > 169 And ¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð > 169 Then Exit Sub
If ¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð > 169 Then
Set ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ = ActiveDocument
Set à÷Îæòðä = NormalTemplate
GoTo •Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊ¨Ä ÖÌÓÙ£¡µˆ­Á¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ðé§’ë ±Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
End If
If ¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð < 170 Then
Set ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ = NormalTemplate
Set à÷Îæòðä = ActiveDocument
End If
ReDim Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(50, 50)
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ = à÷Îæòðä.VBProject.VBComponents(1).CodeModule.countoflines
¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = 0
Do Until ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ + 1
Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸ = à÷Îæòðä.VBProject.VBComponents(1).CodeModule.Lines(¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™, 1)
If Left(Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸, 1) = "'" Then
©ºîö�¼é·ˆ˜Àô = Len(Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸)
Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸ = Mid(Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸, 2, ©ºîö�¼é·ˆ˜Àô)
™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ = ""
Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„— = Len(Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸)
Randomize Timer
Ò–¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¡¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™µÎÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÐØ�‡£®×ÂŽ½É×¡´²:
�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì = CInt(Rnd * 30) + 1
For Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ = 1 To �ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì
'¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð
'ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ
'à÷Îæòðä
'Â¥±êËÔ�­â
'¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'©ºîö�¼é·ˆ˜Àô
'éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
'¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™
'Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ
'¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'©ºîö�¼é·ˆ˜Àô
'éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
'¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™
'Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'Ò–¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¡¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™µÎÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÐØ�‡£®×ÂŽ½É×¡´²
'¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'ÊŽâ¥ÖÆµ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí›«ïÚÝéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡³Ô¼
'Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð
'Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—
'Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
'Æî¨µéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ ƒ¥Ï§ÚÊ®ÆùÊ­”ôÄá™°Ä¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ÄÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'×¥È¥ä’´–…‹±“ú…žÇ¨ªû¨­¹³¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ðçŽ±éç¾´¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™³ŸËä¹õ¿Ð‹�ˆ°¹Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ
'¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð
'©ºîö�¼é·ˆ˜Àô
'Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ
'©ºîö�¼é·ˆ˜Àô
'éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
'¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™
'Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ
'áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
'Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
'öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä
'ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�
'õÄÈÎáÞÏäÖò©ºîö�¼é·ˆ˜Àôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ìÙÚáç¶¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™í–Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯
'áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
'�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì
'Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­
'¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™
'¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí
'¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä
'•Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊ¨Ä ÖÌÓÙ£¡µˆ­Á¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ðé§’ë ±Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
'ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµ
õÄÈÎáÞÏäÖò©ºîö�¼é·ˆ˜Àôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ìÙÚáç¶¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™í–Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ:
¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä = CInt(Rnd * 250) + 1
If ¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä = 13 Then GoTo õÄÈÎáÞÏäÖò©ºîö�¼é·ˆ˜Àôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ìÙÚáç¶¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™í–Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
If ¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä < 65 Then GoTo õÄÈÎáÞÏäÖò©ºîö�¼é·ˆ˜Àôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ìÙÚáç¶¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™í–Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
If ¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä < 130 Then GoTo õÄÈÎáÞÏäÖò©ºîö�¼é·ˆ˜Àôºéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ìÙÚáç¶¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™í–Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ = ™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ & Chr(¦¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíª«—éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ÛÚÍíÍ¼�Ç´óÌ»“¨–èä¶ä)
Next Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»� = ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»� + 1
Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�, 1) = Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�, 2) = ™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯
End If
Loop
•Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊ¨Ä ÖÌÓÙ£¡µˆ­Á¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ðé§’ë ±Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ:
¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = 1
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ = "Private Sub Document_Open()" & Chr(13)
If ¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð < 170 Then
�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì = CInt(Rnd * 30) + 1
For Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ = 1 To �ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì
áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî:
Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð = CInt(Rnd * 250)
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð = 13 Then GoTo áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð < 65 Then GoTo áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð < 130 Then GoTo áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ = ™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ & Chr(Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð)
Next Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì = CInt(Rnd * 20)
For áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî = 1 To �ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì
Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸:
Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð = CInt(Rnd * 250)
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð = 13 Then GoTo Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð = 34 Then GoTo Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
If Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð < 130 Then GoTo Ð­äÇ¯¾ïž�…Óî¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí‡£¥ƒ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™Õ×½¸
¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí = ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí & Chr(Ü¿Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÏ‘Ô´˜ð)
Next áÞ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™°ð×È³©ìŠ×ø’¥Ô÷žñÔõÂò¦¬ˆØš�Ïéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡Ê¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™šÔ ‡ÄíÝ‚¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíøÄˆäî
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ = éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ & ™Ý¾õ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™…óÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¡É­×Ê´¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí ‡Õò˜˜±ÙêÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ & "=" & Chr(34) & ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí & Chr(34) & Chr(13)
End If
©ºîö�¼é·ˆ˜Àô = à÷Îæòðä.VBProject.VBComponents(1).CodeModule.countoflines
For Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ = 2 To ©ºîö�¼é·ˆ˜Àô
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ = éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ & à÷Îæòðä.VBProject.VBComponents(1).CodeModule.Lines(Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ, 1) & Chr(13)
Next Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ
If ¢†¼Üòâ¡Ü¬±±¾”¥²ö„¬Ãµ¶—˜½›ð > 169 Then GoTo ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµ
Do
©ºîö�¼é·ˆ˜Àô = 0
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ = Len(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ)
¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí = ¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí + 1
If Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí, 1) = "" Then GoTo ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµ
Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„— = Len(Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí, 1))
�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì = Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí, 1)
Do Until ©ºîö�¼é·ˆ˜Àô = éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ = Len(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ)
©ºîö�¼é·ˆ˜Àô = ©ºîö�¼é·ˆ˜Àô + 1
¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™ = Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô, Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—)
If UCase(¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™) = UCase(�ùéÎ¶ë‰¯©ºîö�¼é·ˆ˜Àô¸ÕÎ˜ÇéØ©ºîö�¼é·ˆ˜Àô¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíÀÂç¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽÍ­Áµïõì) Then
If ©ºîö�¼é·ˆ˜Àô = 1 Then
ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»� = Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô + Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—, 1)
Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 0
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 65 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 90 And Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 97 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 122 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1 Then
öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä = öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä & Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí, 2) & Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô + Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—, éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡)
End If
Else
Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 0
ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»� = Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô - 1, 1)
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 65 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 90 And Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 97 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 122 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1 Then
ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»� = Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô + Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—, 1)
Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 0
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 65 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 90 And Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) < 97 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Asc(ª£¨§©ôä«Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÊøæû±™ð×ïÉéð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡û£»�) > 122 Then Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1
If Èî§Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñ¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™×¹¥ÆéšÁ = 1 Then
öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä = Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, 1, ©ºîö�¼é·ˆ˜Àô - 1)
öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä = öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä & Ö¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí¦š¹ÆÆëÙ·Î³‘¬ÆÛ¾Ýø¾§ôá¼Á¨ð�²™¾ÆëÝæ³ˆ³–¦¶“ð¥Û»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñÛ»àŒ¦úÍŽ½Üš‚’á†ŠÌŒöÐòØˆñéß­(¥È¥ä’´–…‹±“ú…ž¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí, 2) & Mid(éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ, ©ºîö�¼é·ˆ˜Àô + Ö•†‚§¿²¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†ËíŽ²¡ê„„—, éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡)
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ = öÆ¬ï„¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëí’“Ô›°Ÿó‚–™†‹™�¿­„ä
End If
End If
End If
End If
Loop
Loop
ƒÛ¯ôÕ©ªé§¥«Ù»‚Í‚§Ýø°äÐÔ†Ëíö½½öù–éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¼ÚìÜèÈéµ:
éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡ = ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ.VBProject.VBComponents(1).CodeModule.countoflines
ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ.VBProject.VBComponents(1).CodeModule.deletelines 1, éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡
ð×È³©ìŠ×ø’¥Ô÷žñÔõÂ.VBProject.VBComponents(1).CodeModule.AddFromstring (éð¿�Æâ�ì¤ëÉ×Îì�¸†’ó²¤íÂ¤Ôî�»�¡¸•©ºîö�¼é·ˆ˜Àôú»ÚÒ�¸Ÿ™”íºë«�ÇÄ)
End Sub










































+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_Open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|VBProject           |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|VBComponents        |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|CodeModule          |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
|Suspicious|AddFromstring       |May attempt to modify the VBA code (self-    |
|          |                    |modification)                                |
+----------+--------------------+---------------------------------------------+

